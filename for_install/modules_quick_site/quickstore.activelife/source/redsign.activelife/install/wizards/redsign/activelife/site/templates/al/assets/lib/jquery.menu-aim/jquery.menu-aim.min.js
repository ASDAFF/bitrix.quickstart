(function(b){var a=function(d,c){this.$menu=this.activeRow=this.mouseLocs=this.lastDelayLoc=this.timeoutId=this.options=null;this.init(d,c)};a.DEFAULTS={rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:b.noop,exit:b.noop,activate:b.noop,deactivate:b.noop,exitMenu:b.noop};a.prototype.getDefaults=function(){return a.DEFAULTS};a.prototype.mousemoveDocument=function(c){this.mouseLocs.push({x:c.pageX,y:c.pageY});if(this.mouseLocs.length>this.MOUSE_LOCS_TRACKED){this.mouseLocs.shift()}};a.prototype.mouseleaveMenu=function(){if(this.timeoutId){clearTimeout(this.timeoutId)}if(this.options.exitMenu(this)){if(this.activeRow){this.options.deactivate(this.activeRow)}this.activeRow=null}};a.prototype.mouseenterRow=function(c){if(this.timeoutId){clearTimeout(this.timeoutId)}this.options.enter(c.currentTarget);this.possiblyActivate(c.currentTarget)};a.prototype.mouseleaveRow=function(c){this.options.exit(c.currentTarget)};a.prototype.clickRow=function(c){this.activate(c.currentTarget)};a.prototype.activate=function(c){if(c==this.activeRow){return}if(this.activeRow){this.options.deactivate(this.activeRow)}this.options.activate(c);this.activeRow=c};a.prototype.possiblyActivate=function(e){var d=this.activationDelay(),c=this;if(d){this.timeoutId=setTimeout(function(){c.possiblyActivate(e)},d)}else{this.activate(e)}};a.prototype.activationDelay=function(){if(!this.activeRow||!b(this.activeRow).is(this.options.submenuSelector)){return 0}var g=this.$menu.offset(),c={x:g.left,y:g.top-this.options.tolerance},n={x:g.left+this.$menu.outerWidth(),y:c.y},p={x:g.left,y:g.top+this.$menu.outerHeight()+this.options.tolerance},h={x:g.left+this.$menu.outerWidth(),y:p.y},i=this.mouseLocs[this.mouseLocs.length-1],m=this.mouseLocs[0];if(!i){return 0}if(!m){m=i}if(m.x<g.left||m.x>h.x||m.y<g.top||m.y>h.y){return 0}if(this.lastDelayLoc&&i.x==this.lastDelayLoc.x&&i.y==this.lastDelayLoc.y){return 0}function j(r,q){return(q.y-r.y)/(q.x-r.x)}var l=n,d=h;if(this.options.submenuDirection=="left"){l=p;d=c}else{if(this.options.submenuDirection=="below"){l=h;d=p}else{if(this.options.submenuDirection=="above"){l=c;d=n}}}var e=j(i,l),k=j(i,d),o=j(m,l),f=j(m,d);if(e<o&&k>f){this.lastDelayLoc=i;return this.DELAY}this.lastDelayLoc=null;return 0};a.prototype.destroy=function(){this.$menu.removeData("jquery.menu-aim");this.$menu.off(".menu-aim").find(this.options.rowSelector).off(".menu-aim");b(document).off(".menu-aim")};a.prototype.reset=function(c){if(this.timeoutId){clearTimeout(this.timeoutId)}if(this.activeRow&&c){this.options.deactivate(this.activeRow)}this.activeRow=null};a.prototype.init=function(c,d){this.$menu=b(c);this.activeRow=null;this.mouseLocs=[];this.lastDelayLoc=null;this.timeoutId=null;this.options=b.extend({},this.getDefaults(),d);this.MOUSE_LOCS_TRACKED=3;this.DELAY=300;this.$menu.on("mouseleave.menu-aim",b.proxy(this.mouseleaveMenu,this)).find(this.options.rowSelector).on("mouseenter.menu-aim",b.proxy(this.mouseenterRow,this)).on("mouseleave.menu-aim",b.proxy(this.mouseleaveRow,this)).on("click.menu-aim",b.proxy(this.clickRow,this));b(document).on("mousemove.menu-aim",b.proxy(this.mousemoveDocument,this))};b.fn.menuAim=function(c){return this.each(function(){var f=b(this),e=f.data("jquery.menu-aim"),d=typeof c=="object"&&c;if(!e){f.data("jquery.menu-aim",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})}})(jQuery);