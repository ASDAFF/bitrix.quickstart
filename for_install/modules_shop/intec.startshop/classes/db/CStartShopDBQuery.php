<? $GLOBALS['_765963362_']=Array('def' .'i' .'ne','def' .'ine','' .'def' .'ine','define','intval','is_array','str' .'val','is_ar' .'ray','str' .'va' .'l','str' .'val','is_ar' .'ray','strva' .'l','is_a' .'rr' .'ay','' .'strval','is_array','intval','intval','' .'is_array','implode','implo' .'de','i' .'s_a' .'rray','i' .'s_' .'num' .'er' .'i' .'c','s' .'ubstr','su' .'b' .'st' .'r','is_a' .'rr' .'ay','strv' .'al','' .'st' .'rlen','subst' .'r','subst' .'r','i' .'n_a' .'r' .'ra' .'y','st' .'rlen','subs' .'tr','' .'sub' .'str','is_array','' .'substr','substr','' .'is_arr' .'ay','strval','implo' .'de','im' .'plode','implo' .'de','' .'im' .'plode','i' .'mplode','' .'intval','intval','' .'in' .'t' .'v' .'al','strt' .'oupper','implode','' .'st' .'rval','implode','s' .'trval','i' .'mplode','count','co' .'unt','co' .'u' .'nt','c' .'ount','' .'co' .'un' .'t'); ?><? function _666170371($i){$a=Array('STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT','STARTSHOP_UTILS_DB_QUERY_TYPE_INSERT','STARTSHOP_UTILS_DB_QUERY_TYPE_DELETE','STARTSHOP_UTILS_DB_QUERY_TYPE_UPDATE','*','*',' ',' FROM ',' WHERE ',' ORDER BY ',' LIMIT ',' INTO ',' (',')',' VALUES (',')',' FROM ',' WHERE ',' ',' SET ',' WHERE ','SELECT',' DISTINCT','','INSERT','DELETE','UPDATE','*','`','*',', ',', ','OR','AND','!','`','=','`','`','`','','','>=','<=','>=','`','>','`','<=','`','<','`','!','NOT `','=','`','`','`','LOGIC','LOGIC','LOGIC','(','\'','\'','!','`',', ',')','=','`',', ',')','`',', ',')','`',', ',')',' ',' ','','','DESC','ASC','`',', ','','NULL','`','`',', ','','`','`','\'',', ','');return $a[$i];} ?><? $GLOBALS['_765963362_'][0](_666170371(0),0);$GLOBALS['_765963362_'][1](_666170371(1),round(0+1));$GLOBALS['_765963362_'][2](_666170371(2),round(0+0.5+0.5+0.5+0.5));$GLOBALS['_765963362_'][3](_666170371(3),round(0+0.6+0.6+0.6+0.6+0.6));class CStartShopDBQuery{protected $Type=0;protected $IsDistinct=false;protected $Fields=array('*');protected $Tables=array();protected $Conditions=array();protected $Values=array();protected $Limit=array(null,null);protected $Order=array();public function __construct($_0){$_0=$GLOBALS['_765963362_'][4]($_0);if($_0<0|| $_0>round(0+0.75+0.75+0.75+0.75))$_0=0;$this->Type=$_0;}public static function Select(){return new static(STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT);}public static function Insert(){return new static(STARTSHOP_UTILS_DB_QUERY_TYPE_INSERT);}public static function Delete(){return new static(STARTSHOP_UTILS_DB_QUERY_TYPE_DELETE);}public static function Update(){return new static(STARTSHOP_UTILS_DB_QUERY_TYPE_UPDATE);}public function Distinct($_1){if($this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT)return $this;$this->IsDistinct=$_1 === true;return $this;}public function Fields($_2){if($this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT)return $this;if($GLOBALS['_765963362_'][5]($_2)){if(!empty($_2)){$this->Fields=$_2;}else{$this->Fields=array(_666170371(4));}}else{$_2=$GLOBALS['_765963362_'][6]($_2);if(!empty($_2)){$this->Fields=array($_2);}else{$this->Fields=array(_666170371(5));}}return $this;}public function From($_3){if($this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT && $this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_DELETE)return $this;if($GLOBALS['_765963362_'][7]($_3)){$this->Tables=$_3;}else{$_3=$GLOBALS['_765963362_'][8]($_3);if(!empty($_3))$this->Tables=array($_3);}return $this;}public function Into($_4){if($this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_INSERT)return $this;$_4=$GLOBALS['_765963362_'][9]($_4);if(!empty($_4))$this->Tables=array($_4);return $this;}public function Tables($_3){if($this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_UPDATE)return $this;if($GLOBALS['_765963362_'][10]($_3)){$this->Tables=$_3;}else{$_3=$GLOBALS['_765963362_'][11]($_3);if(!empty($_3))$this->Tables=array($_3);}return $this;}public function Values($_5){if($this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_INSERT && $this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_UPDATE)return $this;$this->Fields=array();$this->Values=array();if($GLOBALS['_765963362_'][12]($_5)){foreach($_5 as $sField => $_6)if(!empty($sField)){$this->Fields[]=$sField;if($_6 !== null){$this->Values[]=$GLOBALS['_765963362_'][13]($_6);}else{$this->Values[]=null;}}}return $this;}public function Where($_7){if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_INSERT)return $this;if($GLOBALS['_765963362_'][14]($_7))$this->Conditions=$_7;return $this;}public function Limit($_8=null,$_9=null){if($this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT)return $this;if($_8 !== false)$_8=$GLOBALS['_765963362_'][15]($_8);if($_9 !== false)$_9=$GLOBALS['_765963362_'][16]($_9);$this->Limit=array($_8,$_9);return $this;}public function OrderBy($_7){if($this->Type != STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT)return $this;if($GLOBALS['_765963362_'][17]($_7))$this->Order=$_7;return $this;}public function GetString(){$_10=$this->GetHeader();if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT){$_10 .= _666170371(6) .$this->GetFields();$_10 .= _666170371(7) .$this->GetTables();$_11=$this->GetConditions($this->Conditions);$_12=$this->GetOrder();$_13=$this->GetLimit();if(!empty($_11))$_10 .= _666170371(8) .$_11;if(!empty($_12))$_10 .= _666170371(9) .$_12;if(!empty($_13))$_10 .= _666170371(10) .$_13;}else if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_INSERT){$_10 .= _666170371(11) .$this->GetTables();$_10 .= _666170371(12) .$this->GetFields() ._666170371(13);$_10 .= _666170371(14) .$this->GetValues() ._666170371(15);}else if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_DELETE){$_10 .= _666170371(16) .$this->GetTables();$_11=$this->GetConditions($this->Conditions);if(!empty($_11))$_10 .= _666170371(17) .$_11;}else if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_UPDATE){$_10 .= _666170371(18) .$this->GetTables();$_10 .= _666170371(19) .$this->GetSet();$_11=$this->GetConditions($this->Conditions);if(!empty($_11))$_10 .= _666170371(20) .$_11;}return $_10;}public function Execute(){global $DB;if($this->Validate()){return $DB->Query($this->GetString());}else{return new CDBResult();}}protected function GetHeader(){$_14='';switch($this->Type){case STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT:{$_14 .= _666170371(21) .($this->IsDistinct?_666170371(22):_666170371(23));break;}case STARTSHOP_UTILS_DB_QUERY_TYPE_INSERT:{$_14 .= _666170371(24);break;}case STARTSHOP_UTILS_DB_QUERY_TYPE_DELETE:{$_14 .= _666170371(25);break;}case STARTSHOP_UTILS_DB_QUERY_TYPE_UPDATE:{$_14 .= _666170371(26);break;}}return $_14;}protected function GetFields(){global $DB;$_7=array();foreach($this->Fields as $sField)if($sField != _666170371(27)){$_7[]=_666170371(28) .$DB->ForSql($sField) .'`';}else{$_7[]=_666170371(29);}return $GLOBALS['_765963362_'][18](_666170371(30),$_7);}protected function GetTables(){global $DB;$_15=array();foreach($this->Tables as $_4)$_15[]='`' .$DB->ForSql($_4) .'`';return $GLOBALS['_765963362_'][19](_666170371(31),$_15);}protected function GetConditions($_16,$_17='AND'){global $DB;if($_17 != _666170371(32))$_17=_666170371(33);$_18=array();if($GLOBALS['_765963362_'][20]($_16))foreach($_16 as $_19 => $_6)if(!empty($_19)|| $GLOBALS['_765963362_'][21]($_19))if($_6 === null){$_20=$GLOBALS['_765963362_'][22]($_19,0,round(0+0.2+0.2+0.2+0.2+0.2));$_21=$GLOBALS['_765963362_'][23]($_19,round(0+0.5+0.5));if(!empty($_21)){if($_20 == _666170371(34)){$_18[]=_666170371(35) .$DB->ForSql($_21) .'` IS NOT NULL';}else if($_20 == _666170371(36)){$_18[]=_666170371(37) .$DB->ForSql($_21) .'` IS NULL';}else{$_18[]=_666170371(38) .$DB->ForSql($_19) .'` IS NULL';}}else{$_18[]=_666170371(39) .$DB->ForSql($_19) .'` IS NULL';}}else if(!$GLOBALS['_765963362_'][24]($_6)){$_6=$GLOBALS['_765963362_'][25]($_6);$_20=_666170371(40);$_21=_666170371(41);if($GLOBALS['_765963362_'][26]($_19)>round(0+0.5+0.5+0.5+0.5)){$_20=$GLOBALS['_765963362_'][27]($_19,0,round(0+0.5+0.5+0.5+0.5));$_21=$GLOBALS['_765963362_'][28]($_19,round(0+0.4+0.4+0.4+0.4+0.4));}if((empty($_20)||!$GLOBALS['_765963362_'][29]($_20,array(_666170371(42),_666170371(43))))&& $GLOBALS['_765963362_'][30]($_19)>round(0+0.5+0.5)){$_20=$GLOBALS['_765963362_'][31]($_19,0,round(0+0.5+0.5));$_21=$GLOBALS['_765963362_'][32]($_19,round(0+0.5+0.5));}if(!empty($_21)){if($_20 == _666170371(44)){$_18[]=_666170371(45) .$DB->ForSql($_21) .'` >= \'' .$DB->ForSql($_6) .'\'';}else if($_20 == _666170371(46)){$_18[]=_666170371(47) .$DB->ForSql($_21) .'` > \'' .$DB->ForSql($_6) .'\'';}else if($_20 == _666170371(48)){$_18[]=_666170371(49) .$DB->ForSql($_21) .'` <= \'' .$DB->ForSql($_6) .'\'';}else if($_20 == _666170371(50)){$_18[]=_666170371(51) .$DB->ForSql($_21) .'` < \'' .$DB->ForSql($_6) .'\'';}else if($_20 == _666170371(52)){$_18[]=_666170371(53) .$DB->ForSql($_21) .'` = \'' .$DB->ForSql($_6) .'\'';}else if($_20 == _666170371(54)){$_18[]=_666170371(55) .$DB->ForSql($_21) .'` = \'' .$DB->ForSql($_6) .'\'';}else{$_18[]=_666170371(56) .$DB->ForSql($_19) .'` = \'' .$DB->ForSql($_6) .'\'';}}else{$_18[]=_666170371(57) .$DB->ForSql($_19) .'` = \'' .$DB->ForSql($_6) .'\'';}}else if(!empty($_6)&& $GLOBALS['_765963362_'][33]($_6)){if(isset($_6[_666170371(58)])){$_22=$_6[_666170371(59)];unset($_6[_666170371(60)]);if(!empty($_6))$_18[]=_666170371(61) .$this->GetConditions($_6,$_22) .')';}else{$_20=$GLOBALS['_765963362_'][34]($_19,0,round(0+0.33333333333333+0.33333333333333+0.33333333333333));$_21=$GLOBALS['_765963362_'][35]($_19,round(0+0.25+0.25+0.25+0.25));$_23=array();foreach($_6 as $_24)if(!$GLOBALS['_765963362_'][36]($_24))$_23[]=_666170371(62) .$DB->ForSql($GLOBALS['_765963362_'][37]($_24)) ._666170371(63);if(!empty($_21)){if($_20 == _666170371(64)){$_18[]=_666170371(65) .$DB->ForSql($_21) .'` NOT IN (' .$GLOBALS['_765963362_'][38](_666170371(66),$_23) ._666170371(67);}else if($_20 == _666170371(68)){$_18[]=_666170371(69) .$DB->ForSql($_21) .'` IN (' .$GLOBALS['_765963362_'][39](_666170371(70),$_23) ._666170371(71);}else{$_18[]=_666170371(72) .$DB->ForSql($_19) .'` IN (' .$GLOBALS['_765963362_'][40](_666170371(73),$_23) ._666170371(74);}}else{$_18[]=_666170371(75) .$DB->ForSql($_19) .'` IN (' .$GLOBALS['_765963362_'][41](_666170371(76),$_23) ._666170371(77);}unset($_24);unset($_23);}}if(!empty($_18))return $GLOBALS['_765963362_'][42](_666170371(78) .$_17 ._666170371(79),$_18);return _666170371(80);}protected function GetLimit(){if($this->Limit[round(0+0.33333333333333+0.33333333333333+0.33333333333333)]=== null)return '';$_25=_666170371(81);if($this->Limit[0]!== null){$_25=$GLOBALS['_765963362_'][43]($this->Limit[0]) .', ' .$GLOBALS['_765963362_'][44]($this->Limit[round(0+0.5+0.5)]);}else{$_25=$GLOBALS['_765963362_'][45]($this->Limit[round(0+0.25+0.25+0.25+0.25)]);}return $_25;}protected function GetOrder(){global $DB;$_26=array();foreach($this->Order as $_27 => $_28)if(!empty($_27)){$_28=$GLOBALS['_765963362_'][46]($_28);if($_28 != _666170371(82))$_28=_666170371(83);$_26[]=_666170371(84) .$DB->ForSql($_27) .'` ' .$_28;}if(!empty($_26)){return $GLOBALS['_765963362_'][47](_666170371(85),$_26);}else{return _666170371(86);}}protected function GetValues(){global $DB;$_5=array();foreach($this->Values as $_6)if($_6 === null){$_5[]=_666170371(87);}else{$_5[]=_666170371(88) .$DB->ForSql($GLOBALS['_765963362_'][48]($_6)) ._666170371(89);}if(!empty($_5)){return $GLOBALS['_765963362_'][49](_666170371(90),$_5);}else{return _666170371(91);}}protected function GetSet(){global $DB;$_29=array();foreach($this->Fields as $_30 => $sField){$_31=$this->Values[$_30];if($_31 === null){$_29[]=_666170371(92) .$DB->ForSql($sField) .'` = NULL';}else{$_29[]=_666170371(93) .$DB->ForSql($sField) .'` = \'' .$DB->ForSql($GLOBALS['_765963362_'][50]($_31)) ._666170371(94);}}if(!empty($_29)){return $GLOBALS['_765963362_'][51](_666170371(95),$_29);}else{return _666170371(96);}}protected function Validate(){if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_SELECT){return!empty($this->Tables)&&!empty($this->Fields);}else if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_INSERT){return!empty($this->Tables)&&!empty($this->Fields)&&!empty($this->Values)&& $GLOBALS['_765963362_'][52]($this->Tables)== round(0+0.25+0.25+0.25+0.25)&& $GLOBALS['_765963362_'][53]($this->Fields)== $GLOBALS['_765963362_'][54]($this->Values);}else if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_DELETE){return!empty($this->Tables);}else if($this->Type == STARTSHOP_UTILS_DB_QUERY_TYPE_UPDATE){return!empty($this->Tables)&&!empty($this->Fields)&&!empty($this->Values)&& $GLOBALS['_765963362_'][55]($this->Fields)== $GLOBALS['_765963362_'][56]($this->Values);}return false;}public function IsValid(){return $this->Validate();}} ?>
