<? $GLOBALS['_2099884419_']=Array('explode','is' .'_ar' .'ray','in_a' .'rra' .'y','abs','a' .'bs','float' .'va' .'l','' .'in' .'_array','in_' .'arr' .'a' .'y','' .'i' .'n_a' .'rra' .'y'); ?><? function _1975521605($i){$a=Array(',','CODE','OFFERS_IBLOCK','OFFERS_LINK_PROPERTY','OFFERS_IBLOCK','OFFERS_LINK_PROPERTY','PROPERTIES','STARTSHOP','STARTSHOP','PRICES','STARTSHOP','BASKET','STARTSHOP','QUANTITY','STARTSHOP','QUANTITY','USE','STARTSHOP','QUANTITY','RATIO','STARTSHOP','QUANTITY','VALUE','STARTSHOP','AVAILABLE','STARTSHOP','QUANTITY','USE','STARTSHOP','QUANTITY','VALUE','STARTSHOP','PRICES','LIST','STARTSHOP','PRICES','MINIMAL','STARTSHOP','BASKET','INSIDE','STARTSHOP','BASKET','QUANTITY','STARTSHOP','BASKET','PRICE','STARTSHOP','PRICES','LIST','STARTSHOP','OFFERS','STARTSHOP','OFFER','OFFER','STARTSHOP','OFFER','PROPERTIES','STARTSHOP','OFFER','LINK','STARTSHOP','OFFER','OFFER','IBLOCK_ID','IBLOCK_ID','STARTSHOP','CURRENCY','STARTSHOP','PRICES','LIST','STARTSHOP','PRICES','LIST','STARTSHOP','AVAILABLE','STARTSHOP','BASKET','PRICE','STARTSHOP','BASKET','PRICE','STARTSHOP','PRICES','MINIMAL','STARTSHOP','OFFER','OFFER','PROPERTIES','ID','STARTSHOP','OFFER','LINK','OFFERS_LINK_PROPERTY','VALUE','STARTSHOP','OFFER','LINK','OFFERS_PROPERTIES','STARTSHOP','OFFER','PROPERTIES','CODE','STARTSHOP','OFFER','LINK','STARTSHOP','OFFER','LINK','STARTSHOP','OFFERS','ID','STARTSHOP','OFFER','OFFER','STARTSHOP','OFFER','LINK','DETAIL_PAGE_URL','DETAIL_PAGE_URL','LIST_PAGE_URL','LIST_PAGE_URL','PREVIEW_PICTURE','DETAIL_PICTURE','PREVIEW_PICTURE','PREVIEW_PICTURE','DETAIL_PICTURE','DETAIL_PICTURE',"LOGIC","OR","LOGIC","OR",'PROPERTY_','STARTSHOP','OFFER','OFFER','STARTSHOP','OFFER','LINK','STARTSHOP','OFFERS','STARTSHOP','OFFERS','STARTSHOP','OFFERS','STARTSHOP','OFFER','PROPERTIES','ID','ID','STARTSHOP','OFFER','PROPERTIES','CODE');return $a[$i];} ?><? class CStartShopCatalogProduct extends CStartShop{public static function GetByID($_0,$_1=array(),$_2=array(),$_3=false,$_4=false){return self::GetList(array(),array("ID"=> $_0),$_1,$_2,$_3,$_4);}public static function GetList($_5,$_6,$_1=array(),$_2=array(),$_3=false,$_4=false){global $USER;$_7=array();if(CModule::IncludeModule('iblock')){$_8=$GLOBALS['_2099884419_'][0](_1975521605(0),$USER->GetGroups());$_9=CStartShopUtil::DBResultToArray(CStartShopPrice::GetListByGroups($_8),'ID');if($GLOBALS['_2099884419_'][1]($_4))foreach($_9 as $_10 => $_11)if(!$GLOBALS['_2099884419_'][2]($_11[_1975521605(1)],$_4))unset($_9[$_10]);if(!empty($_3))if(!CStartShopCurrency::GetByCode($_3)->Fetch())$_3=false;$_12=CStartShopUtil::DBResultToArray(CStartShopCatalog::GetList(),'IBLOCK');$_13=array();$_14=array();$_15=array();$_16=CStartShopUtil::DBResultToArray(CStartShopToolsIBlock::GetOffersProperties($_12),'ID');$_17=array();foreach($_12 as $_18)if(!empty($_18[_1975521605(2)])&&!empty($_18[_1975521605(3)])){$_13[$_18[_1975521605(4)]]=$_18;$_17[]=$_18[_1975521605(5)];}unset($_18);$_19=CIBlockElement::GetList($_5,$_6);while($_20=$_19->GetNextElement(false,false)){$_21=$_20->GetFields();if(CStartShopCatalog::IsCatalog($_21['IBLOCK_ID'])|| CStartShopCatalog::IsCatalogOffers($_21['IBLOCK_ID'])){$_22=true;$_21[_1975521605(6)]=$_20->GetProperties();$_21[_1975521605(7)]=array();$_21[_1975521605(8)][_1975521605(9)]=array();$_21[_1975521605(10)][_1975521605(11)]=array();$_21[_1975521605(12)][_1975521605(13)]=array();$_21[_1975521605(14)][_1975521605(15)][_1975521605(16)]=CStartShopCatalog::IsUseQuantity($_21['IBLOCK_ID']);$_21[_1975521605(17)][_1975521605(18)][_1975521605(19)]=$GLOBALS['_2099884419_'][3](CStartShopToolsIBlock::GetQuantityRatioValue($_21));$_21[_1975521605(20)][_1975521605(21)][_1975521605(22)]=$GLOBALS['_2099884419_'][4](CStartShopToolsIBlock::GetQuantityValue($_21));$_21[_1975521605(23)][_1975521605(24)]=($_21[_1975521605(25)][_1975521605(26)][_1975521605(27)])?($GLOBALS['_2099884419_'][5]($_21[_1975521605(28)][_1975521605(29)][_1975521605(30)])>0):true;$_21[_1975521605(31)][_1975521605(32)][_1975521605(33)]=CStartShopToolsIBlock::GetPricesValues($_21,$_9,$_3);$_21[_1975521605(34)][_1975521605(35)][_1975521605(36)]=array();$_21[_1975521605(37)][_1975521605(38)][_1975521605(39)]=CStartShopBasket::InBasket($_21['ID']);$_21[_1975521605(40)][_1975521605(41)][_1975521605(42)]=CStartShopBasket::GetQuantity($_21['ID']);$_21[_1975521605(43)][_1975521605(44)][_1975521605(45)]=$_21[_1975521605(46)][_1975521605(47)][_1975521605(48)][CStartShopBasket::GetItemPriceType($_21['ID'])];$_21[_1975521605(49)][_1975521605(50)]=array();$_21[_1975521605(51)][_1975521605(52)][_1975521605(53)]=CStartShopCatalog::IsCatalogOffers($_21['IBLOCK_ID']);$_21[_1975521605(54)][_1975521605(55)][_1975521605(56)]=array();$_21[_1975521605(57)][_1975521605(58)][_1975521605(59)]=null;if(!$_21[_1975521605(60)][_1975521605(61)][_1975521605(62)]){$_18=$_12[$_21[_1975521605(63)]];}else{$_18=$_13[$_21[_1975521605(64)]];}if(!empty($_3))$_21[_1975521605(65)][_1975521605(66)]=$_3;if(!empty($_21[_1975521605(67)][_1975521605(68)][_1975521605(69)])){foreach($_21[_1975521605(70)][_1975521605(71)][_1975521605(72)]as $_23)if(CStartShopCurrency::Convert($_23['VALUE'],$_23['CURRENCY'])<CStartShopCurrency::Convert($_21['STARTSHOP']['PRICES']['MINIMAL']['VALUE'],$_21['STARTSHOP']['PRICES']['MINIMAL']['CURRENCY'])|| empty($_21['STARTSHOP']['PRICES']['MINIMAL']))$_21['STARTSHOP']['PRICES']['MINIMAL']=$_23;}else{$_21[_1975521605(73)][_1975521605(74)]=false;}if(empty($_21[_1975521605(75)][_1975521605(76)][_1975521605(77)]))$_21[_1975521605(78)][_1975521605(79)][_1975521605(80)]=$_21[_1975521605(81)][_1975521605(82)][_1975521605(83)];if($_21[_1975521605(84)][_1975521605(85)][_1975521605(86)]){$_24=array();foreach($_21[_1975521605(87)]as $_25)$_24[$_25[_1975521605(88)]]=$_25;$_21[_1975521605(89)][_1975521605(90)][_1975521605(91)]=$_24[$_18[_1975521605(92)]][_1975521605(93)];if(!empty($_21[_1975521605(94)][_1975521605(95)][_1975521605(96)])){foreach($_18[_1975521605(97)]as $_26){$_27=CStartShopToolsIBlock::ConvertToOfferProperty($_24[$_26],$_16);if(!empty($_27))$_21[_1975521605(98)][_1975521605(99)][_1975521605(100)][$_27[_1975521605(101)]]=$_27;unset($_27);}if(!$GLOBALS['_2099884419_'][6]($_21[_1975521605(102)][_1975521605(103)][_1975521605(104)],$_15))$_15[]=$_21[_1975521605(105)][_1975521605(106)][_1975521605(107)];unset($_21[_1975521605(108)][_1975521605(109)]);}else{$_22=false;}}else if(CStartShopCatalog::IsCatalogOffers($_18['OFFERS_IBLOCK'])&&!$_21['STARTSHOP']['OFFER']['OFFER']&&!empty($_18['OFFERS_LINK_PROPERTY'])){$_14[]=$_21['ID'];}if($_22){CStartShopEvents::Call('OnCatalogProductGet',array('ITEM'=>&$_21,'OFFER'=> false));$_7[$_21[_1975521605(110)]]=$_21;}unset($_18);}}if(!empty($_15)){$_28=CStartShopUtil::DBResultToArray(CIBlockElement::GetList(array(),array("ID"=> $_15)),'ID',true);foreach($_7 as $_29 => $_30)if($_30[_1975521605(111)][_1975521605(112)][_1975521605(113)]){$_31=$_28[$_30[_1975521605(114)][_1975521605(115)][_1975521605(116)]];$_7[$_29][_1975521605(117)]=$_31[_1975521605(118)];$_7[$_29][_1975521605(119)]=$_31[_1975521605(120)];if(empty($_30[_1975521605(121)])&& empty($_30[_1975521605(122)])){$_7[$_29][_1975521605(123)]=$_31[_1975521605(124)];$_7[$_29][_1975521605(125)]=$_31[_1975521605(126)];}unset($_31);}unset($_28);}if(!empty($_14)&&!empty($_17)){$_32=array(_1975521605(127)=> _1975521605(128));foreach($_14 as $_33){$_34=array(_1975521605(129)=> _1975521605(130));foreach($_17 as $_35)$_34[_1975521605(131) .$_35]=$_33;$_32[]=$_34;unset($_34);}$_2[]=$_32;$_36=static::GetList($_1,$_2,array(),array(),$_3,$_4);while($_37=$_36->Fetch())if($_37[_1975521605(132)][_1975521605(133)][_1975521605(134)])$_7[$_37[_1975521605(135)][_1975521605(136)][_1975521605(137)]][_1975521605(138)][_1975521605(139)][]=$_37;foreach($_7 as $_29 => $_30){if(empty($_30[_1975521605(140)][_1975521605(141)]))continue;$_38=array();foreach($_30[_1975521605(142)][_1975521605(143)]as $_37)foreach($_37[_1975521605(144)][_1975521605(145)][_1975521605(146)]as $_27)if(!$GLOBALS['_2099884419_'][7]($_27[_1975521605(147)],$_38))$_38[]=$_27[_1975521605(148)];foreach($_16 as $_39 => $_40)if($GLOBALS['_2099884419_'][8]($_39,$_38))$_7[$_29][_1975521605(149)][_1975521605(150)][_1975521605(151)][$_40[_1975521605(152)]]=$_40;}}}return CStartShopUtil::ArrayToDBResult($_7);}} ?>
