(function(a){if(a.JCIblockVoteStars){return}JCIblockVoteStars=function(b){this.progressId=b.progressId;this.ratingId=b.ratingId;this.starsId=b.starsId;this.ajaxUrl=b.ajaxUrl;this.voteId=b.voteId;this.starsObj=null;this.votedValue=null;this.preVotedValue=null};JCIblockVoteStars.prototype.setValue=function(b){b=parseInt(b);if(isNaN(b)){b=0}else{if(b>100){b=100}else{if(b<0){b=0}}}var c=BX(this.progressId);if(!!c){c.style.width=parseInt(b)+"%";this.votedValue=b}};JCIblockVoteStars.prototype.setVotes=function(c){var b=BX(this.ratingId);if(!!b){b.innerHTML="( "+c+" )"}};JCIblockVoteStars.prototype.getStarsObj=function(){if(!this.starsObj){this.starsObj=BX(this.starsId)}return this.starsObj};JCIblockVoteStars.prototype.onMouseMove=function(d){var c=BX.pos(this.getStarsObj());var e=(d.pageX-c.left)/c.width*5;for(var b=1;b<=5;b++){if(e<b){e=b;break}}this.setValue(e*20)};JCIblockVoteStars.prototype.onMouseOver=function(b){BX.bind(this.getStarsObj(),"click",BX.proxy(this.onVote,this));this.preVotedValue=this.votedValue};JCIblockVoteStars.prototype.onMouseOut=function(b){BX.unbind(this.getStarsObj(),"click",BX.proxy(this.onVote,this));this.votedValue=this.preVotedValue;this.setValue(this.votedValue)};JCIblockVoteStars.prototype.onVote=function(b){this.unBindEvents();this.ajaxParams.rating=parseInt(this.votedValue/20)-1;this.ajaxParams.vote="Y";this.ajaxParams.vote_id=this.voteId;BX.ajax({timeout:30,method:"POST",dataType:"json",url:this.ajaxUrl,data:this.ajaxParams,onsuccess:BX.delegate(this.SetResult,this)})};JCIblockVoteStars.prototype.SetResult=function(b){if(!!b&&!b.ERROR){this.setValue((b.value+1)*20);this.setVotes(b.votes)}};JCIblockVoteStars.prototype.bindEvents=function(){var b=this.getStarsObj();BX.bind(b,"mousemove",BX.proxy(this.onMouseMove,this));BX.bind(b,"mouseover",BX.proxy(this.onMouseOver,this));BX.bind(b,"mouseout",BX.proxy(this.onMouseOut,this))};JCIblockVoteStars.prototype.unBindEvents=function(){var b=this.getStarsObj();BX.unbind(b,"mousemove",BX.proxy(this.onMouseMove,this));BX.unbind(b,"mouseover",BX.proxy(this.onMouseOver,this));BX.unbind(b,"mouseout",BX.proxy(this.onMouseOut,this));BX.unbind(this.getStarsObj(),"click",BX.proxy(this.onVote,this))}})(window);