/*! ikSelect 1.0.3
	Copyright (c) 2013 Igor Kozlov
	http://igorkozlov.me */
;(function(e,h,j,c){var b=e(h);var d={syntax:'<div class="ik_select_link"><div class="ik_select_link_text"></div></div><div class="ik_select_dropdown"><div class="ik_select_list"></div></div>',autoWidth:true,ddFullWidth:true,equalWidths:true,dynamicWidth:false,extractLink:false,customClass:"",linkCustomClass:"",ddCustomClass:"",ddMaxHeight:200,filter:false,nothingFoundText:"Nothing found",isDisabled:false,onInit:function(){},onShow:function(){},onHide:function(){},onKeyUp:function(){},onKeyDown:function(){},onHoverMove:function(){}};var i;var f=function(m){m=m.toLowerCase();var l=/(chrome)[ \/]([\w.]+)/.exec(m)||/(webkit)[ \/]([\w.]+)/.exec(m)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(m)||/(msie) ([\w.]+)/.exec(m)||m.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(m)||[];return{browser:l[1]||"",version:l[2]||"0"}};if(!e.browser){var a=f(navigator.userAgent);var g={};if(a.browser){g[a.browser]=true;g.version=a.version}if(g.chrome){g.webkit=true}else{if(g.webkit){g.safari=true}}e.browser=g}e.browser.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile/i.test(navigator.userAgent);e.browser.operamini=Object.prototype.toString.call(h.operamini)==="[object OperaMini]";function k(n,l){var o={};this.el=n;this.$el=e(n);for(var m in d){o[m]=this.$el.data(m.toLowerCase())}this.options=e.extend({},d,l,o);if(e.browser.mobile){this.options.filter=false}this.init()}e.extend(k.prototype,{init:function(){this.$wrapper=e('<div class="ik_select">'+this.options.syntax+"</div>");this.$link=e(".ik_select_link",this.$wrapper);this.$linkText=e(".ik_select_link_text",this.$wrapper);this.$dropdown=e(".ik_select_dropdown",this.$wrapper);this.$list=e(".ik_select_list",this.$wrapper);this.$listInner=e('<div class="ik_select_list_inner"/>');this.$active=e([]);this.$hover=e([]);this.hoverIndex=0;this.$optionSet=e([]);this.$optgroupSet=e([]);this.$list.append(this.$listInner);if(this.options.filter){this.$filter=e([]);this.$optionSetOriginal=e([]);this.$nothingFoundText=e('<div class="ik_select_nothing_found"/>').html(this.options.nothingFoundText);this.$filterWrap=e(".ik_select_filter_wrap",this.$wrapper);if(!this.$filterWrap.length){this.$filterWrap=e('<div class="ik_select_filter_wrap"/>')}this.$filter=e('<input type="text" class="ik_select_filter">');this.$filterWrap.append(this.$filter);this.$list.prepend(this.$filterWrap);this.$filter.on({"keydown.ikSelect keyup.ikSelect":e.proxy(this,"_elKeyUpDown"),"keyup.ikSelect":e.proxy(this,"_filterKeyup")})}this.$wrapper.addClass(this.options.customClass);this.$link.addClass(this.options.linkCustomClass||(this.options.customClass&&this.options.customClass+"-link"));this.$dropdown.addClass(this.options.ddCustomClass||(this.options.customClass&&this.options.customClass+"-dd"));this.reset();this.toggle(!(this.options.isDisabled||this.$el.prop("disabled")));this.$link.on("click.ikSelect",e.proxy(this,"_linkClick"));this.$el.on({"focus.ikSelect":e.proxy(this,"_elFocus"),"blur.ikSelect":e.proxy(this,"_elBlur"),"change.ikSelect":e.proxy(this,"_syncOriginalOption"),"keydown.ikSelect keyup.ikSelect":e.proxy(this,"_elKeyUpDown")});this.$list.on({"click.ikSelect":e.proxy(this,"_optionClick"),"mouseover.ikSelect":e.proxy(this,"_optionMouseover")},".ik_select_option");this.$wrapper.on("click",function(){return false});this.$el.after(this.$wrapper);this.redraw();this.$el.appendTo(this.$wrapper);this.options.onInit(this);this.$el.trigger("ikinit",this)},_linkClick:function(){if(this.isDisabled){return}if(this===i){this.hideDropdown()}else{this.showDropdown()}},_optionClick:function(){this._makeOptionActive(this.searchIndexes?this.$optionSetOriginal.index(this.$hover):this.hoverIndex,true);this.hideDropdown();this.$el.change().focus()},_optionMouseover:function(l){var m=e(l.currentTarget);if(m.hasClass("ik_select_option_disabled")){return}this.$hover.removeClass("ik_select_hover");this.$hover=m.addClass("ik_select_hover");this.hoverIndex=this.$optionSet.index(this.$hover)},_makeOptionActive:function(l,m){var n=e(this.el.options[l]),o="";if(n.data("img_src")){o+='<span class="icon_color" style="background: url('+n.data("img_src")+')"></span>';this.$link.addClass("img")}if(n.attr("title")){this.$link.attr("title",n.attr("title"))}o+=n.text();this.$linkText.html(o);this.$link.toggleClass("ik_select_link_novalue",!n.attr("value"));this.$hover.removeClass("ik_select_hover");this.$active.removeClass("ik_select_active");this.$hover=this.$active=this.$optionSet.eq(l).addClass("ik_select_hover ik_select_active");this.hoverIndex=l;if(m){this._syncFakeOption()}},_elKeyUpDown:function(o){var p=e(o.currentTarget);var n=o.type;var l=o.which;var m;switch(l){case 38:if(n==="keydown"){o.preventDefault();this._moveToPrevActive()}break;case 40:if(n==="keydown"){o.preventDefault();this._moveToNextActive()}break;case 33:if(n==="keydown"){o.preventDefault();m=this.$hover.position().top-this.$listInner.height();this._moveToPrevActive(function(q){return q<=m})}break;case 34:if(n==="keydown"){o.preventDefault();m=this.$hover.position().top+this.$listInner.height();this._moveToNextActive(function(q){return q>=m})}break;case 36:if(n==="keydown"&&p.is(this.$el)){o.preventDefault();this._moveToFirstActive()}break;case 35:if(n==="keydown"&&p.is(this.$el)){o.preventDefault();this._moveToLastActive()}break;case 32:if(n==="keydown"&&p.is(this.$el)){o.preventDefault();if(!this.$dropdown.is(":visible")){this._linkClick()}else{this.$hover.click()}}break;case 13:if(n==="keydown"&&this.$dropdown.is(":visible")){o.preventDefault();this.$hover.click()}break;case 27:if(n==="keydown"&&this.$dropdown.is(":visible")){o.preventDefault();this.hideDropdown()}break;case 9:if(n==="keydown"){if(e.browser.webkit&&this.$dropdown.is(":visible")){o.preventDefault()}else{this.hideDropdown()}}break;default:if(n==="keyup"&&p.is(this.$el)){this._syncOriginalOption()}break}if(n==="keyup"&&e.browser.mozilla){this._syncFakeOption()}if(n==="keydown"){this.options.onKeyDown(this,l);this.$el.trigger("ikkeydown",[this,l])}if(n==="keyup"){this.options.onKeyUp(this,l);this.$el.trigger("ikkeyup",[this,l])}},_moveTo:function(m){var n,o;var l;if(!this.$dropdown.is(":visible")&&e.browser.webkit){this.showDropdown();return this}if(!this.$dropdown.is(":visible")||e.browser.mozilla){this._makeOptionActive(m,true)}else{this.$hover.removeClass("ik_select_hover");this.$hover=this.$optionSet.eq(m).addClass("ik_select_hover");this.hoverIndex=m}n=this.$hover.position().top;o=n+this.$active.outerHeight();if(!this.$hover.index()){l=this.$hover.closest(".ik_select_optgroup");if(l.length){n=l.position().top}}if(o>this.$listInner.height()){this.$listInner.scrollTop(this.$listInner.scrollTop()+o-this.$listInner.height())}else{if(n<0){this.$listInner.scrollTop(this.$listInner.scrollTop()+n)}}this.options.onHoverMove(this);this.$el.trigger("ikhovermove",this)},_moveToFirstActive:function(){for(var l=0;l<this.$optionSet.length;l++){if(!this.$optionSet.eq(l).hasClass("ik_select_option_disabled")){this._moveTo(l);break}}},_moveToLastActive:function(){for(var l=this.$optionSet.length-1;l>=0;l++){if(!this.$optionSet.eq(l).hasClass("ik_select_option_disabled")){this._moveTo(l);break}}},_moveToPrevActive:function(n){var m;for(var l=this.hoverIndex-1;l>=0;l--){m=this.$optionSet.eq(l);if(!m.hasClass("ik_select_option_disabled")&&(typeof n==="undefined"||n(m.position().top))){this._moveTo(l);break}}},_moveToNextActive:function(n){var m;for(var l=this.hoverIndex+1;l<this.$optionSet.length;l++){m=this.$optionSet.eq(l);if(!m.hasClass("ik_select_option_disabled")&&(typeof n==="undefined"||n(m.position().top))){this._moveTo(l);break}}},_elFocus:function(){var m,n,l,o;if(this.isDisabled){return this}this.$link.addClass("ik_select_link_focus");m=this.$wrapper.offset().top;n=this.$wrapper.height();l=b.scrollTop();o=b.height();if((m+n>l+o)||(m<l)){b.scrollTop(m-o/2)}},_elBlur:function(){this.$link.removeClass("ik_select_link_focus")},_filterKeyup:function(){var m=e.trim(this.$filter.val());var l;this.$listInner.show();if(typeof this.searchIndexes==="undefined"){this.$optionSetOriginal=this.$optionSet;this.searchIndexes=e.makeArray(this.$optionSet.map(function(o,n){return e(n).text().toLowerCase()}))}if(m!==l){if(m===""){this.$optionSet=this.$optionSetOriginal.show();this.$optgroupSet.show();this.$nothingFoundText.remove()}else{this.$optionSet=e([]);this.$optgroupSet.show();this.$optionSetOriginal.each(e.proxy(function(o,n){var p=e(n);if(this.searchIndexes[o].indexOf(m.toLowerCase())>=0){this.$optionSet=this.$optionSet.add(p);p.show()}else{p.hide()}},this));if(this.$optionSet.length){this.$nothingFoundText.remove();this.$optgroupSet.each(function(p,o){var n=e(o);if(!e(".ik_select_option:visible",n).length){n.hide()}});if(!this.$hover.is(":visible")){this._moveToFirstActive()}}else{this.$listInner.hide();this.$list.append(this.$nothingFoundText)}}l=m}},_syncFakeOption:function(){this.el.selectedIndex=this.hoverIndex},_syncOriginalOption:function(){this._makeOptionActive(this.el.selectedIndex)},_fixHeight:function(){this.$dropdown.show();this.$listInner.css("height","auto");if(this.$listInner.height()>this.options.ddMaxHeight){this.$listInner.css({overflow:"auto",height:this.options.ddMaxHeight,position:"relative"})}this.$dropdown.hide()},redraw:function(){var l,n,m;if(this.options.filter){this.$filter.hide()}this.$wrapper.css({position:"relative"});this.$dropdown.css({position:"absolute",zIndex:9998,width:"100%"});this.$list.css({position:"relative"});this._fixHeight();if(this.options.dynamicWidth||this.options.autoWidth||this.options.ddFullWidth){this.$wrapper.width("");this.$dropdown.show().width(9999);this.$listInner.css("float","left");this.$list.css("float","left");l=this.$list.outerWidth(true);n=this.$listInner.width()-this.$listInnerUl.width();this.$list.css("float","");this.$listInner.css("float","");this.$dropdown.css("width","100%");if(this.options.ddFullWidth){this.$dropdown.width(l+n)}if(this.options.dynamicWidth){this.$wrapper.css({display:"inline-block",width:"auto",verticalAlign:"top"})}else{if(this.options.autoWidth){this.$wrapper.width(l+(this.options.equalWidths?n:0)).addClass("ik_select_autowidth")}}m=this.$wrapper.parent().width();if(this.$wrapper.width()>m){this.$wrapper.width(m)}}if(this.options.filter){this.$filter.show().outerWidth(this.$filterWrap.width())}this.$dropdown.hide();this.$el.css({position:"absolute",margin:0,padding:0,top:0,left:-9999});if(e.browser.mobile){this.$el.css({opacity:0,left:0,height:this.$wrapper.height(),width:this.$wrapper.width()})}},reset:function(){var l="";this.$linkText.html(this.$el.val());this.$listInner.empty();l="<ul>";this.$el.children().each(e.proxy(function(q,p){var o=e(p);var n=p.tagName.toLowerCase();var m;if(n==="optgroup"){m=o.children().map(e.proxy(function(s,r){return this._generateOptionObject(e(r))},this));m=e.makeArray(m);l+=this._renderListOptgroup({label:o.attr("label")||"&nbsp;",isDisabled:o.is(":disabled"),options:m})}else{if(n==="option"){l+=this._renderListOption(this._generateOptionObject(o))}}},this));l+="</ul>";this.$listInner.append(l);this._syncOriginalOption();this.$listInnerUl=e("> ul",this.$listInner);this.$optgroupSet=e(".ik_select_optgroup",this.$listInner);this.$optionSet=e(".ik_select_option",this.$listInner)},hideDropdown:function(){if(this.options.filter){this.$filter.val("");this._filterKeyup()}this.$dropdown.hide().appendTo(this.$wrapper).css({left:"",top:""});if(this.options.extractLink){this.$wrapper.outerWidth(this.$wrapper.data("outerWidth"));this.$wrapper.height("");this.$link.removeClass("ik_select_link_extracted").css({position:"",top:"",left:"",zIndex:""}).prependTo(this.$wrapper)}i=null;this.$el.focus();this.options.onHide(this);this.$el.trigger("ikhide",this)},showDropdown:function(){var o,s,r;var m,p;var n,l,t;var q;if(i===this||!this.$optionSet.length){return}else{if(i){i.hideDropdown()}}this._syncOriginalOption();this.$dropdown.show();o=this.$dropdown.offset();s=this.$dropdown.outerWidth(true);r=this.$dropdown.outerHeight(true);m=this.$wrapper.offset();n=b.width();l=b.height();t=b.scrollTop();if(this.options.ddFullWidth&&m.left+s>n){o.left=n-s}if(o.top+r>t+l){o.top=t+l-r}this.$dropdown.css({left:o.left,top:o.top,width:this.$dropdown.width()}).appendTo("body");if(this.options.extractLink){q=this.$link.offset();p=this.$wrapper.outerWidth();this.$wrapper.data("outerWidth",p);this.$wrapper.outerWidth(p);this.$wrapper.outerHeight(this.$wrapper.outerHeight());this.$link.outerWidth(this.$link.outerWidth());this.$link.addClass("ik_select_link_extracted").css({position:"absolute",top:q.top,left:q.left,zIndex:9999}).appendTo("body")}this.$listInner.scrollTop(this.$active.position().top-this.$list.height()/2);if(this.options.filter){this.$filter.focus()}else{this.$el.focus()}i=this;this.options.onShow(this);this.$el.trigger("ikshow",this)},_generateOptionObject:function(l){return{value:l.val(),label:l.html()||"&nbsp;",isDisabled:l.is(":disabled"),dataParam:l.data(),className:l.attr("class"),title:l.attr("title")}},_renderListOption:function(n){var m;var q=n.isDisabled?" ik_select_option_disabled":"";var l=n.dataParam.img_src?" img":"";var o=n.className=="hidden"?" missing":"";var p=n.title;m='<li class="ik_select_option'+q+l+o+'" title="'+p+'" data-value="'+n.value+'">';m+='<span class="ik_select_option_label" title="'+p+'">';if(n.dataParam.img_src){m+='<span class="icon_color" style="background: url('+n.dataParam.img_src+')"></span>'}m+=n.label;m+="</span>";m+="</li>";return m},_renderListOptgroup:function(l){var m;var n=l.isDisabled?" ik_select_optgroup_disabled":"";m='<li class="ik_select_optgroup'+n+'">';m+='<div class="ik_select_optgroup_label">'+l.label+"</div>";m+="<ul>";if(e.isArray(l.options)){e.each(l.options,e.proxy(function(p,o){m+=this._renderListOption({value:o.value,label:o.label||"&nbsp;",isDisabled:o.isDisabled})},this))}m+="</ul>";m+="</li>";return m},_renderOption:function(l){return'<option value="'+l.value+'">'+l.label+"</option>"},_renderOptgroup:function(l){var m;m='<optgroup label="'+l.label+'">';if(e.isArray(l.options)){e.each(l.options,e.proxy(function(o,n){m+=this._renderOption(n)},this))}m+="</option>";return m},addOptions:function(t,m,r){var o="",n="";var p=this.$listInnerUl;var s=this.$el;var q,l;t=e.isArray(t)?t:[t];e.each(t,e.proxy(function(u,v){o+=this._renderListOption(v);n+=this._renderOption(v)},this));if(e.isNumeric(r)&&r<this.$optgroupSet.length){p=this.$optgroupSet.eq(r);s=e("optgroup",this.$el).eq(r)}if(e.isNumeric(m)){q=e(".ik_select_option",p);if(m<q.length){q.eq(m).before(o);l=e("option",s);l.eq(m).before(n)}}if(!l){p.append(o);s.append(n)}this.$optionSet=e(".ik_select_option",this.$listInner);this._fixHeight()},addOptgroups:function(l,o){var n="",m="";if(!l){return}l=e.isArray(l)?l:[l];e.each(l,e.proxy(function(q,p){n+=this._renderListOptgroup(p);m+=this._renderOptgroup(p)},this));if(e.isNumeric(o)&&o<this.$optgroupSet.length){this.$optgroupSet.eq(o).before(n);e("optgroup",this.$el).eq(o).before(m)}else{this.$listInnerUl.append(n);this.$el.append(m)}this.$optgroupSet=e(".ik_select_optgroup",this.$listInner);this.$optionSet=e(".ik_select_option",this.$listInner);this._fixHeight()},removeOptions:function(l,m){var o=e([]);var p;var n;if(e.isNumeric(m)){if(m<0){p=e("> .ik_select_option",this.$listInnerUl);n=e("> option",this.$el)}else{if(m<this.$optgroupSet.length){p=e(".ik_select_option",this.$optgroupSet.eq(m));n=e("optgroup",this.$el).eq(m).find("option")}}}if(!p){p=this.$optionSet;n=e(this.el.options)}if(!e.isArray(l)){l=[l]}e.each(l,e.proxy(function(q,r){if(r<p.length){o=o.add(p.eq(r)).add(n.eq(r))}},this));o.remove();this.$optionSet=e(".ik_select_option",this.$listInner);this._syncOriginalOption();this._fixHeight()},removeOptgroups:function(l){var n=e([]);var m=e("optgroup",this.el);if(!e.isArray(l)){l=[l]}e.each(l,e.proxy(function(o,p){if(p<this.$optgroupSet.length){n=n.add(this.$optgroupSet.eq(p)).add(m.eq(p))}},this));n.remove();this.$optionSet=e(".ik_select_option",this.$listInner);this.$optgroupSet=e(".ik_select_optgroup",this.$listInner);this._syncOriginalOption();this._fixHeight()},disable:function(){this.toggle(false)},enable:function(){this.toggle(true)},toggle:function(l){this.isDisabled=typeof l!=="undefined"?!l:!this.isDisabled;this.$el.prop("disabled",this.isDisabled);this.$link.toggleClass("ik_select_link_disabled",this.isDisabled)},select:function(m,l){if(!l){this.$el.val(m)}else{this.el.selectedIndex=m}this._syncOriginalOption()},disableOptgroups:function(l){this.toggleOptgroups(l,false)},enableOptgroups:function(l){this.toggleOptgroups(l,true)},toggleOptgroups:function(m,l){if(!e.isArray(m)){m=[m]}e.each(m,e.proxy(function(r,u){var o;var t,q=[],p;var n=e("optgroup",this.$el).eq(u);o=typeof l!=="undefined"?l:n.prop("disabled");n.prop("disabled",!o);this.$optgroupSet.eq(u).toggleClass("ik_select_optgroup_disabled",!o);t=e("option",n);p=e(this.el.options).index(t.eq(0));for(var s=p;s<p+t.length;s++){q.push(s)}this.toggleOptions(q,true,o)},this));this._syncOriginalOption()},disableOptions:function(l,m){this.toggleOptions(l,m,false)},enableOptions:function(l,m){this.toggleOptions(l,m,true)},toggleOptions:function(m,n,l){var o=e("option",this.el);if(!e.isArray(m)){m=[m]}var p=e.proxy(function(s,r){var q=typeof l!=="undefined"?l:s.prop("disabled");s.prop("disabled",!q);this.$optionSet.eq(r).toggleClass("ik_select_option_disabled",!q)},this);e.each(m,function(q,r){if(!n){o.each(function(t,s){var u=e(s);if(u.val()===r){p(u,t);return this}})}else{p(o.eq(r),r)}});this._syncOriginalOption()},detach:function(){this.$el.off(".ikSelect").css({width:"",height:"",left:"",top:"",position:"",margin:"",padding:""});this.$wrapper.before(this.$el);this.$wrapper.remove();this.$el.removeData("plugin_ikSelect")}});e.fn.ikSelect=function(m){var l;if(e.browser.operamini){return this}l=Array.prototype.slice.call(arguments,1);return this.each(function(){var n;if(!e.data(this,"plugin_ikSelect")){e.data(this,"plugin_ikSelect",new k(this,m))}else{if(typeof m==="string"){n=e.data(this,"plugin_ikSelect");if(typeof n[m]==="function"){n[m].apply(n,l)}}}})};e.ikSelect={extendDefaults:function(l){e.extend(d,l)}};e(j).bind("click.ikSelect",function(){if(i){i.hideDropdown()}})})(jQuery,window,document);