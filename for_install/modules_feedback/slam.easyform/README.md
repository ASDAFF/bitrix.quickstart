# Продуманная форма обратной связи на Bootstrap 3

**Описание решения**  
Продуманная форма обратной связи сочетает в себе простоту и функциональность. Мы заранее продумали основные сценарии использования данной формы, значительно упростили параметры компонента, обдуманно подошли к предустановленным настройкам всех полей. Поэтому добавление формы на страницу займет у вас всего несколько кликов. В то же время данная форма обладает огромным арсеналом параметров для тонкой настройки.

Функционал формы:

1. Создание формы и доступные поля:
быстрое создание полей формы из списка с предустановленнеми настройками названий, валидации, маски и других параметров;
сортировка полей при помощи интерфейса drag-and-drop;
на данный момент доступны следующие поля: text, select, multiselect, checkbox, radio, e-mail, textarea, tel, number, url (добавить любый другие типы не составит труда для программистов);
возможность прилагать файлы к форме, удобный загрузчик drag-and-drop для файлов;
возможность отображения формы в модальном окне.
2. Отправка писем:
единый универсальный шаблон для отправки писем (устанавливается по умолчанию);
возможность автоматического создания почтового шаблона из параметров компонента для конкретной формы;
возможность прикладывать файлы к письму вложениями;
возможность отправлять 2 письма: администратору сайта и отправителю;
возможность задать получателя как в настройках модуля, так и для каждой формы отдельно.
3. Валидация:
обязательные поля всегда валидируются сервером;
возможность использовать JS валидацию библиотеки JS Bootstrap Validators;
тонкие настройки валидации для каждого поля, возможность настроить практически любой сценарий;
возможность указать маску для телефона.
4. Запись результатов в базу данных:
хранение всех результатов всех форм в отдельных таблице модуля со стандартным интерфейсом инфоблоков;
возможность дополнительно записывать результаты в выбранный инфоблок по принципу "свойство в свойство";
возможность автоматического создания инфоблока из параметров компонента для хранения результатов;
возможность автоматического создания свойств в выбранном инфоблоке для записи по принципу "свойство в свойство" (свойства разово создаются при первой попытке записи в ИБ).
5. Отправка формы:
режимы отправки формы: "AJAX" и "с перезагрузкой страницы";
два варианта получения ответа: "сообщение над формой" и "ответ в модальном окне".
6. Защита от спама:
встроенная защита от спама без использования капчи;
возможность простого подключения умной капчи reCAPTCHA.
7. Поддержка 152-ФЗ:
возможность управлением выводом соглашения об обработке персональных данных из настроек модуля сразу для всех форм;
в настройках модуля приложена инструкция и шаблон для создания соглашения об обработке персональных данных;
возможность опционально задавать/отключать сообщение для конкретной формы.
Примеры внедрения формы:
https://slam.by/ - форма обратной связи с умным выбором услуг (штатная возможность);
http://protennis.by/contacts/ - простая форма обратной связи;
https://www.logoton.by/contacts/ - простая форма обратной связи;
https://officelife.media/about/magazine/subscriptions/ - форма в модальном окне с небольшой кастомизацией

Для разработчиков. 
Модуль спроектирован на основании сотен форм, внедренных нами на разных проектах и в первую очередь предназначен для разработчиков. При создании мы максимально стремились устранить все лишние телодвижения, которые была возможность автоматизировать. Для этого из параметров компонента в 1 клик реализованы автоматическое создание шаблонов, создание инфоблока и свойств для записи в инфоблок . Шаблон формы легко кастомизируется под любую верстку. Компонент написан просто без использования сложной архитектуры. Для шаблонов мы использовали стандартные стили Bootstrap.

**Установка**
Установка стандартная.

После установки доступен компонент "Форма обратной связи - SLAM".
На вкладке "сервисы" появится раздел модуля с таблицей общих результатов формы.

Если в визуальном редакторе вы не видите компонента - то вам необходимо обновить кеш в редакторе вот так https://s.mail.ru/MLaC/pJMsqc2Qv

Одна из самых частых проблем это создание дополнительных полей у формы. Делается это правильно вот так https://s.mail.ru/GpES/uef8tWDUk

У формы предусмотрено 4 события:
OnBeforeFieldsValue($code, &$val) - перед первичной обработкой всех полей
OnBeforeIBlockElementAdd(&$arLoadProductArray, &$arParams, &$arPostFields, &$arServiceFields, &$file_id) - перед добавлением в ИБ (если включена такая опция в параметрах компонента)
OnAfterIBlockElementAdd($idElement, &$arParams, &$arPostFields, &$arServiceFields, &$file_id) - после добавления в ИБ (если включена такая опция в параметрах компонента)
OnAfterAdditionalMessage(&$arAdditionalMessage, &$arParams, $idElement, $arPostFields) - после отправки письма

Пример использования наших событий https://s.mail.ru/FY46/oVz35dnHd
Инструкция по работе с событиями в Битрикс https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=43&LESSON_ID=3493&LESSON_PATH=3913.4619.3493