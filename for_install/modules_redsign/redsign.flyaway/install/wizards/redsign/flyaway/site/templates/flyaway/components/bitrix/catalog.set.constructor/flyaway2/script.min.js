$(function(){var c=false;$(".setbuy1click").on("click",function(g){c=true});$(document).on("click",".fancyajaxwait.setbuy1click",function(j){j.preventDefault();var i=$(this),g={},h="";if(!$(this).hasClass("fancybox.ajax")){g={RS_EXT_FIELD_0:f(b()),get_form:"1"}}h=i.attr("href").indexOf("?")!=-1?i.attr("href")+"&"+$.param(g):i.attr("href")+"?"+$.param(g);window.location=h});$(document).on();$(document).on("RSFLYAWAY_fancyBeforeShow",function(){var g=[],h="";if(c){g=b();$(".fancybox-wrap [name=RS_EXT_FIELD_0]").val(f(g))}c=false});$(".set_add2basket").on("click",function(){var k=$(this),g=k.parents(".js-constructor"),j={},i=[],h=g.data("ajaxpath");b().forEach(function(l){i.push(l.id)});rsFlyaway.darken($(".constructor-wrapper"));j={sessid:BX.bitrix_sessid(),action:"catalogSetAdd2Basket",set_ids:i,lid:g.data("lid"),iblockId:g.data("iblockid"),setOffersCartProps:g.data("setOffersCartProps")};$.post(h,j,function(l){updateBasketLine();rsFlyaway.darken($(".constructor-wrapper"))},"json")});$(".my-sets_link").on("click",function(){$(".my-set").toggle()});$(".selected-items ").on("click",".item > .remove",function(){var h=$(this),g=$(this).parent();$(".allitems .item[data-elementid="+g.data("elementid")+"] .checkbox").click()});$(".my-set .checkbox").on("click",function(){var j=$(this),g=j.parent(),h=j.hasClass("selected");if(!h&&b().length>=5){return false}j.toggleClass("selected");h=!h;if(!h){var i=$(".selected-items .item[data-elementid="+g.data("elementid")+"]");e(i)}else{d(g)}});function b(){var g=[];$(".selected-items .item").each(function(i,j){var h=$(j);g.push({id:h.data("elementid"),name:h.find(".set-name").text().trim()})});return g}function f(g){var h="";g.map(function(k,j){h+="["+k.id+"] "+k.name;if(g.length!==j+1){h+=", "}});return h}function a(i){var h=0,k=0,m=0,g=$(".js-constructor"),j=g.data("ajaxpath"),l={};i=i||function(){};$(".selected-items .item").each(function(n,o){h+=parseInt($(o).data("price"));k+=parseInt($(o).data("oldprice"));m+=parseInt($(o).data("discount"))});l={sessid:BX.bitrix_sessid(),action:"ajax_recount_prices",sumPrice:h,sumOldPrice:k,sumDiffDiscountPrice:m,currency:g.data("currency")};$.post(j,l,function(n){var o=g.find(".set-panel");if(n.formatSum){o.find(".set-panel-price__cool").html(n.formatSum)}if(n.formatOldSum){o.find(".set-panel-price__old").html(n.formatOldSum)}if(n.formatDiscDiffSum){o.find(".set-price__discount").html(n.formatDiscDiffSum)}i(n)},"json")}function e(g){rsFlyaway.darken($(".constructor-wrapper"));$(".selected-items.owlslider").trigger("remove.owl.carousel",g.parent().index()).trigger("refresh.owl.carousel");a(function(){rsFlyaway.darken($(".constructor-wrapper"))})}function d(g){var h=g.clone();h.find(".checkbox").remove();h.prepend("<div class = 'remove'><i class='fa fa-close'></i></div>");h.append("<div class = 'separator plus'></div>");rsFlyaway.darken($(".constructor-wrapper"));$(".selected-items.owlslider").trigger("add.owl.carousel",h).trigger("refresh.owl.carousel");a(function(){rsFlyaway.darken($(".constructor-wrapper"))})}});$(document).ready(function(){$(".item-right").parent().css("float","right")});