(function(d){if(d.BX.ajax){return}var b=d.BX,g={},c={method:"GET",dataType:"html",timeout:0,async:true,processData:true,scriptsRunFirst:false,emulateOnload:true,start:true,cache:true,preparePost:true,headers:false,lsTimeout:30,lsForce:false},f=null,e={},j=[],a={url_utf:/[^\034-\254]+/g,script_self:/\/bitrix\/js\/main\/core\/core(_ajax)*.js$/i,script_self_window:/\/bitrix\/js\/main\/core\/core_window.js$/i,script_self_admin:/\/bitrix\/js\/main\/core\/core_admin.js$/i,script_onload:/window.onload/g};b.ajax=function(k){var l,n;if(!k||!k.url||!b.type.isString(k.url)){return false}for(var o in g){if(typeof(k[o])=="undefined"){k[o]=g[o]}}g={};for(var o in c){if(typeof(k[o])=="undefined"){k[o]=c[o]}}k.method=k.method.toUpperCase();if(!b.localStorage){k.lsId=null}if(b.browser.IsIE()){var t=a.url_utf.exec(k.url);if(t){do{k.url=k.url.replace(t,b.util.urlencode(t));t=a.url_utf.exec(k.url)}while(t)}}if(k.dataType=="json"){k.emulateOnload=false}if(!k.cache&&k.method=="GET"){k.url=b.ajax._uncache(k.url)}if(k.method=="POST"&&k.preparePost){k.data=b.ajax.prepareData(k.data)}var s=true;if(k.lsId&&!k.lsForce){var r=b.localStorage.get("ajax-"+k.lsId);if(r!==null){s=false;var p=function(v){if(v.key=="ajax-"+k.lsId&&v.value!="BXAJAXWAIT"){var w=v.value,u=!!v.oldValue&&w==null;if(!u){b.ajax.__run(k,w)}else{if(k.onfailure){k.onfailure("timeout")}}b.removeCustomEvent("onLocalStorageChange",p)}};if(r=="BXAJAXWAIT"){b.addCustomEvent("onLocalStorageChange",p)}else{setTimeout(function(){p({key:"ajax-"+k.lsId,value:r})},10)}}}if(s){k.xhr=b.ajax.xhr();if(!k.xhr){return}if(k.lsId){b.localStorage.set("ajax-"+k.lsId,"BXAJAXWAIT",k.lsTimeout)}k.xhr.open(k.method,k.url,k.async);if(k.method=="POST"&&k.preparePost){k.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(typeof(k.headers)=="object"){for(var o=0;o<k.headers.length;o++){k.xhr.setRequestHeader(k.headers[o].name,k.headers[o].value)}}var m=false;var q=k.xhr.onreadystatechange=function(u){if(m){return}if(u==="timeout"){if(k.onfailure){k.onfailure("timeout")}b.onCustomEvent(k.xhr,"onAjaxFailure",["timeout","",k]);k.xhr.onreadystatechange=b.DoNothing;k.xhr.abort();if(k.async){k.xhr=null}}else{if(k.xhr.readyState==4||u=="run"){l=b.ajax.xhrSuccess(k.xhr)?"success":"error";m=true;k.xhr.onreadystatechange=b.DoNothing;if(l=="success"){var v=k.xhr.responseText;if(k.lsId){b.localStorage.set("ajax-"+k.lsId,v,k.lsTimeout)}b.ajax.__run(k,v)}else{if(k.onfailure){k.onfailure("status",k.xhr.status);b.onCustomEvent(k.xhr,"onAjaxFailure",["status",k.xhr.status,k])}}if(k.async){k.xhr=null}}}};if(k.async&&k.timeout>0){setTimeout(function(){if(k.xhr&&!m){q("timeout")}},k.timeout*1000)}if(k.start){k.xhr.send(k.data);if(!k.async){q("run")}}return k.xhr}};b.ajax.xhr=function(){if(d.XMLHttpRequest){try{return new XMLHttpRequest()}catch(k){}}else{if(d.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(k){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(k){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(k){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(k){}throw new Error("This browser does not support XMLHttpRequest.")}}return null};b.ajax.__prepareOnload=function(l){if(l.length>0){b.ajax["onload_"+f]=null;for(var m=0,k=l.length;m<k;m++){if(l[m].isInternal){l[m].JS=l[m].JS.replace(a.script_onload,"BX.ajax.onload_"+f)}}}b.CaptureEventsGet();b.CaptureEvents(d,"load")};b.ajax.__runOnload=function(){if(null!=b.ajax["onload_"+f]){b.ajax["onload_"+f].apply(d);b.ajax["onload_"+f]=null}var l=b.CaptureEventsGet();if(l){for(var k=0;k<l.length;k++){l[k].apply(d)}}};b.ajax.__run=function(k,l){if(!k.processData){if(k.onsuccess){k.onsuccess(l)}b.onCustomEvent(k.xhr,"onAjaxSuccess",[l,k])}else{l=b.ajax.processRequestData(l,k)}};b.ajax._onParseJSONFailure=function(k){this.jsonFailure=true;this.jsonResponse=k;this.jsonProactive=/^\[WAF\]/.test(k)};b.ajax.processRequestData=function(o,l){var s,n=[],r=[];switch(l.dataType.toUpperCase()){case"JSON":b.addCustomEvent(l.xhr,"onParseJSONFailure",b.proxy(b.ajax._onParseJSONFailure,l));s=b.parseJSON(o,l.xhr);b.removeCustomEvent(l.xhr,"onParseJSONFailure",b.proxy(b.ajax._onParseJSONFailure,l));break;case"SCRIPT":n.push({isInternal:true,JS:o,bRunFirst:l.scriptsRunFirst});l.processScriptsConsecutive=true;s=o;break;default:var k=b.processHTML(o,l.scriptsRunFirst);s=k.HTML;n=k.SCRIPT;r=k.STYLE;break}var q=false;if(null==f){f=parseInt(Math.random()*1000000);q=true}if(r.length>0){b.loadCSS(r)}if(l.emulateOnload){b.ajax.__prepareOnload(n)}var m=b.DoNothing;if(l.emulateOnload||q){m=b.defer(function(){if(l.emulateOnload){b.ajax.__runOnload()}if(q){f=null}b.onCustomEvent(l.xhr,"onAjaxSuccessFinish",[l])})}try{if(!!l.jsonFailure){throw {type:"json_failure",data:l.jsonResponse,bProactive:l.jsonProactive}}l.scripts=n;b.ajax.processScripts(l.scripts,true);if(l.onsuccess){l.onsuccess(s)}b.onCustomEvent(l.xhr,"onAjaxSuccess",[s,l]);if(!l.processScriptsConsecutive){b.ajax.processScripts(l.scripts,false,m)}else{b.ajax.processScriptsConsecutive(l.scripts,false);m()}}catch(p){if(l.onfailure){l.onfailure("processing",p)}b.onCustomEvent(l.xhr,"onAjaxFailure",["processing",p,l])}};b.ajax.processScripts=function(q,k,p){var m=[],r="";p=p||b.DoNothing;for(var s=0,n=q.length;s<n;s++){if(typeof k!="undefined"&&k!=!!q[s].bRunFirst){continue}if(q[s].isInternal){r+=";"+q[s].JS}else{m.push(q[s].JS)}}m=b.util.array_unique(m);var o=l1=m.length,t=r.length>0?function(){b.evalGlobal(r)}:b.DoNothing;if(o>0){var u=function(){if(--l1<=0){t();p();t=b.DoNothing}};for(var s=0;s<o;s++){b.loadScript(m[s],u)}}else{t();p()}};b.ajax.processScriptsConsecutive=function(k,n){for(var l=0,m=k.length;l<m;l++){if(null!=n&&n!=!!k[l].bRunFirst){continue}if(k[l].isInternal){b.evalGlobal(k[l].JS)}else{b.ajax.loadScriptAjax([k[l].JS])}}};b.ajax.prepareData=function(o,n){var m="";if(b.type.isString(o)){m=o}else{if(null!=o){for(var l in o){if(!o.hasOwnProperty(l)){continue}if(m.length>0){m+="&"}var k=b.util.urlencode(l);if(n){k=n+"["+k+"]"}if(typeof o[l]=="object"){m+=b.ajax.prepareData(o[l],k)}else{m+=k+"="+b.util.urlencode(o[l])}}}}return m};b.ajax.xhrSuccess=function(k){return(k.status>=200&&k.status<300)||k.status===304||k.status===1223||k.status===0};b.ajax.Setup=function(k,m){m=!!m;for(var l in k){if(m){g[l]=k[l]}else{c[l]=k[l]}}};b.ajax.replaceLocalStorageValue=function(m,l,k){if(!!b.localStorage){b.localStorage.set("ajax-"+m,l,k)}};b.ajax._uncache=function(k){return k+((k.indexOf("?")!==-1?"&":"?")+"_="+(new Date).getTime())};b.ajax.get=function(k,l,m){if(b.type.isFunction(l)){m=l;l=""}l=b.ajax.prepareData(l);if(l){k+=(k.indexOf("?")!==-1?"&":"?")+l;l=""}return b.ajax({method:"GET",dataType:"html",url:k,data:"",onsuccess:m})};b.ajax.getCaptcha=function(k){return b.ajax.loadJSON("/bitrix/tools/ajax_captcha.php",k)};b.ajax.insertToNode=function(l,m){if(m=b(m)){b.onCustomEvent("onAjaxInsertToNode",[{url:l,node:m}]);var k=null;if(!g.denyShowWait){k=b.showWait(m);delete g.denyShowWait}return b.ajax.get(l,function(n){m.innerHTML=n;b.closeWait(m,k)})}};b.ajax.post=function(k,l,m){l=b.ajax.prepareData(l);return b.ajax({method:"POST",dataType:"html",url:k,data:l,onsuccess:m})};b.ajax.loadScriptAjax=function(n,p,o){if(b.type.isArray(n)){for(var m=0,l=n.length;m<l;m++){b.ajax.loadScriptAjax(n[m],p,o)}}else{var k=n.replace(/\.js\?.*/,".js");if(a.script_self.test(k)){return}if(a.script_self_window.test(k)&&b.CWindow){return}if(a.script_self_admin.test(k)&&b.admin){return}if(typeof e[k]=="undefined"){if(!!o){e[k]="";return b.loadScript(n)}else{return b.ajax({url:n,method:"GET",dataType:"script",processData:true,emulateOnload:false,scriptsRunFirst:true,async:false,start:true,onsuccess:function(q){e[k]=q;if(p){p(q)}}})}}else{if(p){p(e[k])}}}};b.ajax.loadJSON=function(l,m,n,k){if(b.type.isFunction(m)){k=n;n=m;m=""}m=b.ajax.prepareData(m);if(m){l+=(l.indexOf("?")!==-1?"&":"?")+m;m=""}return b.ajax({method:"GET",dataType:"json",url:l,onsuccess:n,onfailure:k})};b.ajax.load=function(n,p){if(!b.type.isArray(n)){n=[n]}var m=0;if(!b.type.isFunction(p)){p=b.DoNothing}var o=function(q){if(b.type.isFunction(this.callback)){this.callback(q)}if(++m>=k){p()}};for(var l=0,k=n.length;l<k;l++){switch(n.type.toUpperCase()){case"SCRIPT":b.loadScript([n[l].url],jsBX.proxy(o,n[l]));break;case"CSS":b.loadCSS([n[l].url]);if(++m>=k){p()}break;case"JSON":b.ajax.loadJSON(n.url,jsBX.proxy(o,n[l]));break;default:b.ajax.get(n.url,"",jsBX.proxy(o,n[l]));break}}};b.ajax.submit=function(l,m){if(!l.target){if(null==l.BXFormTarget){var k="formTarget_"+Math.random();l.BXFormTarget=document.body.appendChild(b.create("IFRAME",{props:{name:k,id:k,src:"javascript:void(0)"},style:{display:"none"}}))}l.target=l.BXFormTarget.name}l.BXFormCallback=m;b.bind(l.BXFormTarget,"load",b.proxy(b.ajax._submit_callback,l));b.submit(l);return false};b.ajax.submitComponentForm=function(n,l,o){if(!n.target){if(null==n.BXFormTarget){var m="formTarget_"+Math.random();n.BXFormTarget=document.body.appendChild(b.create("IFRAME",{props:{name:m,id:m,src:"javascript:void(0)"},style:{display:"none"}}))}n.target=n.BXFormTarget.name}if(!!o){var k=b.showWait(l)}n.BXFormCallback=function(p){if(!!o){b.closeWait(k)}b(l).innerHTML=p;if(d.bxcompajaxframeonload){setTimeout("window.bxcompajaxframeonload();window.bxcompajaxframeonload=null;",10)}b.onCustomEvent("onAjaxSuccess",[])};b.bind(n.BXFormTarget,"load",b.proxy(b.ajax._submit_callback,n));return true};b.ajax._submit_callback=function(){try{if(this.BXFormTarget.contentWindow.location.href.indexOf("http")!=0){return}}catch(k){return}if(this.BXFormCallback){this.BXFormCallback.apply(this,[this.BXFormTarget.contentWindow.document.body.innerHTML])}b.unbindAll(this.BXFormTarget)};b.ajax.submitAjax=function(k,l){};b.ajax.UpdatePageData=function(l){if(l.TITLE){b.ajax.UpdatePageTitle(l.TITLE)}if(l.NAV_CHAIN){b.ajax.UpdatePageNavChain(l.NAV_CHAIN)}if(l.CSS&&l.CSS.length>0){b.loadCSS(l.CSS)}if(l.SCRIPTS&&l.SCRIPTS.length>0){var k=function(m,o){if(!!o&&b.type.isArray(o.scripts)){for(var p=0,n=l.SCRIPTS.length;p<n;p++){o.scripts.push({isInternal:false,JS:l.SCRIPTS[p]})}}else{b.loadScript(l.SCRIPTS)}b.removeCustomEvent("onAjaxSuccess",k)};b.addCustomEvent("onAjaxSuccess",k)}};b.ajax.UpdatePageTitle=function(l){var k=b("pagetitle");if(k){k.removeChild(k.firstChild);if(!k.firstChild){k.appendChild(document.createTextNode(l))}else{k.insertBefore(document.createTextNode(l),k.firstChild)}}document.title=l};b.ajax.UpdatePageNavChain=function(k){var l=b("navigation");if(l){l.innerHTML=k}};b.userOptions={options:null,bSend:false,delay:5000};b.userOptions.save=function(o,p,n,l,m){if(null==b.userOptions.options){b.userOptions.options={}}m=!!m;b.userOptions.options[o+"."+p+"."+n]=[o,p,n,l,m];var k=b.userOptions.__get();if(k!=""){document.cookie=b.message("COOKIE_PREFIX")+"_LAST_SETTINGS="+k+"&sessid="+b.bitrix_sessid()+"; expires=Thu, 31 Dec 2020 23:59:59 GMT; path=/;"}if(!b.userOptions.bSend){b.userOptions.bSend=true;setTimeout(function(){b.userOptions.send(null)},b.userOptions.delay)}};b.userOptions.send=function(l){var k=b.userOptions.__get();b.userOptions.options=null;b.userOptions.bSend=false;if(k!=""){document.cookie=b.message("COOKIE_PREFIX")+"_LAST_SETTINGS=; path=/;";b.ajax({method:"GET",dataType:"html",processData:false,cache:false,url:"/bitrix/admin/user_options.php?"+k+"&sessid="+b.bitrix_sessid(),onsuccess:l})}};b.userOptions.del=function(l,m,k,n){b.ajax.get("/bitrix/admin/user_options.php?action=delete&c="+l+"&n="+m+(k==true?"&common=Y":"")+"&sessid="+b.bitrix_sessid(),n)};b.userOptions.__get=function(){if(!b.userOptions.options){return""}var k="",p=-1,o="",m,l;for(l in b.userOptions.options){m=b.userOptions.options[l];if(o!=m[0]+"."+m[1]){p++;k+="&p["+p+"][c]="+b.util.urlencode(m[0]);k+="&p["+p+"][n]="+b.util.urlencode(m[1]);if(m[4]==true){k+="&p["+p+"][d]=Y"}o=m[0]+"."+m[1]}k+="&p["+p+"][v]["+b.util.urlencode(m[2])+"]="+b.util.urlencode(m[3])}return k.substr(1)};b.ajax.history={expected_hash:"",obParams:null,obFrame:null,obImage:null,obTimer:null,bInited:false,bHashCollision:false,bPushState:!!(history.pushState&&b.type.isFunction(history.pushState)),startState:null,init:function(k){if(b.ajax.history.bInited){return}this.obParams=k;var l=this.obParams.getState();if(b.ajax.history.bPushState){b.ajax.history.expected_hash=d.location.pathname;if(d.location.search){b.ajax.history.expected_hash+=d.location.search}b.ajax.history.put(l,b.ajax.history.expected_hash,"",true);setTimeout("BX.bind(window, 'popstate', BX.ajax.history.__hashListener);",500)}else{b.ajax.history.expected_hash=d.location.hash;if(!b.ajax.history.expected_hash||b.ajax.history.expected_hash=="#"){b.ajax.history.expected_hash="__bx_no_hash__"}h.put(b.ajax.history.expected_hash,l);b.ajax.history.obTimer=setTimeout(b.ajax.history.__hashListener,500);if(b.browser.IsIE()){b.ajax.history.obFrame=document.createElement("IFRAME");b.hide_object(b.ajax.history.obFrame);document.body.appendChild(b.ajax.history.obFrame);b.ajax.history.obFrame.contentWindow.document.open();b.ajax.history.obFrame.contentWindow.document.write(b.ajax.history.expected_hash);b.ajax.history.obFrame.contentWindow.document.close()}else{if(b.browser.IsOpera()){b.ajax.history.obImage=document.createElement("IMG");b.hide_object(b.ajax.history.obImage);document.body.appendChild(b.ajax.history.obImage);b.ajax.history.obImage.setAttribute("src","javascript:location.href = 'javascript:BX.ajax.history.__hashListener();';")}}}b.ajax.history.bInited=true},__hashListener:function(m){m=m||d.event||{state:false};if(b.ajax.history.bPushState){b.ajax.history.obParams.setState(m.state||b.ajax.history.startState)}else{if(b.ajax.history.obTimer){d.clearTimeout(b.ajax.history.obTimer);b.ajax.history.obTimer=null}if(null!=b.ajax.history.obFrame){var n=b.ajax.history.obFrame.contentWindow.document.body.innerText}else{var n=d.location.hash}if(!n||n=="#"){n="__bx_no_hash__"}if(n.indexOf("#")==0){n=n.substring(1)}if(n!=b.ajax.history.expected_hash){var l=h.get(n);if(l){b.ajax.history.obParams.setState(l);b.ajax.history.expected_hash=n;if(null!=b.ajax.history.obFrame){var k=n=="__bx_no_hash__"?"":n;if(d.location.hash!=k&&d.location.hash!="#"+k){d.location.hash=k}}}}b.ajax.history.obTimer=setTimeout(b.ajax.history.__hashListener,500)}},put:function(n,k,m,l){if(this.bPushState){if(!l){history.pushState(n,"",k)}else{b.ajax.history.startState=n}}else{if(typeof m!="undefined"){k=m}else{k="view"+k}h.put(k,n);b.ajax.history.expected_hash=k;d.location.hash=b.util.urlencode(k);if(null!=b.ajax.history.obFrame){b.ajax.history.obFrame.contentWindow.document.open();b.ajax.history.obFrame.contentWindow.document.write(k);b.ajax.history.obFrame.contentWindow.document.close()}}},checkRedirectStart:function(k,m){var l=d.location.hash;if(l.substring(0,1)=="#"){l=l.substring(1)}var n=l.substring(0,5);if(n=="view/"||n=="view%"){b.ajax.history.bHashCollision=true;document.write('<div id="__ajax_hash_collision_'+m+'" style="display: none;">')}},checkRedirectFinish:function(k,m){document.write("</div>");var l=d.location.hash;if(l.substring(0,1)=="#"){l=l.substring(1)}b.ready(function(){var q=l.substring(0,5);if(q=="view/"||q=="view%"){var o=b("__ajax_hash_collision_"+m);var p=o.firstChild;b.cleanNode(p);o.style.display="block";if(q!="view%"){l=b.util.urlencode(l)}l+=(l.indexOf("%3F")==-1?"%3F":"%26")+k+"="+m;var n="/bitrix/tools/ajax_redirector.php?hash="+l;b.ajax.insertToNode(n,p)}})}};b.ajax.component=function(k){this.node=k};b.ajax.component.prototype.getState=function(){var k={node:this.node,title:d.document.title,data:b(this.node).innerHTML};var l=b("navigation");if(null!=l){k.nav_chain=l.innerHTML}return k};b.ajax.component.prototype.setState=function(k){b(k.node).innerHTML=k.data;b.ajax.UpdatePageTitle(k.title);if(k.nav_chain){b.ajax.UpdatePageNavChain(k.nav_chain)}};var h={arHistory:{},put:function(l,k){this.arHistory[l]=k},get:function(k){return this.arHistory[k]}};b.ajax.FormData=function(){this.elements=[];this.files=[];this.features={};this.isSupported();this.log("BX FormData init")};b.ajax.FormData.isSupported=function(){var l=new b.ajax.FormData();var k=l.features.supported;l=null;return k};b.ajax.FormData.prototype.log=function(l){if(false){try{if(b.browser.IsIE()){l=JSON.stringify(l)}console.log(l)}catch(k){}}};b.ajax.FormData.prototype.isSupported=function(){var k={};k.fileReader=(d.FileReader&&d.FileReader.prototype.readAsBinaryString);k.readFormData=k.sendFormData=!!(d.FormData);k.supported=!!(k.readFormData&&k.sendFormData);this.features=k;this.log("features:");this.log(k);return k.supported};b.ajax.FormData.prototype.append=function(k,l){if(typeof(l)==="object"){this.files.push({name:k,value:l})}else{this.elements.push({name:k,value:l})}};b.ajax.FormData.prototype.send=function(l,k,n,o){this.log("FD send");this.xhr=b.ajax({method:"POST",dataType:"html",url:l,onsuccess:k,onfailure:o,start:false,preparePost:false});if(n){this.xhr.upload.addEventListener("progress",function(p){if(p.lengthComputable){n(p.loaded/p.totalSize)}},false)}if(this.features.readFormData&&this.features.sendFormData){var m=new FormData();this.log("use browser formdata");for(i in this.elements){m.append(this.elements[i].name,this.elements[i].value)}for(i in this.files){m.append(this.files[i].name,this.files[i].value)}this.xhr.send(m)}return this.xhr};b.addCustomEvent("onAjaxFailure",b.debug)})(window);