(function(a){a.fn.jflickrfeed=function(k,i){k=a.extend(!0,{flickrbase:"../../api.flickr.com/services/feeds/default.htm",feedapi:"photos_public.gne",limit:20,qstrings:{lang:"en-us",format:"json",jsoncallback:"?"},cleanDescription:!0,useTemplate:!0,itemTemplate:"",itemCallback:function(){}},k);var j=k.flickrbase+k.feedapi+"?",h=!0,b;for(b in k.qstrings){h||(j+="&"),j+=b+"="+k.qstrings[b],h=!1}return a(this).each(function(){var c=a(this),d=this;a.getJSON(j,function(e){a.each(e.items,function(n,g){if(n<k.limit){if(k.cleanDescription){var f=/<p>(.*?)<\/p>/g,m=g.description;f.test(m)&&(g.description=m.match(f)[2],void 0!=g.description&&(g.description=g.description.replace("<p>","").replace("</p>","")))}g.image_s=g.media.m.replace("_m","_s");g.image_t=g.media.m.replace("_m","_t");g.image_m=g.media.m.replace("_m","_m");g.image=g.media.m.replace("_m","");g.image_b=g.media.m.replace("_m","_b");delete g.media;if(k.useTemplate){var f=k.itemTemplate,l;for(l in g){f=f.replace(RegExp("{{"+l+"}}","g"),g[l])}c.append(f)}k.itemCallback.call(d,g)}});a.isFunction(i)&&i.call(d,e)})})}})(jQuery);