(function(a){if(typeof a.fn.each2=="undefined"){a.fn.extend({each2:function(f){var d=a([0]),e=-1,b=this.length;while(++e<b&&(d.context=d[0]=this[e])&&f.call(d[0],e,d)!==false){}return this}})}})(jQuery);(function(B,k){if(window.Select2!==k){return}var I,L,v,c,a,n,m={x:0,y:0},t,u,I={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(M){M=M.which?M.which:M;switch(M){case I.LEFT:case I.RIGHT:case I.UP:case I.DOWN:return true}return false},isControl:function(N){var M=N.which;switch(M){case I.SHIFT:case I.CTRL:case I.ALT:return true}if(N.metaKey){return true}return false},isFunctionKey:function(M){M=M.which?M.which:M;return M>=112&&M<=123}},z="<div class='select2-measure-scrollbar'></div>";t=B(document);a=(function(){var M=1;return function(){return M++}}());function o(O,P){var N=0,M=P.length;for(;N<M;N=N+1){if(r(O,P[N])){return N}}return -1}function K(){var M=B(z);M.appendTo("body");var N={width:M.width()-M[0].clientWidth,height:M.height()-M[0].clientHeight};M.remove();return N}function r(N,M){if(N===M){return true}if(N===k||M===k){return false}if(N===null||M===null){return false}if(N.constructor===String){return N+""===M+""}if(M.constructor===String){return M+""===N+""}return false}function g(N,P){var Q,O,M;if(N===null||N.length<1){return[]}Q=N.split(P);for(O=0,M=Q.length;O<M;O=O+1){Q[O]=B.trim(Q[O])}return Q}function f(M){return M.outerWidth(false)-M.width()}function D(N){var M="keyup-change-value";N.on("keydown",function(){if(B.data(N,M)===k){B.data(N,M,N.val())}});N.on("keyup",function(){var O=B.data(N,M);if(O!==k&&N.val()!==O){B.removeData(N,M);N.trigger("keyup-change")}})}t.on("mousemove",function(M){m.x=M.pageX;m.y=M.pageY});function H(M){M.on("mousemove",function(O){var N=m;if(N===k||N.x!==O.pageX||N.y!==O.pageY){B(O.target).trigger("mousemove-filtered",O)}})}function i(P,N,M){M=M||k;var O;return function(){var Q=arguments;window.clearTimeout(O);O=window.setTimeout(function(){N.apply(M,Q)},P)}}function q(O){var M=false,N;return function(){if(M===false){N=O();M=true}return N}}function j(M,O){var N=i(M,function(P){O.trigger("scroll-debounced",P)});O.on("scroll",function(P){if(o(P.target,O.get())>=0){N(P)}})}function G(M){if(M[0]===document.activeElement){return}window.setTimeout(function(){var O=M[0],P=M.val().length,N;M.focus();if(M.is(":visible")&&O===document.activeElement){if(O.setSelectionRange){O.setSelectionRange(P,P)}else{if(O.createTextRange){N=O.createTextRange();N.collapse(false);N.select()}}}},0)}function d(M){M=B(M)[0];var P=0;var N=0;if("selectionStart" in M){P=M.selectionStart;N=M.selectionEnd-P}else{if("selection" in document){M.focus();var O=document.selection.createRange();N=document.selection.createRange().text.length;O.moveStart("character",-M.value.length);P=O.text.length-N}}return{offset:P,length:N}}function y(M){M.preventDefault();M.stopPropagation()}function b(M){M.preventDefault();M.stopImmediatePropagation()}function l(N){if(!n){var M=N[0].currentStyle||window.getComputedStyle(N[0],null);n=B(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:M.fontSize,fontFamily:M.fontFamily,fontStyle:M.fontStyle,fontWeight:M.fontWeight,letterSpacing:M.letterSpacing,textTransform:M.textTransform,whiteSpace:"nowrap"});n.attr("class","select2-sizer");B("body").append(n)}n.text(N.val());return n.width()}function h(N,R,M){var P,Q=[],O;P=N.attr("class");if(P){P=""+P;B(P.split(" ")).each2(function(){if(this.indexOf("select2-")===0){Q.push(this)}})}P=R.attr("class");if(P){P=""+P;B(P.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){O=M(this);if(O){Q.push(this)}}})}N.attr("class",Q.join(" "))}function s(R,Q,O,M){var P=R.toUpperCase().indexOf(Q.toUpperCase()),N=Q.length;if(P<0){O.push(M(R));return}O.push(M(R.substring(0,P)));O.push("<span class='select2-match'>");O.push(M(R.substring(P,P+N)));O.push("</span>");O.push(M(R.substring(P+N,R.length)))}function E(M){var N={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(M).replace(/[&<>"'\/\\]/g,function(O){return N[O]})}function C(O){var R,N=0,P=null,S=O.quietMillis||100,Q=O.url,M=this;return function(T){window.clearTimeout(R);R=window.setTimeout(function(){N+=1;var W=N,X=O.data,V=Q,Z=O.transport||B.fn.select2.ajaxDefaults.transport,U={type:O.type||"GET",cache:O.cache||false,jsonpCallback:O.jsonpCallback||k,dataType:O.dataType||"json"},Y=B.extend({},B.fn.select2.ajaxDefaults.params,U);X=X?X.call(M,T.term,T.page,T.context):null;V=(typeof V==="function")?V.call(M,T.term,T.page,T.context):V;if(P){P.abort()}if(O.params){if(B.isFunction(O.params)){B.extend(Y,O.params.call(M))}else{B.extend(Y,O.params)}}B.extend(Y,{url:V,dataType:O.dataType,data:X,success:function(ab){if(W<N){return}var aa=O.results(ab,T.page);T.callback(aa)}});P=Z.call(M,Y)},S)}}function F(N){var Q=N,P,O,R=function(S){return""+S.text};if(B.isArray(Q)){O=Q;Q={results:O}}if(B.isFunction(Q)===false){O=Q;Q=function(){return O}}var M=Q();if(M.text){R=M.text;if(!B.isFunction(R)){P=M.text;R=function(S){return S[P]}}}return function(U){var T=U.term,S={results:[]},V;if(T===""){U.callback(Q());return}V=function(X,Z){var Y,W;X=X[0];if(X.children){Y={};for(W in X){if(X.hasOwnProperty(W)){Y[W]=X[W]}}Y.children=[];B(X.children).each2(function(aa,ab){V(ab,Y.children)});if(Y.children.length||U.matcher(T,R(Y),X)){Z.push(Y)}}else{if(U.matcher(T,R(X),X)){Z.push(X)}}};B(Q().results).each2(function(X,W){V(W,S.results)});U.callback(S)}}function x(N){var M=B.isFunction(N);return function(Q){var P=Q.term,O={results:[]};B(M?N():N).each(function(){var R=this.text!==k,S=R?this.text:this;if(P===""||Q.matcher(P,S)){O.results.push(R?this:{id:this,text:this})}});Q.callback(O)}}function w(M,N){if(B.isFunction(M)){return true}if(!M){return false}throw new Error(N+" must be a function or a falsy value")}function A(M){return B.isFunction(M)?M():M}function p(M){var N=0;B.each(M,function(O,P){if(P.children){N+=p(P.children)}else{N++}});return N}function e(U,V,S,M){var N=U,W=false,P,T,Q,O,R;if(!M.createSearchChoice||!M.tokenSeparators||M.tokenSeparators.length<1){return k}while(true){T=-1;for(Q=0,O=M.tokenSeparators.length;Q<O;Q++){R=M.tokenSeparators[Q];T=U.indexOf(R);if(T>=0){break}}if(T<0){break}P=U.substring(0,T);U=U.substring(T+R.length);if(P.length>0){P=M.createSearchChoice.call(this,P,V);if(P!==k&&P!==null&&M.id(P)!==k&&M.id(P)!==null){W=false;for(Q=0,O=V.length;Q<O;Q++){if(r(M.id(P),M.id(V[Q]))){W=true;break}}if(!W){S(P)}}}}if(N!==U){return U}}function J(M,N){var O=function(){};O.prototype=new M;O.prototype.constructor=O;O.prototype.parent=M.prototype;O.prototype=B.extend(O.prototype,N);return O}L=J(Object,{bind:function(N){var M=this;return function(){N.apply(M,arguments)}},init:function(Q){var O,N,R=".select2-results",P,M;this.opts=Q=this.prepareOpts(Q);this.id=Q.id;if(Q.element.data("select2")!==k&&Q.element.data("select2")!==null){Q.element.data("select2").destroy()}this.container=this.createContainer();this.containerId="s2id_"+(Q.element.attr("id")||"autogen"+a());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=q(function(){return Q.element.closest("body")});h(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.css(A(Q.containerCss));this.container.addClass(A(Q.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabindex");this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(A(Q.dropdownCssClass));this.dropdown.data("select2",this);this.results=O=this.container.find(R);this.search=N=this.container.find("input.select2-input");this.resultsPage=0;this.context=null;this.initContainer();H(this.results);this.dropdown.on("mousemove-filtered touchstart touchmove touchend",R,this.bind(this.highlightUnderEvent));j(80,this.results);this.dropdown.on("scroll-debounced",R,this.bind(this.loadMoreIfNeeded));B(this.container).on("change",".select2-input",function(S){S.stopPropagation()});B(this.dropdown).on("change",".select2-input",function(S){S.stopPropagation()});if(B.fn.mousewheel){O.mousewheel(function(W,X,U,T){var V=O.scrollTop(),S;if(T>0&&V-T<=0){O.scrollTop(0);y(W)}else{if(T<0&&O.get(0).scrollHeight-O.scrollTop()+T<=O.height()){O.scrollTop(O.get(0).scrollHeight-O.height());y(W)}}})}D(N);N.on("keyup-change input paste",this.bind(this.updateResults));N.on("focus",function(){N.addClass("select2-focused")});N.on("blur",function(){N.removeClass("select2-focused")});this.dropdown.on("mouseup",R,this.bind(function(S){if(B(S.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(S);this.selectHighlighted(S)}}));this.dropdown.on("click mouseup mousedown",function(S){S.stopPropagation()});if(B.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(Q.maximumInputLength!==null){this.search.attr("maxlength",Q.maximumInputLength)}var P=Q.element.prop("disabled");if(P===k){P=false}this.enable(!P);var M=Q.element.prop("readonly");if(M===k){M=false}this.readonly(M);u=u||K();this.autofocus=Q.element.prop("autofocus");Q.element.prop("autofocus",false);if(this.autofocus){this.focus()}},destroy:function(){var N=this.opts.element,M=N.data("select2");if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}if(M!==k){M.container.remove();M.dropdown.remove();N.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||false);if(this.elementTabIndex){N.attr({tabindex:this.elementTabIndex})}else{N.removeAttr("tabindex")}N.show()}},optionToData:function(M){if(M.is("option")){return{id:M.prop("value"),text:M.text(),element:M.get(),css:M.attr("class"),disabled:M.prop("disabled"),locked:r(M.attr("locked"),"locked")||r(M.data("locked"),true)}}else{if(M.is("optgroup")){return{text:M.attr("label"),children:[],element:M.get(),css:M.attr("class")}}}},prepareOpts:function(R){var P,N,M,Q,O=this;P=R.element;if(P.get(0).tagName.toLowerCase()==="select"){this.select=N=R.element}if(N){B.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in R){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}R=B.extend({},{populateResults:function(T,V,Y){var X,W,S,U,Z=this.opts.id;X=function(ag,aa,af){var ah,ac,am,aj,ad,al,ab,ak,ai,ae;ag=R.sortResults(ag,aa,Y);for(ah=0,ac=ag.length;ah<ac;ah=ah+1){am=ag[ah];ad=(am.disabled===true);aj=(!ad)&&(Z(am)!==k);al=am.children&&am.children.length>0;ab=B("<li></li>");ab.addClass("select2-results-dept-"+af);ab.addClass("select2-result");ab.addClass(aj?"select2-result-selectable":"select2-result-unselectable");if(ad){ab.addClass("select2-disabled")}if(al){ab.addClass("select2-result-with-children")}ab.addClass(O.opts.formatResultCssClass(am));ak=B(document.createElement("div"));ak.addClass("select2-result-label");ae=R.formatResult(am,ak,Y,O.opts.escapeMarkup);if(ae!==k){ak.html(ae)}ab.append(ak);if(al){ai=B("<ul></ul>");ai.addClass("select2-result-sub");X(am.children,ai,af+1);ab.append(ai)}ab.data("select2-data",am);aa.append(ab)}};X(V,T,0)}},B.fn.select2.defaults,R);if(typeof(R.id)!=="function"){M=R.id;R.id=function(S){return S[M]}}if(B.isArray(R.element.data("select2Tags"))){if("tags" in R){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+R.element.attr("id")}R.tags=R.element.data("select2Tags")}if(N){R.query=this.bind(function(W){var V={results:[],more:false},U=W.term,T,S,X;X=function(Y,aa){var Z;if(Y.is("option")){if(W.matcher(U,Y.text(),Y)){aa.push(O.optionToData(Y))}}else{if(Y.is("optgroup")){Z=O.optionToData(Y);Y.children().each2(function(ab,ac){X(ac,Z.children)});if(Z.children.length>0){aa.push(Z)}}}};T=P.children();if(this.getPlaceholder()!==k&&T.length>0){S=this.getPlaceholderOption();if(S){T=T.not(S)}}T.each2(function(Y,Z){X(Z,V.results)});W.callback(V)});R.id=function(S){return S.id};R.formatResultCssClass=function(S){return S.css}}else{if(!("query" in R)){if("ajax" in R){Q=R.element.data("ajax-url");if(Q&&Q.length>0){R.ajax.url=Q}R.query=C.call(R.element,R.ajax)}else{if("data" in R){R.query=F(R.data)}else{if("tags" in R){R.query=x(R.tags);if(R.createSearchChoice===k){R.createSearchChoice=function(S){return{id:S,text:S}}}if(R.initSelection===k){R.initSelection=function(S,U){var T=[];B(g(S.val(),R.separator)).each(function(){var X=this,W=this,V=R.tags;if(B.isFunction(V)){V=V()}B(V).each(function(){if(r(this.id,X)){W=this.text;return false}});T.push({id:X,text:W})});U(T)}}}}}}}if(typeof(R.query)!=="function"){throw"query function not defined for Select2 "+R.element.attr("id")}return R},monitorSource:function(){var M=this.opts.element,N;M.on("change.select2",this.bind(function(O){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));N=this.bind(function(){var Q,P,O=this;var R=M.prop("disabled");if(R===k){R=false}this.enable(!R);var P=M.prop("readonly");if(P===k){P=false}this.readonly(P);h(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(A(this.opts.containerCssClass));h(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(A(this.opts.dropdownCssClass))});M.on("propertychange.select2 DOMAttrModified.select2",N);if(this.mutationCallback===k){this.mutationCallback=function(O){O.forEach(N)}}if(typeof WebKitMutationObserver!=="undefined"){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new WebKitMutationObserver(this.mutationCallback);this.propertyObserver.observe(M.get(0),{attributes:true,subtree:false})}},triggerSelect:function(N){var M=B.Event("select2-selecting",{val:this.id(N),object:N});this.opts.element.trigger(M);return !M.isDefaultPrevented()},triggerChange:function(M){M=M||{};M=B.extend({},M,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(M);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange){this.opts.element.blur()}},isInterfaceEnabled:function(){return this.enabledInterface===true},enableInterface:function(){var M=this._enabled&&!this._readonly,N=!M;if(M===this.enabledInterface){return false}this.container.toggleClass("select2-container-disabled",N);this.close();this.enabledInterface=M;return true},enable:function(M){if(M===k){M=true}if(this._enabled===M){return false}this._enabled=M;this.opts.element.prop("disabled",!M);this.enableInterface();return true},readonly:function(M){if(M===k){M=false}if(this._readonly===M){return false}this._readonly=M;this.opts.element.prop("readonly",M);this.enableInterface();return true},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var O=this.dropdown,Q=this.container.offset(),X=this.container.outerHeight(false),Y=this.container.outerWidth(false),U=O.outerHeight(false),N=B(window).scrollLeft()+B(window).width(),ab=B(window).scrollTop()+B(window).height(),P=Q.top+X,Z=Q.left,M=P+U<=ab,S=(Q.top-U)>=this.body().scrollTop(),V=O.outerWidth(false),ad=Z+V<=N,ac=O.hasClass("select2-drop-above"),R,aa,T,W;if(this.opts.dropdownAutoWidth){W=B(".select2-results",O)[0];O.addClass("select2-drop-auto-width");O.css("width","");V=O.outerWidth(false)+(W.scrollHeight===W.clientHeight?0:u.width);V>Y?Y=V:V=Y;ad=Z+V<=N}else{this.container.removeClass("select2-drop-auto-width")}if(this.body().css("position")!=="static"){R=this.body().offset();P-=R.top;Z-=R.left}if(ac){aa=true;if(!S&&M){aa=false}}else{aa=false;if(!M&&S){aa=true}}if(!ad){Z=Q.left+Y-V}if(aa){P=Q.top-U;this.container.addClass("select2-drop-above");O.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");O.removeClass("select2-drop-above")}T=B.extend({top:P,left:Z,width:Y},A(this.opts.dropdownCss));O.css(T)},shouldOpen:function(){var M;if(this.opened()){return false}if(this._enabled===false||this._readonly===true){return false}M=B.Event("select2-opening");this.opts.element.trigger(M);return !M.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}this.opening();return true},opening:function(){var T=this.containerId,M="scroll."+T,Q="resize."+T,P="orientationchange."+T,N,S;this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.clearDropdownAlignmentPreference();if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}N=B("#select2-drop-mask");if(N.length==0){N=B(document.createElement("div"));N.attr("id","select2-drop-mask").attr("class","select2-drop-mask");N.hide();N.appendTo(this.body());N.on("mousedown touchstart click",function(V){var W=B("#select2-drop"),U;if(W.length>0){U=W.data("select2");if(U.opts.selectOnBlur){U.selectHighlighted({noFocus:true})}U.close();V.preventDefault();V.stopPropagation()}})}if(this.dropdown.prev()[0]!==N[0]){this.dropdown.before(N)}B("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");S=O();N.css(S).show();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");var R=this;this.container.parents().add(window).each(function(){B(this).on(Q+" "+M+" "+P,function(U){var V=O();B("#select2-drop-mask").css(V);R.positionDropdown()})});function O(){return{width:Math.max(document.documentElement.scrollWidth,B(window).width()),height:Math.max(document.documentElement.scrollHeight,B(window).height())}}},close:function(){if(!this.opened()){return}var P=this.containerId,M="scroll."+P,O="resize."+P,N="orientationchange."+P;this.container.parents().add(window).each(function(){B(this).off(M).off(O).off(N)});this.clearDropdownAlignmentPreference();B("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open");this.results.empty();this.clearSearch();this.search.removeClass("select2-active");this.opts.element.trigger(B.Event("select2-close"))},externalSearch:function(M){this.open();this.search.val(M);this.updateResults(false)},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var P=this.results,O,M,T,S,Q,R,N;M=this.highlight();if(M<0){return}if(M==0){P.scrollTop(0);return}O=this.findHighlightableChoices().find(".select2-result-label");T=B(O[M]);S=T.offset().top+T.outerHeight(true);if(M===O.length-1){N=P.find("li.select2-more-results");if(N.length>0){S=N.offset().top+N.outerHeight(true)}}Q=P.offset().top+P.outerHeight(true);if(S>Q){P.scrollTop(P.scrollTop()+(S-Q))}R=T.offset().top-P.offset().top;if(R<0&&T.css("display")!="none"){P.scrollTop(P.scrollTop()+R)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(P){var O=this.findHighlightableChoices(),N=this.highlight();while(N>-1&&N<O.length){N+=P;var M=B(O[N]);if(M.hasClass("select2-result-selectable")&&!M.hasClass("select2-disabled")&&!M.hasClass("select2-selected")){this.highlight(N);break}}},highlight:function(N){var P=this.findHighlightableChoices(),M,O;if(arguments.length===0){return o(P.filter(".select2-highlighted")[0],P.get())}if(N>=P.length){N=P.length-1}if(N<0){N=0}this.results.find(".select2-highlighted").removeClass("select2-highlighted");M=B(P[N]);M.addClass("select2-highlighted");this.ensureHighlightVisible();O=M.data("select2-data");if(O){this.opts.element.trigger({type:"select2-highlight",val:this.id(O),choice:O})}},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(N){var M=B(N.target).closest(".select2-result-selectable");if(M.length>0&&!M.is(".select2-highlighted")){var O=this.findHighlightableChoices();this.highlight(O.index(M))}else{if(M.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}}},loadMoreIfNeeded:function(){var Q=this.results,P=Q.find("li.select2-more-results"),T,S=-1,R=this.resultsPage+1,M=this,O=this.search.val(),N=this.context;if(P.length===0){return}T=P.offset().top-Q.offset().top-Q.height();if(T<=this.opts.loadMorePadding){P.addClass("select2-active");this.opts.query({element:this.opts.element,term:O,page:R,context:N,matcher:this.opts.matcher,callback:this.bind(function(U){if(!M.opened()){return}M.opts.populateResults.call(this,Q,U.results,{term:O,page:R,context:N});M.postprocessResults(U,false,false);if(U.more===true){P.detach().appendTo(Q).text(M.opts.formatLoadMore(R+1));window.setTimeout(function(){M.loadMoreIfNeeded()},10)}else{P.remove()}M.positionDropdown();M.resultsPage=R;M.context=U.context})})}},tokenize:function(){},updateResults:function(U){var X=this.search,S=this.results,M=this.opts,R,W=this,V,Q=X.val(),O=B.data(this.container,"select2-last-term");if(U!==true&&O&&r(Q,O)){return}B.data(this.container,"select2-last-term",Q);if(U!==true&&(this.showSearchInput===false||!this.opened())){return}function T(){X.removeClass("select2-active");W.positionDropdown()}function N(Y){S.html(Y);T()}var P=this.getMaximumSelectionSize();if(P>=1){R=this.data();if(B.isArray(R)&&R.length>=P&&w(M.formatSelectionTooBig,"formatSelectionTooBig")){N("<li class='select2-selection-limit'>"+M.formatSelectionTooBig(P)+"</li>");return}}if(X.val().length<M.minimumInputLength){if(w(M.formatInputTooShort,"formatInputTooShort")){N("<li class='select2-no-results'>"+M.formatInputTooShort(X.val(),M.minimumInputLength)+"</li>")}else{N("")}if(U&&this.showSearch){this.showSearch(true)}return}if(M.maximumInputLength&&X.val().length>M.maximumInputLength){if(w(M.formatInputTooLong,"formatInputTooLong")){N("<li class='select2-no-results'>"+M.formatInputTooLong(X.val(),M.maximumInputLength)+"</li>")}else{N("")}return}if(M.formatSearching&&this.findHighlightableChoices().length===0){N("<li class='select2-searching'>"+M.formatSearching()+"</li>")}X.addClass("select2-active");V=this.tokenize();if(V!=k&&V!=null){X.val(V)}this.resultsPage=1;M.query({element:M.element,term:X.val(),page:this.resultsPage,context:null,matcher:M.matcher,callback:this.bind(function(Z){var Y;if(!this.opened()){this.search.removeClass("select2-active");return}this.context=(Z.context===k)?null:Z.context;if(this.opts.createSearchChoice&&X.val()!==""){Y=this.opts.createSearchChoice.call(W,X.val(),Z.results);if(Y!==k&&Y!==null&&W.id(Y)!==k&&W.id(Y)!==null){if(B(Z.results).filter(function(){return r(W.id(this),W.id(Y))}).length===0){Z.results.unshift(Y)}}}if(Z.results.length===0&&w(M.formatNoMatches,"formatNoMatches")){N("<li class='select2-no-results'>"+M.formatNoMatches(X.val())+"</li>");return}S.empty();W.opts.populateResults.call(this,S,Z.results,{term:X.val(),page:this.resultsPage,context:null});if(Z.more===true&&w(M.formatLoadMore,"formatLoadMore")){S.append("<li class='select2-more-results'>"+W.opts.escapeMarkup(M.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){W.loadMoreIfNeeded()},10)}this.postprocessResults(Z,U);T();this.opts.element.trigger({type:"select2-loaded",items:Z})})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur){this.selectHighlighted({noFocus:true})}this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){G(this.search)},selectHighlighted:function(N){var M=this.highlight(),O=this.results.find(".select2-highlighted"),P=O.closest(".select2-result").data("select2-data");if(P){this.highlight(M);this.onSelect(P,N)}else{if(N&&N.noFocus){this.close()}}},getPlaceholder:function(){var M;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((M=this.getPlaceholderOption())!==k?M.text():k)},getPlaceholderOption:function(){if(this.select){var M=this.select.children().first();if(this.opts.placeholderOption!==k){return(this.opts.placeholderOption==="first"&&M)||(typeof this.opts.placeholderOption==="function"&&this.opts.placeholderOption(this.select))}else{if(M.text()===""&&M.val()===""){return M}}}},initContainerWidth:function(){function N(){var R,P,S,Q,O;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){R=this.opts.element.attr("style");if(R!==k){P=R.split(";");for(Q=0,O=P.length;Q<O;Q=Q+1){S=P[Q].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(S!==null&&S.length>=1){return S[1]}}}if(this.opts.width==="resolve"){R=this.opts.element.css("width");if(R.indexOf("%")>0){return R}return(this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px")}return null}else{if(B.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var M=N.call(this);if(M!==null){this.container.css("width",M)}}});v=J(L,{createContainer:function(){var M=B(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return M},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.focusser.prop("disabled",!this.isInterfaceEnabled())}},opening:function(){var O,N,M;if(this.opts.minimumResultsForSearch>=0){this.showSearch(true)}this.parent.opening.apply(this,arguments);if(this.showSearchInput!==false){this.search.val(this.focusser.val())}this.search.focus();O=this.search.get(0);if(O.createTextRange){N=O.createTextRange();N.collapse(false);N.select()}else{if(O.setSelectionRange){M=this.search.val().length;O.setSelectionRange(M,M)}}this.focusser.prop("disabled",true).val("");this.updateResults(true);this.opts.element.trigger(B.Event("select2-open"))},close:function(){if(!this.opened()){return}this.parent.close.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},focus:function(){if(this.opened()){this.close()}else{this.focusser.removeAttr("disabled");this.focusser.focus()}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},initContainer:function(){var N,M=this.container,O=this.dropdown;if(this.opts.minimumResultsForSearch<0){this.showSearch(false)}else{this.showSearch(true)}this.selection=N=M.find(".select2-choice");this.focusser=M.find(".select2-focusser");this.focusser.attr("id","s2id_autogen"+a());B("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id"));this.focusser.attr("tabindex",this.elementTabIndex);this.search.on("keydown",this.bind(function(P){if(!this.isInterfaceEnabled()){return}if(P.which===I.PAGE_UP||P.which===I.PAGE_DOWN){y(P);return}switch(P.which){case I.UP:case I.DOWN:this.moveHighlight((P.which===I.UP)?-1:1);y(P);return;case I.ENTER:this.selectHighlighted();y(P);return;case I.TAB:this.selectHighlighted({noFocus:true});return;case I.ESC:this.cancel(P);y(P);return}}));this.search.on("blur",this.bind(function(P){if(document.activeElement===this.body().get(0)){window.setTimeout(this.bind(function(){this.search.focus()}),0)}}));this.focusser.on("keydown",this.bind(function(P){if(!this.isInterfaceEnabled()){return}if(P.which===I.TAB||I.isControl(P)||I.isFunctionKey(P)||P.which===I.ESC){return}if(this.opts.openOnEnter===false&&P.which===I.ENTER){y(P);return}if(P.which==I.DOWN||P.which==I.UP||(P.which==I.ENTER&&this.opts.openOnEnter)){if(P.altKey||P.ctrlKey||P.shiftKey||P.metaKey){return}this.open();y(P);return}if(P.which==I.DELETE||P.which==I.BACKSPACE){if(this.opts.allowClear){this.clear()}y(P);return}}));D(this.focusser);this.focusser.on("keyup-change input",this.bind(function(P){if(this.opts.minimumResultsForSearch>=0){P.stopPropagation();if(this.opened()){return}this.open()}}));N.on("mousedown","abbr",this.bind(function(P){if(!this.isInterfaceEnabled()){return}this.clear();b(P);this.close();this.selection.focus()}));N.on("mousedown",this.bind(function(P){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(B.Event("select2-focus"))}if(this.opened()){this.close()}else{if(this.isInterfaceEnabled()){this.open()}}y(P)}));O.on("mousedown",this.bind(function(){this.search.focus()}));N.on("focus",this.bind(function(P){y(P)}));this.focusser.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(B.Event("select2-focus"))}this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active");this.opts.element.trigger(B.Event("select2-blur"))}}));this.search.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(B.Event("select2-focus"))}this.container.addClass("select2-container-active")}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.setPlaceholder()},clear:function(N){var O=this.selection.data("select2-data");if(O){var M=this.getPlaceholderOption();this.opts.element.val(M?M.val():"");this.selection.find(".select2-chosen").empty();this.selection.removeData("select2-data");this.setPlaceholder();if(N!==false){this.opts.element.trigger({type:"select2-removed",val:this.id(O),choice:O});this.triggerChange({removed:O})}}},initSelection:function(){var N;if(this.isPlaceholderOptionSelected()){this.updateSelection([]);this.close();this.setPlaceholder()}else{var M=this;this.opts.initSelection.call(null,this.opts.element,function(O){if(O!==k&&O!==null){M.updateSelection(O);M.close();M.setPlaceholder()}})}},isPlaceholderOptionSelected:function(){var M;return((M=this.getPlaceholderOption())!==k&&M.is(":selected"))||(this.opts.element.val()==="")||(this.opts.element.val()===k)||(this.opts.element.val()===null)},prepareOpts:function(){var N=this.parent.prepareOpts.apply(this,arguments),M=this;if(N.element.get(0).tagName.toLowerCase()==="select"){N.initSelection=function(O,Q){var P=O.find(":selected");Q(M.optionToData(P))}}else{if("data" in N){N.initSelection=N.initSelection||function(P,R){var Q=P.val();var O=null;N.query({matcher:function(S,V,T){var U=r(Q,N.id(T));if(U){O=T}return U},callback:!B.isFunction(R)?B.noop:function(){R(O)}})}}}return N},getPlaceholder:function(){if(this.select){if(this.getPlaceholderOption()===k){return k}}return this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var M=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&M!==k){if(this.select&&this.getPlaceholderOption()===k){return}this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(M));this.selection.addClass("select2-default");this.container.removeClass("select2-allowclear")}},postprocessResults:function(R,N,Q){var P=0,M=this,S=true;this.findHighlightableChoices().each2(function(T,U){if(r(M.id(U.data("select2-data")),M.opts.element.val())){P=T;return false}});if(Q!==false){if(N===true&&P>=0){this.highlight(P)}else{this.highlight(0)}}if(N===true){var O=this.opts.minimumResultsForSearch;if(O>=0){this.showSearch(p(R.results)>=O)}}},showSearch:function(M){if(this.showSearchInput===M){return}this.showSearchInput=M;this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!M);this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!M);B(this.dropdown,this.container).toggleClass("select2-with-searchbox",M)},onSelect:function(O,N){if(!this.triggerSelect(O)){return}var M=this.opts.element.val(),P=this.data();this.opts.element.val(this.id(O));this.updateSelection(O);this.opts.element.trigger({type:"select2-selected",val:this.id(O),choice:O});this.close();if(!N||!N.noFocus){this.selection.focus()}if(!r(M,this.id(O))){this.triggerChange({added:O,removed:P})}},updateSelection:function(P){var N=this.selection.find(".select2-chosen"),O,M;this.selection.data("select2-data",P);N.empty();O=this.opts.formatSelection(P,N,this.opts.escapeMarkup);if(O!==k){N.append(O)}M=this.opts.formatSelectionCssClass(P,N);if(M!==k){N.addClass(M)}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==k){this.container.addClass("select2-allowclear")}},val:function(){var Q,N=false,O=null,M=this,P=this.data();if(arguments.length===0){return this.opts.element.val()}Q=arguments[0];if(arguments.length>1){N=arguments[1]}if(this.select){this.select.val(Q).find(":selected").each2(function(R,S){O=M.optionToData(S);return false});this.updateSelection(O);this.setPlaceholder();if(N){this.triggerChange({added:O,removed:P})}}else{if(!Q&&Q!==0){this.clear(N);return}if(this.opts.initSelection===k){throw new Error("cannot call val() if initSelection() is not defined")}this.opts.element.val(Q);this.opts.initSelection(this.opts.element,function(R){M.opts.element.val(!R?"":M.id(R));M.updateSelection(R);M.setPlaceholder();if(N){M.triggerChange({added:R,removed:P})}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(O,M){var N;if(arguments.length===0){N=this.selection.data("select2-data");if(N==k){N=null}return N}else{if(!O||O===""){this.clear(M)}else{N=this.data();this.opts.element.val(!O?"":this.id(O));this.updateSelection(O);if(M){this.triggerChange({added:O,removed:N})}}}}});c=J(L,{createContainer:function(){var M=B(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitilize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return M},prepareOpts:function(){var N=this.parent.prepareOpts.apply(this,arguments),M=this;if(N.element.get(0).tagName.toLowerCase()==="select"){N.initSelection=function(O,Q){var P=[];O.find(":selected").each2(function(R,S){P.push(M.optionToData(S))});Q(P)}}else{if("data" in N){N.initSelection=N.initSelection||function(O,R){var P=g(O.val(),N.separator);var Q=[];N.query({matcher:function(S,V,T){var U=B.grep(P,function(W){return r(W,N.id(T))}).length;if(U){Q.push(T)}return U},callback:!B.isFunction(R)?B.noop:function(){var S=[];for(var V=0;V<P.length;V++){var W=P[V];for(var U=0;U<Q.length;U++){var T=Q[U];if(r(W,N.id(T))){S.push(T);Q.splice(U,1);break}}}R(S)}})}}}return N},selectChoice:function(M){var N=this.container.find(".select2-search-choice-focus");if(N.length&&M&&M[0]==N[0]){}else{if(N.length){this.opts.element.trigger("choice-deselected",N)}N.removeClass("select2-search-choice-focus");if(M&&M.length){this.close();M.addClass("select2-search-choice-focus");this.opts.element.trigger("choice-selected",M)}}},initContainer:function(){var M=".select2-choices",N;this.searchContainer=this.container.find(".select2-search-field");this.selection=N=this.container.find(M);var O=this;this.selection.on("mousedown",".select2-search-choice",function(P){O.search[0].focus();O.selectChoice(B(this))});this.search.attr("id","s2id_autogen"+a());B("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id"));this.search.on("input paste",this.bind(function(){if(!this.isInterfaceEnabled()){return}if(!this.opened()){this.open()}}));this.search.attr("tabindex",this.elementTabIndex);this.keydowns=0;this.search.on("keydown",this.bind(function(T){if(!this.isInterfaceEnabled()){return}++this.keydowns;var R=N.find(".select2-search-choice-focus");var S=R.prev(".select2-search-choice:not(.select2-locked)");var Q=R.next(".select2-search-choice:not(.select2-locked)");var U=d(this.search);if(R.length&&(T.which==I.LEFT||T.which==I.RIGHT||T.which==I.BACKSPACE||T.which==I.DELETE||T.which==I.ENTER)){var P=R;if(T.which==I.LEFT&&S.length){P=S}else{if(T.which==I.RIGHT){P=Q.length?Q:null}else{if(T.which===I.BACKSPACE){this.unselect(R.first());this.search.width(10);P=S.length?S:Q}else{if(T.which==I.DELETE){this.unselect(R.first());this.search.width(10);P=Q.length?Q:null}else{if(T.which==I.ENTER){P=null}}}}}this.selectChoice(P);y(T);if(!P||!P.length){this.open()}return}else{if(((T.which===I.BACKSPACE&&this.keydowns==1)||T.which==I.LEFT)&&(U.offset==0&&!U.length)){this.selectChoice(N.find(".select2-search-choice:not(.select2-locked)").last());y(T);return}else{this.selectChoice(null)}}if(this.opened()){switch(T.which){case I.UP:case I.DOWN:this.moveHighlight((T.which===I.UP)?-1:1);y(T);return;case I.ENTER:this.selectHighlighted();y(T);return;case I.TAB:this.selectHighlighted({noFocus:true});this.close();return;case I.ESC:this.cancel(T);y(T);return}}if(T.which===I.TAB||I.isControl(T)||I.isFunctionKey(T)||T.which===I.BACKSPACE||T.which===I.ESC){return}if(T.which===I.ENTER){if(this.opts.openOnEnter===false){return}else{if(T.altKey||T.ctrlKey||T.shiftKey||T.metaKey){return}}}this.open();if(T.which===I.PAGE_UP||T.which===I.PAGE_DOWN){y(T)}if(T.which===I.ENTER){y(T)}}));this.search.on("keyup",this.bind(function(P){this.keydowns=0;this.resizeSearch()}));this.search.on("blur",this.bind(function(P){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.selectChoice(null);if(!this.opened()){this.clearSearch()}P.stopImmediatePropagation();this.opts.element.trigger(B.Event("select2-blur"))}));this.container.on("click",M,this.bind(function(P){if(!this.isInterfaceEnabled()){return}if(B(P.target).closest(".select2-search-choice").length>0){return}this.selectChoice(null);this.clearPlaceholder();if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(B.Event("select2-focus"))}this.open();this.focusSearch();P.preventDefault()}));this.container.on("focus",M,this.bind(function(){if(!this.isInterfaceEnabled()){return}if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(B.Event("select2-focus"))}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.clearSearch()},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.search.prop("disabled",!this.isInterfaceEnabled())}},initSelection:function(){var N;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var M=this;this.opts.initSelection.call(null,this.opts.element,function(O){if(O!==k&&O!==null){M.updateSelection(O);M.close();M.clearSearch()}})}},clearSearch:function(){var N=this.getPlaceholder(),M=this.getMaxSearchWidth();if(N!==k&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(N).addClass("select2-default");this.search.width(M>0?M:this.container.css("width"))}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.clearPlaceholder();this.resizeSearch();this.parent.opening.apply(this,arguments);this.focusSearch();this.updateResults(true);this.search.focus();this.opts.element.trigger(B.Event("select2-open"))},close:function(){if(!this.opened()){return}this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(P){var O=[],N=[],M=this;B(P).each(function(){if(o(M.id(this),O)<0){O.push(M.id(this));N.push(this)}});P=N;this.selection.find(".select2-search-choice").remove();B(P).each(function(){M.addSelectedChoice(this)});M.postprocessResults()},tokenize:function(){var M=this.search.val();M=this.opts.tokenizer.call(this,M,this.data(),this.bind(this.onSelect),this.opts);if(M!=null&&M!=k){this.search.val(M);if(M.length>0){this.open()}}},onSelect:function(N,M){if(!this.triggerSelect(N)){return}this.addSelectedChoice(N);this.opts.element.trigger({type:"selected",val:this.id(N),choice:N});if(this.select||!this.opts.closeOnSelect){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:N});if(!M||!M.noFocus){this.focusSearch()}},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(Q){var S=!Q.locked,O=B("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),T=B("<li class='select2-search-choice select2-locked'><div></div></li>");var P=S?O:T,M=this.id(Q),N=this.getVal(),R,U;R=this.opts.formatSelection(Q,P.find("div"),this.opts.escapeMarkup);if(R!=k){P.find("div").replaceWith("<div>"+R+"</div>")}U=this.opts.formatSelectionCssClass(Q,P.find("div"));if(U!=k){P.addClass(U)}if(S){P.find(".select2-search-choice-close").on("mousedown",y).on("click dblclick",this.bind(function(V){if(!this.isInterfaceEnabled()){return}B(V.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(B(V.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();y(V)})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled()){return}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}P.data("select2-data",Q);P.insertBefore(this.searchContainer);N.push(M);this.setVal(N)},unselect:function(N){var P=this.getVal(),O,M;N=N.closest(".select2-search-choice");if(N.length===0){throw"Invalid argument: "+N+". Must be .select2-search-choice"}O=N.data("select2-data");if(!O){return}M=o(this.id(O),P);if(M>=0){P.splice(M,1);this.setVal(P);if(this.select){this.postprocessResults()}}N.remove();this.opts.element.trigger({type:"removed",val:this.id(O),choice:O});this.triggerChange({removed:O})},postprocessResults:function(Q,N,P){var R=this.getVal(),S=this.results.find(".select2-result"),O=this.results.find(".select2-result-with-children"),M=this;S.each2(function(U,T){var V=M.id(T.data("select2-data"));if(o(V,R)>=0){T.addClass("select2-selected");T.find(".select2-result-selectable").addClass("select2-selected")}});O.each2(function(U,T){if(!T.is(".select2-result-selectable")&&T.find(".select2-result-selectable:not(.select2-selected)").length===0){T.addClass("select2-selected")}});if(this.highlight()==-1&&P!==false){M.highlight(0)}if(!this.opts.createSearchChoice&&!S.filter(".select2-result:not(.select2-selected)").length>0){if(!Q||Q&&!Q.more&&this.results.find(".select2-no-results").length===0){if(w(M.opts.formatNoMatches,"formatNoMatches")){this.results.append("<li class='select2-no-results'>"+M.opts.formatNoMatches(M.search.val())+"</li>")}}}},getMaxSearchWidth:function(){return this.selection.width()-f(this.search)},resizeSearch:function(){var R,P,O,M,N,Q=f(this.search);R=l(this.search)+10;P=this.search.offset().left;O=this.selection.width();M=this.selection.offset().left;N=O-(P-M)-Q;if(N<R){N=O-Q}if(N<40){N=O-Q}if(N<=0){N=R}this.search.width(N)},getVal:function(){var M;if(this.select){M=this.select.val();return M===null?[]:M}else{M=this.opts.element.val();return g(M,this.opts.separator)}},setVal:function(N){var M;if(this.select){this.select.val(N)}else{M=[];B(N).each(function(){if(o(this,M)<0){M.push(this)}});this.opts.element.val(M.length===0?"":M.join(this.opts.separator))}},buildChangeDetails:function(M,P){var P=P.slice(0),M=M.slice(0);for(var O=0;O<P.length;O++){for(var N=0;N<M.length;N++){if(r(this.opts.id(P[O]),this.opts.id(M[N]))){P.splice(O,1);O--;M.splice(N,1);N--}}}return{added:P,removed:M}},val:function(Q,N){var P,M=this,O;if(arguments.length===0){return this.getVal()}P=this.data();if(!P.length){P=[]}if(!Q&&Q!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(N){this.triggerChange({added:this.data(),removed:P})}return}this.setVal(Q);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(N){this.triggerChange(this.buildChangeDetails(P,this.data()))}}else{if(this.opts.initSelection===k){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(S){var R=B.map(S,M.id);M.setVal(R);M.updateSelection(S);M.clearSearch();if(N){M.triggerChange(this.buildChangeDetails(P,this.data()))}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var N=[],M=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){N.push(M.opts.id(B(this).data("select2-data")))});this.setVal(N);this.triggerChange()},data:function(O,P){var N=this,Q,M;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return B(this).data("select2-data")}).get()}else{M=this.data();if(!O){O=[]}Q=B.map(O,function(R){return N.opts.id(R)});this.setVal(Q);this.updateSelection(O);this.clearSearch();if(P){this.triggerChange(this.buildChangeDetails(M,this.data()))}}}});B.fn.select2=function(){var Q=Array.prototype.slice.call(arguments,0),N,P,M,S,U,T=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","readonly","positionDropdown","data","search"],R=["val","opened","isFocused","container","data"],O={search:"externalSearch"};this.each(function(){if(Q.length===0||typeof(Q[0])==="object"){N=Q.length===0?{}:B.extend({},Q[0]);N.element=B(this);if(N.element.get(0).tagName.toLowerCase()==="select"){U=N.element.prop("multiple")}else{U=N.multiple||false;if("tags" in N){N.multiple=U=true}}P=U?new c():new v();P.init(N)}else{if(typeof(Q[0])==="string"){if(o(Q[0],T)<0){throw"Unknown method: "+Q[0]}S=k;P=B(this).data("select2");if(P===k){return}M=Q[0];if(M==="container"){S=P.container}else{if(M==="dropdown"){S=P.dropdown}else{if(O[M]){M=O[M]}S=P[M].apply(P,Q.slice(1))}}if(o(Q[0],R)>=0){return false}}else{throw"Invalid arguments to select2 plugin: "+Q}}});return(S===k)?this:S};B.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(N,O,Q,M){var P=[];s(N.text,Q.term,P,M);return P.join("")},formatSelection:function(O,N,M){return O?M(O.text):k},sortResults:function(N,M,O){return N},formatResultCssClass:function(M){return k},formatSelectionCssClass:function(N,M){return k},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(M,N){var O=N-M.length;return"Please enter "+O+" more character"+(O==1?"":"s")},formatInputTooLong:function(N,M){var O=N.length-M;return"Please delete "+O+" character"+(O==1?"":"s")},formatSelectionTooBig:function(M){return"You can only select "+M+" item"+(M==1?"":"s")},formatLoadMore:function(M){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(M){return M.id},matcher:function(M,N){return(""+N).toUpperCase().indexOf((""+M).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:e,escapeMarkup:E,blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(M){return M},adaptDropdownCssClass:function(M){return null}};B.fn.select2.ajaxDefaults={transport:B.ajax,params:{type:"GET",cache:false,dataType:"json"}};window.Select2={query:{ajax:C,local:F,tags:x},util:{debounce:i,markMatch:s,escapeMarkup:E},"class":{"abstract":L,single:v,multi:c}}}(jQuery));