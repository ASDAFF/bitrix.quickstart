(function(c){var b=BX.message("SERVER_TIME"),a;c.fn.timer=function(e){e=c.extend({days:".days",hours:".hours",minute:".minute",second:".second",blockTime:".timer__item",linePercent:".progress_bar",textLinePercent:".progress_text",destroy:false},e);var d=e;var f=this;if(c(this).length<1){return false}return c.timer.count(f,e)};jQuery.extend({timer:{count:function(f,d){var e=c(d.minute).closest(d.blockTime).css("display");if(!a){b=parseInt(b)+1;setInterval(function(){b=parseInt(b)+1},1000)}a=true;c(f).not(".runTimer").each(function(){var g=c(this);c.timer.runTimer(g,d,e);setInterval(function(){c.timer.runTimer(g,d,e)},1000);c(g).addClass("runTimer")})},runTimer:function(m,g,i){var o=m,e=m.data("timer"),u=e.DATE_TO-e.DATE_FROM,d=e.DATE_TO-b;if(d<1&&e.AUTO_RENEWAL=="Y"){for(var f=0;f<200;f++){var p=(f*u+e.DATE_TO)-b;if(p>0){d=p;break}}}if(d>0){var k=parseInt((d/(60*60))/24);if(k<10){k="0"+k}k=k.toString();var q=parseInt(d/(60*60)),t=parseInt((d/(60*60))%24);if(t<10){t="0"+t}t=t.toString();var r=parseInt(d/(60))%60;if(r<10){r="0"+r}r=r.toString();var n=parseInt(d)%60;if(n<10){n="0"+n}n=n.toString();var s=false;if(!!e.DINAMICA_DATA){if(e.DINAMICA_DATA=="evenly"){s=Math.floor(100-((d/u)*100));o.find(g.linePercent).css("width",s+"%");o.find(g.textLinePercent).text(s)}else{var h=false,l=false;for(var j in e.DINAMICA_DATA){if(!h){h=j;l=j}if(h<q&&q<j){s=e.DINAMICA_DATA[j];break}h=j}if(!s){if(q>h){s=e.DINAMICA_DATA[h]}else{if(q<h){s=e.DINAMICA_DATA[l]}}}if(s){o.find(g.linePercent).css("width",s+"%");o.find(g.textLinePercent).text(s)}}}else{s=Math.floor((d/u)*100);o.find(g.linePercent).css("width",s+"%");o.find(g.textLinePercent).text(s)}if(k<1&&c(g.days).is(":visible")){o.find(g.days).closest(g.blockTime).css("display","none");o.find(g.second).closest(g.blockTime).css("display",i)}else{if(k>0&&c(g.second).is(":visible")){o.find(g.days).closest(g.blockTime).css("display",i);o.find(g.second).closest(g.blockTime).css("display","none")}}o.find(g.second).text(n);o.find(g.minute).text(r);o.find(g.hours).text(t);o.find(g.days).text(k)}else{c(document).trigger("timerCanDelete",o)}}}})})(jQuery);