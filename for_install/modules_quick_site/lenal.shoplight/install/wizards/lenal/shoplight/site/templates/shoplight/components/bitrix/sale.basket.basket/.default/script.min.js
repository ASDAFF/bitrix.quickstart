BX.ready(function(){var a=BX.findChildren(BX("basket_items"),{tagName:"li",className:"sku_prop"},true);if(!!a&&a.length>0){for(i=0;a.length>i;i++){BX.bind(a[i],"click",BX.delegate(function(f){e(f)},this))}}function e(n){if(!n){n=window.event}var m=BX.proxy_context;if(!!m&&m.hasAttribute("data-value-id")){BX.showWait();var f=m.getAttribute("data-element"),l=m.getAttribute("data-property"),h={};h[l]=m.getAttribute("data-value-id");if(BX.hasClass(m,"bx_active")){BX.closeWait();return}var k=BX.findChildren(BX(f),{tagName:"ul",className:"sku_prop_list"},true);if(!!k&&k.length>0){for(i=0;k.length>i;i++){if(k[i].id=="prop_"+l+"_"+f){continue}else{var g=BX.findChildren(BX(k[i].id),{tagName:"li",className:"bx_active"},true);if(!!g&&g.length>0){for(i=0;g.length>i;i++){if(g[i].hasAttribute("data-value-id")){h[g[i].getAttribute("data-property")]=g[i].getAttribute("data-value-id")}}}}}}postData={action:"basket_item_select",basketItemId:f,sessid:BX.bitrix_sessid(),props:h,select_props:BX("column_headers").value,offers_props:BX("offers_props").value,QUANTITY_FLOAT:BX("QUANTITY_FLOAT").value,COUNT_DISCOUNT_4_ALL_QUANTITY:BX("COUNT_DISCOUNT_4_ALL_QUANTITY").value,PRICE_VAT_SHOW_VALUE:BX("PRICE_VAT_SHOW_VALUE").value,HIDE_COUPON:BX("HIDE_COUPON").value,USE_PREPAYMENT:BX("USE_PREPAYMENT").value};BX.ajax({url:"/bitrix/components/bitrix/sale.basket.basket/ajax.php",method:"POST",data:postData,dataType:"json",onsuccess:function(o){BX.closeWait();b(f,o)}})}}function b(O,L){var B=BX("basket_items");if(!B){return}var W=B.rows,I=BX(O),S=L.BASKET_ID,v=L.BASKET_DATA["GRID"]["ROWS"][S],G=W[W.length-1],g=document.createElement("tr"),E=L.COLUMNS.split(","),F=false,M=false,f=false,p=(L.PARAMS["QUANTITY_FLOAT"]=="Y")?true:false;g.setAttribute("id",L.BASKET_ID);G.parentNode.insertBefore(g,I.nextSibling);if(L.DELETE_ORIGINAL=="Y"){I.parentNode.removeChild(I)}var R=g.insertCell(-1);R.setAttribute("class","margin");for(i=0;i<E.length;i++){if(E[i]=="DELETE"){F=true}if(E[i]=="DELAY"){M=true}if(E[i]=="PROPS"){f=true}}for(i=0;i<E.length;i++){if(E[i]=="PROPS"||E[i]=="DELAY"||E[i]=="DELETE"||E[i]=="TYPE"){continue}if(E[i]=="NAME"){var n=g.insertCell(-1),C="",P="";n.setAttribute("class","itemphoto");if(v.PREVIEW_PICTURE_SRC.length>0){C=v.PREVIEW_PICTURE_SRC}else{if(v.DETAIL_PICTURE_SRC.length>0){C=v.DETAIL_PICTURE_SRC}else{C=basketJSParams.TEMPLATE_FOLDER+"/images/no_photo.png"}}if(v.DETAIL_PAGE_URL.length>0){P='<div class="bx_ordercart_photo_container">						<a href="'+v.DETAIL_PAGE_URL+'">							<div class="bx_ordercart_photo" style="background-image:url(\''+C+"')\"></div>						</a>					</div>"}else{P='<div class="bx_ordercart_photo_container">						<div class="bx_ordercart_photo" style="background-image:url(\''+C+"')\"></div>					</div>"}if(v.BRAND&&v.BRAND.length>0){P+='<div class="bx_ordercart_brand">						<img alt="" src="'+v.BRAND+'"/>					</div>'}n.innerHTML=P;var z=g.insertCell(-1),h="";z.setAttribute("class","item");if(v.DETAIL_PAGE_URL.length>0){h+='<h2 class="bx_ordercart_itemtitle"><a href="'+v.DETAIL_PAGE_URL+'">'+v.NAME+"</a></h2>"}else{h+='<h2 class="bx_ordercart_itemtitle">'+v.NAME+"</h2>"}h+='<div class="bx_ordercart_itemart">';if(f){for(var V=0;V<v.PROPS.length;V++){var J=v.PROPS[V];if(v.SKU_DATA){bSkip=false;for(var w in v.SKU_DATA){var l=v.SKU_DATA[w];if(l.CODE==J.CODE){bSkip=true;break}}if(bSkip){continue}}h+=J.NAME+":&nbsp;<span>"+J.VALUE+"</span><br/>"}}h+="</div>";if(v.SKU_DATA){for(var w in v.SKU_DATA){var l=v.SKU_DATA[w],N=false,Y=(l.VALUES.length>5)?"full":"";for(var o in l.VALUES){var H=l.VALUES[o];if(H.PICT!==false){N=true;break}}if(N){h+='<div class="bx_item_detail_scu_small_noadaptive '+Y+'">';h+='<span class="bx_item_section_name_gray">'+l.NAME+"</span>";h+='<div class="bx_scu_scroller_container">';h+='<div class="bx_scu">';h+='<ul id="prop_'+l.CODE+"_"+v.ID+'" style="width: 200%; margin-left:0%;" class="sku_prop_list">';for(var u in l.VALUES){var y=l.VALUES[u],K="";for(var T=0;T<v.PROPS.length;T++){var s=v.PROPS[T];if(s.CODE==l.CODE){if(s.VALUE==y.NAME||s.VALUE==y.XML_ID){K="bx_active"}}}h+='<li style="width:10%;"													class="sku_prop '+K+'"													data-value-id="'+y.XML_ID+'"													data-element="'+v.ID+'"													data-property="'+l.CODE+'"													>													<a href="javascript:void(0);">														<span style="background-image:url('+y.PICT["SRC"]+')"></span>													</a>												</li>'}h+="</ul>";h+="</div>";h+='<div class="bx_slide_left" onclick="leftScroll('+l.CODE+", "+v.ID+');"></div>';h+='<div class="bx_slide_right" onclick="rightScroll('+l.CODE+", "+v.ID+');"></div>';h+="</div>";h+="</div>"}else{h+='<div class="bx_item_detail_size_small_noadaptive '+Y+'">';h+='<span class="bx_item_section_name_gray">'+l.NAME+"</span>";h+='<div class="bx_size_scroller_container">';h+='<div class="bx_size">';h+='<ul id="prop_'+l.CODE+"_"+v.ID+'" style="width: 200%; margin-left:0%;" class="sku_prop_list">';for(var u in l.VALUES){var y=l.VALUES[u],K="";for(var T=0;T<v.PROPS.length;T++){var s=v.PROPS[T];if(s.CODE==l.CODE){if(s.VALUE==y.NAME){K="bx_active"}}}h+='<li style="width:10%;"													class="sku_prop '+K+'"													data-value-id="'+y.NAME+'"													data-element="'+v.ID+'"													data-property="'+l.CODE+'"													>													<a href="javascript:void(0);">'+y.NAME+"</span></a>												</li>"}h+="</ul>";h+="</div>";h+='<div class="bx_slide_left" onclick="leftScroll('+l.CODE+", "+v.ID+');"></div>';h+='<div class="bx_slide_right" onclick="rightScroll('+l.CODE+", "+v.ID+');"></div>';h+="</div>";h+="</div>"}}}z.innerHTML=h}else{if(E[i]=="QUANTITY"){var x=g.insertCell(-1),U="",Q=(parseFloat(v.MEASURE_RATIO)>0)?v.MEASURE_RATIO:0,D=(parseFloat(v.AVAILABLE_QUANTITY)>0)?'max="'+v.AVAILABLE_QUANTITY+'"':"";x.setAttribute("class","custom");U+="<span>"+d(L,E[i])+":</span>";U+='<div class="centered">';U+='<table cellspacing="0" cellpadding="0" class="counter">';U+="<tr>";U+="<td>";U+='<input										type="text"										size="3"										id="QUANTITY_INPUT_'+v.ID+'"										name="QUANTITY_INPUT_'+v.ID+'"										size="2"										maxlength="18"										min="0"										'+D+"										step="+Q+'										style="max-width: 50px"										value="'+v.QUANTITY+'"										onchange="updateQuantity(\'QUANTITY_INPUT_'+v.ID+"','"+v.ID+"', '"+Q+"','"+p+"')\"					>";U+="</td>";if(Q!=0&&Q!=""&&!(parseInt(v.SET_PARENT_ID)>0&&v.TYPE==1)){U+='<td id="quantity_control">						<div class="quantity_control">							<a href="javascript:void(0);" class="plus" onclick="setQuantity('+v.ID+", "+Q+", 'up', "+p+');"></a>							<a href="javascript:void(0);" class="minus" onclick="setQuantity('+v.ID+", "+Q+", 'down', "+p+');"></a>						</div>					</td>'}if(v.hasOwnProperty("MEASURE_TEXT")&&v.MEASURE_TEXT.length>0){U+='<td style="text-align: left">'+v.MEASURE_TEXT+"</td>"}U+="</tr>";U+="</table>";U+="</div>";U+="<!-- quantity selector for mobile -->";U+=c("QUANTITY_SELECT_"+v.ID,"QUANTITY_SELECT_"+v.ID,v.QUANTITY,v.AVAILABLE_QUANTITY,v.MEASURE_RATIO,v.MEASURE_TEXT);U+='<input type="hidden" id="QUANTITY_'+v.ID+'" name="QUANTITY_'+v.ID+'" value="'+v.QUANTITY+'" />';x.innerHTML=U}else{if(E[i]=="PRICE"){var q=g.insertCell(-1);q.setAttribute("class","price");q.innerHTML+='<div class="current_price">'+v.PRICE_FORMATED+"</div>";if(parseFloat(v.DISCOUNT_PRICE_PERCENT)>0){q.innerHTML+='<div class="old_price">'+v.FULL_PRICE_FORMATED+"</div>"}if(v.NOTES.length>0){q.innerHTML+='<div class="type_price">'+basketJSParams.SALE_TYPE+"</div>";q.innerHTML+='<div class="type_price_value">'+v.NOTES+"</div>"}}else{if(E[i]=="DISCOUNT"){var q=g.insertCell(-1);q.setAttribute("class","custom");q.innerHTML="<span>"+d(L,E[i])+":</span>";q.innerHTML+=v.DISCOUNT_PRICE_PERCENT_FORMATED}else{if(E[i]=="WEIGHT"){var A=g.insertCell(-1);A.setAttribute("class","custom");A.innerHTML="<span>"+d(L,E[i])+":</span>";A.innerHTML+=v.WEIGHT_FORMATED}else{var m=g.insertCell(-1);m.setAttribute("class","custom");m.innerHTML="<span>"+d(L,E[i])+":</span>";m.innerHTML+=v[E[i]]}}}}}}if(F||M){var X=g.insertCell(-1);X.setAttribute("class","control");if(F){X.innerHTML='<a href="'+basketJSParams.DELETE_URL.replace("#ID#",v.ID)+'">'+basketJSParams.SALE_DELETE+"</a><br />"}if(M){X.innerHTML+='<a href="'+basketJSParams.DELAY_URL.replace("#ID#",v.ID)+'">'+basketJSParams.SALE_DELAY+"</a>"}}var t=g.insertCell(-1);t.setAttribute("class","margin");var r=BX.findChildren(BX(S),{tagName:"li",className:"sku_prop"},true);if(!!r&&r.length>0){for(i=0;r.length>i;i++){BX.bind(r[i],"click",BX.delegate(function(k){e(k)},this))}}if(BX("allWeight_FORMATED")){BX("allWeight_FORMATED").innerHTML=L.BASKET_DATA["allWeight_FORMATED"]}if(BX("allSum_wVAT_FORMATED")){BX("allSum_wVAT_FORMATED").innerHTML=L.BASKET_DATA["allSum_wVAT_FORMATED"]}if(BX("allVATSum_FORMATED")){BX("allVATSum_FORMATED").innerHTML=L.BASKET_DATA["allVATSum_FORMATED"]}if(BX("allSum_FORMATED")){BX("allSum_FORMATED").innerHTML=L.BASKET_DATA["allSum_FORMATED"]}}function d(f,g){return BX("col_"+g).innerHTML.trim()}function c(g,f,q,m,p,l){var m=parseFloat(m),p=(parseFloat(p)!=0&&!isNaN(parseFloat(p)))?parseFloat(p):1,h=(p>0&&p<1)?p:1,k=g.replace("QUANTITY_SELECT_",""),n="",o="";if(m==0){n="disabled";m=1}o='<div class="some-class">';o+='<select id="'+g+'" name="'+f+'" onchange="updateQuantity(\''+g+"', "+k+", "+p+');" '+n+">";for(j=h;j<=m;j=j+p){selected=(j==q)?"selected":"";o+="<option value="+j+" "+selected+">"+j+"</option>"}o+="</select>";if(l!==undefined){o+=l}o+="</div>";return o}});function leftScroll(d,c){var b=BX("prop_"+d+"_"+c);if(b){var a=parseInt(b.style.marginLeft);if(a<0){b.style.marginLeft=a+20+"%"}}}function rightScroll(d,c){var b=BX("prop_"+d+"_"+c);if(b){var a=parseInt(b.style.marginLeft);if(a>=0){b.style.marginLeft=a-20+"%"}}}function checkOut(){BX("basket_form").submit();return true}function updateQuantity(m,c,k,b){var l=BX(m).defaultValue,a=parseFloat(BX(m).value)||0;bValidChange=false;if(k==0||k==1){bValidChange=true}else{var d=a*10000,e=k*10000,h=d%e;if(h==0){bValidChange=true}}if(bValidChange){a=((k==0||k==1)&&!b)?parseInt(a):parseFloat(a).toFixed(2);BX(m).defaultValue=a;BX("QUANTITY_INPUT_"+c).value=a;var g,n=BX("QUANTITY_SELECT_"+c).options,f=n.length;while(f--){g=n[f];if(parseFloat(g.value).toFixed(2)==parseFloat(a).toFixed(2)){g.selected=true}}BX("QUANTITY_"+c).value=a}else{BX(m).value=l}}function setQuantity(b,e,a,f){var d=parseFloat(BX("QUANTITY_INPUT_"+b).value),c;c=(a=="up")?d+e:d-e;if(c<0){c=0}c=c.toFixed(2);BX("QUANTITY_INPUT_"+b).value=c;BX("QUANTITY_INPUT_"+b).defaultValue=c;updateQuantity("QUANTITY_INPUT_"+b,b,e,f)}function showBasketItemsList(a){BX.removeClass(BX("basket_toolbar_button"),"current");BX.removeClass(BX("basket_toolbar_button_delayed"),"current");BX.removeClass(BX("basket_toolbar_button_subscribed"),"current");BX.removeClass(BX("basket_toolbar_button_not_available"),"current");BX("normal_count").style.display="inline-block";BX("delay_count").style.display="inline-block";BX("subscribe_count").style.display="inline-block";BX("not_available_count").style.display="inline-block";if(a==2){if(BX("basket_items_list")){BX("basket_items_list").style.display="none"}if(BX("basket_items_delayed")){BX("basket_items_delayed").style.display="block";BX.addClass(BX("basket_toolbar_button_delayed"),"current");BX("delay_count").style.display="none"}if(BX("basket_items_subscribed")){BX("basket_items_subscribed").style.display="none"}if(BX("basket_items_not_available")){BX("basket_items_not_available").style.display="none"}}else{if(a==3){if(BX("basket_items_list")){BX("basket_items_list").style.display="none"}if(BX("basket_items_delayed")){BX("basket_items_delayed").style.display="none"}if(BX("basket_items_subscribed")){BX("basket_items_subscribed").style.display="block";BX.addClass(BX("basket_toolbar_button_subscribed"),"current");BX("subscribe_count").style.display="none"}if(BX("basket_items_not_available")){BX("basket_items_not_available").style.display="none"}}else{if(a==4){if(BX("basket_items_list")){BX("basket_items_list").style.display="none"}if(BX("basket_items_delayed")){BX("basket_items_delayed").style.display="none"}if(BX("basket_items_subscribed")){BX("basket_items_subscribed").style.display="none"}if(BX("basket_items_not_available")){BX("basket_items_not_available").style.display="block";BX.addClass(BX("basket_toolbar_button_not_available"),"current");BX("not_available_count").style.display="none"}}else{if(BX("basket_items_list")){BX("basket_items_list").style.display="block";BX.addClass(BX("basket_toolbar_button"),"current");BX("normal_count").style.display="none"}if(BX("basket_items_delayed")){BX("basket_items_delayed").style.display="none"}if(BX("basket_items_subscribed")){BX("basket_items_subscribed").style.display="none"}if(BX("basket_items_not_available")){BX("basket_items_not_available").style.display="none"}}}}};