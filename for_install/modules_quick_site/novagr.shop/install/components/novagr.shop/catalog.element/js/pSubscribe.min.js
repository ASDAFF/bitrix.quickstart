var pSubscribe={messages:[],init:function(messages){var self=this;self.messages=messages;var options={beforeSubmit:self.checkNotifyForm,success:function(responseText){var rs=eval("("+responseText+")");var error="";if(rs.STATUS=="N"){if(rs.ERRORS=="NOTIFY_ALREADY_SUBSCRIBED"){error=self.messages.NOTIFY_YOU_ARE_SUBSCRIBE}else{if(rs.ERRORS=="NOTIFY_ERR_LOGIN"){error=self.messages.NOTIFY_ERR_LOGIN}else{if(rs.ERRORS=="NOTIFY_ERR_MAIL"){error=self.messages.NOTIFY_ERR_MAIL}else{if(rs.ERRORS=="NOTIFY_ERR_CAPTHA"){error=self.messages.NOTIFY_ERR_CAPTHA}else{if(rs.ERRORS=="NOTIFY_ERR_MAIL_EXIST"){error=self.messages.NOTIFY_ERR_MAIL_EXIST}else{if(rs.ERRORS=="NOTIFY_ERR_REG"){error=self.messages.NOTIFY_ERR_REG}}}}}}if(error!=""){$("#notifyme-response").html(error);$("#signed").show();$("#notifyme-response").show();$("#box").hide();$("#notifyme-form").show();$("#unsubsc").hide()}else{$("#notifyme-response").html(self.messages.NOTIFY_YOU_ARE_SUBSCRIBE);$("#signed").show();$("#notifyme-response").show();$("#box").hide();$("#notifyme-form").hide();$("#notifyme-form").hide();$("#unsubsc").show()}}else{if(rs.STATUS=="Y"){$("#notifyme-response").html(self.messages.NOTIFY_YOU_ARE_SUBSCRIBE);$("#signed").show();$("#notifyme-response").show();$("#box").hide();$("#notifyme-form").hide();$("#notifyme-form").hide();$("#unsubsc").show();$("#btn_"+rs.elemId).html(self.messages.NOTIFY_SUBSCRIBED).removeClass("authNotify").removeClass("notify");$("#myModal-notify").modal("hide")}}}};$("#notifyForm").ajaxForm(options);$(".notify").live("click",function(){var elemId=$(this).data("elem-id");$("#notify_elem_id").val(elemId);$("#myModal-notify").modal("show");return false});$(".authNotify").live("click",function(){var elemId=$(this).data("elem-id");self.makeUserProductSubscribe(elemId);return false});$(".authNotifySize").live("click",function(){var elemId=$(this).data("elem-id");$("#notify_elem_id").val(elemId);$("#notify_user_mail").val(product.userEmail);$("#notifyEmail").hide();$("#myModal-notify").modal("show");return false})},makeUserProductSubscribe:function(a){$.ajax({type:"POST",url:"/local/components/novagr.shop/catalog.list/templates/.default/ajax.php",data:{elemId:a,action:"productSubsribe"},dataType:"JSON",success:function(b){if(b.result=="OK"){$("#btn_"+b.elemId).html(pSubscribe.messages.NOTIFY_SUBSCRIBED).removeClass("authNotify").removeClass("authNotifySize")}}})},CheckEmail:function(b){var a=/^[0-9\.a-z_\-]+@[0-9a-z_\-^\.]+\.[a-z]{2,6}$/i;if(b!=""){if(!a.test(b)){return false}}return true},checkNotifyForm:function(){var b="";var a=Array();var c=document.getElementById("notify_user_mail");if(c.value==""){a.push(pSubscribe.messages.NOTIFY_EMAIL_WRING1)}else{if(!pSubscribe.CheckEmail(c.value)){a.push(pSubscribe.messages.NOTIFY_EMAIL_WRING2)}}var d=a.join("\n");if(d!=""){alert(d);return false}}};