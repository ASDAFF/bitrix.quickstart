var RSGoPro_tamautID=0,RSGoPro_timeoutDelay=1200,RSGoPro_inputter,RSGoPro_modef_delay_hide=4000,RSGoPro_modef_posFix=0;var RSGoPro_filtren,RSGoPro_offsetTopFilter=0,RSGoPro_offsetTopFilterH=0,RSGoPro_content,RSGoPro_offsetTopContent=0,RSGoPro_offsetTopContentH=0;function RSGoPro_priceGoupClick(){if($(".filtren").hasClass("ajaxfilter")){RSGoPro_FilterAjax()}}function RSGoPro_SeachProp(c){var b=c.val();var a=c.parents(".lvl1");if(b.length<1){a.find(".lvl2").css("display","block")}else{a.find(".lvl2").each(function(){var d=$(this).find("label").html().substr(0,b.length);if(b.toLowerCase()==d.toLowerCase()){$(this).css("display","block")}else{$(this).css("display","none")}})}if(c.parents(".lvl1").hasClass("scrolable")){RSGoPro_FilterJScrollPaneReinitialize()}}function RSGoPro_FilterSetPropHide(){if($.cookie(BX_COOKIE_PREFIX+"RSGOPRO_SMARTFILTER_SHOW_ALL")=="Y"){$(".filtren").addClass("opened")}var a="";$(".filtren").find("li.lvl1").removeClass("closed");$(".filtren").find("li.lvl1").each(function(b){a=$(this).data("propcode");if($.cookie(BX_COOKIE_PREFIX+"RSGOPRO_SMARTFILTER_HIDE_"+a)=="Y"){$(this).addClass("closed")}})}function RSGoPro_FilterJScrollPaneReinitialize(){var a;$(".f_jscrollpane").each(function(b){a=$(this).data("jsp");a.reinitialise()})}function RSGoPro_BeforeSend(a){if(a=="disable"){$(".filtren").find(".min, .max").each(function(b){if(parseFloat($(this).data("startvalue"))==parseFloat($(this).val().replace(/[,]/g,".").replace(/[ ]+/g,""))){$(this).attr("disabled","disabled")}})}else{$(".filtren").find(".min, .max").removeAttr("disabled")}}function RSGoPro_ReplaceProbel(){$(".filtren").find(".min, .max").each(function(a){$(this).val($(this).val().replace(/[ ]+/g,""))})}function RSGoPro_ReturnProbel(){$(".filtren").find(".min, .max").each(function(a){$(this).val(RSDevFunc_NumberFormat($(this).val()))})}function RSGoPro_FixedFilterWinScroll(){if(RSGoPro_filtren&&RSGoPro_filtren.length>0){RSGoPro_offsetTopFilterH=RSGoPro_offsetTopFilter+RSGoPro_filtren.outerHeight(true);RSGoPro_offsetTopContentH=RSGoPro_content.offset().top+RSGoPro_content.outerHeight(true);if(window.pageYOffset>RSGoPro_offsetTopFilter){RSGoPro_filtren.addClass("fixed")}else{RSGoPro_filtren.removeClass("fixed")}if(window.pageYOffset+RSGoPro_filtren.outerHeight(true)>RSGoPro_content.offset().top+RSGoPro_content.outerHeight(true)){RSGoPro_filtren.addClass("stop").css("top",(RSGoPro_offsetTopContentH-RSGoPro_offsetTopFilterH)+"px")}else{RSGoPro_filtren.removeClass("stop").css("top","0px")}}}function RSGoPro_FixedFilter(){if(RSGoPro_filtren&&RSGoPro_filtren.length>0){RSGoPro_offsetTopFilter=RSGoPro_filtren.offset().top;RSGoPro_offsetTopFilterH=RSGoPro_offsetTopFilter+RSGoPro_filtren.outerHeight(true);RSGoPro_offsetTopContent=RSGoPro_content.offset().top;RSGoPro_offsetTopContentH=RSGoPro_offsetTopContent+RSGoPro_content.outerHeight(true);window.onscroll=RSGoPro_FixedFilterWinScroll}}function RSGoPro_FilterAjax(){clearTimeout(RSGoPro_tamautID);RSGoPro_tamautID=setTimeout(function(){RSGoPro_Area2Darken($("#catalog"),"animashka");RSGoPro_ReplaceProbel();RSGoPro_BeforeSend("disable");var c=$("form.smartfilter");var b=c.serialize(),a=c.attr("action");if(a.indexOf("?")<1){a=a+"?"+b+"&AJAX_CALL=Y&get=catalog&set_filter=Y"}else{a=a+"&"+b+"&AJAX_CALL=Y&get=catalog&set_filter=Y"}BX.ajax({url:a,method:"GET",dataType:"html",scriptsRunFirst:false,emulateOnload:false,start:true,cache:false,onsuccess:function(d){$("#catalog").html(d);RSGoPro_ScrollInit(".prices_jscrollpane");RSGoPro_Area2Darken($("#catalog"));RSGoPro_FilterOnDocumentReady()},onfailure:function(){RSGoPro_Area2Darken($("#catalog"));RSGoPro_FilterOnDocumentReady();console.warn("FILTER -> ajax load failed")}})},RSGoPro_timeoutDelay)}function RSGoPro_FilterOnDocumentReady(){RSGoPro_FilterSetPropHide();$(document).on("click",".filtren .title a.shhi",function(){if($(".filtren").hasClass("opened")){$.removeCookie(BX_COOKIE_PREFIX+"RSGOPRO_SMARTFILTER_SHOW_ALL");$(".filtren").removeClass("opened")}else{$.cookie(BX_COOKIE_PREFIX+"RSGOPRO_SMARTFILTER_SHOW_ALL","Y","/");$(".filtren").addClass("opened")}RSGoPro_FilterJScrollPaneReinitialize();RSGoPro_FixedFilterWinScroll();return false});$(document).on("click",".filtren .showchild",function(){var b=$(this).parents("li.lvl1");var a=b.data("propcode");if(b.hasClass("closed")){$.removeCookie(BX_COOKIE_PREFIX+"RSGOPRO_SMARTFILTER_HIDE_"+a);b.removeClass("closed")}else{$.cookie(BX_COOKIE_PREFIX+"RSGOPRO_SMARTFILTER_HIDE_"+a,"Y","/");b.addClass("closed")}RSGoPro_FilterJScrollPaneReinitialize();RSGoPro_FixedFilterWinScroll();return false});$(document).on("click",".lvl2_disabled input, .lvl2_disabled label",function(a){a.stopPropagation();return false});setTimeout(function(){RSGoPro_ReplaceProbel();var a;$(".filtren").find(".min, .max").on("keyup",function(b){clearTimeout(a);if(b.which!=8&&b.which!=37&&b.which!=39&&b.which!=191&&b.which!=190&&b.which!=188){var c=$(this);a=setTimeout(function(){$(this).val(RSDevFunc_NumberFormat(c.val()));smartFilter.keyup(BX(c.attr("id")))},1500)}}).each(function(){$(this).val(RSDevFunc_NumberFormat($(this).val()))})},25);$(".f_jscrollpane").jScrollPane();RSGoPro_FilterJScrollPaneReinitialize();$(window).resize(function(){RSGoPro_FilterJScrollPaneReinitialize()});$(document).on("keyup",".f_search",function(){var a=$(this);RSGoPro_SeachProp(a)});$(document).on("click",".filtren .buttons .set_filter, .filtren .buttons .del_filter",function(){RSGoPro_BeforeSend("disable");RSGoPro_ReplaceProbel();if($(this).hasClass("set_filter")){$("#set_filter").click()}else{$("#del_filter").click()}return false});$(document).on("click","#modef a",function(){RSGoPro_BeforeSend("disable");RSGoPro_ReplaceProbel();$("#set_filter").click();return false});if(!RSDevFunc_PHONETABLET){RSGoPro_filtren=$(".filtren.filterfixed"),RSGoPro_offsetTopFilter=0,RSGoPro_offsetTopFilterH=0,RSGoPro_content=$(".content"),RSGoPro_offsetTopContent=0,RSGoPro_offsetTopContentH=0;RSGoPro_FixedFilter()}}function RSGoPro_FilterOnSubmitForm(){RSGoPro_ReplaceProbel();RSGoPro_BeforeSend("disable");return true}function JCSmartFilter(a){this.ajaxURL=a;this.form=null;this.timer=null}JCSmartFilter.prototype.keyup=function(a){if($(".filtren").hasClass("ajaxfilter")){RSGoPro_FilterAjax()}else{if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.delegate(function(){this.reload(a)},this),RSGoPro_timeoutDelay)}};JCSmartFilter.prototype.click=function(a){if($(".filtren").hasClass("ajaxfilter")){RSGoPro_FilterAjax()}else{if($(a).is(":checked")){$(".filtren").find('label[for="'+$(a).attr("id")+'"]').addClass("checked")}else{$(".filtren").find('label[for="'+$(a).attr("id")+'"]').removeClass("checked")}if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.delegate(function(){this.reload(a)},this),RSGoPro_timeoutDelay)}};JCSmartFilter.prototype.reload=function(b){if(!RSDevFunc_PHONETABLET){RSGoPro_inputter=b;var c=BX.pos(BX.findParent(b,{tag:"ul"}),true);RSGoPro_Area2Darken($(b).closest(".filtren"),"animashka",{progressTop:c.top+c.height/2});this.position=BX.pos(b,true);this.form=BX.findParent(b,{tag:"form"});if(this.form){RSGoPro_ReplaceProbel();RSGoPro_BeforeSend("disable");var a=new Array;a[0]={name:"ajax",value:"y"};this.gatherInputsValues(a,BX.findChildren(this.form,{tag:"input"},true));BX.ajax.loadJSON(this.ajaxURL,this.values2post(a),BX.delegate(this.postHandler,this));RSGoPro_ReturnProbel();RSGoPro_BeforeSend()}}};JCSmartFilter.prototype.postHandler=function(m){clearInterval(RSGoPro_tamautID);RSGoPro_Area2Darken($(".filtren"));if(m.ITEMS){for(var a in m.ITEMS){var f=m.ITEMS[a];if(f.PROPERTY_TYPE=="N"||f.PRICE){}else{if(f.VALUES){for(var k in f.VALUES){var g=f.VALUES[k];var j=BX(g.CONTROL_ID);if(j){j.parentNode.className=g.DISABLED?"lvl2 lvl2_disabled":"lvl2"}}}}}var l=BX("modef");var h=BX("modef_num");if(l&&h){h.innerHTML=m.ELEMENT_COUNT;var e=BX.findChildren(l,{tag:"A"},true);if(m.FILTER_URL&&e){e[0].href=BX.util.htmlspecialcharsback(m.FILTER_URL)}if(m.FILTER_AJAX_URL&&m.COMPONENT_CONTAINER_ID){BX.bind(e[0],"click",function(n){var i=BX.util.htmlspecialcharsback(m.FILTER_AJAX_URL);BX.ajax.insertToNode(i,m.COMPONENT_CONTAINER_ID);return BX.PreventDefault(n)})}if(m.INSTANT_RELOAD&&m.COMPONENT_CONTAINER_ID){var c=BX.util.htmlspecialcharsback(m.FILTER_AJAX_URL);BX.ajax.insertToNode(c,m.COMPONENT_CONTAINER_ID)}else{if(l.style.display=="none"){l.style.display="block"}var b=this.position.top;if($(RSGoPro_inputter).hasClass("min")||$(RSGoPro_inputter).hasClass("max")){b=b+RSGoPro_modef_posFix+1}else{if($(RSGoPro_inputter).parents(".f_jscrollpane").length>0){var d=$(RSGoPro_inputter).parents(".f_jscrollpane").attr("id");b=b+RSGoPro_modef_posFix+BX(d).offsetTop-$("#"+d).data("jsp").getContentPositionY()}else{b=b+RSGoPro_modef_posFix}}l.style.top=b+"px"}RSGoPro_tamautID=setInterval(function(){l.style.display="none";clearInterval(RSGoPro_tamautID)},RSGoPro_modef_delay_hide)}}};JCSmartFilter.prototype.gatherInputsValues=function(a,e){if(e){for(var c=0;c<e.length;c++){var d=e[c];if(d.disabled||!d.type){continue}switch(d.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":case"select-one":if(d.value.length){a[a.length]={name:d.name,value:d.value}}break;case"radio":case"checkbox":if(d.checked){a[a.length]={name:d.name,value:d.value}}break;case"select-multiple":for(var b=0;b<d.options.length;b++){if(d.options[b].selected){a[a.length]={name:d.name,value:d.options[b].value}}}break;default:break}}}};JCSmartFilter.prototype.values2post=function(b){var e=new Array;var h=e;var d=0;while(d<b.length){var g=b[d].name.indexOf("[");if(g==-1){h[b[d].name]=b[d].value;h=e;d++}else{var c=b[d].name.substring(0,g);var f=b[d].name.substring(g+1);if(!h[c]){h[c]=new Array}var a=f.indexOf("]");if(a==-1){h=e;d++}else{if(a==0){h=h[c];b[d].name=""+h.length}else{h=h[c];b[d].name=f.substring(0,a)+f.substring(a+1)}}}}return e};$(document).ready(function(){RSGoPro_FilterOnDocumentReady()});