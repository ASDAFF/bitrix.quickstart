(function(window){if(!!window.BX&&!!window.BX.extend){return}window.BXDEBUG=false;var _bxtmp;if(!!window.BX){_bxtmp=window.BX}window.BX=function(node,bCache){if(BX.type.isNotEmptyString(node)){var ob;if(!!bCache&&null!=NODECACHE[node]){ob=NODECACHE[node]}ob=ob||document.getElementById(node);if(!!bCache){NODECACHE[node]=ob}return ob}else{if(BX.type.isDomNode(node)){return node}else{if(BX.type.isFunction(node)){return BX.ready(node)}}}return null};BX.message=function(mess){if(BX.type.isString(mess)){if(typeof BX.message[mess]=="undefined"){BX.onCustomEvent("onBXMessageNotFound",[mess]);if(typeof BX.message[mess]=="undefined"){BX.debug("message undefined: "+mess);BX.message[mess]=""}}return BX.message[mess]}else{for(var i in mess){if(mess.hasOwnProperty(i)){BX.message[i]=mess[i]}}return true}};if(!!_bxtmp){for(var i in _bxtmp){if(_bxtmp.hasOwnProperty(i)){if(!BX[i]){BX[i]=_bxtmp[i]}else{if(i=="message"){for(var j in _bxtmp[i]){if(_bxtmp[i].hasOwnProperty(j)){BX.message[j]=_bxtmp[i][j]}}}}}}_bxtmp=null}var __readyHandler=null,readyBound=false,readyList=[],proxySalt=Math.random(),proxyId=1,proxyList=[],deferList=[],NODECACHE={},deniedEvents=[],eventsList=[],customEvents={},garbageCollectors=[],cssList=[],cssInit=false,jsList=[],jsInit=false,bSafari=navigator.userAgent.toLowerCase().indexOf("webkit")!=-1,bOpera=navigator.userAgent.toLowerCase().indexOf("opera")!=-1,bFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")!=-1,bChrome=navigator.userAgent.toLowerCase().indexOf("chrome")!=-1,bIE=document.attachEvent&&!bOpera,r={script:/<script([^>]*)>/i,script_src:/src=["\']([^"\']+)["\']/i,space:/\s+/,ltrim:/^[\s\r\n]+/g,rtrim:/[\s\r\n]+$/g,style:/<link.*?(rel="stylesheet"|type="text\/css")[^>]*>/i,style_href:/href=["\']([^"\']+)["\']/i},eventTypes={click:"MouseEvent",dblclick:"MouseEvent",mousedown:"MouseEvent",mousemove:"MouseEvent",mouseout:"MouseEvent",mouseover:"MouseEvent",mouseup:"MouseEvent",focus:"MouseEvent",blur:"MouseEvent"},lastWait=[],CHECK_FORM_ELEMENTS={tagName:/^INPUT|SELECT|TEXTAREA|BUTTON$/i};BX.MSLEFT=1;BX.MSMIDDLE=2;BX.MSRIGHT=4;BX.ext=function(ob){for(var i in ob){if(ob.hasOwnProperty(i)){this[i]=ob[i]}}};BX.extend=function(child,parent){var f=function(){};f.prototype=parent.prototype;child.prototype=new f();child.prototype.constructor=child;child.superclass=parent.prototype;if(parent.prototype.constructor==Object.prototype.constructor){parent.prototype.constructor=parent}};BX.namespace=function(namespace){var parts=namespace.split(".");var parent=BX;if(parts[0]==="BX"){parts=parts.slice(1)}for(var i=0;i<parts.length;i++){if(typeof parent[parts[i]]==="undefined"){parent[parts[i]]={}}parent=parent[parts[i]]}return parent};BX.debug=function(){if(window.BXDEBUG){if(window.console&&window.console.log){window.console.log("BX.debug: ",arguments.length>0?arguments:arguments[0])}if(window.console&&window.console.trace){console.trace()}}};BX.is_subclass_of=function(ob,parent_class){if(ob instanceof parent_class){return true}if(parent_class.superclass){return BX.is_subclass_of(ob,parent_class.superclass)}return false};BX.clearNodeCache=function(){NODECACHE={};return false};BX.bitrix_sessid=function(){return BX.message("bitrix_sessid")};BX.create=function(tag,data,context){context=context||document;if(null==data&&typeof tag=="object"&&tag.constructor!==String){data=tag;tag=tag.tag}var elem;if(BX.browser.IsIE()&&!BX.browser.IsIE9()&&null!=data&&null!=data.props&&(data.props.name||data.props.id)){elem=context.createElement("<"+tag+(data.props.name?' name="'+data.props.name+'"':"")+(data.props.id?' id="'+data.props.id+'"':"")+">")}else{elem=context.createElement(tag)}return data?BX.adjust(elem,data):elem};BX.adjust=function(elem,data){var j,len;if(!elem.nodeType){return null}if(elem.nodeType==9){elem=elem.body}if(data.attrs){for(j in data.attrs){if(data.attrs.hasOwnProperty(j)){if(j=="class"||j=="className"){elem.className=data.attrs[j]}else{if(j=="for"){elem.htmlFor=data.attrs[j]}else{if(data.attrs[j]==""){elem.removeAttribute(j)}else{elem.setAttribute(j,data.attrs[j])}}}}}}if(data.style){for(j in data.style){if(data.style.hasOwnProperty(j)){elem.style[j]=data.style[j]}}}if(data.props){for(j in data.props){if(data.props.hasOwnProperty(j)){elem[j]=data.props[j]}}}if(data.events){for(j in data.events){if(data.events.hasOwnProperty(j)){BX.bind(elem,j,data.events[j])}}}if(data.children&&data.children.length>0){for(j=0,len=data.children.length;j<len;j++){if(BX.type.isNotEmptyString(data.children[j])){elem.innerHTML+=data.children[j]}else{if(BX.type.isElementNode(data.children[j])){elem.appendChild(data.children[j])}}}}else{if(data.text){BX.cleanNode(elem);elem.appendChild((elem.ownerDocument||document).createTextNode(data.text))}else{if(data.html){elem.innerHTML=data.html}}}return elem};BX.remove=function(ob){if(ob&&null!=ob.parentNode){ob.parentNode.removeChild(ob)}ob=null;return null};BX.cleanNode=function(node,bSuicide){node=BX(node);bSuicide=!!bSuicide;if(node&&node.childNodes){while(node.childNodes.length>0){node.removeChild(node.firstChild)}}if(node&&bSuicide){node=BX.remove(node)}return node};BX.addClass=function(ob,value){var classNames;ob=BX(ob);value=BX.util.trim(value);if(value==""){return ob}if(ob){if(!ob.className){ob.className=value}else{if(!!ob.classList&&value.indexOf(" ")<0){ob.classList.add(value)}else{classNames=(value||"").split(r.space);var className=" "+ob.className+" ";for(var j=0,cl=classNames.length;j<cl;j++){if(className.indexOf(" "+classNames[j]+" ")<0){ob.className+=" "+classNames[j]}}}}}return ob};BX.removeClass=function(ob,value){ob=BX(ob);if(ob){if(ob.className&&!!value){if(BX.type.isString(value)){if(!!ob.classList&&value.indexOf(" ")<0){ob.classList.remove(value)}else{var classNames=value.split(r.space),className=" "+ob.className+" ";for(var j=0,cl=classNames.length;j<cl;j++){className=className.replace(" "+classNames[j]+" "," ")}ob.className=BX.util.trim(className)}}else{ob.className=""}}}return ob};BX.toggleClass=function(ob,value){var className;if(BX.type.isArray(value)){className=" "+ob.className+" ";for(var j=0,len=value.length;j<len;j++){if(BX.hasClass(ob,value[j])){className=(" "+className+" ").replace(" "+value[j]+" "," ");className+=" "+value[j>=len-1?0:j+1];j--;break}}if(j==len){ob.className+=" "+value[0]}else{ob.className=className}ob.className=BX.util.trim(ob.className)}else{if(BX.type.isNotEmptyString(value)){if(!!ob.classList){ob.classList.toggle(value)}else{className=ob.className;if(BX.hasClass(ob,value)){className=(" "+className+" ").replace(" "+value+" "," ")}else{className+=" "+value}ob.className=BX.util.trim(className)}}}return ob};BX.hasClass=function(el,className){if(!el||!BX.type.isDomNode(el)){BX.debug(el);return false}if(!el.className||!className){return false}if(!!el.classList&&!!className&&className.indexOf(" ")<0){return el.classList.contains(BX.util.trim(className))}else{return((" "+el.className+" ").indexOf(" "+className+" "))>=0}};BX.setOpacity=function(ob,percentage){if(ob.style.filter!=null){ob.style.zoom="100%";if(percentage==100){ob.style.filter=""}else{ob.style.filter="alpha(opacity="+percentage.toString()+")"}}else{if(ob.style.opacity!=null){ob.style.opacity=(percentage/100).toString()}else{if(ob.style.MozOpacity!=null){ob.style.MozOpacity=(percentage/100).toString()}}}};BX.hoverEvents=function(el){if(el){return BX.adjust(el,{events:BX.hoverEvents()})}else{return{mouseover:BX.hoverEventsHover,mouseout:BX.hoverEventsHout}}};BX.hoverEventsHover=function(){BX.addClass(this,"bx-hover");this.BXHOVER=true};BX.hoverEventsHout=function(){BX.removeClass(this,"bx-hover");this.BXHOVER=false};BX.focusEvents=function(el){if(el){return BX.adjust(el,{events:BX.focusEvents()})}else{return{mouseover:BX.focusEventsFocus,mouseout:BX.focusEventsBlur}}};BX.focusEventsFocus=function(){BX.addClass(this,"bx-focus");this.BXFOCUS=true};BX.focusEventsBlur=function(){BX.removeClass(this,"bx-focus");this.BXFOCUS=false};BX.setUnselectable=function(node){BX.addClass(node,"bx-unselectable");node.setAttribute("unSelectable","on")};BX.setSelectable=function(node){BX.removeClass(node,"bx-unselectable");node.removeAttribute("unSelectable")};BX.styleIEPropertyName=function(name){if(name=="float"){name=BX.browser.IsIE()?"styleFloat":"cssFloat"}else{var res=BX.browser.isPropertySupported(name);if(res){name=res}else{var reg=/(\-([a-z]){1})/g;if(reg.test(name)){name=name.replace(reg,function(){return arguments[2].toUpperCase()})}}}return name};BX.style=function(el,property,value){if(!BX.type.isElementNode(el)){return null}if(value==null){var res;if(el.currentStyle){res=el.currentStyle[BX.styleIEPropertyName(property)]}else{if(window.getComputedStyle){var q=BX.browser.isPropertySupported(property,true);if(!!q){property=q}res=BX.GetContext(el).getComputedStyle(el,null).getPropertyValue(property)}}if(!res){res=""}return res}else{el.style[BX.styleIEPropertyName(property)]=value;return el}};BX.focus=function(el){try{el.focus();return true}catch(e){return false}};BX.firstChild=function(el){var e=el.firstChild;while(e&&!BX.type.isElementNode(e)){e=e.nextSibling}return e};BX.lastChild=function(el){var e=el.lastChild;while(e&&!BX.type.isElementNode(e)){e=e.previousSibling}return e};BX.previousSibling=function(el){var e=el.previousSibling;while(e&&!BX.type.isElementNode(e)){e=e.previousSibling}return e};BX.nextSibling=function(el){var e=el.nextSibling;while(e&&!BX.type.isElementNode(e)){e=e.nextSibling}return e};BX.findChildren=function(obj,params,recursive){return BX.findChild(obj,params,recursive,true)};BX.findChild=function(obj,params,recursive,get_all){if(!obj||!obj.childNodes){return null}recursive=!!recursive;get_all=!!get_all;var n=obj.childNodes.length,result=[];for(var j=0;j<n;j++){var child=obj.childNodes[j];if(_checkNode(child,params)){if(get_all){result.push(child)}else{return child}}if(recursive==true){var res=BX.findChild(child,params,recursive,get_all);if(res){if(get_all){result=BX.util.array_merge(result,res)}else{return res}}}}if(get_all||result.length>0){return result}else{return null}};BX.findParent=function(obj,params,maxParent){if(!obj){return null}var o=obj;while(o.parentNode){var parent=o.parentNode;if(_checkNode(parent,params)){return parent}o=parent;if(!!maxParent&&(BX.type.isFunction(maxParent)||typeof maxParent=="object")){if(BX.type.isElementNode(maxParent)){if(o==maxParent){break}}else{if(_checkNode(o,maxParent)){break}}}}return null};BX.findNextSibling=function(obj,params){if(!obj){return null}var o=obj;while(o.nextSibling){var sibling=o.nextSibling;if(_checkNode(sibling,params)){return sibling}o=sibling}return null};BX.findPreviousSibling=function(obj,params){if(!obj){return null}var o=obj;while(o.previousSibling){var sibling=o.previousSibling;if(_checkNode(sibling,params)){return sibling}o=sibling}return null};BX.findFormElements=function(form){if(BX.type.isString(form)){form=document.forms[form]||BX(form)}var res=[];if(BX.type.isElementNode(form)){if(form.tagName.toUpperCase()=="FORM"){res=form.elements}else{res=BX.findChildren(form,CHECK_FORM_ELEMENTS,true)}}return res};BX.clone=function(obj,bCopyObj){var _obj,i,l;if(bCopyObj!==false){bCopyObj=true}if(obj===null){return null}if(BX.type.isDomNode(obj)){_obj=obj.cloneNode(bCopyObj)}else{if(typeof obj=="object"){if(BX.type.isArray(obj)){_obj=[];for(i=0,l=obj.length;i<l;i++){if(typeof obj[i]=="object"&&bCopyObj){_obj[i]=BX.clone(obj[i],bCopyObj)}else{_obj[i]=obj[i]}}}else{_obj={};if(obj.constructor){if(obj.constructor===Date){_obj=new Date(obj)}else{_obj=new obj.constructor()}}for(i in obj){if(typeof obj[i]=="object"&&bCopyObj){_obj[i]=BX.clone(obj[i],bCopyObj)}else{_obj[i]=obj[i]}}}}else{_obj=obj}}return _obj};BX.bind=function(el,evname,func){if(!el){return}if(evname==="mousewheel"){BX.bind(el,"DOMMouseScroll",func)}else{if(evname==="transitionend"){BX.bind(el,"webkitTransitionEnd",func);BX.bind(el,"msTransitionEnd",func);BX.bind(el,"oTransitionEnd",func)}else{if(evname==="bxchange"){BX.bind(el,"change",func);BX.bind(el,"cut",func);BX.bind(el,"paste",func);BX.bind(el,"drop",func);BX.bind(el,"keyup",func);return}}}if(el.addEventListener){el.addEventListener(evname,func,false)}else{if(el.attachEvent){el.attachEvent("on"+evname,BX.proxy(func,el))}else{el["on"+evname]=func}}eventsList[eventsList.length]={element:el,event:evname,fn:func}};BX.unbind=function(el,evname,func){if(!el){return}if(evname==="mousewheel"){BX.unbind(el,"DOMMouseScroll",func)}else{if(evname==="transitionend"){BX.unbind(el,"webkitTransitionEnd",func);BX.unbind(el,"msTransitionEnd",func);BX.unbind(el,"oTransitionEnd",func)}else{if(evname==="bxchange"){BX.unbind(el,"change",func);BX.unbind(el,"cut",func);BX.unbind(el,"paste",func);BX.unbind(el,"drop",func);BX.unbind(el,"keyup",func);return}}}if(el.removeEventListener){el.removeEventListener(evname,func,false)}else{if(el.detachEvent){el.detachEvent("on"+evname,BX.proxy(func,el))}else{el["on"+evname]=null}}};BX.getEventButton=function(e){e=e||window.event;var flags=0;if(typeof e.which!="undefined"){switch(e.which){case 1:flags=flags|BX.MSLEFT;break;case 2:flags=flags|BX.MSMIDDLE;break;case 3:flags=flags|BX.MSRIGHT;break}}else{if(typeof e.button!="undefined"){flags=event.button}}return flags||BX.MSLEFT};BX.unbindAll=function(el){if(!el){return}for(var i=0,len=eventsList.length;i<len;i++){try{if(eventsList[i]&&(null==el||el==eventsList[i].element)){BX.unbind(eventsList[i].element,eventsList[i].event,eventsList[i].fn);eventsList[i]=null}}catch(e){}}if(null==el){eventsList=[]}};var captured_events=null,_bind=null;BX.CaptureEvents=function(el_c,evname_c){if(_bind){return false}_bind=BX.bind;captured_events=[];BX.bind=function(el,evname,func){if(el===el_c&&evname===evname_c){captured_events.push(func)}_bind.apply(this,arguments)}};BX.CaptureEventsGet=function(){if(_bind){BX.bind=_bind;var captured=captured_events;_bind=null;captured_events=null;return captured}};BX.fireEvent=function(ob,ev){var result=false,e=null;if(BX.type.isDomNode(ob)){result=true;if(document.createEventObject){if(eventTypes[ev]!="MouseEvent"){e=document.createEventObject();e.type=ev;result=ob.fireEvent("on"+ev,e)}if(ob[ev]){ob[ev]()}}else{e=null;switch(eventTypes[ev]){case"MouseEvent":e=document.createEvent("MouseEvent");e.initMouseEvent(ev,true,true,top,1,0,0,0,0,0,0,0,0,0,null);break;default:e=document.createEvent("Event");e.initEvent(ev,true,true)}result=ob.dispatchEvent(e)}}return result};BX.getWheelData=function(e){e=e||window.event;e.wheelData=e.detail?e.detail*-1:e.wheelDelta/40;return e.wheelData};BX.proxy_context=null;BX.delegate=function(func,thisObject){if(!func||!thisObject){return func}return function(){var cur=BX.proxy_context;BX.proxy_context=this;var res=func.apply(thisObject,arguments);BX.proxy_context=cur;return res}};BX.delegateLater=function(func_name,thisObject,contextObject){return function(){if(thisObject[func_name]){var cur=BX.proxy_context;BX.proxy_context=this;var res=thisObject[func_name].apply(contextObject||thisObject,arguments);BX.proxy_context=cur;return res}}};BX._initObjectProxy=function(thisObject){if(typeof thisObject["__proxy_id_"+proxySalt]=="undefined"){thisObject["__proxy_id_"+proxySalt]=proxyList.length;proxyList[thisObject["__proxy_id_"+proxySalt]]={}}};BX.proxy=function(func,thisObject){if(!func||!thisObject){return func}BX._initObjectProxy(thisObject);if(typeof func["__proxy_id_"+proxySalt]=="undefined"){func["__proxy_id_"+proxySalt]=proxyId++}if(!proxyList[thisObject["__proxy_id_"+proxySalt]][func["__proxy_id_"+proxySalt]]){proxyList[thisObject["__proxy_id_"+proxySalt]][func["__proxy_id_"+proxySalt]]=BX.delegate(func,thisObject)}return proxyList[thisObject["__proxy_id_"+proxySalt]][func["__proxy_id_"+proxySalt]]};BX.defer=function(func,thisObject){if(!!thisObject){return BX.defer_proxy(func,thisObject)}else{return function(){var arg=arguments;setTimeout(function(){func.apply(this,arg)},10)}}};BX.defer_proxy=function(func,thisObject){if(!func||!thisObject){return func}var f=BX.proxy(func,thisObject);this._initObjectProxy(thisObject);if(typeof func["__defer_id_"+proxySalt]=="undefined"){func["__defer_id_"+proxySalt]=proxyId++}if(!proxyList[thisObject["__proxy_id_"+proxySalt]][func["__defer_id_"+proxySalt]]){proxyList[thisObject["__proxy_id_"+proxySalt]][func["__defer_id_"+proxySalt]]=BX.defer(BX.delegate(func,thisObject))}return proxyList[thisObject["__proxy_id_"+proxySalt]][func["__defer_id_"+proxySalt]]};BX.bindDelegate=function(elem,eventName,isTarget,handler){var h=BX.delegateEvent(isTarget,handler);BX.bind(elem,eventName,h);return h};BX.delegateEvent=function(isTarget,handler){return function(e){e=e||window.event;var target=e.target||e.srcElement;while(target!=this){if(_checkNode(target,isTarget)){return handler.call(target,e)}if(target&&target.parentNode){target=target.parentNode}else{break}}}};BX.False=function(){return false};BX.DoNothing=function(){};BX.denyEvent=function(el,ev){deniedEvents.push([el,ev,el["on"+ev]]);el["on"+ev]=BX.DoNothing};BX.allowEvent=function(el,ev){for(var i=0,len=deniedEvents.length;i<len;i++){if(deniedEvents[i][0]==el&&deniedEvents[i][1]==ev){el["on"+ev]=deniedEvents[i][2];BX.util.deleteFromArray(deniedEvents,i);return}}};BX.fixEventPageXY=function(event){BX.fixEventPageX(event);BX.fixEventPageY(event);return event};BX.fixEventPageX=function(event){if(event.pageX==null&&event.clientX!=null){event.pageX=event.clientX+(document.documentElement&&document.documentElement.scrollLeft||document.body&&document.body.scrollLeft||0)-(document.documentElement.clientLeft||0)}return event};BX.fixEventPageY=function(event){if(event.pageY==null&&event.clientY!=null){event.pageY=event.clientY+(document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0)-(document.documentElement.clientTop||0)}return event};BX.PreventDefault=function(e){if(!e){e=window.event}if(e.stopPropagation){e.preventDefault();e.stopPropagation()}else{e.cancelBubble=true;e.returnValue=false}return false};BX.eventReturnFalse=function(e){e=e||window.event;if(e&&e.preventDefault){e.preventDefault()}else{e.returnValue=false}return false};BX.eventCancelBubble=function(e){e=e||window.event;if(e&&e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}};BX.addCustomEvent=function(eventObject,eventName,eventHandler){if(BX.type.isString(eventObject)){eventHandler=eventName;eventName=eventObject;eventObject=window}eventName=eventName.toUpperCase();if(!customEvents[eventName]){customEvents[eventName]=[]}customEvents[eventName].push({handler:eventHandler,obj:eventObject})};BX.removeCustomEvent=function(eventObject,eventName,eventHandler){if(BX.type.isString(eventObject)){eventHandler=eventName;eventName=eventObject;eventObject=window}eventName=eventName.toUpperCase();if(!customEvents[eventName]){return}for(var i=0,l=customEvents[eventName].length;i<l;i++){if(!customEvents[eventName][i]){continue}if(customEvents[eventName][i].handler==eventHandler&&customEvents[eventName][i].obj==eventObject){delete customEvents[eventName][i];return}}};BX.onCustomEvent=function(eventObject,eventName,arEventParams,secureParams){if(BX.type.isString(eventObject)){secureParams=arEventParams;arEventParams=eventName;eventName=eventObject;eventObject=window}eventName=eventName.toUpperCase();if(!customEvents[eventName]){return}if(!arEventParams){arEventParams=[]}var h;for(var i=0,l=customEvents[eventName].length;i<l;i++){h=customEvents[eventName][i];if(!h||!h.handler){continue}if(h.obj==window||h.obj==eventObject){h.handler.apply(eventObject,!!secureParams?BX.clone(arEventParams):arEventParams)}}};BX.parseJSON=function(data,context){var result=null;if(BX.type.isString(data)){try{if(data.indexOf("\n")>=0){eval("result = "+data)}else{result=(new Function("return "+data))()}}catch(e){BX.onCustomEvent(context,"onParseJSONFailure",[data,context])}}return result};BX.isReady=false;BX.ready=function(handler){bindReady();if(!BX.type.isFunction(handler)){BX.debug("READY: not a function! ",handler)}else{if(BX.isReady){handler.call(document)}else{if(readyList){readyList.push(handler)}}}};BX.submit=function(obForm,action_name,action_value,onAfterSubmit){action_name=action_name||"save";if(!obForm["BXFormSubmit_"+action_name]){obForm["BXFormSubmit_"+action_name]=obForm.appendChild(BX.create("INPUT",{props:{type:"submit",name:action_name,value:action_value||"Y"},style:{display:"none"}}))}if(obForm.sessid){obForm.sessid.value=BX.bitrix_sessid()}setTimeout(BX.delegate(function(){BX.fireEvent(this,"click");if(onAfterSubmit){onAfterSubmit()}},obForm["BXFormSubmit_"+action_name]),10)};BX.browser={IsIE:function(){return bIE},IsIE6:function(){return(/MSIE 6/i.test(navigator.userAgent))},IsIE7:function(){return(/MSIE 7/i.test(navigator.userAgent))},IsIE8:function(){return(/MSIE 8/i.test(navigator.userAgent))},IsIE9:function(){return !!document.documentMode&&document.documentMode>=9},IsIE10:function(){return !!document.documentMode&&document.documentMode>=10},IsIE11:function(){return BX.browser.DetectIeVersion()>=11},IsOpera:function(){return bOpera},IsSafari:function(){return bSafari},IsFirefox:function(){return bFirefox},IsChrome:function(){return bChrome},IsMac:function(){return(/Macintosh/i.test(navigator.userAgent))},IsAndroid:function(){return(/Android/i.test(navigator.userAgent))},IsIOS:function(){return(/(iPad;)|(iPhone;)/i.test(navigator.userAgent))},DetectIeVersion:function(){if(BX.browser.IsOpera()||BX.browser.IsSafari()||BX.browser.IsFirefox()||BX.browser.IsChrome()){return -1}var rv=-1;if(!!(window.MSStream)&&!(window.ActiveXObject)&&("ActiveXObject" in window)){rv=11}else{if(BX.browser.IsIE10()){rv=10}else{if(BX.browser.IsIE9()){rv=9}else{if(BX.browser.IsIE()){rv=8}}}}if(rv==-1||rv==8){var re;if(navigator.appName=="Microsoft Internet Explorer"){re=new RegExp("MSIE ([0-9]+[.0-9]*)");if(re.exec(navigator.userAgent)!=null){rv=parseFloat(RegExp.$1)}}else{if(navigator.appName=="Netscape"){rv=11;re=new RegExp("Trident/.*rv:([0-9]+[.0-9]*)");if(re.exec(navigator.userAgent)!=null){rv=parseFloat(RegExp.$1)}}}}return rv},IsDoctype:function(pDoc){pDoc=pDoc||document;if(pDoc.compatMode){return(pDoc.compatMode=="CSS1Compat")}if(pDoc.documentElement&&pDoc.documentElement.clientHeight){return true}return false},SupportLocalStorage:function(){return !!BX.localStorage&&!!BX.localStorage.checkBrowser()},addGlobalClass:function(){var globalClass="";if(BX.browser.IsIOS()){globalClass+=" bx-ios"}else{if(BX.browser.IsMac()){globalClass+=" bx-mac"}else{if(BX.browser.IsAndroid()){globalClass+=" bx-android"}}}globalClass+=(BX.browser.IsIOS()||BX.browser.IsAndroid()?" bx-touch":" bx-no-touch");globalClass+=(BX.browser.isRetina()?" bx-retina":" bx-no-retina");var ieVersion=-1;if(/AppleWebKit/.test(navigator.userAgent)){globalClass+=" bx-chrome"}else{if((ieVersion=BX.browser.DetectIeVersion())>0){globalClass+=" bx-ie bx-ie"+ieVersion;if(ieVersion>7&&ieVersion<10&&!BX.browser.IsDoctype()){globalClass+=" bx-quirks"}}else{if(/Opera/.test(navigator.userAgent)){globalClass+=" bx-opera"}else{if(/Gecko/.test(navigator.userAgent)){globalClass+=" bx-firefox"}}}}BX.addClass(document.documentElement,globalClass);BX.browser.addGlobalClass=BX.DoNothing},isPropertySupported:function(jsProperty,bReturnCSSName){if(!BX.type.isNotEmptyString(jsProperty)){return false}var property=jsProperty.indexOf("-")>-1?getJsName(jsProperty):jsProperty;bReturnCSSName=!!bReturnCSSName;var ucProperty=property.charAt(0).toUpperCase()+property.slice(1);var properties=(property+" "+["Webkit","Moz","O","ms"].join(ucProperty+" ")+ucProperty).split(" ");var obj=document.body||document.documentElement;for(var i=0;i<properties.length;i++){var prop=properties[i];if(obj.style[prop]!==undefined){var prefix=prop==property?"":"-"+prop.substr(0,prop.length-property.length).toLowerCase()+"-";return bReturnCSSName?prefix+getCssName(property):prop}}function getCssName(propertyName){return propertyName.replace(/([A-Z])/g,function(){return"-"+arguments[1].toLowerCase()})}function getJsName(cssName){var reg=/(\-([a-z]){1})/g;if(reg.test(cssName)){return cssName.replace(reg,function(){return arguments[2].toUpperCase()})}else{return cssName}}return false},addGlobalFeatures:function(features,prefix){if(!BX.type.isArray(features)){return}var classNames=[];for(var i=0;i<features.length;i++){var support=!!BX.browser.isPropertySupported(features[i]);classNames.push("bx-"+(support?"":"no-")+features[i].toLowerCase())}BX.addClass(document.documentElement,classNames.join(" "))},isRetina:function(){return window.devicePixelRatio&&window.devicePixelRatio>=2}};BX.show=function(ob,displayType){if(ob.BXDISPLAY||!_checkDisplay(ob,displayType)){ob.style.display=ob.BXDISPLAY}};BX.hide=function(ob,displayType){if(!ob.BXDISPLAY){_checkDisplay(ob,displayType)}ob.style.display="none"};BX.toggle=function(ob,values){if(!values&&BX.type.isElementNode(ob)){var bShow=true;if(ob.BXDISPLAY){bShow=!_checkDisplay(ob)}else{bShow=ob.style.display=="none"}if(bShow){BX.show(ob)}else{BX.hide(ob)}}else{if(BX.type.isArray(values)){for(var i=0,len=values.length;i<len;i++){if(ob==values[i]){ob=values[i==len-1?0:i+1];break}}if(i==len){ob=values[0]}}}return ob};BX.util={array_values:function(ar){if(!BX.type.isArray(ar)){return BX.util._array_values_ob(ar)}var arv=[];for(var i=0,l=ar.length;i<l;i++){if(ar[i]!==null&&typeof ar[i]!="undefined"){arv.push(ar[i])}}return arv},_array_values_ob:function(ar){var arv=[];for(var i in ar){if(ar[i]!==null&&typeof ar[i]!="undefined"){arv.push(ar[i])}}return arv},array_keys:function(ar){if(!BX.type.isArray(ar)){return BX.util._array_keys_ob(ar)}var arv=[];for(var i=0,l=ar.length;i<l;i++){if(ar[i]!==null&&typeof ar[i]!="undefined"){arv.push(i)}}return arv},_array_keys_ob:function(ar){var arv=[];for(var i in ar){if(ar[i]!==null&&typeof ar[i]!="undefined"){arv.push(i)}}return arv},array_merge:function(first,second){if(!BX.type.isArray(first)){first=[]}if(!BX.type.isArray(second)){second=[]}var i=first.length,j=0;if(typeof second.length==="number"){for(var l=second.length;j<l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},array_unique:function(ar){var i=0,j,len=ar.length;if(len<2){return ar}for(;i<len-1;i++){for(j=i+1;j<len;j++){if(ar[i]==ar[j]){ar.splice(j--,1);len--}}}return ar},in_array:function(needle,haystack){for(var i=0;i<haystack.length;i++){if(haystack[i]==needle){return true}}return false},array_search:function(needle,haystack){for(var i=0;i<haystack.length;i++){if(haystack[i]==needle){return i}}return -1},object_search_key:function(needle,haystack){if(typeof haystack[needle]!="undefined"){return haystack[needle]}for(var i in haystack){if(typeof haystack[i]=="object"){var result=BX.util.object_search_key(needle,haystack[i]);if(result!==false){return result}}}return false},trim:function(s){if(BX.type.isString(s)){return s.replace(r.ltrim,"").replace(r.rtrim,"")}else{return s}},urlencode:function(s){return encodeURIComponent(s)},deleteFromArray:function(ar,ind){return ar.slice(0,ind).concat(ar.slice(ind+1))},insertIntoArray:function(ar,ind,el){return ar.slice(0,ind).concat([el]).concat(ar.slice(ind))},htmlspecialchars:function(str){if(!str.replace){return str}return str.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlspecialcharsback:function(str){if(!str.replace){return str}return str.replace(/\&quot;/g,'"').replace(/&#39;/g,"'").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&amp;/g,"&")},preg_quote:function(str,delimiter){if(!str.replace){return str}return str.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(delimiter||"")+"-]","g"),"\\$&")},jsencode:function(str){if(!str||!str.replace){return str}var escapes=[{c:"\\\\",r:"\\\\"},{c:"\\t",r:"\\t"},{c:"\\n",r:"\\n"},{c:"\\r",r:"\\r"},{c:'"',r:'\\"'},{c:"'",r:"\\'"},{c:"<",r:"\\x3C"},{c:">",r:"\\x3E"},{c:"\\u2028",r:"\\u2028"},{c:"\\u2029",r:"\\u2029"}];for(var i=0;i<escapes.length;i++){str=str.replace(new RegExp(escapes[i].c,"g"),escapes[i].r)}return str},str_pad:function(input,pad_length,pad_string,pad_type){pad_string=pad_string||" ";pad_type=pad_type||"right";input=input.toString();if(pad_type=="left"){return BX.util.str_pad_left(input,pad_length,pad_string)}else{return BX.util.str_pad_right(input,pad_length,pad_string)}},str_pad_left:function(input,pad_length,pad_string){var i=input.length,q=pad_string.length;if(i>=pad_length){return input}for(;i<pad_length;i+=q){input=pad_string+input}return input},str_pad_right:function(input,pad_length,pad_string){var i=input.length,q=pad_string.length;if(i>=pad_length){return input}for(;i<pad_length;i+=q){input+=pad_string}return input},strip_tags:function(str){return str.split(/<[^>]+>/g).join("")},strip_php_tags:function(str){return str.replace(/<\?(.|[\r\n])*?\?>/g,"")},popup:function(url,width,height){var w,h;if(BX.browser.IsOpera()){w=document.body.offsetWidth;h=document.body.offsetHeight}else{w=screen.width;h=screen.height}return window.open(url,"","status=no,scrollbars=yes,resizable=yes,width="+width+",height="+height+",top="+Math.floor((h-height)/2-14)+",left="+Math.floor((w-width)/2-5))},objectSort:function(object,sortBy,sortDir){sortDir=sortDir=="asc"?"asc":"desc";var arItems=[],i;for(i in object){if(object.hasOwnProperty(i)&&object[i][sortBy]){arItems.push([i,object[i][sortBy]])}}if(sortDir=="asc"){arItems.sort(function(i,ii){var s1,s2;if(!isNaN(i[1])&&!isNaN(ii[1])){s1=parseInt(i[1]);s2=parseInt(ii[1])}else{s1=i[1].toString().toLowerCase();s2=ii[1].toString().toLowerCase()}if(s1>s2){return 1}else{if(s1<s2){return -1}else{return 0}}})}else{arItems.sort(function(i,ii){var s1,s2;if(!isNaN(i[1])&&!isNaN(ii[1])){s1=parseInt(i[1]);s2=parseInt(ii[1])}else{s1=i[1].toString().toLowerCase();s2=ii[1].toString().toLowerCase()}if(s1<s2){return 1}else{if(s1>s2){return -1}else{return 0}}})}var arReturnArray=Array();for(i=0;i<arItems.length;i++){arReturnArray.push(object[arItems[i][0]])}return arReturnArray},hex2rgb:function(color){var rgb=color.replace(/[# ]/g,"").replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3").match(/.{2}/g);for(var i=0;i<3;i++){rgb[i]=parseInt(rgb[i],16)}return{r:rgb[0],g:rgb[1],b:rgb[2]}},remove_url_param:function(url,param){if(BX.type.isArray(param)){for(var i=0;i<param.length;i++){url=BX.util.remove_url_param(url,param[i])}}else{url=url.replace(new RegExp("([?&])"+param+"=[^&]*[&]*","i"),"$1")}return url},even:function(digit){return(parseInt(digit)%2==0)?true:false},hashCode:function(str){if(!BX.type.isNotEmptyString(str)){return 0}var hash=0;for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);hash=((hash<<5)-hash)+c;hash=hash&hash}return hash},getRandomString:function(length){var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var charQty=chars.length;length=parseInt(length);if(isNaN(length)||length<=0){length=8}var result="";for(var i=0;i<length;i++){result+=chars.charAt(Math.floor(Math.random()*charQty))}return result},number_format:function(number,decimals,dec_point,thousands_sep){var i,j,kw,kd,km,sign="";decimals=Math.abs(decimals);if(isNaN(decimals)||decimals<0){decimals=2}dec_point=dec_point||",";thousands_sep=thousands_sep||".";number=(+number||0).toFixed(decimals);if(number<0){sign="-";number=-number}i=parseInt(number,10)+"";j=(i.length>3?i.length%3:0);km=(j?i.substr(0,j)+thousands_sep:"");kw=i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+thousands_sep);kd=(decimals?dec_point+Math.abs(number-i).toFixed(decimals).replace(/-/,"0").slice(2):"");return sign+km+kw+kd}};BX.type={isString:function(item){return item===""?true:(item?(typeof(item)=="string"||item instanceof String):false)},isNotEmptyString:function(item){return BX.type.isString(item)?item.length>0:false},isBoolean:function(item){return item===true||item===false},isNumber:function(item){return item===0?true:(item?(typeof(item)=="number"||item instanceof Number):false)},isFunction:function(item){return item===null?false:(typeof(item)=="function"||item instanceof Function)},isElementNode:function(item){return item&&typeof(item)=="object"&&"nodeType" in item&&item.nodeType==1&&item.tagName&&item.tagName.toUpperCase()!="SCRIPT"&&item.tagName.toUpperCase()!="STYLE"&&item.tagName.toUpperCase()!="LINK"},isDomNode:function(item){return item&&typeof(item)=="object"&&"nodeType" in item},isArray:function(item){return item&&Object.prototype.toString.call(item)=="[object Array]"},isDate:function(item){return item&&Object.prototype.toString.call(item)=="[object Date]"},isPlainObject:function(item){if(!item||typeof(item)!=="object"||item.nodeType){return false}var hasProp=Object.prototype.hasOwnProperty;try{if(item.constructor&&!hasProp.call(item,"constructor")&&!hasProp.call(item.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}var key;for(key in item){}return typeof(key)==="undefined"||hasProp.call(item,key)}};BX.isNodeInDom=function(node,doc){return node===(doc||document)?true:(node.parentNode?BX.isNodeInDom(node.parentNode):false)};BX.isNodeHidden=function(node){if(node===document){return false}else{if(BX.style(node,"display")=="none"){return true}else{return(node.parentNode?BX.isNodeHidden(node.parentNode):true)}}};BX.evalPack=function(code){while(code.length>0){var c=code.shift();if(c.TYPE=="SCRIPT_EXT"||c.TYPE=="SCRIPT_SRC"){BX.loadScript(c.DATA,function(){BX.evalPack(code)});return}else{if(c.TYPE=="SCRIPT"){BX.evalGlobal(c.DATA)}}}};BX.evalGlobal=function(data){if(data){var head=document.getElementsByTagName("head")[0]||document.documentElement,script=document.createElement("script");script.type="text/javascript";if(!BX.browser.IsIE()){script.appendChild(document.createTextNode(data))}else{script.text=data}head.insertBefore(script,head.firstChild);head.removeChild(script)}};BX.processHTML=function(HTML,scriptsRunFirst){var matchScript,matchStyle,matchSrc,matchHref,scripts=[],styles=[],data=HTML;while((matchScript=data.match(r.script))!==null){var end=data.search(/<\/script>/i);if(end==-1){break}var bRunFirst=scriptsRunFirst||(matchScript[1].indexOf("bxrunfirst")!="-1");if((matchSrc=matchScript[1].match(r.script_src))!==null){scripts.push({bRunFirst:bRunFirst,isInternal:false,JS:matchSrc[1]})}else{var start=matchScript.index+matchScript[0].length;var js=data.substr(start,end-start);scripts.push({bRunFirst:bRunFirst,isInternal:true,JS:js})}data=data.substr(0,matchScript.index)+data.substr(end+9)}while((matchStyle=data.match(r.style))!==null){if((matchHref=matchStyle[0].match(r.style_href))!==null&&matchStyle[0].indexOf('media="')<0){styles.push(matchHref[1])}data=data.replace(matchStyle[0],"")}return{HTML:data,SCRIPT:scripts,STYLE:styles}};BX.garbage=function(call,thisObject){garbageCollectors.push({callback:call,context:thisObject})};BX.GetDocElement=function(pDoc){pDoc=pDoc||document;return(BX.browser.IsDoctype(pDoc)?pDoc.documentElement:pDoc.body)};BX.GetContext=function(node){if(BX.type.isElementNode(node)){return node.ownerDocument.parentWindow||node.ownerDocument.defaultView||window}else{if(BX.type.isDomNode(node)){return node.parentWindow||node.defaultView||window}else{return window}}};BX.GetWindowInnerSize=function(pDoc){var width,height;pDoc=pDoc||document;if(window.innerHeight){width=BX.GetContext(pDoc).innerWidth;height=BX.GetContext(pDoc).innerHeight}else{if(pDoc.documentElement&&(pDoc.documentElement.clientHeight||pDoc.documentElement.clientWidth)){width=pDoc.documentElement.clientWidth;height=pDoc.documentElement.clientHeight}else{if(pDoc.body){width=pDoc.body.clientWidth;height=pDoc.body.clientHeight}}}return{innerWidth:width,innerHeight:height}};BX.GetWindowScrollPos=function(pDoc){var left,top;pDoc=pDoc||document;if(window.pageYOffset){left=BX.GetContext(pDoc).pageXOffset;top=BX.GetContext(pDoc).pageYOffset}else{if(pDoc.documentElement&&(pDoc.documentElement.scrollTop||pDoc.documentElement.scrollLeft)){left=pDoc.documentElement.scrollLeft;top=pDoc.documentElement.scrollTop}else{if(pDoc.body){left=pDoc.body.scrollLeft;top=pDoc.body.scrollTop}}}return{scrollLeft:left,scrollTop:top}};BX.GetWindowScrollSize=function(pDoc){var width,height;if(!pDoc){pDoc=document}if((pDoc.compatMode&&pDoc.compatMode=="CSS1Compat")){width=pDoc.documentElement.scrollWidth;height=pDoc.documentElement.scrollHeight}else{if(pDoc.body.scrollHeight>pDoc.body.offsetHeight){height=pDoc.body.scrollHeight}else{height=pDoc.body.offsetHeight}if(pDoc.body.scrollWidth>pDoc.body.offsetWidth||(pDoc.compatMode&&pDoc.compatMode=="BackCompat")||(pDoc.documentElement&&!pDoc.documentElement.clientWidth)){width=pDoc.body.scrollWidth}else{width=pDoc.body.offsetWidth}}return{scrollWidth:width,scrollHeight:height}};BX.GetWindowSize=function(pDoc){var innerSize=this.GetWindowInnerSize(pDoc);var scrollPos=this.GetWindowScrollPos(pDoc);var scrollSize=this.GetWindowScrollSize(pDoc);return{innerWidth:innerSize.innerWidth,innerHeight:innerSize.innerHeight,scrollLeft:scrollPos.scrollLeft,scrollTop:scrollPos.scrollTop,scrollWidth:scrollSize.scrollWidth,scrollHeight:scrollSize.scrollHeight}};BX.hide_object=function(ob){ob=BX(ob);ob.style.position="absolute";ob.style.top="-1000px";ob.style.left="-1000px";ob.style.height="10px";ob.style.width="10px"};BX.is_relative=function(el){var p=BX.style(el,"position");return p=="relative"||p=="absolute"};BX.is_float=function(el){var p=BX.style(el,"float");return p=="right"||p=="left"};BX.is_fixed=function(el){var p=BX.style(el,"position");return p=="fixed"};BX.pos=function(el,bRelative){var r={top:0,right:0,bottom:0,left:0,width:0,height:0};bRelative=!!bRelative;if(!el){return r}if(typeof(el.getBoundingClientRect)!="undefined"&&el.ownerDocument==document&&!bRelative){var clientRect={};try{clientRect=el.getBoundingClientRect()}catch(e){clientRect={top:el.offsetTop,left:el.offsetLeft,width:el.offsetWidth,height:el.offsetHeight,right:el.offsetLeft+el.offsetWidth,bottom:el.offsetTop+el.offsetHeight}}var root=document.documentElement;var body=document.body;r.top=clientRect.top+(root.scrollTop||body.scrollTop);r.left=clientRect.left+(root.scrollLeft||body.scrollLeft);r.width=clientRect.right-clientRect.left;r.height=clientRect.bottom-clientRect.top;r.right=clientRect.right+(root.scrollLeft||body.scrollLeft);r.bottom=clientRect.bottom+(root.scrollTop||body.scrollTop)}else{var x=0,y=0,w=el.offsetWidth,h=el.offsetHeight;var first=true;for(;el!=null;el=el.offsetParent){if(!first&&bRelative&&BX.is_relative(el)){break}x+=el.offsetLeft;y+=el.offsetTop;if(first){first=false;continue}var elBorderLeftWidth=parseInt(BX.style(el,"border-left-width")),elBorderTopWidth=parseInt(BX.style(el,"border-top-width"));if(!isNaN(elBorderLeftWidth)&&elBorderLeftWidth>0){x+=elBorderLeftWidth}if(!isNaN(elBorderTopWidth)&&elBorderTopWidth>0){y+=elBorderTopWidth}}r.top=y;r.left=x;r.width=w;r.height=h;r.right=r.left+w;r.bottom=r.top+h}for(var i in r){if(r.hasOwnProperty(i)){r[i]=parseInt(r[i])}}return r};BX.align=function(pos,w,h,type){if(type){type=type.toLowerCase()}else{type=""}var pDoc=document;if(BX.type.isElementNode(pos)){pDoc=pos.ownerDocument;pos=BX.pos(pos)}var x=pos.left,y=pos.bottom;var scroll=BX.GetWindowScrollPos(pDoc);var size=BX.GetWindowInnerSize(pDoc);if((size.innerWidth+scroll.scrollLeft)-(pos.left+w)<0){if(pos.right-w>=0){x=pos.right-w}else{x=scroll.scrollLeft}}if(((size.innerHeight+scroll.scrollTop)-(pos.bottom+h)<0)||~type.indexOf("top")){if(pos.top-h>=0||~type.indexOf("top")){y=pos.top-h}else{y=scroll.scrollTop}}return{left:x,top:y}};BX.scrollToNode=function(node){var obNode=BX(node);if(obNode.scrollIntoView){obNode.scrollIntoView(true)}else{var arNodePos=BX.pos(obNode);window.scrollTo(arNodePos.left,arNodePos.top)}};BX.showWait=function(node,msg){node=BX(node)||document.body||document.documentElement;msg=msg||BX.message("JS_CORE_LOADING");var container_id=node.id||Math.random();var obMsg=node.bxmsg=document.body.appendChild(BX.create("DIV",{props:{id:"wait_"+container_id,className:"bx-core-waitwindow"},text:msg}));setTimeout(BX.delegate(_adjustWait,node),10);lastWait[lastWait.length]=obMsg;return obMsg};BX.closeWait=function(node,obMsg){if(node&&!obMsg){obMsg=node.bxmsg}if(node&&!obMsg&&BX.hasClass(node,"bx-core-waitwindow")){obMsg=node}if(node&&!obMsg){obMsg=BX("wait_"+node.id)}if(!obMsg){obMsg=lastWait.pop()}if(obMsg&&obMsg.parentNode){for(var i=0,len=lastWait.length;i<len;i++){if(obMsg==lastWait[i]){lastWait=BX.util.deleteFromArray(lastWait,i);break}}obMsg.parentNode.removeChild(obMsg);if(node){node.bxmsg=null}BX.cleanNode(obMsg,true)}};BX.setJSList=function(scripts){if(BX.type.isArray(scripts)){jsList=scripts}};BX.setCSSList=function(scripts){if(BX.type.isArray(scripts)){cssList=scripts}};BX.getJSPath=function(js){return js.replace(/\.js(\?\d*)/,".js").replace(/^(http[s]*:)*\/\/[^\/]+/i,"")};BX.getCSSPath=function(css){return css.replace(/\.css(\?\d*)/,".css").replace(/^(http[s]*:)*\/\/[^\/]+/i,"")};BX.getCDNPath=function(path){return path};BX.loadScript=function(script,callback,doc){if(!BX.isReady){var _args=arguments;BX.ready(function(){BX.loadScript.apply(this,_args)});return}doc=doc||document;if(BX.type.isString(script)){script=[script]}var _callback=function(){return(callback&&BX.type.isFunction(callback))?callback():null};var load_js=function(ind){if(ind>=script.length){return _callback()}if(!!script[ind]){var fileSrc=BX.getJSPath(script[ind]);if(_isScriptLoaded(fileSrc)){load_js(++ind)}else{var oHead=doc.getElementsByTagName("head")[0]||doc.documentElement;var oScript=doc.createElement("script");oScript.src=script[ind];var bLoaded=false;oScript.onload=oScript.onreadystatechange=function(){if(!bLoaded&&(!oScript.readyState||oScript.readyState=="loaded"||oScript.readyState=="complete")){bLoaded=true;setTimeout(function(){load_js(++ind)},50);oScript.onload=oScript.onreadystatechange=null;if(oHead&&oScript.parentNode){oHead.removeChild(oScript)}}};jsList.push(fileSrc);return oHead.insertBefore(oScript,oHead.firstChild)}}else{load_js(++ind)}};load_js(0)};BX.loadCSS=function(arCSS,doc,win){if(!BX.isReady){var _args=arguments;BX.ready(function(){BX.loadCSS.apply(this,_args)});return null}var bSingle=false;if(BX.type.isString(arCSS)){bSingle=true;arCSS=[arCSS]}var i=0,l=arCSS.length,lnk=null,pLnk=[];if(l==0){return null}doc=doc||document;win=win||window;if(!win.bxhead){var heads=doc.getElementsByTagName("HEAD");win.bxhead=heads[0];if(!win.bxhead){return null}}for(i=0;i<l;i++){var _check=BX.getCSSPath(arCSS[i]);if(_isCssLoaded(_check)){continue}lnk=document.createElement("LINK");lnk.href=arCSS[i];lnk.rel="stylesheet";lnk.type="text/css";var templateLink=_getTemplateLink(win.bxhead);if(templateLink!==null){templateLink.parentNode.insertBefore(lnk,templateLink)}else{win.bxhead.appendChild(lnk)}pLnk.push(lnk);cssList.push(_check)}if(bSingle){return lnk}return pLnk};BX.reload=function(back_url,bAddClearCache){if(back_url===true){bAddClearCache=true;back_url=null}var new_href=back_url||top.location.href;var hashpos=new_href.indexOf("#"),hash="";if(hashpos!=-1){hash=new_href.substr(hashpos);new_href=new_href.substr(0,hashpos)}if(bAddClearCache&&new_href.indexOf("clear_cache=Y")<0){new_href+=(new_href.indexOf("?")==-1?"?":"&")+"clear_cache=Y"}if(hash){if(bAddClearCache&&(hash.substr(0,5)=="view/"||hash.substr(0,6)=="#view/")&&hash.indexOf("clear_cache%3DY")<0){hash+=(hash.indexOf("%3F")==-1?"%3F":"%26")+"clear_cache%3DY"}new_href=new_href.replace(/(\?|\&)_r=[\d]*/,"");new_href+=(new_href.indexOf("?")==-1?"?":"&")+"_r="+Math.round(Math.random()*10000)+hash}top.location.href=new_href};BX.clearCache=function(){BX.showWait();BX.reload(true)};BX.template=function(tpl,callback,bKillTpl){BX.ready(function(){_processTpl(BX(tpl),callback,bKillTpl)})};BX.isAmPmMode=function(){return BX.message("FORMAT_DATETIME").match("T")==null?false:true};BX.formatDate=function(date,format){date=date||new Date();var bTime=date.getHours()||date.getMinutes()||date.getSeconds(),str=!!format?format:(bTime?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE"));return str.replace(/YYYY/ig,date.getFullYear()).replace(/MMMM/ig,BX.util.str_pad_left((date.getMonth()+1).toString(),2,"0")).replace(/MM/ig,BX.util.str_pad_left((date.getMonth()+1).toString(),2,"0")).replace(/DD/ig,BX.util.str_pad_left(date.getDate().toString(),2,"0")).replace(/HH/ig,BX.util.str_pad_left(date.getHours().toString(),2,"0")).replace(/MI/ig,BX.util.str_pad_left(date.getMinutes().toString(),2,"0")).replace(/SS/ig,BX.util.str_pad_left(date.getSeconds().toString(),2,"0"))};BX.getNumMonth=function(month){var wordMonthCut=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];var wordMonth=["january","february","march","april","may","june","july","august","september","october","november","december"];var q=month.toUpperCase();for(i=1;i<=12;i++){if(q==BX.message("MON_"+i).toUpperCase()||q==BX.message("MONTH_"+i).toUpperCase()||q==wordMonthCut[i-1].toUpperCase()||q==wordMonth[i-1].toUpperCase()){return i}}return month};BX.parseDate=function(str){if(BX.type.isNotEmptyString(str)){var regMonths="";for(i=1;i<=12;i++){regMonths=regMonths+"|"+BX.message("MON_"+i)}var expr=new RegExp("([0-9]+|[a-z]+"+regMonths+")","ig");var aDate=str.match(expr),aFormat=BX.message("FORMAT_DATE").match(/(DD|MI|MMMM|MM|M|YYYY)/ig),i,cnt,aDateArgs=[],aFormatArgs=[],aResult={};if(!aDate){return null}if(aDate.length>aFormat.length){aFormat=BX.message("FORMAT_DATETIME").match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/ig)}for(i=0,cnt=aDate.length;i<cnt;i++){if(BX.util.trim(aDate[i])!=""){aDateArgs[aDateArgs.length]=aDate[i]}}for(i=0,cnt=aFormat.length;i<cnt;i++){if(BX.util.trim(aFormat[i])!=""){aFormatArgs[aFormatArgs.length]=aFormat[i]}}var m=BX.util.array_search("MMMM",aFormatArgs);if(m>0){aDateArgs[m]=BX.getNumMonth(aDateArgs[m]);aFormatArgs[m]="MM"}else{m=BX.util.array_search("M",aFormatArgs);if(m>0){aDateArgs[m]=BX.getNumMonth(aDateArgs[m]);aFormatArgs[m]="MM"}}for(i=0,cnt=aFormatArgs.length;i<cnt;i++){var k=aFormatArgs[i].toUpperCase();aResult[k]=k=="T"||k=="TT"?aDateArgs[i]:parseInt(aDateArgs[i],10)}if(aResult.DD>0&&aResult.MM>0&&aResult.YYYY>0){var d=new Date();d.setDate(1);d.setFullYear(aResult.YYYY);d.setMonth(aResult.MM-1);d.setDate(aResult.DD);d.setHours(0,0,0);if((!isNaN(aResult.HH)||!isNaN(aResult.GG)||!isNaN(aResult.H)||!isNaN(aResult.G))&&!isNaN(aResult.MI)){if(!isNaN(aResult.H)||!isNaN(aResult.G)){var bPM=(aResult.T||aResult.TT||"am").toUpperCase()=="PM";var h=parseInt(aResult.H||aResult.G||0,10);if(bPM){aResult.HH=h+(h==12?0:12)}else{aResult.HH=h<12?h:0}}else{aResult.HH=parseInt(aResult.HH||aResult.GG||0,10)}if(isNaN(aResult.SS)){aResult.SS=0}d.setHours(aResult.HH,aResult.MI,aResult.SS)}return d}}return null};BX.selectUtils={addNewOption:function(oSelect,opt_value,opt_name,do_sort,check_unique){oSelect=BX(oSelect);if(oSelect){var n=oSelect.length;if(check_unique!==false){for(var i=0;i<n;i++){if(oSelect[i].value==opt_value){return}}}var newoption=new Option(opt_name,opt_value,false,false);oSelect.options[n]=newoption}if(do_sort===true){this.sortSelect(oSelect)}},deleteOption:function(oSelect,opt_value){oSelect=BX(oSelect);if(oSelect){for(var i=0;i<oSelect.length;i++){if(oSelect[i].value==opt_value){oSelect.remove(i);break}}}},deleteSelectedOptions:function(oSelect){oSelect=BX(oSelect);if(oSelect){var i=0;while(i<oSelect.length){if(oSelect[i].selected){oSelect[i].selected=false;oSelect.remove(i)}else{i++}}}},deleteAllOptions:function(oSelect){oSelect=BX(oSelect);if(oSelect){for(var i=oSelect.length-1;i>=0;i--){oSelect.remove(i)}}},optionCompare:function(record1,record2){var value1=record1.optText.toLowerCase();var value2=record2.optText.toLowerCase();if(value1>value2){return(1)}if(value1<value2){return(-1)}return(0)},sortSelect:function(oSelect){oSelect=BX(oSelect);if(oSelect){var myOptions=[];var n=oSelect.options.length;var i=0;for(i=0;i<n;i++){myOptions[i]={optText:oSelect[i].text,optValue:oSelect[i].value}}myOptions.sort(this.optionCompare);oSelect.length=0;n=myOptions.length;for(i=0;i<n;i++){oSelect[i]=new Option(myOptions[i].optText,myOptions[i].optValue,false,false)}}},selectAllOptions:function(oSelect){oSelect=BX(oSelect);if(oSelect){var n=oSelect.length;for(var i=0;i<n;i++){oSelect[i].selected=true}}},selectOption:function(oSelect,opt_value){oSelect=BX(oSelect);if(oSelect){var n=oSelect.length;for(var i=0;i<n;i++){oSelect[i].selected=(oSelect[i].value==opt_value)}}},addSelectedOptions:function(oSelect,to_select_id,check_unique,do_sort){oSelect=BX(oSelect);if(!oSelect){return}var n=oSelect.length;for(var i=0;i<n;i++){if(oSelect[i].selected){this.addNewOption(to_select_id,oSelect[i].value,oSelect[i].text,do_sort,check_unique)}}},moveOptionsUp:function(oSelect){oSelect=BX(oSelect);if(!oSelect){return}var n=oSelect.length;for(var i=0;i<n;i++){if(oSelect[i].selected&&i>0&&oSelect[i-1].selected==false){var option1=new Option(oSelect[i].text,oSelect[i].value);var option2=new Option(oSelect[i-1].text,oSelect[i-1].value);oSelect[i]=option2;oSelect[i].selected=false;oSelect[i-1]=option1;oSelect[i-1].selected=true}}},moveOptionsDown:function(oSelect){oSelect=BX(oSelect);if(!oSelect){return}var n=oSelect.length;for(var i=n-1;i>=0;i--){if(oSelect[i].selected&&i<n-1&&oSelect[i+1].selected==false){var option1=new Option(oSelect[i].text,oSelect[i].value);var option2=new Option(oSelect[i+1].text,oSelect[i+1].value);oSelect[i]=option2;oSelect[i].selected=false;oSelect[i+1]=option1;oSelect[i+1].selected=true}}}};BX.getEventTarget=function(e){if(e.target){return e.target}else{if(e.srcElement){return e.srcElement}}return null};BX.hint=function(el,hint_title,hint_html,hint_id){if(null==hint_html){hint_html=hint_title;hint_title=""}if(null==el.BXHINT){el.BXHINT=new BX.CHint({parent:el,hint:hint_html,title:hint_title,id:hint_id});el.BXHINT.Show()}};BX.hint_replace=function(el,hint_title,hint_html){if(null==hint_html){hint_html=hint_title;hint_title=""}if(!el||!el.parentNode||!hint_html){return null}var obHint=new BX.CHint({hint:hint_html,title:hint_title});obHint.CreateParent();el.parentNode.insertBefore(obHint.PARENT,el);el.parentNode.removeChild(el);obHint.PARENT.style.marginLeft="5px";return el};BX.CHint=function(params){this.PARENT=BX(params.parent);this.HINT=params.hint;this.HINT_TITLE=params.title;this.PARAMS={};for(var i in this.defaultSettings){if(null==params[i]){this.PARAMS[i]=this.defaultSettings[i]}else{this.PARAMS[i]=params[i]}}if(null!=params.id){this.ID=params.id}this.timer=null;this.bInited=false;this.msover=true;if(this.PARAMS.showOnce){this.__show();this.msover=false;this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)}else{if(this.PARENT){BX.bind(this.PARENT,"mouseover",BX.proxy(this.Show,this));BX.bind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))}}BX.addCustomEvent("onMenuOpen",BX.delegate(this.disable,this));BX.addCustomEvent("onMenuClose",BX.delegate(this.enable,this))};BX.CHint.prototype.defaultSettings={show_timeout:1000,hide_timeout:500,dx:2,showOnce:false,preventHide:true,min_width:250};BX.CHint.prototype.CreateParent=function(element,params){if(this.PARENT){BX.unbind(this.PARENT,"mouseover",BX.proxy(this.Show,this));BX.unbind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))}if(!params){params={}}var type="icon";if(params.type&&(params.type=="link"||params.type=="icon")){type=params.type}if(element){type="element"}if(type=="icon"){element=BX.create("IMG",{props:{src:params.iconSrc?params.iconSrc:"/bitrix/js/main/core/images/hint.gif"}})}else{if(type=="link"){element=BX.create("A",{props:{href:"javascript:void(0)"},html:"[?]"})}}this.PARENT=element;BX.bind(this.PARENT,"mouseover",BX.proxy(this.Show,this));BX.bind(this.PARENT,"mouseout",BX.proxy(this.Hide,this));return this.PARENT};BX.CHint.prototype.Show=function(){this.msover=true;if(null!=this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.proxy(this.__show,this),this.PARAMS.show_timeout)};BX.CHint.prototype.Hide=function(){this.msover=false;if(null!=this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)};BX.CHint.prototype.__show=function(){if(!this.msover||this.disabled){return}if(!this.bInited){this.Init()}if(this.prepareAdjustPos()){this.DIV.style.display="block";this.adjustPos();BX.bind(window,"scroll",BX.proxy(this.__onscroll,this));if(this.PARAMS.showOnce){this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)}}};BX.CHint.prototype.__onscroll=function(){if(!BX.admin||!BX.admin.panel||!BX.admin.panel.isFixed()){return}if(this.scrollTimer){clearTimeout(this.scrollTimer)}this.DIV.style.display="none";this.scrollTimer=setTimeout(BX.proxy(this.Reopen,this),this.PARAMS.show_timeout)};BX.CHint.prototype.Reopen=function(){if(null!=this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.proxy(this.__show,this),50)};BX.CHint.prototype.__hide=function(){if(this.msover){return}if(!this.bInited){return}BX.unbind(window,"scroll",BX.proxy(this.Reopen,this));if(this.PARAMS.showOnce){this.Destroy()}else{this.DIV.style.display="none"}};BX.CHint.prototype.__hide_immediately=function(){this.msover=false;this.__hide()};BX.CHint.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip"},style:{display:"none"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-top-border"},html:'<div class="bx-panel-tooltip-corner bx-panel-tooltip-left-corner"></div><div class="bx-panel-tooltip-border"></div><div class="bx-panel-tooltip-corner bx-panel-tooltip-right-corner"></div>'}),(this.CONTENT=BX.create("DIV",{props:{className:"bx-panel-tooltip-content"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-underlay"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-underlay-bg"}})]})]})),BX.create("DIV",{props:{className:"bx-panel-tooltip-bottom-border"},html:'<div class="bx-panel-tooltip-corner bx-panel-tooltip-left-corner"></div><div class="bx-panel-tooltip-border"></div><div class="bx-panel-tooltip-corner bx-panel-tooltip-right-corner"></div>'})]}));if(this.ID){this.CONTENT.insertBefore(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-panel-tooltip-close"},events:{click:BX.delegate(this.Close,this)}}),this.CONTENT.firstChild)}if(this.HINT_TITLE){this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-title"},text:this.HINT_TITLE}))}if(this.HINT){this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-text"}})).appendChild(BX.create("SPAN",{html:this.HINT}))}if(this.PARAMS.preventHide){BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this));BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))}this.bInited=true};BX.CHint.prototype.setContent=function(content){this.HINT=content;if(this.CONTENT_TEXT){this.CONTENT_TEXT.innerHTML=this.HINT}else{this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-text"}})).appendChild(BX.create("SPAN",{html:this.HINT}))}};BX.CHint.prototype.prepareAdjustPos=function(){this._wnd={scrollPos:BX.GetWindowScrollPos(),scrollSize:BX.GetWindowScrollSize()};return BX.style(this.PARENT,"display")!="none"};BX.CHint.prototype.getAdjustPos=function(){var res={},pos=BX.pos(this.PARENT),min_top=0;res.top=pos.bottom+this.PARAMS.dx;if(BX.admin&&BX.admin.panel.DIV){min_top=BX.admin.panel.DIV.offsetHeight+this.PARAMS.dx;if(BX.admin.panel.isFixed()){min_top+=this._wnd.scrollPos.scrollTop}}if(res.top<min_top){res.top=min_top}else{if(res.top+this.DIV.offsetHeight>this._wnd.scrollSize.scrollHeight){res.top=pos.top-this.PARAMS.dx-this.DIV.offsetHeight}}res.left=pos.left;if(pos.left<this.PARAMS.dx){pos.left=this.PARAMS.dx}else{var floatWidth=this.DIV.offsetWidth;var max_left=this._wnd.scrollSize.scrollWidth-floatWidth-this.PARAMS.dx;if(res.left>max_left){res.left=max_left}}return res};BX.CHint.prototype.adjustWidth=function(){if(this.bWidthAdjusted){return}var w=this.DIV.offsetWidth,h=this.DIV.offsetHeight;if(w>this.PARAMS.min_width){w=Math.round(Math.sqrt(1.618*w*h))}if(w<this.PARAMS.min_width){w=this.PARAMS.min_width}this.DIV.style.width=w+"px";if(this._adjustWidthInt){clearInterval(this._adjustWidthInt)}this._adjustWidthInt=setInterval(BX.delegate(this._adjustWidthInterval,this),5);this.bWidthAdjusted=true};BX.CHint.prototype._adjustWidthInterval=function(){if(!this.DIV||this.DIV.style.display=="none"){clearInterval(this._adjustWidthInt)}var dW=20,maxWidth=1500,w=this.DIV.offsetWidth,w1=this.CONTENT_TEXT.offsetWidth;if(w>0&&w1>0&&w-w1<dW&&w<maxWidth){this.DIV.style.width=(w+dW)+"px";return}clearInterval(this._adjustWidthInt)};BX.CHint.prototype.adjustPos=function(){this.adjustWidth();var pos=this.getAdjustPos();this.DIV.style.top=pos.top+"px";this.DIV.style.left=pos.left+"px"};BX.CHint.prototype.Close=function(){if(this.ID&&BX.WindowManager){BX.WindowManager.saveWindowOptions(this.ID,{display:"off"})}this.__hide_immediately();this.Destroy()};BX.CHint.prototype.Destroy=function(){if(this.PARENT){BX.unbind(this.PARENT,"mouseover",BX.proxy(this.Show,this));BX.unbind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))}if(this.DIV){BX.unbind(this.DIV,"mouseover",BX.proxy(this.Show,this));BX.unbind(this.DIV,"mouseout",BX.proxy(this.Hide,this));BX.cleanNode(this.DIV,true)}};BX.CHint.prototype.enable=function(){this.disabled=false};BX.CHint.prototype.disable=function(){this.__hide_immediately();this.disabled=true};if(document.addEventListener){__readyHandler=function(){document.removeEventListener("DOMContentLoaded",__readyHandler,false);runReady()}}else{if(document.attachEvent){__readyHandler=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",__readyHandler);runReady()}}}}function bindReady(){if(!readyBound){readyBound=true;if(document.readyState==="complete"){return runReady()}if(document.addEventListener){document.addEventListener("DOMContentLoaded",__readyHandler,false);window.addEventListener("load",runReady,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",__readyHandler);window.attachEvent("onload",runReady);var toplevel=false;try{toplevel=(window.frameElement==null)}catch(e){}if(document.documentElement.doScroll&&toplevel){doScrollCheck()}}}}return null}function runReady(){if(!BX.isReady){if(!document.body){return setTimeout(runReady,15)}BX.isReady=true;if(readyList&&readyList.length>0){var fn,i=0;while(readyList&&(fn=readyList[i++])){try{fn.call(document)}catch(e){BX.debug("BX.ready error: ",e)}}readyList=null}}return null}function doScrollCheck(){if(BX.isReady){return}try{document.documentElement.doScroll("left")}catch(error){setTimeout(doScrollCheck,1);return}runReady()}function _adjustWait(){if(!this.bxmsg){return}var arContainerPos=BX.pos(this),div_top=arContainerPos.top;if(div_top<BX.GetDocElement().scrollTop){div_top=BX.GetDocElement().scrollTop+5}this.bxmsg.style.top=(div_top+5)+"px";if(this==BX.GetDocElement()){this.bxmsg.style.right="5px"}else{this.bxmsg.style.left=(arContainerPos.right-this.bxmsg.offsetWidth-5)+"px"}}function _checkDisplay(ob,displayType){if(typeof displayType!="undefined"){ob.BXDISPLAY=displayType}var d=ob.style.display||BX.style(ob,"display");if(d!="none"){ob.BXDISPLAY=ob.BXDISPLAY||d;return true}else{ob.BXDISPLAY=ob.BXDISPLAY||"block";return false}}function _processTpl(tplNode,cb,bKillTpl){if(tplNode){if(bKillTpl){tplNode.parentNode.removeChild(tplNode)}var res={},nodes=BX.findChildren(tplNode,{attribute:"data-role"},true);for(var i=0,l=nodes.length;i<l;i++){res[nodes[i].getAttribute("data-role")]=nodes[i]}cb.apply(tplNode,[res])}}function _checkNode(obj,params){params=params||{};if(BX.type.isFunction(params)){return params.call(window,obj)}if(!params.allowTextNodes&&!BX.type.isElementNode(obj)){return false}var i,j,len;for(i in params){if(params.hasOwnProperty(i)){switch(i){case"tag":case"tagName":if(BX.type.isString(params[i])){if(obj.tagName.toUpperCase()!=params[i].toUpperCase()){return false}}else{if(params[i] instanceof RegExp){if(!params[i].test(obj.tagName)){return false}}}break;case"class":case"className":if(BX.type.isString(params[i])){if(!BX.hasClass(obj,params[i])){return false}}else{if(params[i] instanceof RegExp){if(!BX.type.isString(obj.className)||!params[i].test(obj.className)){return false}}}break;case"attr":case"attribute":if(BX.type.isString(params[i])){if(!obj.getAttribute(params[i])){return false}}else{if(BX.type.isArray(params[i])){for(j=0,len=params[i].length;j<len;j++){if(params[i]&&!obj.getAttribute(params[i])){return false}}}else{for(j in params[i]){if(params[i].hasOwnProperty(j)){var q=obj.getAttribute(j);if(params[i][j] instanceof RegExp){if(!BX.type.isString(q)||!params[i][j].test(q)){return false}}else{if(q!=""+params[i][j]){return false}}}}}}break;case"property":if(BX.type.isString(params[i])){if(!obj[params[i]]){return false}}else{if(BX.type.isArray(params[i])){for(j=0,len=params[i].length;j<len;j++){if(params[i]&&!obj[params[i]]){return false}}}else{for(j in params[i]){if(BX.type.isString(params[i][j])){if(obj[j]!=params[i][j]){return false}}else{if(params[i][j] instanceof RegExp){if(!BX.type.isString(obj[j])||!params[i][j].test(obj[j])){return false}}}}}}break;case"callback":return params[i](obj)}}}return true}function _isCssLoaded(fileSrc){if(!cssInit){var linksCol=document.getElementsByTagName("LINK"),links=[];if(!!linksCol&&linksCol.length>0){for(var i=0;i<linksCol.length;i++){var href=linksCol[i].getAttribute("href");if(BX.type.isNotEmptyString(href)){cssList.push(BX.getCSSPath(href))}}}cssInit=true}return(BX.util.in_array(fileSrc,cssList))}function _getTemplateLink(head){var findLink=function(tag){var links=head.getElementsByTagName(tag);for(var i=0,length=links.length;i<length;i++){var templateStyle=links[i].getAttribute("data-template-style");if(BX.type.isNotEmptyString(templateStyle)&&templateStyle=="true"){return links[i]}}return null};var link=findLink("link");if(link===null){link=findLink("style")}return link}function _isScriptLoaded(fileSrc){if(!jsInit){var scriptCol=document.getElementsByTagName("script"),script=[];if(!!scriptCol&&scriptCol.length>0){for(var i=0;i<scriptCol.length;i++){var src=scriptCol[i].getAttribute("src");if(BX.type.isNotEmptyString(src)){jsList.push(BX.getJSPath(src))}}}jsInit=true}return BX.util.in_array(fileSrc,jsList)}function Trash(){var i,len;for(i=0,len=garbageCollectors.length;i<len;i++){try{garbageCollectors[i].callback.apply(garbageCollectors[i].context||window);delete garbageCollectors[i];garbageCollectors[i]=null}catch(e){}}try{BX.unbindAll()}catch(e){}}if(window.attachEvent){window.attachEvent("onunload",Trash)}else{if(window.addEventListener){window.addEventListener("unload",Trash,false)}else{window.onunload=Trash}}BX(BX.DoNothing);window.BX=BX;BX.browser.addGlobalClass();BX.browser.addGlobalFeatures(["boxShadow","borderRadius","flexWrap","boxDirection","transition","transform"])})(window);(function(d){if(d.BX.ajax){return}var b=d.BX,g={},c={method:"GET",dataType:"html",timeout:0,async:true,processData:true,scriptsRunFirst:false,emulateOnload:true,skipAuthCheck:false,start:true,cache:true,preparePost:true,headers:false,lsTimeout:30,lsForce:false},f=null,e={},i=[],a={url_utf:/[^\034-\254]+/g,script_self:/\/bitrix\/js\/main\/core\/core(_ajax)*.js$/i,script_self_window:/\/bitrix\/js\/main\/core\/core_window.js$/i,script_self_admin:/\/bitrix\/js\/main\/core\/core_admin.js$/i,script_onload:/window.onload/g};b.ajax=function(j){var k,m;if(!j||!j.url||!b.type.isString(j.url)){return false}for(var n in g){if(typeof(j[n])=="undefined"){j[n]=g[n]}}g={};for(n in c){if(typeof(j[n])=="undefined"){j[n]=c[n]}}j.method=j.method.toUpperCase();if(!b.localStorage){j.lsId=null}if(b.browser.IsIE()){var s=a.url_utf.exec(j.url);if(s){do{j.url=j.url.replace(s,b.util.urlencode(s));s=a.url_utf.exec(j.url)}while(s)}}if(j.dataType=="json"){j.emulateOnload=false}if(!j.cache&&j.method=="GET"){j.url=b.ajax._uncache(j.url)}if(j.method=="POST"&&j.preparePost){j.data=b.ajax.prepareData(j.data)}var r=true;if(j.lsId&&!j.lsForce){var q=b.localStorage.get("ajax-"+j.lsId);if(q!==null){r=false;var o=function(u){if(u.key=="ajax-"+j.lsId&&u.value!="BXAJAXWAIT"){var v=u.value,t=!!u.oldValue&&v==null;if(!t){b.ajax.__run(j,v)}else{if(j.onfailure){j.onfailure("timeout")}}b.removeCustomEvent("onLocalStorageChange",o)}};if(q=="BXAJAXWAIT"){b.addCustomEvent("onLocalStorageChange",o)}else{setTimeout(function(){o({key:"ajax-"+j.lsId,value:q})},10)}}}if(r){j.xhr=b.ajax.xhr();if(!j.xhr){return}if(j.lsId){b.localStorage.set("ajax-"+j.lsId,"BXAJAXWAIT",j.lsTimeout)}j.xhr.open(j.method,j.url,j.async);if(!j.skipBxHeader&&!b.ajax.isCrossDomain(j.url)){j.xhr.setRequestHeader("Bx-ajax","true")}if(j.method=="POST"&&j.preparePost){j.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(typeof(j.headers)=="object"){for(n=0;n<j.headers.length;n++){j.xhr.setRequestHeader(j.headers[n].name,j.headers[n].value)}}var l=false;var p=j.xhr.onreadystatechange=function(t){if(l){return}if(t==="timeout"){if(j.onfailure){j.onfailure("timeout")}b.onCustomEvent(j.xhr,"onAjaxFailure",["timeout","",j]);j.xhr.onreadystatechange=b.DoNothing;j.xhr.abort();if(j.async){j.xhr=null}}else{if(j.xhr.readyState==4||t=="run"){k=b.ajax.xhrSuccess(j.xhr)?"success":"error";l=true;j.xhr.onreadystatechange=b.DoNothing;if(k=="success"){var u=(!!j.skipAuthCheck||b.ajax.isCrossDomain(j.url))?false:j.xhr.getResponseHeader("X-Bitrix-Ajax-Status");if(!!u&&u=="Authorize"){if(j.onfailure){j.onfailure("auth",j.xhr.status)}b.onCustomEvent(j.xhr,"onAjaxFailure",["auth",j.xhr.status,j])}else{var v=j.xhr.responseText;if(j.lsId){b.localStorage.set("ajax-"+j.lsId,v,j.lsTimeout)}b.ajax.__run(j,v)}}else{if(j.onfailure){j.onfailure("status",j.xhr.status)}b.onCustomEvent(j.xhr,"onAjaxFailure",["status",j.xhr.status,j])}if(j.async){j.xhr=null}}}};if(j.async&&j.timeout>0){setTimeout(function(){if(j.xhr&&!l){p("timeout")}},j.timeout*1000)}if(j.start){j.xhr.send(j.data);if(!j.async){p("run")}}return j.xhr}};b.ajax.xhr=function(){if(d.XMLHttpRequest){try{return new XMLHttpRequest()}catch(j){}}else{if(d.ActiveXObject){try{return new d.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(j){}try{return new d.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(j){}try{return new d.ActiveXObject("Msxml2.XMLHTTP")}catch(j){}try{return new d.ActiveXObject("Microsoft.XMLHTTP")}catch(j){}throw new Error("This browser does not support XMLHttpRequest.")}}return null};b.ajax.isCrossDomain=function(k,j){j=j||d.location;if(k.indexOf("//")===0){k=j.protocol+k}if(k.indexOf("http")!==0){return false}var l=d.document.createElement("a");l.href=k;return l.protocol!==j.protocol||l.hostname!==j.hostname||b.ajax.getHostPort(l.protocol,l.host)!==b.ajax.getHostPort(j.protocol,j.host)};b.ajax.getHostPort=function(l,k){var j=/:(\d+)$/.exec(k);if(j){return j[1]}else{if(l==="http:"){return"80"}else{if(l==="https:"){return"443"}}}return""};b.ajax.__prepareOnload=function(k){if(k.length>0){b.ajax["onload_"+f]=null;for(var l=0,j=k.length;l<j;l++){if(k[l].isInternal){k[l].JS=k[l].JS.replace(a.script_onload,"BX.ajax.onload_"+f)}}}b.CaptureEventsGet();b.CaptureEvents(d,"load")};b.ajax.__runOnload=function(){if(null!=b.ajax["onload_"+f]){b.ajax["onload_"+f].apply(d);b.ajax["onload_"+f]=null}var k=b.CaptureEventsGet();if(k){for(var j=0;j<k.length;j++){k[j].apply(d)}}};b.ajax.__run=function(j,k){if(!j.processData){if(j.onsuccess){j.onsuccess(k)}b.onCustomEvent(j.xhr,"onAjaxSuccess",[k,j])}else{k=b.ajax.processRequestData(k,j)}};b.ajax._onParseJSONFailure=function(j){this.jsonFailure=true;this.jsonResponse=j;this.jsonProactive=/^\[WAF\]/.test(j)};b.ajax.processRequestData=function(n,k){var r,m=[],q=[];switch(k.dataType.toUpperCase()){case"JSON":b.addCustomEvent(k.xhr,"onParseJSONFailure",b.proxy(b.ajax._onParseJSONFailure,k));r=b.parseJSON(n,k.xhr);b.removeCustomEvent(k.xhr,"onParseJSONFailure",b.proxy(b.ajax._onParseJSONFailure,k));break;case"SCRIPT":m.push({isInternal:true,JS:n,bRunFirst:k.scriptsRunFirst});k.processScriptsConsecutive=true;r=n;break;default:var j=b.processHTML(n,k.scriptsRunFirst);r=j.HTML;m=j.SCRIPT;q=j.STYLE;break}var p=false;if(null==f){f=parseInt(Math.random()*1000000);p=true}if(q.length>0){b.loadCSS(q)}if(k.emulateOnload){b.ajax.__prepareOnload(m)}var l=b.DoNothing;if(k.emulateOnload||p){l=b.defer(function(){if(k.emulateOnload){b.ajax.__runOnload()}if(p){f=null}b.onCustomEvent(k.xhr,"onAjaxSuccessFinish",[k])})}try{if(!!k.jsonFailure){throw {type:"json_failure",data:k.jsonResponse,bProactive:k.jsonProactive}}k.scripts=m;b.ajax.processScripts(k.scripts,true);if(k.onsuccess){k.onsuccess(r)}b.onCustomEvent(k.xhr,"onAjaxSuccess",[r,k]);if(!k.processScriptsConsecutive){b.ajax.processScripts(k.scripts,false,l)}else{b.ajax.processScriptsConsecutive(k.scripts,false);l()}}catch(o){if(k.onfailure){k.onfailure("processing",o)}b.onCustomEvent(k.xhr,"onAjaxFailure",["processing",o,k])}};b.ajax.processScripts=function(q,j,p){var k=[],r="";p=p||b.DoNothing;for(var s=0,m=q.length;s<m;s++){if(typeof j!="undefined"&&j!=!!q[s].bRunFirst){continue}if(q[s].isInternal){r+=";"+q[s].JS}else{k.push(q[s].JS)}}k=b.util.array_unique(k);var o=k.length;var n=o;var t=r.length>0?function(){b.evalGlobal(r)}:b.DoNothing;if(o>0){var u=function(){if(--n<=0){t();p();t=b.DoNothing}};for(s=0;s<o;s++){b.loadScript(k[s],u)}}else{t();p()}};b.ajax.processScriptsConsecutive=function(j,m){for(var k=0,l=j.length;k<l;k++){if(null!=m&&m!=!!j[k].bRunFirst){continue}if(j[k].isInternal){b.evalGlobal(j[k].JS)}else{b.ajax.loadScriptAjax([j[k].JS])}}};b.ajax.prepareData=function(n,m){var l="";if(b.type.isString(n)){l=n}else{if(null!=n){for(var k in n){if(n.hasOwnProperty(k)){if(l.length>0){l+="&"}var j=b.util.urlencode(k);if(m){j=m+"["+j+"]"}if(typeof n[k]=="object"){l+=b.ajax.prepareData(n[k],j)}else{l+=j+"="+b.util.urlencode(n[k])}}}}}return l};b.ajax.xhrSuccess=function(j){return(j.status>=200&&j.status<300)||j.status===304||j.status===1223||j.status===0};b.ajax.Setup=function(j,l){l=!!l;for(var k in j){if(l){g[k]=j[k]}else{c[k]=j[k]}}};b.ajax.replaceLocalStorageValue=function(l,k,j){if(!!b.localStorage){b.localStorage.set("ajax-"+l,k,j)}};b.ajax._uncache=function(j){return j+((j.indexOf("?")!==-1?"&":"?")+"_="+(new Date()).getTime())};b.ajax.get=function(j,k,l){if(b.type.isFunction(k)){l=k;k=""}k=b.ajax.prepareData(k);if(k){j+=(j.indexOf("?")!==-1?"&":"?")+k;k=""}return b.ajax({method:"GET",dataType:"html",url:j,data:"",onsuccess:l})};b.ajax.getCaptcha=function(j){return b.ajax.loadJSON("/bitrix/tools/ajax_captcha.php",j)};b.ajax.insertToNode=function(k,l){l=b(l);if(!!l){b.onCustomEvent("onAjaxInsertToNode",[{url:k,node:l}]);var j=null;if(!g.denyShowWait){j=b.showWait(l);delete g.denyShowWait}return b.ajax.get(k,function(m){l.innerHTML=m;b.closeWait(l,j)})}};b.ajax.post=function(j,k,l){k=b.ajax.prepareData(k);return b.ajax({method:"POST",dataType:"html",url:j,data:k,onsuccess:l})};b.ajax.loadScriptAjax=function(m,o,n){if(b.type.isArray(m)){for(var l=0,k=m.length;l<k;l++){b.ajax.loadScriptAjax(m[l],o,n)}}else{var j=m.replace(/\.js\?.*/,".js");if(a.script_self.test(j)){return}if(a.script_self_window.test(j)&&b.CWindow){return}if(a.script_self_admin.test(j)&&b.admin){return}if(typeof e[j]=="undefined"){if(!!n){e[j]="";return b.loadScript(m)}else{return b.ajax({url:m,method:"GET",dataType:"script",processData:true,emulateOnload:false,scriptsRunFirst:true,async:false,start:true,onsuccess:function(p){e[j]=p;if(o){o(p)}}})}}else{if(o){o(e[j])}}}};b.ajax.loadJSON=function(k,l,m,j){if(b.type.isFunction(l)){j=m;m=l;l=""}l=b.ajax.prepareData(l);if(l){k+=(k.indexOf("?")!==-1?"&":"?")+l;l=""}return b.ajax({method:"GET",dataType:"json",url:k,onsuccess:m,onfailure:j})};b.ajax.load=function(m,o){if(!b.type.isArray(m)){m=[m]}var l=0;if(!b.type.isFunction(o)){o=b.DoNothing}var n=function(p){if(b.type.isFunction(this.callback)){this.callback(p)}if(++l>=j){o()}};for(var k=0,j=m.length;k<j;k++){switch(m[k].type.toUpperCase()){case"SCRIPT":b.loadScript([m[k].url],b.proxy(n,m[k]));break;case"CSS":b.loadCSS([m[k].url]);if(++l>=j){o()}break;case"JSON":b.ajax.loadJSON(m[k].url,b.proxy(n,m[k]));break;default:b.ajax.get(m[k].url,"",b.proxy(n,m[k]));break}}};b.ajax.submit=function(k,l){if(!k.target){if(null==k.BXFormTarget){var j="formTarget_"+Math.random();k.BXFormTarget=document.body.appendChild(b.create("IFRAME",{props:{name:j,id:j,src:"javascript:void(0)"},style:{display:"none"}}))}k.target=k.BXFormTarget.name}k.BXFormCallback=l;b.bind(k.BXFormTarget,"load",b.proxy(b.ajax._submit_callback,k));b.submit(k);return false};b.ajax.submitComponentForm=function(m,k,n){if(!m.target){if(null==m.BXFormTarget){var l="formTarget_"+Math.random();m.BXFormTarget=document.body.appendChild(b.create("IFRAME",{props:{name:l,id:l,src:"javascript:void(0)"},style:{display:"none"}}))}m.target=m.BXFormTarget.name}if(!!n){var j=b.showWait(k)}m.BXFormCallback=function(o){if(!!n){b.closeWait(j)}var p=function(){if(!!d.bxcompajaxframeonload){setTimeout(function(){d.bxcompajaxframeonload();d.bxcompajaxframeonload=null},10)}};b(k).innerHTML=o;b.onCustomEvent("onAjaxSuccess",[null,null,p])};b.bind(m.BXFormTarget,"load",b.proxy(b.ajax._submit_callback,m));return true};b.ajax._submit_callback=function(){try{if(this.BXFormTarget.contentWindow.location.href.indexOf("http")!=0){return}}catch(j){return}if(this.BXFormCallback){this.BXFormCallback.apply(this,[this.BXFormTarget.contentWindow.document.body.innerHTML])}b.unbindAll(this.BXFormTarget)};b.ajax.prepareForm=function(A,w){w=(!!w?w:{});var x,z,s,t=[],u=A.elements.length,l=0,r=0;if(!!A){for(x=0;x<u;x++){s=A.elements[x];if(s.disabled){continue}switch(s.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":case"select-one":t.push({name:s.name,value:s.value});r+=(s.name.length+s.value.length);break;case"file":if(!!s.files){for(z=0;z<s.files.length;z++){l++;t.push({name:s.name,value:s.files[z],file:true});r+=s.files[z].size}}break;case"radio":case"checkbox":if(s.checked){t.push({name:s.name,value:s.value});r+=(s.name.length+s.value.length)}break;case"select-multiple":for(var v=0;v<s.options.length;v++){if(s.options[v].selected){t.push({name:s.name,value:s.options[v].value});r+=(s.name.length+s.options[v].length)}}break;default:break}}x=0;r=0;var y=w;while(x<t.length){var m=t[x].name.indexOf("[");if(m==-1){y[t[x].name]=t[x].value;y=w;x++}else{var k=t[x].name.substring(0,m);var q=t[x].name.substring(m+1);if(!y[k]){y[k]=[]}var o=q.indexOf("]");if(o==-1){y=w;x++}else{if(o==0){y=y[k];t[x].name=""+y.length}else{y=y[k];t[x].name=q.substring(0,o)+q.substring(o+1)}}}}}return{data:w,filesCount:l,roughSize:r}};b.ajax.submitAjax=function(o,j){j=(!!j&&typeof j=="object"?j:{});j.url=(j.url||o.getAttribute("action"));j.data=b.ajax.prepareForm(o).data;if(!d.FormData){b.ajax(j)}else{var m=function(q,p,s){if(!!s&&typeof s=="object"){for(var r in s){if(s.hasOwnProperty(r)){m(q,(p==""?r:p+"["+r+"]"),s[r])}}}else{q.append(p,(!!s?s:""))}},l=function(s){var r={};if(null!=s){if(typeof s=="object"){for(var q in s){if(s.hasOwnProperty(q)){var p=b.util.urlencode(q);if(typeof s[q]=="object"&&s[q]["file"]!==true){r[p]=l(s[q])}else{r[p]=b.util.urlencode(s[q])}}}}else{r=b.util.urlencode(s)}}return r},k=new d.FormData();if(j.method!=="POST"){j.data=b.ajax.prepareData(j.data);if(j.data){j.url+=(j.url.indexOf("?")!==-1?"&":"?")+j.data;j.data=""}}else{if(j.preparePost===true){j.data=l(j.data)}m(k,"",j.data);j.data=k}j.preparePost=false;j.start=false;var n=b.ajax(j);if(!!j.onprogress){n.upload.addEventListener("progress",function(q){var p=null;if(q.lengthComputable&&(q.total||q.totalSize)){p=q.loaded*100/(q.total||q.totalSize)}j.onprogress(q,p)})}n.send(k)}};b.ajax.UpdatePageData=function(l){if(l.TITLE){b.ajax.UpdatePageTitle(l.TITLE)}if(l.WINDOW_TITLE||l.TITLE){b.ajax.UpdateWindowTitle(l.WINDOW_TITLE||l.TITLE)}if(l.NAV_CHAIN){b.ajax.UpdatePageNavChain(l.NAV_CHAIN)}if(l.CSS&&l.CSS.length>0){b.loadCSS(l.CSS)}if(l.SCRIPTS&&l.SCRIPTS.length>0){var k=function(n,p,m){if(!!p&&b.type.isArray(p.scripts)){for(var q=0,o=l.SCRIPTS.length;q<o;q++){p.scripts.push({isInternal:false,JS:l.SCRIPTS[q]})}}else{b.loadScript(l.SCRIPTS,m)}b.removeCustomEvent("onAjaxSuccess",k)};b.addCustomEvent("onAjaxSuccess",k)}else{var j=function(n,o,m){if(b.type.isFunction(m)){m()}b.removeCustomEvent("onAjaxSuccess",j)};b.addCustomEvent("onAjaxSuccess",j)}};b.ajax.UpdatePageTitle=function(k){var j=b("pagetitle");if(j){j.removeChild(j.firstChild);if(!j.firstChild){j.appendChild(document.createTextNode(k))}else{j.insertBefore(document.createTextNode(k),j.firstChild)}}};b.ajax.UpdateWindowTitle=function(j){document.title=j};b.ajax.UpdatePageNavChain=function(j){var k=b("navigation");if(k){k.innerHTML=j}};b.userOptions={options:null,bSend:false,delay:5000,path:"/bitrix/admin/user_options.php?"};b.userOptions.setAjaxPath=function(j){b.userOptions.path=j.indexOf("?")==-1?j+"?":j+"&"};b.userOptions.save=function(n,o,m,k,l){if(null==b.userOptions.options){b.userOptions.options={}}l=!!l;b.userOptions.options[n+"."+o+"."+m]=[n,o,m,k,l];var j=b.userOptions.__get();if(j!=""){document.cookie=b.message("COOKIE_PREFIX")+"_LAST_SETTINGS="+j+"&sessid="+b.bitrix_sessid()+"; expires=Thu, 31 Dec 2020 23:59:59 GMT; path=/;"}if(!b.userOptions.bSend){b.userOptions.bSend=true;setTimeout(function(){b.userOptions.send(null)},b.userOptions.delay)}};b.userOptions.send=function(k){var j=b.userOptions.__get();b.userOptions.options=null;b.userOptions.bSend=false;if(j!=""){document.cookie=b.message("COOKIE_PREFIX")+"_LAST_SETTINGS=; path=/;";b.ajax({method:"GET",dataType:"html",processData:false,cache:false,url:b.userOptions.path+j+"&sessid="+b.bitrix_sessid(),onsuccess:k})}};b.userOptions.del=function(k,l,j,m){b.ajax.get(b.userOptions.path+"action=delete&c="+k+"&n="+l+(j==true?"&common=Y":"")+"&sessid="+b.bitrix_sessid(),m)};b.userOptions.__get=function(){if(!b.userOptions.options){return""}var j="",o=-1,m="",l,k;for(k in b.userOptions.options){if(b.userOptions.options.hasOwnProperty(k)){l=b.userOptions.options[k];if(m!=l[0]+"."+l[1]){o++;j+="&p["+o+"][c]="+b.util.urlencode(l[0]);j+="&p["+o+"][n]="+b.util.urlencode(l[1]);if(l[4]==true){j+="&p["+o+"][d]=Y"}m=l[0]+"."+l[1]}j+="&p["+o+"][v]["+b.util.urlencode(l[2])+"]="+b.util.urlencode(l[3])}}return j.substr(1)};b.ajax.history={expected_hash:"",obParams:null,obFrame:null,obImage:null,obTimer:null,bInited:false,bHashCollision:false,bPushState:!!(history.pushState&&b.type.isFunction(history.pushState)),startState:null,init:function(j){if(b.ajax.history.bInited){return}this.obParams=j;var k=this.obParams.getState();if(b.ajax.history.bPushState){b.ajax.history.expected_hash=d.location.pathname;if(d.location.search){b.ajax.history.expected_hash+=d.location.search}b.ajax.history.put(k,b.ajax.history.expected_hash,"",true);setTimeout(function(){b.bind(d,"popstate",b.ajax.history.__hashListener)},500)}else{b.ajax.history.expected_hash=d.location.hash;if(!b.ajax.history.expected_hash||b.ajax.history.expected_hash=="#"){b.ajax.history.expected_hash="__bx_no_hash__"}h.put(b.ajax.history.expected_hash,k);b.ajax.history.obTimer=setTimeout(b.ajax.history.__hashListener,500);if(b.browser.IsIE()){b.ajax.history.obFrame=document.createElement("IFRAME");b.hide_object(b.ajax.history.obFrame);document.body.appendChild(b.ajax.history.obFrame);b.ajax.history.obFrame.contentWindow.document.open();b.ajax.history.obFrame.contentWindow.document.write(b.ajax.history.expected_hash);b.ajax.history.obFrame.contentWindow.document.close()}else{if(b.browser.IsOpera()){b.ajax.history.obImage=document.createElement("IMG");b.hide_object(b.ajax.history.obImage);document.body.appendChild(b.ajax.history.obImage);b.ajax.history.obImage.setAttribute("src","javascript:location.href = 'javascript:BX.ajax.history.__hashListener();';")}}}b.ajax.history.bInited=true},__hashListener:function(l){l=l||d.event||{state:false};if(b.ajax.history.bPushState){b.ajax.history.obParams.setState(l.state||b.ajax.history.startState)}else{if(b.ajax.history.obTimer){d.clearTimeout(b.ajax.history.obTimer);b.ajax.history.obTimer=null}var m;if(null!=b.ajax.history.obFrame){m=b.ajax.history.obFrame.contentWindow.document.body.innerText}else{m=d.location.hash}if(!m||m=="#"){m="__bx_no_hash__"}if(m.indexOf("#")==0){m=m.substring(1)}if(m!=b.ajax.history.expected_hash){var k=h.get(m);if(k){b.ajax.history.obParams.setState(k);b.ajax.history.expected_hash=m;if(null!=b.ajax.history.obFrame){var j=m=="__bx_no_hash__"?"":m;if(d.location.hash!=j&&d.location.hash!="#"+j){d.location.hash=j}}}}b.ajax.history.obTimer=setTimeout(b.ajax.history.__hashListener,500)}},put:function(m,j,l,k){if(this.bPushState){if(!k){history.pushState(m,"",j)}else{b.ajax.history.startState=m}}else{if(typeof l!="undefined"){j=l}else{j="view"+j}h.put(j,m);b.ajax.history.expected_hash=j;d.location.hash=b.util.urlencode(j);if(null!=b.ajax.history.obFrame){b.ajax.history.obFrame.contentWindow.document.open();b.ajax.history.obFrame.contentWindow.document.write(j);b.ajax.history.obFrame.contentWindow.document.close()}}},checkRedirectStart:function(j,l){var k=d.location.hash;if(k.substring(0,1)=="#"){k=k.substring(1)}var m=k.substring(0,5);if(m=="view/"||m=="view%"){b.ajax.history.bHashCollision=true;document.write('<div id="__ajax_hash_collision_'+l+'" style="display: none;">')}},checkRedirectFinish:function(j,l){document.write("</div>");var k=d.location.hash;if(k.substring(0,1)=="#"){k=k.substring(1)}b.ready(function(){var p=k.substring(0,5);if(p=="view/"||p=="view%"){var n=b("__ajax_hash_collision_"+l);var o=n.firstChild;b.cleanNode(o);n.style.display="block";if(p!="view%"){k=b.util.urlencode(k)}k+=(k.indexOf("%3F")==-1?"%3F":"%26")+j+"="+l;var m="/bitrix/tools/ajax_redirector.php?hash="+k;b.ajax.insertToNode(m,o)}})}};b.ajax.component=function(j){this.node=j};b.ajax.component.prototype.getState=function(){var j={node:this.node,title:d.document.title,data:b(this.node).innerHTML};var k=b("navigation");if(null!=k){j.nav_chain=k.innerHTML}return j};b.ajax.component.prototype.setState=function(j){b(j.node).innerHTML=j.data;b.ajax.UpdatePageTitle(j.title);if(j.nav_chain){b.ajax.UpdatePageNavChain(j.nav_chain)}};var h={arHistory:{},put:function(k,j){this.arHistory[k]=j},get:function(j){return this.arHistory[j]}};b.ajax.FormData=function(){this.elements=[];this.files=[];this.features={};this.isSupported();this.log("BX FormData init")};b.ajax.FormData.isSupported=function(){var k=new b.ajax.FormData();var j=k.features.supported;k=null;return j};b.ajax.FormData.prototype.log=function(k){if(false){try{if(b.browser.IsIE()){k=JSON.stringify(k)}console.log(k)}catch(j){}}};b.ajax.FormData.prototype.isSupported=function(){var j={};j.fileReader=(d.FileReader&&d.FileReader.prototype.readAsBinaryString);j.readFormData=j.sendFormData=!!(d.FormData);j.supported=!!(j.readFormData&&j.sendFormData);this.features=j;this.log("features:");this.log(j);return j.supported};b.ajax.FormData.prototype.append=function(j,k){if(typeof(k)==="object"){this.files.push({name:j,value:k})}else{this.elements.push({name:j,value:k})}};b.ajax.FormData.prototype.send=function(k,j,n,o){this.log("FD send");this.xhr=b.ajax({method:"POST",dataType:"html",url:k,onsuccess:j,onfailure:o,start:false,preparePost:false});if(n){this.xhr.upload.addEventListener("progress",function(p){if(p.lengthComputable){n(p.loaded/(p.total||p.totalSize))}},false)}if(this.features.readFormData&&this.features.sendFormData){var m=new FormData();this.log("use browser formdata");for(var l in this.elements){if(this.elements.hasOwnProperty(l)){m.append(this.elements[l].name,this.elements[l].value)}}for(l in this.files){if(this.files.hasOwnProperty(l)){m.append(this.files[l].name,this.files[l].value)}}this.xhr.send(m)}return this.xhr};b.addCustomEvent("onAjaxFailure",b.debug)})(window);var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(f){if(f.BX.localStorage){return}var c=f.BX,g=null,j=null,a="_bxCurrentKey",h=false;c.localStorage=function(){this.keyChanges={};c.bind((c.browser.IsIE()&&!c.browser.IsIE9())?document:f,"storage",c.proxy(this._onchange,this));setInterval(c.delegate(this._clear,this),5000)};c.localStorage.checkBrowser=function(){return h};c.localStorage.set=function(k,l,e){return c.localStorage.instance().set(k,l,e)};c.localStorage.get=function(e){return c.localStorage.instance().get(e)};c.localStorage.remove=function(e){return c.localStorage.instance().remove(e)};c.localStorage.instance=function(){if(!g){var e=c.localStorage.checkBrowser();if(e=="native"){g=new c.localStorage()}else{if(e=="ie8"){g=new c.localStorageIE8()}else{if(e=="ie7"){g=new c.localStorageIE7()}else{g={set:c.DoNothing,get:function(){return null},remove:c.DoNothing}}}}}return g};c.localStorage.prototype.prefix=function(){if(!j){j="bx"+c.message("USER_ID")+"-"+(c.message("SITE_ID")||"admin")+"-"}return j};c.localStorage.prototype._onchange=function(k){k=k||f.event;if(!k.key){return}if(c.browser.DetectIeVersion()>0&&this.keyChanges[k.key]){this.keyChanges[k.key]=false;return}if(!!k.key&&k.key.substring(0,this.prefix().length)==this.prefix()){var l={key:k.key.substring(this.prefix().length,k.key.length),value:!!k.newValue?this._decode(k.newValue.substring(11,k.newValue.length)):null,oldValue:!!k.oldValue?this._decode(k.oldValue.substring(11,k.oldValue.length)):null};switch(l.key){case"BXGCE":if(l.value){c.onCustomEvent(l.value.e,l.value.p)}break;default:if(k.newValue){c.onCustomEvent(f,"onLocalStorageSet",[l])}if(k.oldValue&&!k.newValue){c.onCustomEvent(f,"onLocalStorageRemove",[l])}c.onCustomEvent(f,"onLocalStorageChange",[l]);break}}};c.localStorage.prototype._clear=function(){var k=+new Date(),m,l;for(l=0;l<localStorage.length;l++){m=localStorage.key(l);if(m.substring(0,2)=="bx"){var e=localStorage.getItem(m).split(":",1)*1000;if(k>=e){localStorage.removeItem(m)}}}};c.localStorage.prototype._encode=function(e){if(typeof(e)=="object"){e=JSON.stringify(e)}else{e=e.toString()}return e};c.localStorage.prototype._decode=function(l){var k=null;if(!!l){try{k=JSON.parse(l)}catch(m){k=l}}return k};c.localStorage.prototype._trigger_error=function(n,l,m,k){c.onCustomEvent(this,"onLocalStorageError",[n,{key:l,value:m,ttl:k}])};c.localStorage.prototype.set=function(l,m,k){if(!k||k<=0){k=60}if(l==undefined||l==null||m==undefined){return false}this.keyChanges[this.prefix()+l]=true;try{localStorage.setItem(this.prefix()+l,(Math.round((+new Date())/1000)+k)+":"+this._encode(m))}catch(n){this._trigger_error(n,l,m,k)}};c.localStorage.prototype.get=function(k){var l=localStorage.getItem(this.prefix()+k);if(l){var e=l.split(":",1)*1000;if((+new Date())<=e){l=l.substring(11,l.length);return this._decode(l)}}return null};c.localStorage.prototype.remove=function(e){this.keyChanges[this.prefix()+e]=true;localStorage.removeItem(this.prefix()+e)};c.localStorageIE7=function(){this.NS="BXLocalStorage";this.__current_state={};this.keyChanges={};c.ready(c.delegate(this._Init,this))};c.extend(c.localStorageIE7,c.localStorage);c.localStorageIE7.prototype._Init=function(){this.storage_element=document.body.appendChild(c.create("DIV"));this.storage_element.addBehavior("#default#userData");this.storage_element.load(this.NS);var n=this.storage_element.xmlDocument,e=n.firstChild.attributes.length;for(var m=0;m<e;m++){if(!!n.firstChild.attributes[m]){var l=n.firstChild.attributes[m].nodeName;if(l.substring(0,this.prefix().length)==this.prefix()){this.__current_state[l]=n.firstChild.attributes[m].nodeValue}}}setInterval(c.delegate(this._Listener,this),500);setInterval(c.delegate(this._clear,this),5000)};c.localStorageIE7.prototype._Listener=function(l){this.storage_element.load(this.NS);var r=this.storage_element.xmlDocument,e=r.firstChild.attributes.length,q,o,n;var p={},m=[];for(q=0;q<e;q++){if(!!r.firstChild.attributes[q]){o=r.firstChild.attributes[q].nodeName;if(o.substring(0,this.prefix().length)==this.prefix()){n=r.firstChild.attributes[q].nodeValue;if(this.__current_state[o]!=n){m.push({key:o,newValue:n,oldValue:this.__current_state[o]})}p[o]=n;delete this.__current_state[o]}}}for(q in this.__current_state){if(this.__current_state.hasOwnProperty(q)){m.push({key:q,newValue:undefined,oldValue:this.__current_state[q]})}}this.__current_state=p;for(q=0;q<m.length;q++){this._onchange(m[q])}};c.localStorageIE7.prototype._clear=function(){this.storage_element.load(this.NS);var q=this.storage_element.xmlDocument,l=q.firstChild.attributes.length,o=+new Date(),p,n,m,e;for(p=0;p<l;p++){if(!!q.firstChild.attributes[p]){n=q.firstChild.attributes[p].nodeName;if(n.substring(0,2)=="bx"){m=q.firstChild.attributes[p].nodeValue;e=m.split(":",1)*1000;if(o>=e){q.firstChild.removeAttribute(n)}}}}this.storage_element.save(this.NS)};c.localStorageIE7.prototype.set=function(l,m,k){if(!k||k<=0){k=60}try{this.storage_element.load(this.NS);var o=this.storage_element.xmlDocument;this.keyChanges[this.prefix()+l]=true;o.firstChild.setAttribute(this.prefix()+l,(Math.round((+new Date())/1000)+k)+":"+this._encode(m));this.storage_element.save(this.NS)}catch(n){this._trigger_error(n,l,m,k)}};c.localStorageIE7.prototype.get=function(k){this.storage_element.load(this.NS);var m=this.storage_element.xmlDocument;var l=m.firstChild.getAttribute(this.prefix()+k);if(l){var e=l.split(":",1)*1000;if((+new Date())<=e){l=l.substring(11,l.length);return this._decode(l)}}return null};c.localStorageIE7.prototype.remove=function(e){this.storage_element.load(this.NS);var k=this.storage_element.xmlDocument;k.firstChild.removeAttribute(this.prefix()+e);this.keyChanges[this.prefix()+e]=true;this.storage_element.save(this.NS)};c.localStorageIE8=function(){this.key=a;this.currentKey=null;this.currentValue=null;c.localStorageIE8.superclass.constructor.apply(this)};c.extend(c.localStorageIE8,c.localStorage);c.localStorageIE8.prototype._onchange=function(k){if(null==this.currentKey){this.currentKey=localStorage.getItem(this.key);if(this.currentKey){this.currentValue=localStorage.getItem(this.prefix()+this.currentKey)}}else{k={key:this.prefix()+this.currentKey,newValue:localStorage.getItem(this.prefix()+this.currentKey),oldValue:this.currentValue};this.currentKey=null;this.currentValue=null;if(this.keyChanges[k.key]){this.keyChanges[k.key]=false;return}c.localStorageIE8.superclass._onchange.apply(this,[k])}};c.localStorageIE8.prototype.set=function(l,m,k){this.currentKey=null;this.keyChanges[this.prefix()+l]=true;try{localStorage.setItem(this.key,l);c.localStorageIE8.superclass.set.apply(this,arguments)}catch(n){this._trigger_error(n,l,m,k)}};c.localStorageIE8.prototype.remove=function(e){this.currentKey=null;this.keyChanges[this.prefix()+e]=true;localStorage.setItem(this.key,e);c.localStorageIE8.superclass.remove.apply(this,arguments)};c.onGlobalCustomEvent=function(l,e,k){if(!!c.localStorage.checkBrowser()){c.localStorage.set("BXGCE",{e:l,p:e},1)}if(!k){c.onCustomEvent(l,e)}};try{h=!!localStorage.setItem}catch(d){}if(h){h="native";var b=(c.browser.IsIE()&&!c.browser.IsIE9())?document:f,i=function(k){if(typeof(k||f.event).key=="undefined"){h="ie8"}c.unbind(b,"storage",i);c.localStorage.instance()};c.bind(b,"storage",i);localStorage.setItem(a,null)}else{if(c.browser.IsIE7()){h="ie7";c.localStorage.instance()}}})(window);(function(c){var a={time:1,step:0.05,type:"linear",allowFloat:false};BX.fx=function(d){this.options=d;if(null!=this.options.time){this.options.originalTime=this.options.time}if(null!=this.options.step){this.options.originalStep=this.options.step}if(!this.__checkOptions()){return false}this.__go=BX.delegate(this.go,this);this.PARAMS={}};BX.fx.prototype.__checkOptions=function(){if(typeof this.options.start!=typeof this.options.finish){return false}if(null==this.options.time){this.options.time=a.time}if(null==this.options.step){this.options.step=a.step}if(null==this.options.type){this.options.type=a.type}if(null==this.options.allowFloat){this.options.allowFloat=a.allowFloat}this.options.time*=1000;this.options.step*=1000;if(typeof this.options.start!="object"){this.options.start={_param:this.options.start};this.options.finish={_param:this.options.finish}}var d;for(d in this.options.start){if(null==this.options.finish[d]){this.options.start[d]=null;delete this.options.start[d]}}if(!BX.type.isFunction(this.options.type)){if(BX.type.isFunction(c[this.options.type])){this.options.type=c[this.options.type]}else{if(BX.type.isFunction(BX.fx.RULES[this.options.type])){this.options.type=BX.fx.RULES[this.options.type]}else{this.options.type=BX.fx.RULES[a.type]}}}return true};BX.fx.prototype.go=function(){var d=new Date().valueOf();if(d<this.PARAMS.timeFinish){for(var e in this.PARAMS.current){this.PARAMS.current[e][0]=this.options.type.apply(this,[{start_value:this.PARAMS.start[e][0],finish_value:this.PARAMS.finish[e][0],current_value:this.PARAMS.current[e][0],current_time:d-this.PARAMS.timeStart,total_time:this.options.time}])}this._callback(this.options.callback);if(!this.paused){this.PARAMS.timer=setTimeout(this.__go,this.options.step)}}else{this.stop()}};BX.fx.prototype._callback=function(d){var f={};d=d||this.options.callback;for(var e in this.PARAMS.current){f[e]=(this.options.allowFloat?this.PARAMS.current[e][0]:Math.round(this.PARAMS.current[e][0]))+this.PARAMS.current[e][1]}return d.apply(this,[null!=f._param?f._param:f])};BX.fx.prototype.start=function(){var d,f,e;this.PARAMS.start={};this.PARAMS.current={};this.PARAMS.finish={};for(d in this.options.start){f=+this.options.start[d];e=(this.options.start[d]+"").substring((f+"").length);this.PARAMS.start[d]=[f,e];this.PARAMS.current[d]=[f,e];this.PARAMS.finish[d]=[+this.options.finish[d],e]}this._callback(this.options.callback_start);this._callback(this.options.callback);this.PARAMS.timeStart=new Date().valueOf();this.PARAMS.timeFinish=this.PARAMS.timeStart+this.options.time;this.PARAMS.timer=setTimeout(BX.delegate(this.go,this),this.options.step);return this};BX.fx.prototype.pause=function(){if(this.paused){this.PARAMS.timer=setTimeout(this.__go,this.options.step);this.paused=false}else{clearTimeout(this.PARAMS.timer);this.paused=true}};BX.fx.prototype.stop=function(d){d=!!d;if(this.PARAMS.timer){clearTimeout(this.PARAMS.timer)}if(null!=this.options.originalTime){this.options.time=this.options.originalTime}if(null!=this.options.originalStep){this.options.step=this.options.originalStep}this.PARAMS.current=this.PARAMS.finish;if(!d){this._callback(this.options.callback);this._callback(this.options.callback_complete)}};BX.fx.RULES={linear:function(d){return d.start_value+(d.current_time/d.total_time)*(d.finish_value-d.start_value)},decelerated:function(d){return d.start_value+Math.sqrt(d.current_time/d.total_time)*(d.finish_value-d.start_value)},accelerated:function(e){var d=e.current_time/e.total_time;return e.start_value+d*d*(e.finish_value-e.start_value)}};BX.fx.hide=function(e,d,g){e=BX(e);if(typeof d=="object"&&null==g){g=d;d=g.type}if(!BX.type.isNotEmptyString(d)){e.style.display="none";return}var f=BX.fx.EFFECTS[d](e,g,0);f.callback_complete=function(){if(g.hide!==false){e.style.display="none"}if(g.callback_complete){g.callback_complete.apply(this,arguments)}};return(new BX.fx(f)).start()};BX.fx.show=function(e,d,g){e=BX(e);if(typeof d=="object"&&null==g){g=d;d=g.type}if(!g){g={}}if(!BX.type.isNotEmptyString(d)){e.style.display="block";return}var f=BX.fx.EFFECTS[d](e,g,1);f.callback_complete=function(){if(g.show!==false){e.style.display="block"}if(g.callback_complete){g.callback_complete.apply(this,arguments)}};return(new BX.fx(f)).start()};BX.fx.EFFECTS={scroll:function(e,f,g){if(!f.direction){f.direction="vertical"}var i=f.direction=="horizontal"?"width":"height";var h=parseInt(BX.style(e,i));if(isNaN(h)){h=BX.pos(e)[i]}if(g==0){var j=h,d=f.min_height?parseInt(f.min_height):0}else{var d=h,j=f.min_height?parseInt(f.min_height):0}return{start:j,finish:d,time:f.time||a.time,type:"linear",callback_start:function(){if(BX.style(e,"position")=="static"){e.style.position="relative"}e.style.overflow="hidden";e.style[i]=j+"px";e.style.display="block"},callback:function(k){e.style[i]=k+"px"}}},fade:function(d,e,f){var g={time:e.time||a.time,type:f==0?"decelerated":"linear",start:f==0?1:0,finish:f==0?0:1,allowFloat:true};if(BX.browser.IsIE()&&!BX.browser.IsIE9()){g.start*=100;g.finish*=100;g.allowFloat=false;g.callback_start=function(){d.style.display="block";d.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity="+g.start+")"};g.callback=function(h){(d.filters["DXImageTransform.Microsoft.alpha"]||d.filters.alpha).opacity=h}}else{g.callback_start=function(){d.style.display="block"};g.callback=function(h){d.style.opacity=d.style.KhtmlOpacity=d.style.MozOpacity=h}}return g},fold:function(e,f,h){if(h!=0){return}var i=BX.pos(e);var g=i.height/(i.width+i.height);var d={time:f.time||a.time,callback_complete:f.callback_complete,hide:f.hide};f.type="scroll";f.direction="vertical";f.min_height=f.min_height||10;f.hide=false;f.time=g*d.time;f.callback_complete=function(){e.style.whiteSpace="nowrap";f.direction="horizontal";f.min_height=null;f.time=d.time-f.time;f.hide=d.hide;f.callback_complete=d.callback_complete;BX.fx.hide(e,f)};return BX.fx.EFFECTS.scroll(e,f,h)},scale:function(e,f,g){var h={width:parseInt(BX.style(e,"width")),height:parseInt(BX.style(e,"height"))};if(isNaN(h.width)||isNaN(h.height)){var j=BX.pos(e);h={width:j.width,height:j.height}}if(g==0){var i=h,d={width:0,height:0}}else{var d=h,i={width:0,height:0}}return{start:i,finish:d,time:f.time||a.time,type:"linear",callback_start:function(){e.style.position="relative";e.style.overflow="hidden";e.style.display="block";e.style.height=i.height+"px";e.style.width=i.width+"px"},callback:function(k){e.style.height=k.height+"px";e.style.width=k.width+"px"}}}};var b={arStack:{},arRules:{},globalAnimationId:0};BX.fx.colorAnimate=function(h,k,e){if(h==null){return}animationId=h.getAttribute("data-animation-id");if(animationId==null){animationId=b.globalAnimationId;h.setAttribute("data-animation-id",b.globalAnimationId++)}var d=k.split(/\s*,\s*/);for(var f=0;f<d.length;f++){k=d[f];if(!b.arRules[k]){continue}var g=0;if(!b.arStack[animationId]){b.arStack[animationId]={}}else{if(b.arStack[animationId][k]){g=b.arStack[animationId][k].i;clearInterval(b.arStack[animationId][k].tId)}}if((g==0&&e)||(g==b.arRules[k][3]&&!e)){continue}b.arStack[animationId][k]={i:g,element:h,tId:setInterval('BX.fx.colorAnimate.run("'+animationId+'","'+k+'")',b.arRules[k][4]),back:Boolean(e)}}};BX.fx.colorAnimate.addRule=function(j,i,e,h,g,f,d){b.arRules[j]=[BX.util.hex2rgb(i),BX.util.hex2rgb(e),h.replace(/\-(.)/g,function(){return arguments[1].toUpperCase()}),g,f||1,d||false]};BX.fx.colorAnimate.run=function(i,h){element=b.arStack[i][h].element;b.arStack[i][h].i+=b.arStack[i][h].back?-1:1;var e=b.arStack[i][h].i/b.arRules[h][3];var f=1-e;var d=b.arRules[h][0];var g=b.arRules[h][1];element.style[b.arRules[h][2]]="rgb("+Math.floor(d.r*f+g.r*e)+","+Math.floor(d.g*f+g.g*e)+","+Math.floor(d.b*f+g.b*e)+")";if(b.arStack[i][h].i==b.arRules[h][3]||b.arStack[i][h].i==0){clearInterval(b.arStack[i][h].tId);if(b.arRules[h][5]){BX.fx.colorAnimate(b.arStack[i][h].element,h,true)}}};BX.easing=function(d){this.options=d;this.timer=null};BX.easing.prototype.animate=function(){if(!this.options||!this.options.start||!this.options.finish||typeof(this.options.start)!="object"||typeof(this.options.finish)!="object"){return null}for(var d in this.options.start){if(typeof(this.options.finish[d])=="undefined"){delete this.options.start[d]}}this.options.progress=function(e){var g={};for(var f in this.start){g[f]=Math.round(this.start[f]+(this.finish[f]-this.start[f])*e)}if(this.step){this.step(g)}};this.animateProgress()};BX.easing.prototype.stop=function(d){if(this.timer){clearInterval(this.timer);this.timer=null;if(d){this.options.complete&&this.options.complete()}}};BX.easing.prototype.animateProgress=function(){var f=new Date();var e=this.options.transition||BX.easing.transitions.linear;var d=this.options.duration||1000;this.timer=setInterval(BX.proxy(function(){var g=(new Date()-f)/d;if(g>1){g=1}this.options.progress(e(g));if(g==1){this.stop(true)}},this),this.options.delay||13)};BX.easing.makeEaseInOut=function(d){return function(e){if(e<0.5){return d(2*e)/2}else{return(2-d(2*(1-e)))/2}}};BX.easing.makeEaseOut=function(d){return function(e){return 1-d(1-e)}};BX.easing.transitions={linear:function(d){return d},quad:function(d){return Math.pow(d,2)},cubic:function(d){return Math.pow(d,3)},quart:function(d){return Math.pow(d,4)},quint:function(d){return Math.pow(d,5)},circ:function(d){return 1-Math.sin(Math.acos(d))},back:function(d){return Math.pow(d,2)*((1.5+1)*d-1.5)},elastic:function(d){return Math.pow(2,10*(d-1))*Math.cos(20*Math.PI*1.5/3*d)},bounce:function(f){for(var e=0,d=1;1;e+=d,d/=2){if(f>=(7-4*e)/11){return -Math.pow((11-6*e-11*f)/4,2)+Math.pow(d,2)}}}}})(window);(function(window){if(BX.WindowManager){return}BX.WindowManager={_stack:[],_runtime_resize:{},_delta:2,_delta_start:1000,currently_loaded:null,settings_category:"BX.WindowManager.9.5",register:function(w){this.currently_loaded=null;var div=w.Get();div.style.zIndex=w.zIndex=this.GetZIndex();w.WM_REG_INDEX=this._stack.length;this._stack.push(w);if(this._stack.length<2){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))}},unregister:function(w){if(null==w.WM_REG_INDEX){return null}var _current;if(this._stack.length>0){while((_current=this.__pop_stack())!=w){if(!_current){_current=null;break}}if(this._stack.length<=0){this.enableKeyCheck()}return _current}else{return null}},__pop_stack:function(clean){if(this._stack.length>0){var _current=this._stack.pop();_current.WM_REG_INDEX=null;BX.onCustomEvent(_current,"onWindowUnRegister",[clean===true]);return _current}else{return null}},clean:function(){while(this.__pop_stack(true)){}this._stack=null;this.disableKeyCheck()},Get:function(){if(this.currently_loaded){return this.currently_loaded}else{if(this._stack.length>0){return this._stack[this._stack.length-1]}else{return null}}},setStartZIndex:function(value){this._delta_start=value},restoreStartZIndex:function(){this._delta_start=1000},GetZIndex:function(){var _current;return(null!=(_current=this._stack[this._stack.length-1])?parseInt(_current.Get().style.zIndex)+this._delta:this._delta_start)},__get_check_url:function(url){var pos=url.indexOf("?");return pos==-1?url:url.substring(0,pos)},saveWindowSize:function(url,params){var check_url=this.__get_check_url(url);if(BX.userOptions){BX.userOptions.save(this.settings_category,"size_"+check_url,"width",params.width);BX.userOptions.save(this.settings_category,"size_"+check_url,"height",params.height)}this._runtime_resize[check_url]=params},saveWindowOptions:function(wnd_id,opts){if(BX.userOptions){for(var i in opts){if(opts.hasOwnProperty(i)){BX.userOptions.save(this.settings_category,"options_"+wnd_id,i,opts[i])}}}},getRuntimeWindowSize:function(url){return this._runtime_resize[this.__get_check_url(url)]},disableKeyCheck:function(){BX.unbind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},enableKeyCheck:function(){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},__checkKeyPress:function(e){if(null==e){e=window.event}if(e.keyCode==27){var wnd=BX.WindowManager.Get();if(wnd&&!wnd.unclosable){wnd.Close()}}}};BX.garbage(BX.WindowManager.clean,BX.WindowManager);BX.CWindowButton=function(params){if(params.btn){this.btn=params.btn;this.parentWindow=params.parentWindow;if(/save|apply/i.test(this.btn.name)){BX.bind(this.btn,"click",BX.delegate(this.disableUntilError,this))}}else{this.title=params.title;this.hint=params.hint;this.id=params.id;this.name=params.name;this.className=params.className;this.action=params.action;this.onclick=params.onclick;if(params.Button&&BX.type.isFunction(params.Button)){this.Button=params.Button}this.btn=null}};BX.CWindowButton.prototype.disable=function(){if(this.btn){this.parentWindow.showWait(this.btn)}};BX.CWindowButton.prototype.enable=function(){if(this.btn){this.parentWindow.closeWait(this.btn)}};BX.CWindowButton.prototype.emulate=function(){if(this.btn&&this.btn.disabled){return}var act=this.action?BX.delegate(this.action,this):(this.onclick?this.onclick:(this.btn?this.btn.getAttribute("onclick"):""));if(act){setTimeout(act,50);if(this.btn&&/save|apply/i.test(this.btn.name)&&!this.action){this.disableUntilError()}}};BX.CWindowButton.prototype.Button=function(parentWindow){this.parentWindow=parentWindow;var btn={props:{type:"button",name:this.id?this.id:this.name,value:this.title?this.title:this.name,id:this.id}};if(this.hint){btn.props.title=this.hint}if(!!this.className){btn.props.className=this.className}if(this.action){btn.events={click:BX.delegate(this.action,this)}}else{if(this.onclick){if(BX.browser.IsIE()){btn.events={click:BX.delegate(function(){eval(this.onclick)},this)}}else{btn.attrs={onclick:this.onclick}}}}this.btn=BX.create("INPUT",btn);return this.btn};BX.CWindowButton.prototype.disableUntilError=function(){this.disable();if(!this.__window_error_handler_set){BX.addCustomEvent(this.parentWindow,"onWindowError",BX.delegate(this.enable,this));this.__window_error_handler_set=true}};BX.CWindow=function(div,type){this.DIV=div||document.createElement("DIV");this.SETTINGS={resizable:false,min_height:0,min_width:0,top:0,left:0,draggable:false,drag_restrict:true,resize_restrict:true};this.ELEMENTS={draggable:[],resizer:[],close:[]};this.type=type=="float"?"float":"dialog";BX.adjust(this.DIV,{props:{className:"bx-core-window"},style:{zIndex:0,position:"absolute",display:"none",top:this.SETTINGS.top+"px",left:this.SETTINGS.left+"px",height:"100px",width:"100px"}});this.isOpen=false;BX.addCustomEvent(this,"onWindowRegister",BX.delegate(this.onRegister,this));BX.addCustomEvent(this,"onWindowUnRegister",BX.delegate(this.onUnRegister,this));this.MOUSEOVER=null;BX.bind(this.DIV,"mouseover",BX.delegate(this.__set_msover,this));BX.bind(this.DIV,"mouseout",BX.delegate(this.__unset_msover,this));BX.ready(BX.delegate(function(){document.body.appendChild(this.DIV)},this))};BX.CWindow.prototype.Get=function(){return this.DIV};BX.CWindow.prototype.visible=function(){return this.isOpen};BX.CWindow.prototype.Show=function(bNotRegister){this.DIV.style.display="block";if(!bNotRegister){BX.WindowManager.register(this);BX.onCustomEvent(this,"onWindowRegister")}};BX.CWindow.prototype.Hide=function(){BX.WindowManager.unregister(this);this.DIV.style.display="none"};BX.CWindow.prototype.onRegister=function(){this.isOpen=true};BX.CWindow.prototype.onUnRegister=function(clean){this.isOpen=false;if(clean||(this.PARAMS&&this.PARAMS.content_url)){if(clean){BX.onCustomEvent(this,"onWindowClose",[this,true])}if(this.DIV.parentNode){this.DIV.parentNode.removeChild(this.DIV)}}else{this.DIV.style.display="none"}};BX.CWindow.prototype.CloseDialog=BX.CWindow.prototype.Close=function(bImmediately){BX.onCustomEvent(this,"onBeforeWindowClose",[this]);if(bImmediately!==true){if(this.denyClose){return false}}BX.onCustomEvent(this,"onWindowClose",[this]);if(this.bExpanded){var pDocElement=BX.GetDocElement();BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));pDocElement.style.overflow=this.__expand_settings.overflow}BX.WindowManager.unregister(this);return true};BX.CWindow.prototype.SetResize=function(elem){elem.style.cursor="se-resize";BX.bind(elem,"mousedown",BX.proxy(this.__startResize,this));this.ELEMENTS.resizer.push(elem);this.SETTINGS.resizable=true};BX.CWindow.prototype.SetExpand=function(elem,event_name){event_name=event_name||"click";BX.bind(elem,event_name,BX.proxy(this.__expand,this))};BX.CWindow.prototype.__expand_onresize=function(){var windowSize=BX.GetWindowInnerSize();this.DIV.style.width=windowSize.innerWidth+"px";this.DIV.style.height=windowSize.innerHeight+"px";BX.onCustomEvent(this,"onWindowResize")};BX.CWindow.prototype.__expand=function(){var pDocElement=BX.GetDocElement();if(!this.bExpanded){var wndScroll=BX.GetWindowScrollPos(),wndSize=BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.DIV.style.width,height:this.DIV.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:wndScroll.scrollTop,scrollLeft:wndScroll.scrollLeft,overflow:BX.style(pDocElement,"overflow")};this.SETTINGS.resizable=false;this.SETTINGS.draggable=false;window.scrollTo(0,0);pDocElement.style.overflow="hidden";this.DIV.style.top="0px";this.DIV.style.left="0px";this.DIV.style.width=wndSize.innerWidth+"px";this.DIV.style.height=wndSize.innerHeight+"px";this.bExpanded=true;BX.onCustomEvent(this,"onWindowExpand");BX.onCustomEvent(this,"onWindowResize");BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}else{BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));this.SETTINGS.resizable=this.__expand_settings.resizable;this.SETTINGS.draggable=this.__expand_settings.draggable;pDocElement.style.overflow=this.__expand_settings.overflow;this.DIV.style.top=this.__expand_settings.top;this.DIV.style.left=this.__expand_settings.left;this.DIV.style.width=this.__expand_settings.width;this.DIV.style.height=this.__expand_settings.height;window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop);this.bExpanded=false;BX.onCustomEvent(this,"onWindowNarrow");BX.onCustomEvent(this,"onWindowResize")}};BX.CWindow.prototype.Resize=function(x,y){var new_width=Math.max(x-this.pos.left+this.dx,this.SETTINGS.min_width);var new_height=Math.max(y-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var scrollSize=BX.GetWindowScrollSize();if(this.pos.left+new_width>scrollSize.scrollWidth-this.dw){new_width=scrollSize.scrollWidth-this.pos.left-this.dw}}this.DIV.style.width=new_width+"px";this.DIV.style.height=new_height+"px";BX.onCustomEvent(this,"onWindowResize")};BX.CWindow.prototype.__startResize=function(e){if(!this.SETTINGS.resizable){return false}if(!e){e=window.event}this.wndSize=BX.GetWindowScrollPos();this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth;this.pos=BX.pos(this.DIV);this.x=e.clientX+this.wndSize.scrollLeft;this.y=e.clientY+this.wndSize.scrollTop;this.dx=this.pos.left+this.pos.width-this.x;this.dy=this.pos.top+this.pos.height-this.y;this.dw=this.pos.width-parseInt(this.DIV.style.width);BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var b=document.body;b.ondrag=b.onselectstart=BX.False;b.style.MozUserSelect=this.DIV.style.MozUserSelect="none";b.style.cursor="se-resize";BX.onCustomEvent(this,"onWindowResizeStart");return true};BX.CWindow.prototype.__moveResize=function(e){if(!e){e=window.event}var windowScroll=BX.GetWindowScrollPos();var x=e.clientX+windowScroll.scrollLeft;var y=e.clientY+windowScroll.scrollTop;if(this.x==x&&this.y==y){return}this.Resize(x,y);this.x=x;this.y=y};BX.CWindow.prototype.__stopResize=function(){if(document.body.releaseCapture){document.body.releaseCapture()}BX.unbind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.unbind(document,"mouseup",BX.proxy(this.__stopResize,this));document.onmousedown=null;var b=document.body;b.ondrag=b.onselectstart=null;b.style.MozUserSelect=this.DIV.style.MozUserSelect="";b.style.cursor="";BX.onCustomEvent(this,"onWindowResizeFinished")};BX.CWindow.prototype.SetClose=function(elem){BX.bind(elem,"click",BX.proxy(this.Close,this));this.ELEMENTS.close.push(elem)};BX.CWindow.prototype.SetDraggable=function(elem){BX.bind(elem,"mousedown",BX.proxy(this.__startDrag,this));elem.style.cursor="move";this.ELEMENTS.draggable.push(elem);this.SETTINGS.draggable=true};BX.CWindow.prototype.Move=function(x,y){var dxShadow=1;var left=parseInt(this.DIV.style.left)+x;var top=parseInt(this.DIV.style.top)+y;if(this.SETTINGS.drag_restrict){if(left<0){left=0}var scrollSize=BX.GetWindowScrollSize();var floatWidth=this.DIV.offsetWidth;var floatHeight=this.DIV.offsetHeight;if(left>(scrollSize.scrollWidth-floatWidth-dxShadow)){left=scrollSize.scrollWidth-floatWidth-dxShadow}if(top>(scrollSize.scrollHeight-floatHeight-dxShadow)){top=scrollSize.scrollHeight-floatHeight-dxShadow}if(top<0){top=0}}this.DIV.style.left=left+"px";this.DIV.style.top=top+"px"};BX.CWindow.prototype.__startDrag=function(e){if(!this.SETTINGS.draggable){return false}if(!e){e=window.event}this.x=e.clientX+document.body.scrollLeft;this.y=e.clientY+document.body.scrollTop;this.__bWasDragged=false;BX.bind(document,"mousemove",BX.proxy(this.__moveDrag,this));BX.bind(document,"mouseup",BX.proxy(this.__stopDrag,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var b=document.body;b.ondrag=b.onselectstart=BX.False;b.style.MozUserSelect=this.DIV.style.MozUserSelect="none";b.style.cursor="move";return BX.PreventDefault(e)};BX.CWindow.prototype.__moveDrag=function(e){if(!e){e=window.event}var x=e.clientX+document.body.scrollLeft;var y=e.clientY+document.body.scrollTop;if(this.x==x&&this.y==y){return}this.Move((x-this.x),(y-this.y));this.x=x;this.y=y;if(!this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragStart");this.__bWasDragged=true;BX.bind(BX.proxy_context,"click",BX.PreventDefault)}BX.onCustomEvent(this,"onWindowDrag")};BX.CWindow.prototype.__stopDrag=function(e){if(document.body.releaseCapture){document.body.releaseCapture()}BX.unbind(document,"mousemove",BX.proxy(this.__moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this.__stopDrag,this));document.onmousedown=null;var b=document.body;b.ondrag=b.onselectstart=null;b.style.MozUserSelect=this.DIV.style.MozUserSelect="";b.style.cursor="";if(this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragFinished");var _proxy_context=BX.proxy_context;setTimeout(function(){BX.unbind(_proxy_context,"click",BX.PreventDefault)},100);this.__bWasDragged=false}return BX.PreventDefault(e)};BX.CWindow.prototype.DenyClose=function(){this.denyClose=true};BX.CWindow.prototype.AllowClose=function(){this.denyClose=false};BX.CWindow.prototype.ShowError=function(str){BX.onCustomEvent(this,"onWindowError",[str]);if(this._wait){BX.closeWait(this._wait)}window.alert(str)};BX.CWindow.prototype.__set_msover=function(){this.MOUSEOVER=true};BX.CWindow.prototype.__unset_msover=function(){this.MOUSEOVER=false};BX.CWindowDialog=function(){var a=arguments;a[1]="dialog";BX.CWindowDialog.superclass.constructor.apply(this,a);this.DIV.style.top="10px";this.OVERLAY=null};BX.extend(BX.CWindowDialog,BX.CWindow);BX.CWindowDialog.prototype.__resizeOverlay=function(){var windowSize=BX.GetWindowScrollSize();this.OVERLAY.style.width=windowSize.scrollWidth+"px"};BX.CWindowDialog.prototype.CreateOverlay=function(zIndex){if(null==this.OVERLAY){var windowSize=BX.GetWindowScrollSize();this.OVERLAY=document.body.appendChild(BX.create("DIV",{style:{position:"absolute",top:"0px",left:"0px",zIndex:zIndex||(parseInt(this.DIV.style.zIndex)-2),width:windowSize.scrollWidth+"px",height:windowSize.scrollHeight+"px"}}))}return this.OVERLAY};BX.CWindowDialog.prototype.Show=function(){BX.CWindowDialog.superclass.Show.apply(this,arguments);this.CreateOverlay();this.OVERLAY.style.display="block";this.OVERLAY.style.zIndex=parseInt(this.DIV.style.zIndex)-2;BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this));BX.bind(window,"resize",BX.proxy(this.__resizeOverlay,this))};BX.CWindowDialog.prototype.onUnRegister=function(clean){BX.CWindowDialog.superclass.onUnRegister.apply(this,arguments);if(this.clean){if(this.OVERLAY.parentNode){this.OVERLAY.parentNode.removeChild(this.OVERLAY)}}else{this.OVERLAY.style.display="none"}BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this))};BX.CDialog=function(arParams){BX.CDialog.superclass.constructor.apply(this);this._sender="core_window_cdialog";this.PARAMS=arParams||{};for(var i in this.defaultParams){if(typeof this.PARAMS[i]=="undefined"){this.PARAMS[i]=this.defaultParams[i]}}this.PARAMS.width=(!isNaN(parseInt(this.PARAMS.width)))?this.PARAMS.width:this.defaultParams.width;this.PARAMS.height=(!isNaN(parseInt(this.PARAMS.height)))?this.PARAMS.height:this.defaultParams.height;if(this.PARAMS.resize_id||this.PARAMS.content_url){var arSize=BX.WindowManager.getRuntimeWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url);if(arSize){this.PARAMS.width=arSize.width;this.PARAMS.height=arSize.height}}BX.addClass(this.DIV,"bx-core-adm-dialog");this.DIV.id="bx-admin-prefix";this.PARTS={};this.DIV.style.height=null;this.DIV.style.width=null;this.PARTS.TITLEBAR=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head"}}));this.PARTS.TITLE_CONTAINER=this.PARTS.TITLEBAR.appendChild(BX.create("SPAN",{props:{className:"bx-core-adm-dialog-head-inner"},text:this.PARAMS.title}));this.PARTS.TITLEBAR_ICONS=this.PARTS.TITLEBAR.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-icons"},children:(this.PARAMS.resizable?[BX.create("SPAN",{props:{className:"bx-core-adm-icon-expand",title:BX.message("JS_CORE_WINDOW_EXPAND")}}),BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]:[BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})])}));this.PARTS.CONTENT=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap adm-workarea"}}));this.PARTS.CONTENT_DATA=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content"},style:{height:this.PARAMS.height+"px",width:this.PARAMS.width+"px"}}));this.PARTS.HEAD=this.PARTS.CONTENT_DATA.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-block"+(this.PARAMS.icon?" "+this.PARAMS.icon:"")}}));this.SetHead(this.PARAMS.head);this.SetContent(this.PARAMS.content);this.SetTitle(this.PARAMS.title);this.SetClose(this.PARTS.TITLEBAR_ICONS.lastChild);if(this.PARAMS.resizable){this.SetExpand(this.PARTS.TITLEBAR_ICONS.firstChild);this.SetExpand(this.PARTS.TITLEBAR,"dblclick");BX.addCustomEvent(this,"onWindowExpand",BX.proxy(this.__onexpand,this));BX.addCustomEvent(this,"onWindowNarrow",BX.proxy(this.__onexpand,this))}this.PARTS.FOOT=this.PARTS.BUTTONS_CONTAINER=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-buttons"},children:this.ShowButtons()}));if(this.PARAMS.draggable){this.SetDraggable(this.PARTS.TITLEBAR)}if(this.PARAMS.resizable){this.PARTS.RESIZER=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-resizer"}}));this.SetResize(this.PARTS.RESIZER);this.SETTINGS.min_width=this.PARAMS.min_width;this.SETTINGS.min_height=this.PARAMS.min_height}this.auth_callback=BX.delegate(function(){this.PARAMS.content="";this.hideNotify();this.Show()},this)};BX.extend(BX.CDialog,BX.CWindowDialog);BX.CDialog.prototype.defaultParams={width:700,height:400,min_width:500,min_height:300,resizable:true,draggable:true,title:"",icon:""};BX.CDialog.prototype.showWait=function(el){if(BX.type.isElementNode(el)&&(el.type=="button"||el.type=="submit")){BX.defer(function(){el.disabled=true})();var bSave=(BX.hasClass(el,"adm-btn-save")||BX.hasClass(el,"adm-btn-save")),pos=BX.pos(el,true);el.bxwaiter=this.PARTS.FOOT.appendChild(BX.create("DIV",{props:{className:"adm-btn-load-img"+(bSave?"-green":"")},style:{top:parseInt((pos.bottom+pos.top)/2-10)+"px",left:parseInt((pos.right+pos.left)/2-10)+"px"}}));BX.addClass(el,"adm-btn-load");this.lastWaitElement=el;return el.bxwaiter}return null};BX.CDialog.prototype.closeWait=function(el){el=el||this.lastWaitElement;if(BX.type.isElementNode(el)){if(el.bxwaiter){if(el.bxwaiter.parentNode){el.bxwaiter.parentNode.removeChild(el.bxwaiter)}el.bxwaiter=null}el.disabled=false;BX.removeClass(el,"adm-btn-load");if(this.lastWaitElement==el){this.lastWaitElement=null}}};BX.CDialog.prototype.Authorize=function(arAuthResult){this.bSkipReplaceContent=true;this.ShowError(BX.message("JSADM_AUTH_REQ"));BX.onCustomEvent(this,"onWindowError",[]);BX.closeWait();(new BX.CAuthDialog({content_url:this.PARAMS.content_url,auth_result:arAuthResult,callback:BX.delegate(function(){if(this.auth_callback){this.auth_callback()}},this)})).Show()};BX.CDialog.prototype.ShowError=function(str){BX.onCustomEvent(this,"onWindowError",[str]);this.closeWait();if(this._wait){BX.closeWait(this._wait)}this.Notify(str,true)};BX.CDialog.prototype.__expandGetSize=function(){var pDocElement=BX.GetDocElement();pDocElement.style.overflow="hidden";var wndSize=BX.GetWindowInnerSize();pDocElement.scrollTop=0;this.DIV.style.top="-"+this.dxShadow+"px";this.DIV.style.left="-"+this.dxShadow+"px";return{width:(wndSize.innerWidth-parseInt(BX.style(this.PARTS.CONTENT,"padding-right"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-left")))+this.dxShadow,height:(wndSize.innerHeight-this.PARTS.TITLEBAR.offsetHeight-this.PARTS.FOOT.offsetHeight-parseInt(BX.style(this.PARTS.CONTENT,"padding-top"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-bottom")))+this.dxShadow}};BX.CDialog.prototype.__expand=function(){var pDocElement=BX.GetDocElement();this.dxShadow=2;if(!this.bExpanded){var wndScroll=BX.GetWindowScrollPos();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.PARTS.CONTENT_DATA.style.width,height:this.PARTS.CONTENT_DATA.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:wndScroll.scrollTop,scrollLeft:wndScroll.scrollLeft,overflow:BX.style(pDocElement,"overflow")};this.SETTINGS.resizable=false;this.SETTINGS.draggable=false;var pos=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=pos.width+"px";this.PARTS.CONTENT_DATA.style.height=pos.height+"px";window.scrollTo(0,0);pDocElement.style.overflow="hidden";this.bExpanded=true;BX.onCustomEvent(this,"onWindowExpand");BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{width:pos.width,height:pos.height}]);BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}else{BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));this.SETTINGS.resizable=this.__expand_settings.resizable;this.SETTINGS.draggable=this.__expand_settings.draggable;pDocElement.style.overflow=this.__expand_settings.overflow;this.DIV.style.top=this.__expand_settings.top;this.DIV.style.left=this.__expand_settings.left;this.PARTS.CONTENT_DATA.style.width=this.__expand_settings.width;this.PARTS.CONTENT_DATA.style.height=this.__expand_settings.height;window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop);this.bExpanded=false;BX.onCustomEvent(this,"onWindowNarrow");BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{width:parseInt(this.__expand_settings.width),height:parseInt(this.__expand_settings.height)}])}};BX.CDialog.prototype.__expand_onresize=function(){var pos=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=pos.width+"px";this.PARTS.CONTENT_DATA.style.height=pos.height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[pos])};BX.CDialog.prototype.__onexpand=function(){var ob=this.PARTS.TITLEBAR_ICONS.firstChild;ob.className=BX.toggle(ob.className,["bx-core-adm-icon-expand","bx-core-adm-icon-narrow"]);ob.title=BX.toggle(ob.title,[BX.message("JS_CORE_WINDOW_EXPAND"),BX.message("JS_CORE_WINDOW_NARROW")]);if(this.PARTS.RESIZER){this.PARTS.RESIZER.style.display=this.bExpanded?"none":"block"}};BX.CDialog.prototype.__startResize=function(e){if(!this.SETTINGS.resizable){return false}if(!e){e=window.event}this.wndSize=BX.GetWindowScrollPos();this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth;this.pos=BX.pos(this.PARTS.CONTENT_DATA);this.x=e.clientX+this.wndSize.scrollLeft;this.y=e.clientY+this.wndSize.scrollTop;this.dx=this.pos.left+this.pos.width-this.x;this.dy=this.pos.top+this.pos.height-this.y;this.dw=this.pos.width-parseInt(this.PARTS.CONTENT_DATA.style.width)+parseInt(BX.style(this.PARTS.CONTENT,"padding-right"));BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var b=document.body;b.ondrag=b.onselectstart=BX.False;b.style.MozUserSelect=this.DIV.style.MozUserSelect="none";b.style.cursor="se-resize";BX.onCustomEvent(this,"onWindowResizeStart");return true};BX.CDialog.prototype.Resize=function(x,y){var new_width=Math.max(x-this.pos.left+this.dx,this.SETTINGS.min_width);var new_height=Math.max(y-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var scrollSize=BX.GetWindowScrollSize();if(this.pos.left+new_width>scrollSize.scrollWidth-this.dw){new_width=scrollSize.scrollWidth-this.pos.left-this.dw}}this.PARTS.CONTENT_DATA.style.width=new_width+"px";this.PARTS.CONTENT_DATA.style.height=new_height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{height:new_height,width:new_width}])};BX.CDialog.prototype.SetSize=function(obSize){this.PARTS.CONTENT_DATA.style.width=obSize.width+"px";this.PARTS.CONTENT_DATA.style.height=obSize.height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[obSize])};BX.CDialog.prototype.GetParameters=function(form_name){var form=this.GetForm();if(!form){return""}var i,s="";var n=form.elements.length;var delim="";for(i=0;i<n;i++){if(s!=""){delim="&"}var el=form.elements[i];if(el.disabled){continue}switch(el.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==form_name&&el.name.substr(el.name.length-4)=="_alt"&&form.elements[el.name.substr(0,el.name.length-4)]){break}s+=delim+el.name+"="+BX.util.urlencode(el.value);break;case"radio":if(el.checked){s+=delim+el.name+"="+BX.util.urlencode(el.value)}break;case"checkbox":s+=delim+el.name+"="+BX.util.urlencode(el.checked?"Y":"N");break;case"select-one":var val="";if(null==form_name&&form.elements[el.name+"_alt"]&&el.selectedIndex==0){val=form.elements[el.name+"_alt"].value}else{val=el.value}s+=delim+el.name+"="+BX.util.urlencode(val);break;case"select-multiple":var j,bAdded=false;var l=el.options.length;for(j=0;j<l;j++){if(el.options[j].selected){s+=delim+el.name+"="+BX.util.urlencode(el.options[j].value);bAdded=true}}if(!bAdded){s+=delim+el.name+"="}break;default:break}}return s};BX.CDialog.prototype.PostParameters=function(params){var url=this.PARAMS.content_url;if(null==params){params=""}params+=(params==""?"":"&")+"bxsender="+this._sender;var index=url.indexOf("?");if(index==-1){url+="?"+params}else{url=url.substring(0,index)+"?"+params+"&"+url.substring(index+1)}BX.showWait();this.auth_callback=BX.delegate(function(){this.hideNotify();this.PostParameters(params)},this);BX.ajax.Setup({skipAuthCheck:true},true);BX.ajax.post(url,this.GetParameters(),BX.delegate(function(result){BX.closeWait();if(!this.bSkipReplaceContent){this.ClearButtons();this.SetContent(result);this.Show(true)}this.bSkipReplaceContent=false},this))};BX.CDialog.prototype.Submit=function(params,url){var FORM=this.GetForm();if(FORM){FORM.onsubmit=null;FORM.method="POST";if(!FORM.action||url){url=url||this.PARAMS.content_url;if(null!=params){var index=url.indexOf("?");if(index==-1){url+="?"+params}else{url=url.substring(0,index)+"?"+params+"&"+url.substring(index+1)}}FORM.action=url}if(!FORM._bxsender){FORM._bxsender=FORM.appendChild(BX.create("INPUT",{attrs:{type:"hidden",name:"bxsender",value:this._sender}}))}this._wait=BX.showWait();this.auth_callback=BX.delegate(function(){this.hideNotify();this.Submit(params)},this);BX.ajax.submit(FORM,BX.delegate(function(){this.closeWait()},this))}else{window.alert("no form registered!")}};BX.CDialog.prototype.GetForm=function(){if(null==this.__form){var forms=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__form=forms[0]?forms[0]:null}return this.__form};BX.CDialog.prototype.GetRealForm=function(){if(null==this.__rform){var forms=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__rform=forms[1]?forms[1]:(forms[0]?forms[0]:null)}return this.__rform};BX.CDialog.prototype._checkButton=function(btn){var arCustomButtons=["btnSave","btnCancel","btnClose"];for(var i=0;i<arCustomButtons.length;i++){if(this[arCustomButtons[i]]&&(btn==this[arCustomButtons[i]])){return arCustomButtons[i]}}return false};BX.CDialog.prototype.ShowButtons=function(){var result=[];if(this.PARAMS.buttons){if(this.PARAMS.buttons.title){this.PARAMS.buttons=[this.PARAMS.buttons]}for(var i=0,len=this.PARAMS.buttons.length;i<len;i++){if(BX.type.isNotEmptyString(this.PARAMS.buttons[i])){result.push(this.PARAMS.buttons[i])}else{if(this.PARAMS.buttons[i]){if(!BX.is_subclass_of(this.PARAMS.buttons[i],BX.CWindowButton)){var b=this._checkButton(this.PARAMS.buttons[i]);this.PARAMS.buttons[i]=new BX.CWindowButton(this.PARAMS.buttons[i]);if(b){this[b]=this.PARAMS.buttons[i]}}result.push(this.PARAMS.buttons[i].Button(this))}}}}return result};BX.CDialog.prototype.setAutosave=function(){if(!this.bSetAutosaveDelay){this.bSetAutosaveDelay=true;setTimeout(BX.proxy(this.setAutosave,this),10)}};BX.CDialog.prototype.SetTitle=function(title){this.PARAMS.title=title;BX.cleanNode(this.PARTS.TITLE_CONTAINER).appendChild(document.createTextNode(this.PARAMS.title))};BX.CDialog.prototype.SetHead=function(head){this.PARAMS.head=BX.util.trim(head);this.PARTS.HEAD.innerHTML=this.PARAMS.head||"&nbsp;";this.PARTS.HEAD.style.display=this.PARAMS.head?"block":"none";this.adjustSize()};BX.CDialog.prototype.Notify=function(note,bError){if(!this.PARTS.NOTIFY){this.PARTS.NOTIFY=this.DIV.insertBefore(BX.create("DIV",{props:{className:"adm-warning-block"},children:[BX.create("SPAN",{props:{className:"adm-warning-text"}}),BX.create("SPAN",{props:{className:"adm-warning-icon"}}),BX.create("SPAN",{props:{className:"adm-warning-close"},events:{click:BX.proxy(this.hideNotify,this)}})]}),this.DIV.firstChild)}if(bError){BX.addClass(this.PARTS.NOTIFY,"adm-warning-block-red")}else{BX.removeClass(this.PARTS.NOTIFY,"adm-warning-block-red")}this.PARTS.NOTIFY.firstChild.innerHTML=note||"&nbsp;";this.PARTS.NOTIFY.firstChild.style.width=(this.PARAMS.width-50)+"px";BX.removeClass(this.PARTS.NOTIFY,"adm-warning-animate")};BX.CDialog.prototype.hideNotify=function(){BX.addClass(this.PARTS.NOTIFY,"adm-warning-animate")};BX.CDialog.prototype.__adjustHeadToIcon=function(){if(!this.PARTS.HEAD.offsetHeight){setTimeout(BX.delegate(this.__adjustHeadToIcon,this),50)}else{if(this.icon_image&&this.icon_image.height&&this.icon_image.height>this.PARTS.HEAD.offsetHeight-5){this.PARTS.HEAD.style.height=this.icon_image.height+5+"px";this.adjustSize()}this.icon_image.onload=null;this.icon_image=null}};BX.CDialog.prototype.SetIcon=function(icon_class){if(this.PARAMS.icon!=icon_class){if(this.PARAMS.icon){BX.removeClass(this.PARTS.HEAD,this.PARAMS.icon)}this.PARAMS.icon=icon_class;if(this.PARAMS.icon){BX.addClass(this.PARTS.HEAD,this.PARAMS.icon);var icon_file=(BX.style(this.PARTS.HEAD,"background-image")||BX.style(this.PARTS.HEAD,"backgroundImage"));if(BX.type.isNotEmptyString(icon_file)&&icon_file!="none"){var match=icon_file.match(new RegExp("url\\s*\\(\\s*('|\"|)(.+?)(\\1)\\s*\\)"));if(match){icon_file=match[2];if(BX.type.isNotEmptyString(icon_file)){this.icon_image=new Image();this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this);this.icon_image.src=icon_file}}}}}this.adjustSize()};BX.CDialog.prototype.SetIconFile=function(icon_file){this.icon_image=new Image();this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this);this.icon_image.src=icon_file;BX.adjust(this.PARTS.HEAD,{style:{backgroundImage:"url("+icon_file+")",backgroundPosition:"right 9px"}});this.adjustSize()};BX.CDialog.prototype.SetButtons=function(a){if(BX.type.isString(a)){if(a.length>0){this.PARTS.BUTTONS_CONTAINER.innerHTML+=a;var btns=this.PARTS.BUTTONS_CONTAINER.getElementsByTagName("INPUT");if(btns.length>0){this.PARAMS.buttons=[];for(var i=0;i<btns.length;i++){this.PARAMS.buttons.push(new BX.CWindowButton({btn:btns[i],parentWindow:this}))}}}}else{this.PARAMS.buttons=a;BX.adjust(this.PARTS.BUTTONS_CONTAINER,{children:this.ShowButtons()})}this.adjustSize()};BX.CDialog.prototype.ClearButtons=function(){BX.cleanNode(this.PARTS.BUTTONS_CONTAINER);this.adjustSize()};BX.CDialog.prototype.SetContent=function(html){this.__form=null;if(BX.type.isElementNode(html)){if(html.parentNode){html.parentNode.removeChild(html)}}else{if(BX.type.isString(html)){html=BX.create("DIV",{html:html})}}this.PARAMS.content=html;BX.cleanNode(this.PARTS.CONTENT_DATA);BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARTS.HEAD,BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap-inner"},children:[this.PARAMS.content]})]});if(this.PARAMS.content_url&&this.GetForm()){this.__form.submitbtn=this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}}));this.__form.onsubmit=BX.delegate(this.__submit,this)}};BX.CDialog.prototype.__submit=function(e){for(var i=0,len=this.PARAMS.buttons.length;i<len;i++){if(this.PARAMS.buttons[i]&&(this.PARAMS.buttons[i].name&&/save|apply/i.test(this.PARAMS.buttons[i].name)||this.PARAMS.buttons[i].btn&&this.PARAMS.buttons[i].btn.name&&/save|apply/i.test(this.PARAMS.buttons[i].btn.name))){this.PARAMS.buttons[i].emulate();break}}return BX.PreventDefault(e)};BX.CDialog.prototype.SwapContent=function(cont){cont=BX(cont);BX.cleanNode(this.PARTS.CONTENT_DATA);cont.parentNode.removeChild(cont);this.PARTS.CONTENT_DATA.appendChild(cont);cont.style.display="block";this.SetContent(cont.innerHTML)};BX.CDialog.prototype.adjustSize=function(){};BX.CDialog.prototype.__adjustSize=function(){};BX.CDialog.prototype.adjustSizeEx=function(){BX.defer(this.__adjustSizeEx,this)()};BX.CDialog.prototype.__adjustSizeEx=function(){var ob=this.PARTS.CONTENT_DATA.firstChild,new_height=0;while(ob){new_height+=ob.offsetHeight+parseInt(BX.style(ob,"margin-top"))+parseInt(BX.style(ob,"margin-bottom"));ob=BX.nextSibling(ob)}if(new_height){this.PARTS.CONTENT_DATA.style.height=new_height+"px"}};BX.CDialog.prototype.__onResizeFinished=function(){BX.WindowManager.saveWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url,{height:parseInt(this.PARTS.CONTENT_DATA.style.height),width:parseInt(this.PARTS.CONTENT_DATA.style.width)})};BX.CDialog.prototype.Show=function(bNotRegister){if((!this.PARAMS.content)&&this.PARAMS.content_url&&BX.ajax&&!bNotRegister){var wait=BX.showWait();BX.WindowManager.currently_loaded=this;this.CreateOverlay(parseInt(BX.style(wait,"z-index"))-1);this.OVERLAY.style.display="block";this.OVERLAY.className="bx-core-dialog-overlay";var post_data="",method="GET";if(this.PARAMS.content_post){post_data=this.PARAMS.content_post;method="POST"}var url=this.PARAMS.content_url+(this.PARAMS.content_url.indexOf("?")<0?"?":"&")+"bxsender="+this._sender;this.auth_callback=BX.delegate(function(){this.PARAMS.content="";this.hideNotify();this.Show()},this);BX.ajax({method:method,dataType:"html",url:url,data:post_data,skipAuthCheck:true,onsuccess:BX.delegate(function(data){BX.closeWait(null,wait);this.SetContent(data||"&nbsp;");this.Show()},this),processScriptsConsecutive:true})}else{BX.WindowManager.currently_loaded=null;BX.CDialog.superclass.Show.apply(this,arguments);this.adjustPos();this.OVERLAY.className="bx-core-dialog-overlay";this.__adjustSize();BX.addCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this));if(this.PARAMS.resizable&&(this.PARAMS.content_url||this.PARAMS.resize_id)){BX.addCustomEvent(this,"onWindowResizeFinished",BX.delegate(this.__onResizeFinished,this))}}};BX.CDialog.prototype.GetInnerPos=function(){return{width:parseInt(this.PARTS.CONTENT_DATA.style.width),height:parseInt(this.PARTS.CONTENT_DATA.style.height)}};BX.CDialog.prototype.adjustPos=function(){if(!this.bExpanded){var windowSize=BX.GetWindowInnerSize();var windowScroll=BX.GetWindowScrollPos();BX.adjust(this.DIV,{style:{left:parseInt(windowScroll.scrollLeft+windowSize.innerWidth/2-parseInt(this.DIV.offsetWidth)/2)+"px",top:Math.max(parseInt(windowScroll.scrollTop+windowSize.innerHeight/2-parseInt(this.DIV.offsetHeight)/2),0)+"px"}})}};BX.CDialog.prototype.GetContent=function(){return this.PARTS.CONTENT_DATA};BX.CDialog.prototype.btnSave=BX.CDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:BX.browser.IsIE()&&BX.browser.IsDoctype()&&!BX.browser.IsIE10()?"":"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.PostParameters()}};BX.CDialog.prototype.btnCancel=BX.CDialog.btnCancel={title:BX.message("JS_CORE_WINDOW_CANCEL"),id:"cancel",name:"cancel",action:function(){this.parentWindow.Close()}};BX.CDialog.prototype.btnClose=BX.CDialog.btnClose={title:BX.message("JS_CORE_WINDOW_CLOSE"),id:"close",name:"close",action:function(){this.parentWindow.Close()}};BX.CAdminDialog=function(arParams){BX.CAdminDialog.superclass.constructor.apply(this,arguments);this._sender="core_window_cadmindialog";BX.addClass(this.DIV,"bx-core-adm-admin-dialog");this.PARTS.CONTENT.insertBefore(this.PARTS.HEAD,this.PARTS.CONTENT.firstChild);this.PARTS.HEAD.className="bx-core-adm-dialog-tabs"};BX.extend(BX.CAdminDialog,BX.CDialog);BX.CAdminDialog.prototype.SetHead=function(){BX.CAdminDialog.superclass.SetHead.apply(this,arguments);if(this.PARTS.HEAD.firstChild&&BX.type.isElementNode(this.PARTS.HEAD.firstChild)){var ob=this.PARTS.HEAD.firstChild,new_width=0,marginLeft=0,marginRight=0;while(ob){marginLeft=parseInt(BX.style(ob,"margin-left"),10);if(isNaN(marginLeft)){marginLeft=0}marginRight=parseInt(BX.style(ob,"margin-right"),10);if(isNaN(marginRight)){marginRight=0}new_width+=ob.offsetWidth+marginLeft+marginRight;ob=BX.nextSibling(ob)}this.SETTINGS.min_width=Math.max(new_width,this.SETTINGS.min_width)-2;if(this.PARAMS.width<this.SETTINGS.min_width){BX.adjust(this.PARTS.CONTENT_DATA,{style:{width:this.SETTINGS.min_width+"px"}})}}};BX.CAdminDialog.prototype.SetContent=function(html){this.__form=null;if(BX.type.isElementNode(html)){if(html.parentNode){html.parentNode.removeChild(html)}}this.PARAMS.content=html;BX.cleanNode(this.PARTS.CONTENT_DATA);BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARAMS.content||"&nbsp;"]});if(this.PARAMS.content_url&&this.GetForm()){this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}}));this.__form.onsubmit=BX.delegate(this.__submit,this)}};BX.CAdminDialog.prototype.__adjustSizeEx=function(){var new_height=BX.firstChild(this.PARTS.CONTENT_DATA).offsetHeight;if(new_height){this.PARTS.CONTENT_DATA.style.height=new_height+"px"}};BX.CAdminDialog.prototype.__expandGetSize=function(){var res=BX.CAdminDialog.superclass.__expandGetSize.apply(this,arguments);res.width-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-right"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-left"));res.height-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-top"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-bottom"));res.height-=this.PARTS.HEAD.offsetHeight;return res};BX.CAdminDialog.prototype.Submit=function(){var FORM=this.GetForm();if(FORM&&!FORM.bxpublic&&!/bxpublic=/.test(FORM.action)){FORM.appendChild(BX.create("INPUT",{props:{type:"hidden",name:"bxpublic",value:"Y"}}))}return BX.CAdminDialog.superclass.Submit.apply(this,arguments)};BX.CAdminDialog.prototype.btnSave=BX.CAdminDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.Submit()}};BX.CAdminDialog.btnCancel=BX.CAdminDialog.superclass.btnCancel;BX.CAdminDialog.btnClose=BX.CAdminDialog.superclass.btnClose;BX.CDebugDialog=function(arParams){BX.CDebugDialog.superclass.constructor.apply(this,arguments)};BX.extend(BX.CDebugDialog,BX.CDialog);BX.CDebugDialog.prototype.ShowDetails=function(div_id){var div=BX(div_id);if(div){if(this.div_detail_current){this.div_detail_current.style.display="none"}div.style.display="block";this.div_detail_current=div}};BX.CDebugDialog.prototype.SetContent=function(html){if(!html){return}var arHtml=html.split("#DIVIDER#");if(arHtml.length>1){this.PARAMS.content=arHtml[1];this.PARTS.CONTENT_DATA.style.overflow="hidden";BX.CDebugDialog.superclass.SetContent.apply(this,[arHtml[1]]);this.PARTS.CONTENT_INNER=this.PARTS.CONTENT_DATA.firstChild.nextSibling;this.PARTS.CONTENT_TOP=this.PARTS.CONTENT_DATA.insertBefore(BX.create("DIV",{props:{className:"bx-debug-content-top"},html:arHtml[0]}),this.PARTS.CONTENT_INNER);this.PARTS.CONTENT_INNER.style.overflow="auto"}else{BX.CDebugDialog.superclass.SetContent.apply(this,arguments)}};BX.CDebugDialog.prototype.__adjustSize=function(){BX.CDebugDialog.superclass.__adjustSize.apply(this,arguments);if(this.PARTS.CONTENT_TOP){var new_height=this.PARTS.CONTENT_DATA.offsetHeight-this.PARTS.HEAD.offsetHeight-this.PARTS.CONTENT_TOP.offsetHeight-38;if(new_height>0){this.PARTS.CONTENT_INNER.style.height=new_height+"px"}}};BX.CEditorDialog=function(arParams){BX.CEditorDialog.superclass.constructor.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap");BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content");BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner");BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons");BX.addClass(this.PARTS.CONTENT,"bx-core-editor-dialog-content-wrap");BX.addClass(this.PARTS.CONTENT_DATA,"bx-core-editor-dialog-content");BX.addClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-editor-dialog-buttons")};BX.extend(BX.CEditorDialog,BX.CDialog);BX.CEditorDialog.prototype.SetContent=function(){BX.CEditorDialog.superclass.SetContent.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner")};BX.CWizardDialog=function(arParams){BX.CWizardDialog.superclass.constructor.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap");BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content");BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner");BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons");BX.addClass(this.PARTS.CONTENT,"bx-core-wizard-dialog-content-wrap")};BX.extend(BX.CWizardDialog,BX.CDialog);BX.CAuthDialog=function(arParams){arParams.resizable=false;arParams.width=350;arParams.height=200;arParams.buttons=[this.btnSave];BX.CAuthDialog.superclass.constructor.apply(this,arguments);this._sender="core_window_cauthdialog";BX.addClass(this.DIV,"bx-core-auth-dialog");BX.AUTHAGENT=this};BX.extend(BX.CAuthDialog,BX.CDialog);BX.CAuthDialog.prototype.btnSave=BX.CAuthDialog.btnSave={title:BX.message("JS_CORE_WINDOW_AUTH"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.Submit("",this.parentWindow.PARAMS.content_url)}};BX.CAuthDialog.prototype.SetError=function(error){BX.closeWait();if(!!error){this.ShowError(error.MESSAGE||error)}};BX.CAuthDialog.prototype.setAuthResult=function(result){BX.closeWait();if(result===false){this.Close();if(this.PARAMS.callback){this.PARAMS.callback()}}else{this.SetError(result)}};BX.CWindowFloat=function(node){BX.CWindowFloat.superclass.constructor.apply(this,[node,"float"]);this.SETTINGS.resizable=false};BX.extend(BX.CWindowFloat,BX.CWindow);BX.CWindowFloat.prototype.adjustPos=function(){if(this.PARAMS.parent){this.adjustToNode()}else{if(this.PARAMS.x&&this.PARAMS.y){this.adjustToPos([this.PARAMS.x,this.PARAMS.y])}}};BX.CWindowFloat.prototype.adjustToPos=function(pos){this.DIV.style.left=parseInt(pos[0])+"px";this.DIV.style.top=parseInt(pos[1])+"px"};BX.CWindowFloat.prototype.adjustToNodeGetPos=function(){return BX.pos(this.PARAMS.parent)};BX.CWindowFloat.prototype.adjustToNode=function(el){el=el||this.PARAMS.parent;this.PARAMS.parent=BX(el);if(this.PARAMS.parent){var pos=this.adjustToNodeGetPos();this.DIV.style.top=pos.top+"px";this.DIV.style.left=pos.left+"px";this.PARAMS.parent.OPENER=this}};BX.CWindowFloat.prototype.Show=function(){this.adjustToPos([-1000,-1000]);BX.CWindowFloat.superclass.Show.apply(this,arguments);this.adjustPos()};BX.COpener=function(arParams){this.PARAMS=arParams||{};this.MENU=arParams.MENU||[];this.DIV=arParams.DIV;this.ATTACH=arParams.ATTACH||arParams.DIV;this.ATTACH_MODE=arParams.ATTACH_MODE||"bottom";this.ACTIVE_CLASS=arParams.ACTIVE_CLASS||"";this.LEVEL=arParams.LEVEL||0;this.CLOSE_ON_CLICK=typeof arParams.CLOSE_ON_CLICK!="undefined"?!!arParams.CLOSE_ON_CLICK:true;this.ADJUST_ON_CLICK=typeof arParams.ADJUST_ON_CLICK!="undefined"?!!arParams.ADJUST_ON_CLICK:true;this.TYPE=this.PARAMS.TYPE=="hover"?"hover":"click";this._openTimeout=null;if(this.PARAMS.TYPE=="hover"&&arParams.TIMEOUT!==0){this.TIMEOUT=arParams.TIMEOUT||1000}else{this.TIMEOUT=0}if(!!this.PARAMS.MENU_URL){this.bMenuLoaded=false;this.bMenuLoading=false;this.MENU=[{TEXT:BX.message("JS_CORE_LOADING"),CLOSE_ON_CLICK:false}];if(this.PARAMS.MENU_PRELOAD){BX.defer(this.Load,this)()}}BX.ready(BX.defer(this.Init,this))};BX.COpener.prototype.Init=function(){this.DIV=BX(this.DIV);switch(this.TYPE){case"hover":BX.bind(this.DIV,"mouseover",BX.proxy(this.Open,this));BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break;case"click":BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break}this.bMenuInit=false};BX.COpener.prototype.Load=function(){if(this.PARAMS.MENU_URL&&!this.bMenuLoaded){if(!this.bMenuLoading){var url=this.PARAMS.MENU_URL;if(url.indexOf("sessid=")<=0){url+=(url.indexOf("?")>0?"&":"?")+"sessid="+BX.bitrix_sessid()}this.bMenuLoading=true;BX.ajax.loadJSON(url,BX.proxy(this.SetMenu,this),BX.proxy(this.LoadFailed,this))}}};BX.COpener.prototype.SetMenu=function(menu){this.bMenuLoaded=true;this.bMenuLoading=false;if(this.bMenuInit){this.MENU.setItems(menu)}else{this.MENU=menu}};BX.COpener.prototype.LoadFailed=function(type,error){this.bMenuLoading=false;this.SetMenu([{TEXT:BX.message("JS_CORE_NO_DATA"),CLOSE_ON_CLICK:true}]);BX.debug(arguments)};BX.COpener.prototype.checkAdminMenu=function(){if(document.documentElement.id=="bx-admin-prefix"){return true}return !!BX.findParent(this.DIV,{property:{id:"bx-admin-prefix"}})};BX.COpener.prototype.Toggle=function(e){this.__clear_timeout();if(!this.bMenuInit||!this.MENU.visible()){var t=this.TIMEOUT;this.TIMEOUT=0;this.Open(e);this.TIMEOUT=t}else{this.MENU.Close()}return !!(e||window.event)&&BX.PreventDefault(e)};BX.COpener.prototype.GetMenu=function(){if(!this.bMenuInit){if(BX.type.isArray(this.MENU)){this.MENU=new BX.CMenu({ITEMS:this.MENU,ATTACH_MODE:this.ATTACH_MODE,SET_ID:this.checkAdminMenu()?"bx-admin-prefix":"",CLOSE_ON_CLICK:!!this.CLOSE_ON_CLICK,ADJUST_ON_CLICK:!!this.ADJUST_ON_CLICK,LEVEL:this.LEVEL,parent:BX(this.DIV),parent_attach:BX(this.ATTACH)});if(this.LEVEL>0){BX.bind(this.MENU.DIV,"mouseover",BX.proxy(this._on_menu_hover,this));BX.bind(this.MENU.DIV,"mouseout",BX.proxy(this._on_menu_hout,this))}}BX.addCustomEvent(this.MENU,"onMenuOpen",BX.proxy(this.handler_onopen,this));BX.addCustomEvent(this.MENU,"onMenuClose",BX.proxy(this.handler_onclose,this));BX.addCustomEvent("onMenuItemHover",BX.proxy(this.handler_onover,this));this.bMenuInit=true}return this.MENU};BX.COpener.prototype.Open=function(){this.GetMenu();this.bOpen=true;this.__clear_timeout();if(this.TIMEOUT>0){BX.bind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this));this._openTimeout=setTimeout(BX.proxy(this.__open,this),this.TIMEOUT)}else{this.__open()}if(!!this.PARAMS.MENU_URL&&!this.bMenuLoaded){this._loadTimeout=setTimeout(BX.proxy(this.Load,this),parseInt(this.TIMEOUT/2))}return true};BX.COpener.prototype.__clear_timeout=function(){if(!!this._openTimeout){clearTimeout(this._openTimeout)}if(!!this._loadTimeout){clearTimeout(this._loadTimeout)}BX.unbind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this))};BX.COpener.prototype._on_menu_hover=function(){this.bMenuHover=true;this.__clear_timeout();if(this.ACTIVE_CLASS){BX.addClass(this.DIV,this.ACTIVE_CLASS)}};BX.COpener.prototype._on_menu_hout=function(){this.bMenuHover=false};BX.COpener.prototype.handler_onover=function(level,opener){if(this.bMenuHover){return}if(opener!=this&&level==this.LEVEL-1&&this.ACTIVE_CLASS){BX.removeClass(this.DIV,this.ACTIVE_CLASS)}if(this.bMenuInit&&level<=this.LEVEL-1&&this.MENU.visible()){if(opener!=this){this.__clear_timeout();this._openTimeout=setTimeout(BX.proxy(this.Close,this),this.TIMEOUT)}}};BX.COpener.prototype.handler_onopen=function(){this.bOpen=true;if(this.ACTIVE_CLASS){BX.addClass(this.DIV,this.ACTIVE_CLASS)}BX.defer(function(){BX.onCustomEvent(this,"onOpenerMenuOpen")},this)()};BX.COpener.prototype.handler_onclose=function(){this.bOpen=false;BX.onCustomEvent(this,"onOpenerMenuClose");if(this.ACTIVE_CLASS){BX.removeClass(this.DIV,this.ACTIVE_CLASS)}};BX.COpener.prototype.Close=function(){if(!this.bMenuInit){return}if(!!this._openTimeout){clearTimeout(this._openTimeout)}this.bOpen=false;this.__close()};BX.COpener.prototype.__open=function(){this.__clear_timeout();if(this.bMenuInit&&this.bOpen&&!this.MENU.visible()){this.MENU.Show()}};BX.COpener.prototype.__close=function(){if(this.bMenuInit&&!this.bOpen&&this.MENU.visible()){this.MENU.Hide()}};BX.COpener.prototype.__close_immediately=function(){this.bOpen=false;this.__close()};BX.COpener.prototype.isMenuVisible=function(){return null!=this.MENU.visible&&this.MENU.visible()};BX.CMenu=function(arParams){BX.CMenu.superclass.constructor.apply(this);this.DIV.style.width="auto";this.DIV.style.height="auto";this.PARAMS=arParams||{};this.PARTS={};this.PARAMS.ATTACH_MODE=this.PARAMS.ATTACH_MODE||"bottom";this.PARAMS.CLOSE_ON_CLICK=typeof this.PARAMS.CLOSE_ON_CLICK=="undefined"?true:this.PARAMS.CLOSE_ON_CLICK;this.PARAMS.ADJUST_ON_CLICK=typeof this.PARAMS.ADJUST_ON_CLICK=="undefined"?true:this.PARAMS.ADJUST_ON_CLICK;this.PARAMS.LEVEL=this.PARAMS.LEVEL||0;this.DIV.className="bx-core-popup-menu bx-core-popup-menu-"+this.PARAMS.ATTACH_MODE+" bx-core-popup-menu-level"+this.PARAMS.LEVEL+(typeof this.PARAMS.ADDITIONAL_CLASS!="undefined"?" "+this.PARAMS.ADDITIONAL_CLASS:"");if(!!this.PARAMS.SET_ID){this.DIV.id=this.PARAMS.SET_ID}if(this.PARAMS.LEVEL==0){this.ARROW=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-core-popup-menu-angle"},style:{left:"15px"}}))}if(!!this.PARAMS.CLASS_NAME){this.DIV.className+=" "+this.PARAMS.CLASS_NAME}BX.bind(this.DIV,"click",BX.eventCancelBubble);this.ITEMS=[];this.setItems(this.PARAMS.ITEMS);BX.addCustomEvent("onMenuOpen",BX.proxy(this._onMenuOpen,this));BX.addCustomEvent("onMenuItemSelected",BX.proxy(this.Hide,this))};BX.extend(BX.CMenu,BX.CWindowFloat);BX.CMenu.broadcastCloseEvent=function(){BX.onCustomEvent("onMenuItemSelected")};BX.CMenu._toggleChecked=function(){BX.toggleClass(this,"bx-core-popup-menu-item-checked")};BX.CMenu._itemDblClick=function(){window.location.href=this.href};BX.CMenu.prototype.toggleArrow=function(v){if(!!this.ARROW){if(typeof v=="undefined"){v=this.ARROW.style.visibility=="hidden"}this.ARROW.style.visibility=!!v?"visible":"hidden"}};BX.CMenu.prototype.visible=function(){return this.DIV.style.display!=="none"};BX.CMenu.prototype._onMenuOpen=function(menu,menu_level){if(this.visible()){if(menu_level==this.PARAMS.LEVEL&&menu!=this){this.Hide()}}};BX.CMenu.prototype.onUnRegister=function(){if(!this.visible()){return}this.Hide()};BX.CMenu.prototype.setItems=function(items){this.PARAMS.ITEMS=items;BX.cleanNode(this.DIV);if(!!this.ARROW){this.DIV.appendChild(this.ARROW)}if(this.PARAMS.ITEMS){this.PARAMS.ITEMS=BX.util.array_values(this.PARAMS.ITEMS);var bIcons=false;var cnt=0;for(var i=0,len=this.PARAMS.ITEMS.length;i<len;i++){if((i==0||i==len-1)&&this.PARAMS.ITEMS[i].SEPARATOR){continue}cnt++;if(!bIcons){bIcons=!!this.PARAMS.ITEMS[i].GLOBAL_ICON}this.addItem(this.PARAMS.ITEMS[i],i)}if(cnt===1){BX.addClass(this.DIV,"bx-core-popup-menu-single-item")}else{BX.removeClass(this.DIV,"bx-core-popup-menu-single-item")}if(!bIcons){BX.addClass(this.DIV,"bx-core-popup-menu-no-icons")}else{BX.removeClass(this.DIV,"bx-core-popup-menu-no-icons")}}};BX.CMenu.prototype.addItem=function(item){this.ITEMS.push(item);if(item.SEPARATOR){item.NODE=BX.create("DIV",{props:{className:"bx-core-popup-menu-separator"}})}else{var bHasMenu=(!!item.MENU&&((BX.type.isArray(item.MENU)&&item.MENU.length>0)||item.MENU instanceof BX.CMenu)||!!item.MENU_URL);if(item.DISABLED){item.CLOSE_ON_CLICK=false;item.LINK=null;item.ONCLICK=null;item.ACTION=null}item.NODE=BX.create(!!item.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?"A":"SPAN",{props:{className:"bx-core-popup-menu-item"+(bHasMenu?" bx-core-popup-menu-item-opener":"")+(!!item.DEFAULT?" bx-core-popup-menu-item-default":"")+(!!item.DISABLED?" bx-core-popup-menu-item-disabled":"")+(!!item.CHECKED?" bx-core-popup-menu-item-checked":""),title:!!BX.message.MENU_ENABLE_TOOLTIP||!!item.SHOW_TITLE?item.TITLE||"":"",BXMENULEVEL:this.PARAMS.LEVEL},attrs:!!item.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?{href:item.LINK||"javascript:void(0)"}:{},events:{mouseover:function(){BX.onCustomEvent("onMenuItemHover",[this.BXMENULEVEL,this.OPENER])}},html:'<span class="bx-core-popup-menu-item-icon'+(item.GLOBAL_ICON?" "+item.GLOBAL_ICON:"")+'"></span><span class="bx-core-popup-menu-item-text">'+item.TEXT+"</span>"});if(bHasMenu&&!item.DISABLED){item.NODE.OPENER=new BX.COpener({DIV:item.NODE,ACTIVE_CLASS:"bx-core-popup-menu-item-opened",TYPE:"hover",MENU:item.MENU,MENU_URL:item.MENU_URL,MENU_PRELOAD:!!item.MENU_PRELOAD,LEVEL:this.PARAMS.LEVEL+1,ATTACH_MODE:"right",TIMEOUT:500})}else{if(this.PARAMS.CLOSE_ON_CLICK&&(typeof item.CLOSE_ON_CLICK=="undefined"||!!item.CLOSE_ON_CLICK)){BX.bind(item.NODE,"click",BX.CMenu.broadcastCloseEvent)}else{if(this.PARAMS.ADJUST_ON_CLICK&&(typeof item.ADJUST_ON_CLICK=="undefined"||!!item.ADJUST_ON_CLICK)){BX.bind(item.NODE,"click",BX.defer(this.adjustPos,this))}}}if(bHasMenu&&!!item.LINK){BX.bind(item.NODE,"dblclick",BX.CMenu._itemDblClick)}if(typeof item.CHECKED!="undefined"){BX.bind(item.NODE,"click",BX.CMenu._toggleChecked)}item.ONCLICK=item.ACTION||item.ONCLICK;if(!!item.ONCLICK){if(BX.type.isString(item.ONCLICK)){item.ONCLICK=new Function("event",item.ONCLICK)}BX.bind(item.NODE,"click",item.ONCLICK)}}this.DIV.appendChild(item.NODE)};BX.CMenu.prototype._documentClickBind=function(){this._documentClickUnBind();BX.bind(document,"click",BX.proxy(this._documentClick,this))};BX.CMenu.prototype._documentClickUnBind=function(){BX.unbind(document,"click",BX.proxy(this._documentClick,this))};BX.CMenu.prototype._documentClick=function(e){e=e||window.event;if(!!e&&!(BX.getEventButton(e)&BX.MSLEFT)){return}this.Close()};BX.CMenu.prototype.Show=function(){BX.onCustomEvent(this,"onMenuOpen",[this,this.PARAMS.LEVEL]);BX.CMenu.superclass.Show.apply(this,[]);this.bCloseEventFired=false;BX.addCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this));(BX.defer(this._documentClickBind,this))()};BX.CMenu.prototype.Close=BX.CMenu.prototype.Hide=function(){if(!this.visible()){return}BX.removeCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this));this._documentClickUnBind();if(!this.bCloseEventFired){BX.onCustomEvent(this,"onMenuClose",[this,this.PARAMS.LEVEL]);this.bCloseEventFired=true}BX.CMenu.superclass.Hide.apply(this,arguments)};BX.CMenu.prototype.__adjustMenuToNode=function(){var pos=BX.pos(this.PARAMS.parent_attach),bFixed=!!BX.findParent(this.PARAMS.parent_attach,BX.is_fixed);if(bFixed){this.DIV.style.position="fixed"}else{this.DIV.style.position="absolute"}if(!pos.top){this.DIV.style.top="-1000px";this.DIV.style.left="-1000px"}if(this.bTimeoutSet){return}var floatWidth=this.DIV.offsetWidth,floatHeight=this.DIV.offsetHeight;if(!floatWidth){setTimeout(BX.delegate(function(){this.bTimeoutSet=false;this.__adjustMenuToNode()},this),100);this.bTimeoutSet=true;return}var menu_pos={},wndSize=BX.GetWindowSize();switch(this.PARAMS.ATTACH_MODE){case"bottom":menu_pos.top=pos.bottom+9;menu_pos.left=pos.left;var arrowPos=0;if(!!this.ARROW){if(pos.width>floatWidth){arrowPos=parseInt(floatWidth/2-7)}else{arrowPos=parseInt(Math.min(floatWidth,pos.width)/2-7)}if(arrowPos<7){menu_pos.left-=15;arrowPos+=15}}if(menu_pos.left>wndSize.scrollWidth-floatWidth-10){var orig_menu_pos=menu_pos.left;menu_pos.left=wndSize.scrollWidth-floatWidth-10;if(!!this.ARROW){arrowPos+=orig_menu_pos-menu_pos.left}}if(bFixed){menu_pos.left-=wndSize.scrollLeft}if(!!this.ARROW){this.ARROW.style.left=arrowPos+"px"}break;case"right":menu_pos.top=pos.top-1;menu_pos.left=pos.right;if(menu_pos.left>wndSize.scrollWidth-floatWidth-10){menu_pos.left=pos.left-floatWidth-1}break}if(bFixed){menu_pos.top-=wndSize.scrollTop}if(!!this.ARROW){this.ARROW.className="bx-core-popup-menu-angle"}if((menu_pos.top+floatHeight>wndSize.scrollTop+wndSize.innerHeight)||(menu_pos.top+floatHeight>wndSize.scrollHeight)){var new_top=this.PARAMS.ATTACH_MODE=="bottom"?pos.top-floatHeight-9:pos.bottom-floatHeight+1;if((new_top>wndSize.scrollTop)||(menu_pos.top+floatHeight>wndSize.scrollHeight)){if((menu_pos.top+floatHeight>wndSize.scrollHeight)){menu_pos.top=Math.max(0,wndSize.scrollHeight-floatHeight);this.toggleArrow(false)}else{menu_pos.top=new_top;if(!!this.ARROW){this.ARROW.className="bx-core-popup-menu-angle-bottom"}}}}if(menu_pos.top+menu_pos.left==0){this.Hide()}else{this.DIV.style.top=menu_pos.top+"px";this.DIV.style.left=menu_pos.left+"px"}};BX.CMenu.prototype.adjustToNode=function(el){this.PARAMS.parent_attach=BX(el)||this.PARAMS.parent_attach||this.PARAMS.parent;this.__adjustMenuToNode()};BX.CMenuOpener=function(arParams){BX.CMenuOpener.superclass.constructor.apply(this);this.PARAMS=arParams||{};this.setParent(this.PARAMS.parent);this.PARTS={};this.SETTINGS.drag_restrict=true;this.defaultAction=null;this.timeout=500;this.DIV.className="bx-component-opener";this.DIV.ondblclick=BX.PreventDefault;if(this.PARAMS.component_id){this.PARAMS.transform=!!this.PARAMS.transform}this.OPENERS=[];this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar"+(this.PARAMS.transform?" bx-context-toolbar-vertical-mode":"")}}));this.PARTS.INNER=this.DIV.firstChild.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-inner"},html:'<span class="bx-context-toolbar-drag-icon"></span><span class="bx-context-toolbar-vertical-line"></span><br>'}));this.EXTRA_BUTTONS={};var btnCount=0;for(var i=0,len=this.PARAMS.menu.length;i<len;i++){var item=this.addItem(this.PARAMS.menu[i]);if(null!=item){btnCount++;this.PARTS.INNER.appendChild(item);this.PARTS.INNER.appendChild(BX.create("BR"))}}var bHasButtons=btnCount>0;this.PARTS.ICONS=this.PARTS.INNER.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-icons"}}));if(this.PARAMS.component_id){this.PARAMS.pin=!!this.PARAMS.pin;if(bHasButtons){this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-separator"}}))}this.PARTS.ICON_PIN=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin"},events:{click:BX.delegate(this.__pin_btn_clicked,this)}}))}if(this.EXTRA_BUTTONS.components2_props){var btn=this.EXTRA_BUTTONS.components2_props||{URL:"javascript:void(0)"};if(null==this.defaultAction){this.defaultAction=btn.ONCLICK;this.defaultActionTitle=btn.TITLE||btn.TEXT}btn.URL="javascript:"+BX.util.urlencode(btn.ONCLICK);this.ATTACH=this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button bx-context-toolbar-button-settings"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"},children:[BX.create("A",{attrs:{href:btn.URL},events:{mouseover:BX.proxy(this.__msover_text,this),mouseout:BX.proxy(this.__msout_text,this),mousedown:BX.proxy(this.__msdown_text,this)},html:'<span class="bx-context-toolbar-button-icon bx-context-toolbar-settings-icon"></span>'}),BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-button-arrow"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},html:'<span class="bx-context-toolbar-button-arrow"></span>'})]})]}));this.OPENER=this.ATTACH.firstChild.lastChild;var opener=this.attachMenu(this.EXTRA_BUTTONS.components2_submenu["MENU"]);BX.addCustomEvent(opener,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this));BX.addCustomEvent(opener,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(btnCount>1){this.PARTS.ICONS.appendChild(BX.create("span",{props:{className:"bx-context-toolbar-separator bx-context-toolbar-separator-switcher"}}));this.ICON_TRANSFORM=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-switcher"},events:{click:BX.delegate(this.__trf_btn_clicked,this)}}))}if(this.PARAMS.HINT){this.DIV.BXHINT=this.HINT=new BX.CHint({parent:this.DIV,hint:this.PARAMS.HINT.TEXT||"",title:this.PARAMS.HINT.TITLE||"",hide_timeout:this.timeout/2,preventHide:false})}BX.addCustomEvent(this,"onWindowDragFinished",BX.delegate(this.__onMoveFinished,this));BX.addCustomEvent("onDynamicModeChange",BX.delegate(this.__onDynamicModeChange,this));BX.addCustomEvent("onTopPanelCollapse",BX.delegate(this.__onPanelCollapse,this));BX.addCustomEvent("onMenuOpenerMoved",BX.delegate(this.checkPosition,this));BX.addCustomEvent("onMenuOpenerUnhide",BX.delegate(this.checkPosition,this));if(this.OPENERS){for(i=0,len=this.OPENERS.length;i<len;i++){BX.addCustomEvent(this.OPENERS[i],"onOpenerMenuOpen",BX.proxy(this.__hide_hint,this))}}};BX.extend(BX.CMenuOpener,BX.CWindowFloat);BX.CMenuOpener.prototype.setParent=function(new_parent){new_parent=BX(new_parent);if(new_parent.OPENER&&new_parent.OPENER!=this){new_parent.OPENER.Close();new_parent.OPENER.clearHoverHoutEvents()}if(this.PARAMS.parent&&this.PARAMS.parent!=new_parent){this.clearHoverHoutEvents();this.PARAMS.parent.OPENER=null}this.PARAMS.parent=new_parent;this.PARAMS.parent.OPENER=this};BX.CMenuOpener.prototype.setHoverHoutEvents=function(hover,hout){if(!this.__opener_events_set){BX.bind(this.Get(),"mouseover",hover);BX.bind(this.Get(),"mouseout",hout);this.__opener_events_set=true}};BX.CMenuOpener.prototype.clearHoverHoutEvents=function(){if(this.Get()){BX.unbindAll(this.Get());this.__opener_events_set=false}};BX.CMenuOpener.prototype.unclosable=true;BX.CMenuOpener.prototype.__check_intersection=function(pos_self,pos_other){return !(pos_other.right<=pos_self.left||pos_other.left>=pos_self.right||pos_other.bottom<=pos_self.top||pos_other.top>=pos_self.bottom)};BX.CMenuOpener.prototype.__msover_text=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-hover")}};BX.CMenuOpener.prototype.__msout_text=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")}};BX.CMenuOpener.prototype.__msover_arrow=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover")}};BX.CMenuOpener.prototype.__msout_arrow=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")}};BX.CMenuOpener.prototype.__msdown_text=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-active")}};BX.CMenuOpener.prototype.__msdown_arrow=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-active")}};BX.CMenuOpener.prototype.__menu_close=function(){this._menu_open=false;this.bx_active=false;BX.removeClass(this.ATTACH,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active");if(!this.bx_hover){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover");this.bx_hover=false}};BX.CMenuOpener.prototype.__menu_open=function(){this._menu_open=true};BX.CMenuOpener.prototype.checkPosition=function(){if(this.isMenuVisible()||this.DIV.style.display=="none"||this==BX.proxy_context||BX.proxy_context.zIndex>this.zIndex){return}this.correctPosition(BX.proxy_context)};BX.CMenuOpener.prototype.correctPosition=function(opener){var pos_self=BX.pos(this.DIV),pos_other=BX.pos(opener.Get());if(this.__check_intersection(pos_self,pos_other)){var new_top=pos_other.top-pos_self.height;if(new_top<0){new_top=pos_other.bottom}this.DIV.style.top=new_top+"px";BX.addCustomEvent(opener,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));BX.onCustomEvent(this,"onMenuOpenerMoved")}};BX.CMenuOpener.prototype.restorePosition=function(){if(!this.MOUSEOVER&&!this.isMenuVisible()){if(this.originalPos){this.DIV.style.top=this.originalPos.top+"px"}BX.removeCustomEvent(BX.proxy_context,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));if(this.restore_pos_timeout){clearTimeout(this.restore_pos_timeout)}}else{this.restore_pos_timeout=setTimeout(BX.proxy(this.restorePosition,this),this.timeout)}};BX.CMenuOpener.prototype.Show=function(){BX.CMenuOpener.superclass.Show.apply(this,arguments);this.SetDraggable(this.PARTS.INNER.firstChild);this.DIV.style.width="auto";this.DIV.style.height="auto";if(!this.PARAMS.pin){this.DIV.style.left="-1000px";this.DIV.style.top="-1000px";this.Hide()}else{this.bPosAdjusted=true;this.bMoved=true;if(this.PARAMS.top){this.DIV.style.top=this.PARAMS.top+"px"}if(this.PARAMS.left){this.DIV.style.left=this.PARAMS.left+"px"}this.DIV.style.display=(!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders)?"block":"none";if(this.DIV.style.display=="block"){setTimeout(BX.delegate(function(){BX.onCustomEvent(this,"onMenuOpenerUnhide")},this),50)}}};BX.CMenuOpener.prototype.executeDefaultAction=function(){if(this.defaultAction){if(BX.type.isFunction(this.defaultAction)){this.defaultAction()}else{if(BX.type.isString(this.defaultAction)){BX.evalGlobal(this.defaultAction)}}}};BX.CMenuOpener.prototype.__onDynamicModeChange=function(val){this.DIV.style.display=val?"block":"none"};BX.CMenuOpener.prototype.__onPanelCollapse=function(bCollapsed,dy){this.DIV.style.top=(parseInt(this.DIV.style.top)+dy)+"px";if(this.PARAMS.pin){this.__savePosition()}};BX.CMenuOpener.prototype.__onMoveFinished=function(){BX.onCustomEvent(this,"onMenuOpenerMoved");this.bMoved=true;if(this.PARAMS.pin){this.__savePosition()}};BX.CMenuOpener.prototype.__savePosition=function(){var arOpts={};arOpts.pin=this.PARAMS.pin;if(!this.PARAMS.pin){arOpts.top=false;arOpts.left=false;arOpts.transform=false}else{arOpts.transform=this.PARAMS.transform;if(this.bMoved){arOpts.left=parseInt(this.DIV.style.left);arOpts.top=parseInt(this.DIV.style.top)}}BX.WindowManager.saveWindowOptions(this.PARAMS.component_id,arOpts)};BX.CMenuOpener.prototype.__pin_btn_clicked=function(){this.Pin()};BX.CMenuOpener.prototype.Pin=function(val){if(null==val){this.PARAMS.pin=!this.PARAMS.pin}else{this.PARAMS.pin=!!val}this.PARTS.ICON_PIN.className=(this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin");this.__savePosition()};BX.CMenuOpener.prototype.__trf_btn_clicked=function(){this.Transform()};BX.CMenuOpener.prototype.Transform=function(val){var pos={};if(null==val){this.PARAMS.transform=!this.PARAMS.transform}else{this.PARAMS.transform=!!val}if(this.bMoved){pos=BX.pos(this.DIV)}if(this.PARAMS.transform){BX.addClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode")}else{BX.removeClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode")}if(!this.bMoved){this.adjustPos()}else{this.DIV.style.left=(pos.right-this.DIV.offsetWidth-(BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0))+"px"}this.__savePosition()};BX.CMenuOpener.prototype.adjustToNodeGetPos=function(){var pos=BX.pos(this.PARAMS.parent);var scrollSize=BX.GetWindowScrollSize();var floatWidth=this.DIV.offsetWidth;pos.left-=BX.admin.__border_dx;pos.top-=BX.admin.__border_dx;if(true||!this.PARAMS.transform){pos.top-=45}if(pos.left>scrollSize.scrollWidth-floatWidth){pos.left=scrollSize.scrollWidth-floatWidth}return pos};BX.CMenuOpener.prototype.addItem=function(item){if(item.TYPE){this.EXTRA_BUTTONS[item.TYPE]=item;return null}else{var q=new BX.CMenuOpenerItem(item);if(null==this.defaultAction){if(q.item.ONCLICK){this.defaultAction=item.ONCLICK}else{if(q.item.MENU){this.defaultAction=BX.delegate(function(){this.Open()},q.item.OPENER)}}this.defaultActionTitle=item.TITLE||item.TEXT;BX.addClass(q.Get(),"bx-content-toolbar-default")}if(q.item.OPENER){this.OPENERS[this.OPENERS.length]=q.item.OPENER}return q.Get()}};BX.CMenuOpener.prototype.attachMenu=function(menu){var opener=new BX.COpener({DIV:this.OPENER,ATTACH:this.ATTACH,MENU:menu,TYPE:"click"});this.OPENERS[this.OPENERS.length]=opener;return opener};BX.CMenuOpener.prototype.__hide_hint=function(){if(this.HINT){this.HINT.__hide_immediately()}};BX.CMenuOpener.prototype.isMenuVisible=function(){for(var i=0,len=this.OPENERS.length;i<len;i++){if(this.OPENERS[i].isMenuVisible()){return true}}return false};BX.CMenuOpener.prototype.Hide=function(){if(!this.PARAMS.pin){this.DIV.style.display="none";BX.onCustomEvent(this,"onMenuOpenerHide")}};BX.CMenuOpener.prototype.UnHide=function(){this.DIV.style.display="block";if(!this.bPosAdjusted&&!this.PARAMS.pin){this.adjustPos();this.bPosAdjusted=true}if(null==this.originalPos&&!this.bMoved){this.originalPos=BX.pos(this.DIV)}BX.onCustomEvent(this,"onMenuOpenerUnhide")};BX.CMenuOpenerItem=function(item){this.item=item;if(this.item.ACTION&&!this.item.ONCLICK){this.item.ONCLICK=this.item.ACTION}this.DIV=BX.create("SPAN");this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-underlay"}}));this.WRAPPER=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-wrapper"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button",title:item.TITLE},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"}})]})]}));var btn_icon=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-icon"+(this.item.ICON||this.item.ICONCLASS?" "+(this.item.ICON||this.item.ICONCLASS):"")},attrs:(!(this.item.ICON||this.item.ICONCLASS)&&(this.item.SRC||this.item.IMAGE))?{style:"background: scroll transparent url("+(this.item.SRC||this.item.IMAGE)+") no-repeat center center !important;"}:{}}),btn_text=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-text"},text:this.item.TEXT});if(this.item.ACTION&&!this.item.ONCLICK){this.item.ONCLICK=this.item.ACTION}this.bHasMenu=!!this.item.MENU;this.bHasAction=!!this.item.ONCLICK;if(this.bHasAction){this.LINK=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:this.bHasMenu?BX.proxy(this.__msover_text,this):BX.proxy(this.__msover,this),mouseout:this.bHasMenu?BX.proxy(this.__msout_text,this):BX.proxy(this.__msout,this),mousedown:this.bHasMenu?BX.proxy(this.__msdown_text,this):BX.proxy(this.__msdown,this)},children:[btn_icon,btn_text]}));if(this.bHasMenu){this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{props:{className:"bx-context-toolbar-button-arrow"},attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-arrow"}})]}))}}else{if(this.bHasMenu){this.item.ONCLICK=null;this.LINK=this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover,this),mouseout:BX.proxy(this.__msout,this),mousedown:BX.proxy(this.__msdown,this)},children:[btn_icon,btn_text]}));this.LINK.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-single-button-arrow"}}))}}if(this.bHasMenu){this.item.SUBMENU=new BX.CMenu({ATTACH_MODE:"bottom",ITEMS:this.item.MENU,parent:this.LINK_MENU,parent_attach:this.WRAPPER.firstChild});this.item.OPENER=new BX.COpener({DIV:this.LINK_MENU,TYPE:"click",MENU:this.item.SUBMENU});BX.addCustomEvent(this.item.OPENER,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this));BX.addCustomEvent(this.item.OPENER,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(this.bHasAction){BX.bind(this.LINK,"click",BX.delegate(this.__click,this))}};BX.CMenuOpenerItem.prototype.Get=function(){return this.DIV};BX.CMenuOpenerItem.prototype.__msover=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover")}};BX.CMenuOpenerItem.prototype.__msout=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-active")}};BX.CMenuOpenerItem.prototype.__msover_text=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover")}};BX.CMenuOpenerItem.prototype.__msout_text=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")}};BX.CMenuOpenerItem.prototype.__msover_arrow=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover")}};BX.CMenuOpenerItem.prototype.__msout_arrow=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")}};BX.CMenuOpenerItem.prototype.__msdown=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active")}};BX.CMenuOpenerItem.prototype.__msdown_text=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-active")}};BX.CMenuOpenerItem.prototype.__msdown_arrow=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-active")}};BX.CMenuOpenerItem.prototype.__menu_close=function(){this._menu_open=false;this.bx_active=false;BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active");if(!this.bx_hover){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover");this.bx_hover=false}};BX.CMenuOpenerItem.prototype.__menu_open=function(){this._menu_open=true};BX.CMenuOpenerItem.prototype.__click=function(){BX.evalGlobal(this.item.ONCLICK)};BX.CPageOpener=function(arParams){BX.CPageOpener.superclass.constructor.apply(this,arguments);this.timeout=505;window.PAGE_EDIT_CONTROL=this};BX.extend(BX.CPageOpener,BX.CMenuOpener);BX.CPageOpener.prototype.checkPosition=function(){if(this==BX.proxy_context){return}this.correctPosition(BX.proxy_context)};BX.CPageOpener.prototype.correctPosition=function(opener){if(this.bPosCorrected){return}var pos_self;if(this.DIV.style.display=="none"){pos_self=this.adjustToNodeGetPos();pos_self.bottom=pos_self.top+30;pos_self.right=pos_self.left+300}else{pos_self=BX.pos(this.DIV)}var pos_other=BX.pos(opener.Get());if(this.__check_intersection(pos_self,pos_other)){this.DIV.style.display="none";BX.addCustomEvent(opener,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));this.bPosCorrected=true}};BX.CPageOpener.prototype.restorePosition=function(){if(BX.proxy_context&&BX.proxy_context.Get().style.display=="none"){this.bPosCorrected=false;if(this.PARAMS.parent.bx_over||this.PARAMS.pin){this.UnHide()}BX.removeCustomEvent("onMenuOpenerHide",BX.proxy(this.restorePosition,this))}};BX.CPageOpener.prototype.UnHide=function(){if(!this.bPosCorrected){BX.CPageOpener.superclass.UnHide.apply(this,arguments)}};BX.CPageOpener.prototype.Remove=function(){BX.admin.removeComponentBorder(this.PARAMS.parent);BX.userOptions.save("global","settings","page_edit_control_enable","N");this.DIV.style.display="none"};BX.CHintSimple=function(){BX.CHintSimple.superclass.constructor.apply(this,arguments)};BX.extend(BX.CHintSimple,BX.CHint);BX.CHintSimple.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-tooltip-simple"},style:{display:"none"},children:[(this.CONTENT=BX.create("DIV"))]}));if(this.HINT_TITLE){this.CONTENT.appendChild(BX.create("B",{text:this.HINT_TITLE}))}if(this.HINT){this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV")).appendChild(BX.create("SPAN",{html:this.HINT}))}if(this.PARAMS.preventHide){BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this));BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))}this.bInited=true};BX.adminInformer={itemsShow:3,Init:function(itemsShow){if(itemsShow){BX.adminInformer.itemsShow=itemsShow}var informer=BX("admin-informer");if(informer){document.body.appendChild(informer)}BX.addCustomEvent("onTopPanelCollapse",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},Toggle:function(notifyBlock){var informer=BX("admin-informer");if(!informer){return false}var pos=BX.pos(notifyBlock);informer.style.top=(parseInt(pos.top)+parseInt(pos.height)+7)+"px";informer.style.left=pos.left+"px";if(!BX.hasClass(informer,"adm-informer-active")){BX.adminInformer.Show(informer)}else{BX.adminInformer.Hide(informer)}return false},Close:function(){BX.adminInformer.Hide(BX("admin-informer"))},OnInnerClick:function(event){var target=event.target||event.srcElement;if(target.nodeName.toLowerCase()!="a"||BX.hasClass(target,"adm-informer-footer")){return BX.PreventDefault(event)}return true},ToggleExtra:function(){var footerLink=BX("adm-informer-footer");if(BX.hasClass(footerLink,"adm-informer-footer-collapsed")){this.ShowAll()}else{this.HideExtra()}return false},ShowAll:function(){var informer=BX("admin-informer");for(var i=0;i<informer.children.length;i++){if(BX.hasClass(informer.children[i],"adm-informer-item")&&informer.children[i].style.display=="none"){informer.children[i].style.display="block"}}var footerLink=BX("adm-informer-footer");if(footerLink.textContent!==undefined){footerLink.textContent=BX.message("JSADM_AI_HIDE_EXTRA")}else{footerLink.innerText=BX.message("JSADM_AI_HIDE_EXTRA")}BX.removeClass(footerLink,"adm-informer-footer-collapsed");return false},HideExtra:function(){var informer=BX("admin-informer");var hided=0;for(var i=BX.adminInformer.itemsShow+1;i<informer.children.length;i++){if(BX.hasClass(informer.children[i],"adm-informer-item")&&informer.children[i].style.display=="block"){informer.children[i].style.display="none";hided++}}var footerLink=BX("adm-informer-footer");var linkText=BX.message("JSADM_AI_ALL_NOTIF")+" ("+(BX.adminInformer.itemsShow+parseInt(hided))+")";if(footerLink.textContent!==undefined){footerLink.textContent=linkText}else{footerLink.innerText=linkText}BX.addClass(footerLink,"adm-informer-footer-collapsed");return false},Show:function(informer){var notifButton=BX("adm-header-notif-block");if(notifButton){BX.addClass(notifButton,"adm-header-notif-block-active")}BX.onCustomEvent(informer,"onBeforeAdminInformerShow");setTimeout(BX.proxy(function(){BX.bind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},BX.adminInformer),0);BX.addClass(informer,"adm-informer-active");setTimeout(function(){BX.addClass(informer,"adm-informer-animate")},0)},Hide:function(informer){var notifButton=BX("adm-header-notif-block");if(notifButton){BX.removeClass(notifButton,"adm-header-notif-block-active")}BX.unbind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer));BX.removeClass(informer,"adm-informer-animate");if(this.IsAnimationSupported()){setTimeout(function(){BX.removeClass(informer,"adm-informer-active")},300)}else{BX.removeClass(informer,"adm-informer-active")}BX.onCustomEvent(informer,"onAdminInformerHide")},IsAnimationSupported:function(){var d=document.body||document.documentElement;if(typeof(d.style.transition)=="string"){return true}else{if(typeof(d.style.MozTransition)=="string"){return true}else{if(typeof(d.style.OTransition)=="string"){return true}else{if(typeof(d.style.WebkitTransition)=="string"){return true}else{if(typeof(d.style.msTransition)=="string"){return true}}}}}return false},SetItemHtml:function(itemIdx,html){var itemHtmlDiv=BX("adm-informer-item-html-"+itemIdx);if(!itemHtmlDiv){return false}itemHtmlDiv.innerHTML=html;return true},SetItemFooter:function(itemIdx,html){var itemFooterDiv=BX("adm-informer-item-footer-"+itemIdx);if(!itemFooterDiv){return false}itemFooterDiv.innerHTML=html;if(html){itemFooterDiv.style.display="block"}else{itemFooterDiv.style.display="none"}return true}}})(window);var phpVars;if(!phpVars){phpVars={ADMIN_THEME_ID:".default",LANGUAGE_ID:"en",FORMAT_DATE:"DD.MM.YYYY",FORMAT_DATETIME:"DD.MM.YYYY HH:MI:SS",opt_context_ctrl:false,cookiePrefix:"BITRIX_SM",titlePrefix:"",bitrix_sessid:"",messHideMenu:"",messShowMenu:"",messHideButtons:"",messShowButtons:"",messFilterInactive:"",messFilterActive:"",messFilterLess:"",messLoading:"Loading...",messMenuLoading:"",messMenuLoadingTitle:"",messNoData:"",messExpandTabs:"",messCollapseTabs:"",messPanelFixOn:"",messPanelFixOff:"",messPanelCollapse:"",messPanelExpand:""}}var jsUtils={arEvents:Array(),addEvent:function(b,d,c,a){if(b.attachEvent){b.attachEvent("on"+d,c)}else{if(b.addEventListener){b.addEventListener(d,c,false)}else{b["on"+d]=c}}this.arEvents[this.arEvents.length]={element:b,event:d,fn:c}},removeEvent:function(a,c,b){if(a.detachEvent){a.detachEvent("on"+c,b)}else{if(a.removeEventListener){a.removeEventListener(c,b,false)}else{a["on"+c]=null}}},removeAllEvents:function(b){var a;for(a=0;a<this.arEvents.length;a++){if(this.arEvents[a]&&(b==false||b==this.arEvents[a].element)){jsUtils.removeEvent(this.arEvents[a].element,this.arEvents[a].event,this.arEvents[a].fn);this.arEvents[a]=null}}if(b==false){this.arEvents.length=0}},IsDoctype:function(){if(document.compatMode){return(document.compatMode=="CSS1Compat")}if(document.documentElement&&document.documentElement.clientHeight){return true}return false},GetRealPos:function(c){if(window.BX){return BX.pos(c)}if(!c||!c.offsetParent){return false}var b=Array();b.left=c.offsetLeft;b.top=c.offsetTop;var a=c.offsetParent;while(a&&a.tagName!="BODY"){b.left+=a.offsetLeft;b.top+=a.offsetTop;a=a.offsetParent}b.right=b.left+c.offsetWidth;b.bottom=b.top+c.offsetHeight;return b},FindChildObject:function(h,b,f,d){if(!h){return null}var k=b.toUpperCase();var i=(f?f.toLowerCase():null);var c=h.childNodes.length;for(var g=0;g<c;g++){var a=h.childNodes[g];if(a.tagName&&a.tagName.toUpperCase()==k){if(!f||a.className.toLowerCase()==i){return a}}if(d==true){var e;if((e=jsUtils.FindChildObject(a,b,f,true))){return e}}}return null},FindParentObject:function(e,g,d){if(!e){return null}var f=e;var a=g.toUpperCase();var b=(d?d.toLowerCase():null);while(f.parentNode){var c=f.parentNode;if(c.tagName&&c.tagName.toUpperCase()==a){if(!d||c.className.toLowerCase()==b){return c}}f=c}return null},FindNextSibling:function(c,e){if(!c){return null}var d=c;var a=e.toUpperCase();while(d.nextSibling){var b=d.nextSibling;if(b.tagName&&b.tagName.toUpperCase()==a){return b}d=b}return null},FindPreviousSibling:function(c,e){if(!c){return null}var d=c;var a=e.toUpperCase();while(d.previousSibling){var b=d.previousSibling;if(b.tagName&&b.tagName.toUpperCase()==a){return b}d=b}return null},bOpera:navigator.userAgent.toLowerCase().indexOf("opera")!=-1,bIsIE:document.attachEvent&&navigator.userAgent.toLowerCase().indexOf("opera")==-1,IsIE:function(){return this.bIsIE},IsOpera:function(){return this.bOpera},IsSafari:function(){var a=navigator.userAgent.toLowerCase();return(/webkit/.test(a))},IsEditor:function(){var c=navigator.userAgent.toLowerCase();var a=(c.match(/.+(msie)[\/: ]([\d.]+)/)||[])[2];var b=/webkit/.test(c);if(this.IsOpera()||(document.all&&!document.compatMode&&a<6)||b){return false}return true},ToggleDiv:function(b){var a=document.getElementById(b).style;if(a.display!="none"){a.display="none"}else{a.display="block"}return(a.display!="none")},urlencode:function(a){return escape(a).replace(new RegExp("\\+","g"),"%2B")},OpenWindow:function(c,e,a){var b=screen.width,d=screen.height;if(this.IsOpera()){b=document.body.offsetWidth;d=document.body.offsetHeight}window.open(c,"","status=no,scrollbars=yes,resizable=yes,width="+e+",height="+a+",top="+Math.floor((d-a)/2-14)+",left="+Math.floor((b-e)/2-5))},SetPageTitle:function(b){document.title=phpVars.titlePrefix+b;var a=document.getElementsByTagName("H1");if(a){a[0].innerHTML=b}},LoadPageToDiv:function(a,b){var c=document.getElementById(b);if(!c){return}CHttpRequest.Action=function(d){CloseWaitWindow();document.getElementById(b).innerHTML=d};ShowWaitWindow();CHttpRequest.Send(a)},trim:function(b){if(typeof b=="string"||typeof b=="object"&&b.constructor==String){var c,a;a=/^[\s\r\n]+/g;c=b.replace(a,"");a=/[\s\r\n]+$/g;c=c.replace(a,"");return c}else{return b}},Redirect:function(b,a){var c=null,d=false;if(b&&b.length>0){c=b[0]}if(!c){c=window.event}if(c){d=c.shiftKey}if(d){window.open(a)}else{window.location.href=a}},False:function(){return false},AlignToPos:function(g,c,e){var b=g.left,f=g.bottom;var a=jsUtils.GetWindowScrollPos();var d=jsUtils.GetWindowInnerSize();if((d.innerWidth+a.scrollLeft)-(g.left+c)<0){if(g.right-c>=0){b=g.right-c}else{b=a.scrollLeft}}if((d.innerHeight+a.scrollTop)-(g.bottom+e)<0){if(g.top-e>=0){f=g.top-e}else{f=a.scrollTop}}return{left:b,top:f}},EvalGlobal:function(script){try{if(window.execScript){window.execScript(script,"javascript")}else{if(jsUtils.IsSafari()){window.setTimeout(script,0)}else{window.eval(script)}}}catch(e){}},GetStyleValue:function(c,a){var b;if(c.currentStyle){b=c.currentStyle[a]}else{if(window.getComputedStyle){b=document.defaultView.getComputedStyle(c,null).getPropertyValue(a)}}if(!b){b=""}return b},GetWindowInnerSize:function(c){var b,a;if(!c){c=document}if(self.innerHeight){b=self.innerWidth;a=self.innerHeight}else{if(c.documentElement&&(c.documentElement.clientHeight||c.documentElement.clientWidth)){b=c.documentElement.clientWidth;a=c.documentElement.clientHeight}else{if(c.body){b=c.body.clientWidth;a=c.body.clientHeight}}}return{innerWidth:b,innerHeight:a}},GetWindowScrollPos:function(c){var b,a;if(!c){c=document}if(self.pageYOffset){b=self.pageXOffset;a=self.pageYOffset}else{if(c.documentElement&&(c.documentElement.scrollTop||c.documentElement.scrollLeft)){b=document.documentElement.scrollLeft;a=document.documentElement.scrollTop}else{if(c.body){b=c.body.scrollLeft;a=c.body.scrollTop}}}return{scrollLeft:b,scrollTop:a}},GetWindowScrollSize:function(c){var b,a;if(!c){c=document}if((c.compatMode&&c.compatMode=="CSS1Compat")){b=c.documentElement.scrollWidth;a=c.documentElement.scrollHeight}else{if(c.body.scrollHeight>c.body.offsetHeight){a=c.body.scrollHeight}else{a=c.body.offsetHeight}if(c.body.scrollWidth>c.body.offsetWidth||(c.compatMode&&c.compatMode=="BackCompat")||(c.documentElement&&!c.documentElement.clientWidth)){b=c.body.scrollWidth}else{b=c.body.offsetWidth}}return{scrollWidth:b,scrollHeight:a}},GetWindowSize:function(){var a=jsUtils.GetWindowInnerSize();var c=jsUtils.GetWindowScrollPos();var b=jsUtils.GetWindowScrollSize();return{innerWidth:a.innerWidth,innerHeight:a.innerHeight,scrollLeft:c.scrollLeft,scrollTop:c.scrollTop,scrollWidth:b.scrollWidth,scrollHeight:b.scrollHeight}},arCustomEvents:{},addCustomEvent:function(a,b,c,d){if(!this.arCustomEvents[a]){this.arCustomEvents[a]=[]}if(!c){c=[]}if(!d){d=false}this.arCustomEvents[a].push({handler:b,arParams:c,obj:d})},removeCustomEvent:function(b,d){if(!this.arCustomEvents[b]){return}var a=this.arCustomEvents[b].length;if(a==1){delete this.arCustomEvents[b];return}for(var c=0;c<a;c++){if(!this.arCustomEvents[b][c]){continue}if(this.arCustomEvents[b][c].handler==d){delete this.arCustomEvents[b][c];return}}},onCustomEvent:function(c,b){if(!this.arCustomEvents[c]){return}if(!b){b=[]}var e;for(var d=0,a=this.arCustomEvents[c].length;d<a;d++){e=this.arCustomEvents[c][d];if(!e||!e.handler){continue}if(e.obj){e.handler.call(e.obj,e.arParams,b)}else{e.handler(e.arParams,b)}}},loadJSFile:function(a,e,c){if(!c){c=document}if(typeof a=="string"){a=[a]}var d=function(){if(!e){return}if(typeof e=="function"){return e()}if(typeof e!="object"||!e.func){return}var f=e.params||{};if(e.obj){e.func.apply(e.obj,f)}else{e.func(f)}};var b=function(g){if(g>=a.length){return d()}var h=c.body.appendChild(c.createElement("script"));h.src=a[g];var f=false;h.onload=h.onreadystatechange=function(){if(!f&&(!h.readyState||h.readyState=="loaded"||h.readyState=="complete")){f=true;setTimeout(function(){b(++g)},50)}}};b(0)},loadCSSFile:function(h,g,c){if(typeof h=="string"){var a=true;h=[h]}var e,b=h.length,d=[];if(b==0){return}if(!g){g=document}if(!c){c=window}if(!c.bxhead){var j=g.getElementsByTagName("HEAD");c.bxhead=j[0]}if(!c.bxhead){return}for(e=0;e<b;e++){var f=document.createElement("LINK");f.href=h[e];f.rel="stylesheet";f.type="text/css";c.bxhead.appendChild(f);d.push(f)}if(a){return f}return d},appendBXHint:function(c,b){if(!c||!c.parentNode||!b){return}var a=new BXHint(b);c.parentNode.insertBefore(a.oIcon,c);c.parentNode.removeChild(c);a.oIcon.style.marginLeft="5px"},PreventDefault:function(a){if(!a){a=window.event}if(a.stopPropagation){a.preventDefault();a.stopPropagation()}else{a.cancelBubble=true;a.returnValue=false}return false},CreateElement:function(a,c,b,e){if(!e){e=document}var f=e.createElement(a),d;if(c){for(d in c){if(d=="className"||d=="class"){f.setAttribute("class",c[d]);if(jsUtils.IsIE()){f.setAttribute("className",c[d])}continue}if(c[d]!=undefined&&c[d]!=null){f.setAttribute(d,c[d])}}}if(b){for(d in b){f.style[d]=b[d]}}return f},in_array:function(c,b){for(var a=0;a<b.length;a++){if(b[a]==c){return true}}return false},htmlspecialchars:function(a){if(!a.replace){return a}return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}};function JCFloatDiv(){var a=this;this.floatDiv=null;this.x=this.y=0;this.Create=function(b){var c=document.body.appendChild(document.createElement("DIV"));c.id=b.id;c.style.position="absolute";c.style.left="-10000px";c.style.top="-10000px";if(b.className){c.className=b.className}if(b.zIndex){c.style.zIndex=b.zIndex}if(b.width){c.style.width=b.width+"px"}if(b.height){c.style.height=b.height+"px"}return c};this.Show=function(b,f,j,c,h,e){if(e!==false){e=true}var i=parseInt(b.style.zIndex);if(i<=0||isNaN(i)){i=100}b.style.zIndex=i;if(f<0){f=0}if(j<0){j=0}b.style.left=parseInt(f)+"px";b.style.top=parseInt(j)+"px";if(jsUtils.IsIE()&&e===true){var d=document.getElementById(b.id+"_frame");if(!d){d=document.createElement("IFRAME");d.src="javascript:''";d.id=b.id+"_frame";d.style.position="absolute";d.style.borderWidth="0px";d.style.zIndex=i-1;document.body.appendChild(d)}d.style.width=b.offsetWidth+"px";d.style.height=b.offsetHeight+"px";d.style.left=b.style.left;d.style.top=b.style.top;d.style.visibility="visible"}b.restrictDrag=h||false;if(isNaN(c)){c=5}if(c>0){var g=document.getElementById(b.id+"_shadow");if(!g){if(jsUtils.IsIE()){g=document.createElement("DIV");g.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/images/shadow.png',sizingMethod='scale')"}else{g=document.createElement("IMG");g.src="/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/images/shadow.png"}g.id=b.id+"_shadow";g.style.position="absolute";g.style.zIndex=i-2;g.style.left="-1000px";g.style.top="-1000px";g.style.lineHeight="normal";g.className="bx-js-float-shadow";document.body.appendChild(g)}g.style.width=b.offsetWidth+"px";g.style.height=b.offsetHeight+"px";g.style.left=parseInt(b.style.left)+c+"px";g.style.top=parseInt(b.style.top)+c+"px";g.style.visibility="visible"}b.dxShadow=c};this.Close=function(d){if(!d){return}var b=document.getElementById(d.id+"_shadow");if(b){b.style.visibility="hidden"}var c=document.getElementById(d.id+"_frame");if(c){c.style.visibility="hidden"}};this.Move=function(h,b,g){if(!h){return}var c=h.dxShadow;var f=parseInt(h.style.left)+b;var e=parseInt(h.style.top)+g;if(h.restrictDrag){if(f<0){f=0}if((document.compatMode&&document.compatMode=="CSS1Compat")){windowWidth=document.documentElement.scrollWidth}else{if(document.body.scrollWidth>document.body.offsetWidth||(document.compatMode&&document.compatMode=="BackCompat")||(document.documentElement&&!document.documentElement.clientWidth)){windowWidth=document.body.scrollWidth}else{windowWidth=document.body.offsetWidth}}var d=h.offsetWidth;if(f>(windowWidth-d-c)){f=windowWidth-d-c}if(e<0){e=0}}h.style.left=f+"px";h.style.top=e+"px";this.AdjustShadow(h)};this.HideShadow=function(c){var b=document.getElementById(c.id+"_shadow");b.style.visibility="hidden"};this.UnhideShadow=function(c){var b=document.getElementById(c.id+"_shadow");b.style.visibility="visible"};this.AdjustShadow=function(e){var c=document.getElementById(e.id+"_shadow");if(c&&c.style.visibility!="hidden"){var b=e.dxShadow;c.style.width=e.offsetWidth+"px";c.style.height=e.offsetHeight+"px";c.style.left=parseInt(e.style.left)+b+"px";c.style.top=parseInt(e.style.top)+b+"px"}var d=document.getElementById(e.id+"_frame");if(d){d.style.width=e.offsetWidth+"px";d.style.height=e.offsetHeight+"px";d.style.left=e.style.left;d.style.top=e.style.top}};this.StartDrag=function(d,f){if(!d){d=window.event}this.x=d.clientX+document.body.scrollLeft;this.y=d.clientY+document.body.scrollTop;this.floatDiv=f;jsUtils.addEvent(document,"mousemove",this.MoveDrag);document.onmouseup=this.StopDrag;if(document.body.setCapture){document.body.setCapture()}document.onmousedown=jsUtils.False;var c=document.body;c.ondrag=jsUtils.False;c.onselectstart=jsUtils.False;c.style.MozUserSelect=a.floatDiv.style.MozUserSelect="none";c.style.cursor="move"};this.StopDrag=function(d){if(document.body.releaseCapture){document.body.releaseCapture()}jsUtils.removeEvent(document,"mousemove",a.MoveDrag);document.onmouseup=null;this.floatDiv=null;document.onmousedown=null;var c=document.body;c.ondrag=null;c.onselectstart=null;c.style.MozUserSelect=a.floatDiv.style.MozUserSelect="";c.style.cursor=""};this.MoveDrag=function(c){var b=c.clientX+document.body.scrollLeft;var d=c.clientY+document.body.scrollTop;if(a.x==b&&a.y==d){return}a.Move(a.floatDiv,(b-a.x),(d-a.y));a.x=b;a.y=d}}var jsFloatDiv=new JCFloatDiv();var BXHint=function(c,a,b){this.oDivOver=false;this.timeOutID=null;this.oIcon=null;this.freeze=false;this.x=0;this.y=0;this.time=700;if(!c){c=""}this.Create(c,a,b)};BXHint.prototype.Create=function(h,b,f){var g=this,e=0,a=0,d=null,c="icon";this.bWidth=true;if(f){if(f.width===false){this.bWidth=false}else{if(f.width){e=f.width}}if(f.height){a=f.height}if(f.className){d=f.className}if(f.type&&(f.type=="link"||f.type=="icon")){c=f.type}if(f.time>0){this.time=f.time}}if(b){c="element"}if(c=="icon"){var b=document.createElement("IMG");b.src=(f&&f.iconSrc)?f.iconSrc:"/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/public/popup/hint.gif";b.ondrag=jsUtils.False}else{if(c=="link"){var b=document.createElement("A");b.href="";b.onclick=function(i){return false};b.innerHTML="[?]"}}this.element=b;if(c=="element"){if(f&&f.show_on_click){jsUtils.addEvent(b,"click",function(i){if(!i){i=window.event}g.GetMouseXY(i);g.timeOutID=setTimeout(function(){g.Show(h,e,a,d)},10)})}else{jsUtils.addEvent(b,"mouseover",function(i){if(!i){i=window.event}g.GetMouseXY(i);g.timeOutID=setTimeout(function(){g.Show(h,e,a,d)},750)})}jsUtils.addEvent(b,"mouseout",function(i){if(g.timeOutID){clearTimeout(g.timeOutID)}g.SmartHide(g)})}else{this.oIcon=b;b.onmouseover=function(i){if(!i){i=window.event}g.GetMouseXY(i);g.Show(h,e,a,d)};b.onmouseout=function(){g.SmartHide(g)}}};BXHint.prototype.IsFrozen=function(){return this.freeze};BXHint.prototype.Freeze=function(){this.freeze=true;this.Hide()};BXHint.prototype.UnFreeze=function(){this.freeze=false};BXHint.prototype.GetMouseXY=function(a){if(a.pageX||a.pageY){this.x=a.pageX;this.y=a.pageY}else{if(a.clientX||a.clientY){this.x=a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft;this.y=a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop}}};BXHint.prototype.Show=function(i,a,k,f){var c=document.getElementById("__BXHint_div");if(c){this.Hide()}if(this.freeze){return}var e=this;var b=document.body.appendChild(document.createElement("DIV"));b.onmouseover=function(){e.oDivOver=true};b.onmouseout=function(){e.oDivOver=false;e.SmartHide(e)};b.id="__BXHint_div";b.className=(f)?f:"bxhint";b.style.position="absolute";if(a&&this.bWidth){b.style.width=a+"px"}if(k){b.style.height=k+"px"}b.innerHTML=i;var j=b.offsetWidth;var d=b.offsetHeight;if(this.bWidth){if(!a&&j>200){j=Math.round(Math.sqrt(1.618*j*d))}b.style.width=j+"px";d=b.offsetHeight}var g={left:this.x+10,right:this.x+j,top:this.y,bottom:this.y+d};g=this.AlignToPos(g,j,d);b.style.zIndex=2100;jsFloatDiv.Show(b,g.left,g.top,3);b=null};BXHint.prototype.AlignToPos=function(d,b,c){var a=document.body;if((a.clientWidth+a.scrollLeft)<(d.left+b)){d.left=(d.left-b>=0)?(d.left-b):a.scrollLeft}if((a.clientHeight+a.scrollTop)-(d.bottom)<0){d.top=(d.top-c>=0)?(d.top-c):a.scrollTop}return d};BXHint.prototype.Hide=function(){var a=document.getElementById("__BXHint_div");if(!a){return}jsFloatDiv.Close(a);a.parentNode.removeChild(a);a=null};BXHint.prototype.SmartHide=function(a){setTimeout(function(){if(!a.oDivOver){a.Hide()}},100)};function WaitOnKeyPress(a){if(!a){a=window.event}if(!a){return}if(a.keyCode==27){CloseWaitWindow()}}function ShowWaitWindow(){CloseWaitWindow();var c=jsUtils.GetWindowSize();var b=document.body.appendChild(document.createElement("DIV"));b.id="wait_window_div";b.innerHTML=phpVars.messLoading;b.className="waitwindow";b.style.right=(5-c.scrollLeft)+"px";b.style.top=c.scrollTop+5+"px";if(jsUtils.IsIE()){var a=document.createElement("IFRAME");a.src="javascript:''";a.id="wait_window_frame";a.className="waitwindow";a.style.width=b.offsetWidth+"px";a.style.height=b.offsetHeight+"px";a.style.right=b.style.right;a.style.top=b.style.top;document.body.appendChild(a)}jsUtils.addEvent(document,"keypress",WaitOnKeyPress)}function CloseWaitWindow(){jsUtils.removeEvent(document,"keypress",WaitOnKeyPress);var a=document.getElementById("wait_window_frame");if(a){a.parentNode.removeChild(a)}var b=document.getElementById("wait_window_div");if(b){b.parentNode.removeChild(b)}}var jsSelectUtils={addNewOption:function(b,j,a,e,h){var d=(typeof(b)=="string"||b instanceof String?document.getElementById(b):b);if(d){var c=d.length;if(h!==false){for(var f=0;f<c;f++){if(d[f].value==j){return}}}var g=new Option(a,j,false,false);d.options[c]=g}if(e===true){this.sortSelect(b)}},deleteOption:function(d,a){var c=(typeof(d)=="string"||d instanceof String?document.getElementById(d):d);if(c){for(var b=0;b<c.length;b++){if(c[b].value==a){c.remove(b);break}}}},deleteSelectedOptions:function(c){var b=(typeof(c)=="string"||c instanceof String?document.getElementById(c):c);if(b){var a=0;while(a<b.length){if(b[a].selected){b[a].selected=false;b.remove(a)}else{a++}}}},deleteAllOptions:function(b){if(b){for(var a=b.length-1;a>=0;a--){b.remove(a)}}},optionCompare:function(d,b){var c=d.optText.toLowerCase();var a=b.optText.toLowerCase();if(c>a){return(1)}if(c<a){return(-1)}return(0)},sortSelect:function(f){var c=(typeof(f)=="string"||f instanceof String?document.getElementById(f):f);if(c){var a=[];var e=c.options.length;for(var b=0;b<e;b++){a[b]={optText:c[b].text,optValue:c[b].value}}a.sort(this.optionCompare);c.length=0;e=a.length;for(var b=0;b<e;b++){var d=new Option(a[b].optText,a[b].optValue,false,false);c[b]=d}}},selectAllOptions:function(d){var b=(typeof(d)=="string"||d instanceof String?document.getElementById(d):d);if(b){var c=b.length;for(var a=0;a<c;a++){b[a].selected=true}}},selectOption:function(e,a){var c=(typeof(e)=="string"||e instanceof String?document.getElementById(e):e);if(c){var d=c.length;for(var b=0;b<d;b++){c[b].selected=(c[b].value==a)}}},addSelectedOptions:function(b,f,c,e){if(!b){return}var d=b.length;for(var a=0;a<d;a++){if(b[a].selected){this.addNewOption(f,b[a].value,b[a].text,e,c)}}},moveOptionsUp:function(d){if(!d){return}var e=d.length;for(var c=0;c<e;c++){if(d[c].selected&&c>0&&d[c-1].selected==false){var b=new Option(d[c].text,d[c].value);var a=new Option(d[c-1].text,d[c-1].value);d[c]=a;d[c].selected=false;d[c-1]=b;d[c-1].selected=true}}},moveOptionsDown:function(d){if(!d){return}var e=d.length;for(var c=e-1;c>=0;c--){if(d[c].selected&&c<e-1&&d[c+1].selected==false){var b=new Option(d[c].text,d[c].value);var a=new Option(d[c+1].text,d[c+1].value);d[c]=a;d[c].selected=false;d[c+1]=b;d[c+1].selected=true}}}};(function(a){if(BX.PopupWindowManager){return}BX.PopupWindowManager={_popups:[],_currentPopup:null,create:function(h,e,i){var f=-1;if((f=this._getPopupIndex(h))!==-1){return this._popups[f]}var g=new BX.PopupWindow(h,e,i);BX.addCustomEvent(g,"onPopupShow",BX.delegate(this.onPopupShow,this));BX.addCustomEvent(g,"onPopupClose",BX.delegate(this.onPopupClose,this));BX.addCustomEvent(g,"onPopupDestroy",BX.delegate(this.onPopupDestroy,this));this._popups.push(g);return g},onPopupShow:function(e){if(this._currentPopup!==null){this._currentPopup.close()}this._currentPopup=e},onPopupClose:function(e){this._currentPopup=null},onPopupDestroy:function(f){var e=-1;if((e=this._getPopupIndex(f.uniquePopupId))!==-1){this._popups=BX.util.deleteFromArray(this._popups,e)}},getCurrentPopup:function(){return this._currentPopup},isPopupExists:function(e){return this._getPopupIndex(e)!==-1},_getPopupIndex:function(g){var e=-1;for(var f=0;f<this._popups.length;f++){if(this._popups[f].uniquePopupId==g){return f}}return e}};BX.PopupWindow=function(g,f,i){BX.onCustomEvent("onPopupWindowInit",[g,f,i]);this.uniquePopupId=g;this.params=i||{};this.params.zIndex=parseInt(this.params.zIndex);this.params.zIndex=isNaN(this.params.zIndex)?0:this.params.zIndex;this.buttons=this.params.buttons&&BX.type.isArray(this.params.buttons)?this.params.buttons:[];this.offsetTop=BX.PopupWindow.getOption("offsetTop");this.offsetLeft=BX.PopupWindow.getOption("offsetLeft");this.firstShow=false;this.bordersWidth=20;this.bindElementPos=null;this.closeIcon=null;this.angle=null;this.overlay=null;this.titleBar=null;this.bindOptions=typeof(this.params.bindOptions)=="object"?this.params.bindOptions:{};this.isAutoHideBinded=false;this.closeByEsc=!!this.params.closeByEsc;this.isCloseByEscBinded=false;this.dragged=false;this.dragPageX=0;this.dragPageY=0;if(this.params.events){for(var e in this.params.events){BX.addCustomEvent(this,e,this.params.events[e])}}this.popupContainer=document.createElement("DIV");BX.adjust(this.popupContainer,{props:{id:g},style:{zIndex:this.getZindex(),position:"absolute",display:"none",top:"0px",left:"0px"}});if(i.darkMode){BX.addClass(this.popupContainer,"popup-window-dark")}var h="popup-window";if(i.lightShadow){h+=" popup-window-light"}if(i.titleBar){h+=i.lightShadow?" popup-window-titlebar-light":" popup-window-titlebar"}if(i.className&&BX.type.isNotEmptyString(i.className)){h+=" "+i.className}this.popupContainer.innerHTML=['<table class="',h,'" cellspacing="0"> 		<tr class="popup-window-top-row"> 			<td class="popup-window-left-column"><div class="popup-window-left-spacer"></div></td> 			<td class="popup-window-center-column">',(i.titleBar?'<div class="popup-window-titlebar" id="popup-window-titlebar-'+g+'"></div>':""),'</td> 			<td class="popup-window-right-column"><div class="popup-window-right-spacer"></div></td> 		</tr> 		<tr class="popup-window-content-row"> 			<td class="popup-window-left-column"></td> 			<td class="popup-window-center-column"><div class="popup-window-content" id="popup-window-content-',g,'"> 			</div></td> 			<td class="popup-window-right-column"></td> 		</tr> 		<tr class="popup-window-bottom-row"> 			<td class="popup-window-left-column"></td> 			<td class="popup-window-center-column"></td> 			<td class="popup-window-right-column"></td> 		</tr> 	</table>'].join("");document.body.appendChild(this.popupContainer);if(i.closeIcon){this.popupContainer.appendChild((this.closeIcon=BX.create("a",{props:{className:"popup-window-close-icon"+(i.titleBar?" popup-window-titlebar-close-icon":""),href:""},style:(typeof(i.closeIcon)=="object"?i.closeIcon:{}),events:{click:BX.proxy(this._onCloseIconClick,this)}})));if(BX.browser.IsIE()){BX.adjust(this.closeIcon,{attrs:{hidefocus:"true"}})}}this.contentContainer=BX("popup-window-content-"+g);this.titleBar=BX("popup-window-titlebar-"+g);this.buttonsContainer=this.buttonsHr=null;if(i.angle){this.setAngle(i.angle)}if(i.overlay){this.setOverlay(i.overlay)}this.setOffset(this.params);this.setBindElement(f);this.setTitleBar(this.params.titleBar);this.setContent(this.params.content);this.setButtons(this.params.buttons);if(this.params.bindOnResize!==false){BX.bind(a,"resize",BX.proxy(this._onResizeWindow,this))}};BX.PopupWindow.prototype.setContent=function(e){if(!this.contentContainer||!e){return}if(BX.type.isElementNode(e)){BX.cleanNode(this.contentContainer);this.contentContainer.appendChild(e.parentNode?e.parentNode.removeChild(e):e);e.style.display="block"}else{if(BX.type.isString(e)){this.contentContainer.innerHTML=e}else{this.contentContainer.innerHTML="&nbsp;"}}};BX.PopupWindow.prototype.setButtons=function(h){this.buttons=h&&BX.type.isArray(h)?h:[];if(this.buttonsHr){BX.remove(this.buttonsHr)}if(this.buttonsContainer){BX.remove(this.buttonsContainer)}if(this.buttons.length>0&&this.contentContainer){var e=[];for(var g=0;g<this.buttons.length;g++){var f=this.buttons[g];if(f==null||!BX.is_subclass_of(f,BX.PopupWindowButton)){continue}f.popupWindow=this;e.push(f.render())}this.buttonsHr=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-hr popup-window-buttons-hr"},children:[BX.create("i",{})]}));this.buttonsContainer=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-buttons"},children:e}))}};BX.PopupWindow.prototype.setBindElement=function(e){if(!e||typeof(e)!="object"){return}if(BX.type.isDomNode(e)||(BX.type.isNumber(e.top)&&BX.type.isNumber(e.left))){this.bindElement=e}else{if(BX.type.isNumber(e.clientX)&&BX.type.isNumber(e.clientY)){BX.fixEventPageXY(e);this.bindElement={left:e.pageX,top:e.pageY,bottom:e.pageY}}}};BX.PopupWindow.prototype.getBindElementPos=function(e){if(BX.type.isDomNode(e)){return BX.pos(e,false)}else{if(e&&typeof(e)=="object"){if(!BX.type.isNumber(e.bottom)){e.bottom=e.top}return e}else{var f=BX.GetWindowInnerSize();var i=BX.GetWindowScrollPos();var g=this.popupContainer.offsetWidth;var h=this.popupContainer.offsetHeight;return{left:f.innerWidth/2-g/2+i.scrollLeft,top:f.innerHeight/2-h/2+i.scrollTop,bottom:f.innerHeight/2-h/2+i.scrollTop,windowSize:f,windowScroll:i,popupWidth:g,popupHeight:h}}}};BX.PopupWindow.prototype.setAngle=function(f){var k=this.params.lightShadow?"popup-window-light-angly":"popup-window-angly";if(this.angle==null){var h=this.bindOptions.position&&this.bindOptions.position=="top"?"bottom":"top";var m=BX.PopupWindow.getOption(h=="top"?"angleMinTop":"angleMinBottom");var i=BX.type.isNumber(f.offset)?f.offset:0;var l=BX.PopupWindow.getOption("angleLeftOffset",null);if(i>0&&BX.type.isNumber(l)){i+=l-BX.PopupWindow.defaultOptions.angleLeftOffset}this.angle={element:BX.create("div",{props:{className:k+" "+k+"-"+h}}),position:h,offset:0,defaultOffset:Math.max(i,m)};this.popupContainer.appendChild(this.angle.element)}if(typeof(f)=="object"&&f.position&&BX.util.in_array(f.position,["top","right","bottom","left","hide"])){BX.removeClass(this.angle.element,k+"-"+this.angle.position);BX.addClass(this.angle.element,k+"-"+f.position);this.angle.position=f.position}if(typeof(f)=="object"&&BX.type.isNumber(f.offset)){var g=f.offset;var j,e;if(this.angle.position=="top"){j=BX.PopupWindow.getOption("angleMinTop");e=this.popupContainer.offsetWidth-BX.PopupWindow.getOption("angleMaxTop");e=e<j?Math.max(j,g):e;this.angle.offset=Math.min(Math.max(j,g),e);this.angle.element.style.left=this.angle.offset+"px";this.angle.element.style.marginLeft="auto"}else{if(this.angle.position=="bottom"){j=BX.PopupWindow.getOption("angleMinBottom");e=this.popupContainer.offsetWidth-BX.PopupWindow.getOption("angleMaxBottom");e=e<j?Math.max(j,g):e;this.angle.offset=Math.min(Math.max(j,g),e);this.angle.element.style.marginLeft=this.angle.offset+"px";this.angle.element.style.left="auto"}else{if(this.angle.position=="right"){j=BX.PopupWindow.getOption("angleMinRight");e=this.popupContainer.offsetHeight-BX.PopupWindow.getOption("angleMaxRight");e=e<j?Math.max(j,g):e;this.angle.offset=Math.min(Math.max(j,g),e);this.angle.element.style.top=this.angle.offset+"px"}else{if(this.angle.position=="left"){j=BX.PopupWindow.getOption("angleMinLeft");e=this.popupContainer.offsetHeight-BX.PopupWindow.getOption("angleMaxLeft");e=e<j?Math.max(j,g):e;this.angle.offset=Math.min(Math.max(j,g),e);this.angle.element.style.top=this.angle.offset+"px"}}}}}};BX.PopupWindow.prototype.isTopAngle=function(){return this.angle!=null&&this.angle.position=="top"};BX.PopupWindow.prototype.isBottomAngle=function(){return this.angle!=null&&this.angle.position=="bottom"};BX.PopupWindow.prototype.isTopOrBottomAngle=function(){return this.angle!=null&&BX.util.in_array(this.angle.position,["top","bottom"])};BX.PopupWindow.prototype.getAngleHeight=function(){return(this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleTopOffset"):0)};BX.PopupWindow.prototype.setOffset=function(e){if(typeof(e)!="object"){return}if(e.offsetLeft&&BX.type.isNumber(e.offsetLeft)){this.offsetLeft=e.offsetLeft+BX.PopupWindow.getOption("offsetLeft")}if(e.offsetTop&&BX.type.isNumber(e.offsetTop)){this.offsetTop=e.offsetTop+BX.PopupWindow.getOption("offsetTop")}};BX.PopupWindow.prototype.setTitleBar=function(e){if(!this.titleBar||typeof(e)!="object"||!BX.type.isDomNode(e.content)){return}this.titleBar.innerHTML="";this.titleBar.appendChild(e.content);if(this.params.draggable){this.titleBar.parentNode.style.cursor="move";BX.bind(this.titleBar.parentNode,"mousedown",BX.proxy(this._startDrag,this))}};BX.PopupWindow.prototype.setClosingByEsc=function(e){e=!!e;if(e){this.closeByEsc=true;if(!this.isCloseByEscBinded){BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=true}}else{this.closeByEsc=false;if(this.isCloseByEscBinded){BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=false}}};BX.PopupWindow.prototype.setOverlay=function(e){if(this.overlay==null){this.overlay={element:BX.create("div",{props:{className:"popup-window-overlay",id:"popup-window-overlay-"+this.uniquePopupId}})};this.adjustOverlayZindex();this.resizeOverlay();document.body.appendChild(this.overlay.element)}if(e&&e.opacity&&BX.type.isNumber(e.opacity)&&e.opacity>=0&&e.opacity<=100){if(BX.browser.IsIE()&&!BX.browser.IsIE9()){this.overlay.element.style.filter="alpha(opacity="+e.opacity+")"}else{this.overlay.element.style.filter="none";this.overlay.element.style.opacity=parseFloat(e.opacity/100).toPrecision(3)}}if(e&&e.backgroundColor){this.overlay.element.style.backgroundColor=e.backgroundColor}};BX.PopupWindow.prototype.removeOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){BX.remove(this.overlay.element)}this.overlay=null};BX.PopupWindow.prototype.hideOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){this.overlay.element.style.display="none"}};BX.PopupWindow.prototype.showOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){this.overlay.element.style.display="block"}};BX.PopupWindow.prototype.resizeOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){var e=BX.GetWindowScrollSize();this.overlay.element.style.width=e.scrollWidth+"px";this.overlay.element.style.height=e.scrollHeight+"px"}};BX.PopupWindow.prototype.getZindex=function(){if(this.overlay!=null){return BX.PopupWindow.getOption("popupOverlayZindex")+this.params.zIndex}else{return BX.PopupWindow.getOption("popupZindex")+this.params.zIndex}};BX.PopupWindow.prototype.adjustOverlayZindex=function(){if(this.overlay!=null&&this.overlay.element!=null){this.overlay.element.style.zIndex=parseInt(this.popupContainer.style.zIndex)-1}};BX.PopupWindow.prototype.show=function(){if(!this.firstShow){BX.onCustomEvent(this,"onPopupFirstShow",[this]);this.firstShow=true}BX.onCustomEvent(this,"onPopupShow",[this]);this.showOverlay();this.popupContainer.style.display="block";this.adjustPosition();BX.onCustomEvent(this,"onAfterPopupShow",[this]);if(this.closeByEsc&&!this.isCloseByEscBinded){BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=true}if(this.params.autoHide&&!this.isAutoHideBinded){setTimeout(BX.proxy(function(){this.isAutoHideBinded=true;BX.bind(this.popupContainer,"click",this.cancelBubble);BX.bind(document,"click",BX.proxy(this.close,this))},this),0)}};BX.PopupWindow.prototype.isShown=function(){return this.popupContainer.style.display=="block"};BX.PopupWindow.prototype.cancelBubble=function(e){if(!e){e=a.event}if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}};BX.PopupWindow.prototype.close=function(e){if(!this.isShown()){return}if(e&&!(BX.getEventButton(e)&BX.MSLEFT)){return true}BX.onCustomEvent(this,"onPopupClose",[this,e]);this.hideOverlay();this.popupContainer.style.display="none";if(this.isCloseByEscBinded){BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=false}setTimeout(BX.proxy(this._close,this),0)};BX.PopupWindow.prototype._close=function(){if(this.params.autoHide&&this.isAutoHideBinded){this.isAutoHideBinded=false;BX.unbind(this.popupContainer,"click",this.cancelBubble);BX.unbind(document,"click",BX.proxy(this.close,this))}};BX.PopupWindow.prototype._onCloseIconClick=function(e){e=e||a.event;this.close(e);BX.PreventDefault(e)};BX.PopupWindow.prototype._onKeyUp=function(e){e=e||a.event;if(e.keyCode==27){b(this.getZindex(),BX.proxy(this.close,this))}};BX.PopupWindow.prototype.destroy=function(){BX.onCustomEvent(this,"onPopupDestroy",[this]);BX.unbindAll(this);BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));BX.unbind(document,"click",BX.proxy(this.close,this));BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this));BX.unbind(a,"resize",BX.proxy(this._onResizeWindow,this));BX.remove(this.popupContainer);this.removeOverlay()};BX.PopupWindow.prototype.adjustPosition=function(m){if(m&&typeof(m)=="object"){this.bindOptions=m}var g=this.getBindElementPos(this.bindElement);if(!this.bindOptions.forceBindPosition&&this.bindElementPos!=null&&g.top==this.bindElementPos.top&&g.left==this.bindElementPos.left){return}this.bindElementPos=g;var k=g.windowSize?g.windowSize:BX.GetWindowInnerSize();var n=g.windowScroll?g.windowScroll:BX.GetWindowScrollPos();var j=g.popupWidth?g.popupWidth:this.popupContainer.offsetWidth;var h=g.popupHeight?g.popupHeight:this.popupContainer.offsetHeight;var l=BX.PopupWindow.getOption("angleTopOffset");var f=this.bindElementPos.left+this.offsetLeft-(this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleLeftOffset"):0);if(!this.bindOptions.forceLeft&&(f+j+this.bordersWidth)>=(k.innerWidth+n.scrollLeft)&&(k.innerWidth+n.scrollLeft-j-this.bordersWidth)>0){var e=f;f=k.innerWidth+n.scrollLeft-j-this.bordersWidth;if(this.isTopOrBottomAngle()){this.setAngle({offset:e-f+this.angle.defaultOffset})}}else{if(this.isTopOrBottomAngle()){this.setAngle({offset:this.angle.defaultOffset+(f<0?f:0)})}}if(f<0){f=0}var i=0;if(this.bindOptions.position&&this.bindOptions.position=="top"){i=this.bindElementPos.top-h-this.offsetTop-(this.isBottomAngle()?l:0);if(i<0||(!this.bindOptions.forceTop&&i<n.scrollTop)){i=this.bindElementPos.bottom+this.offsetTop;if(this.angle!=null){i+=l;this.setAngle({position:"top"})}}else{if(this.isTopAngle()){i=i-l+BX.PopupWindow.getOption("positionTopXOffset");this.setAngle({position:"bottom"})}else{i+=BX.PopupWindow.getOption("positionTopXOffset")}}}else{i=this.bindElementPos.bottom+this.offsetTop+this.getAngleHeight();if(!this.bindOptions.forceTop&&(i+h)>(k.innerHeight+n.scrollTop)&&(this.bindElementPos.top-h-this.getAngleHeight())>=0){i=this.bindElementPos.top-h;if(this.isTopOrBottomAngle()){i-=l;this.setAngle({position:"bottom"})}i+=BX.PopupWindow.getOption("positionTopXOffset")}else{if(this.isBottomAngle()){i+=l;this.setAngle({position:"top"})}}}if(i<0){i=0}BX.adjust(this.popupContainer,{style:{top:i+"px",left:f+"px",zIndex:this.getZindex()}});this.adjustOverlayZindex()};BX.PopupWindow.prototype._onResizeWindow=function(e){if(this.isShown()){this.adjustPosition();if(this.overlay!=null){this.resizeOverlay()}}};BX.PopupWindow.prototype.move=function(e,k){var j=parseInt(this.popupContainer.style.left)+e;var i=parseInt(this.popupContainer.style.top)+k;if(typeof(this.params.draggable)=="object"&&this.params.draggable.restrict){if(j<0){j=0}var g=BX.GetWindowScrollSize();var h=this.popupContainer.offsetWidth;var f=this.popupContainer.offsetHeight;if(j>(g.scrollWidth-h)){j=g.scrollWidth-h}if(i>(g.scrollHeight-f)){i=g.scrollHeight-f}if(i<0){i=0}}this.popupContainer.style.left=j+"px";this.popupContainer.style.top=i+"px"};BX.PopupWindow.prototype._startDrag=function(e){e=e||a.event;BX.fixEventPageXY(e);this.dragPageX=e.pageX;this.dragPageY=e.pageY;this.dragged=false;BX.bind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.bind(document,"mouseup",BX.proxy(this._stopDrag,this));if(document.body.setCapture){document.body.setCapture()}document.body.ondrag=BX.False;document.body.onselectstart=BX.False;document.body.style.cursor="move";document.body.style.MozUserSelect="none";this.popupContainer.style.MozUserSelect="none";return BX.PreventDefault(e)};BX.PopupWindow.prototype._moveDrag=function(e){e=e||a.event;BX.fixEventPageXY(e);if(this.dragPageX==e.pageX&&this.dragPageY==e.pageY){return}this.move((e.pageX-this.dragPageX),(e.pageY-this.dragPageY));this.dragPageX=e.pageX;this.dragPageY=e.pageY;if(!this.dragged){BX.onCustomEvent(this,"onPopupDragStart");this.dragged=true}BX.onCustomEvent(this,"onPopupDrag")};BX.PopupWindow.prototype._stopDrag=function(e){if(document.body.releaseCapture){document.body.releaseCapture()}BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this));document.body.ondrag=null;document.body.onselectstart=null;document.body.style.cursor="";document.body.style.MozUserSelect="";this.popupContainer.style.MozUserSelect="";BX.onCustomEvent(this,"onPopupDragEnd");this.dragged=false;return BX.PreventDefault(e)};BX.PopupWindow.options={};BX.PopupWindow.defaultOptions={angleLeftOffset:15,positionTopXOffset:0,angleTopOffset:8,popupZindex:1000,popupOverlayZindex:1100,angleMinLeft:10,angleMaxLeft:10,angleMinRight:10,angleMaxRight:10,angleMinBottom:7,angleMaxBottom:25,angleMinTop:7,angleMaxTop:25,offsetLeft:0,offsetTop:0};BX.PopupWindow.setOptions=function(e){if(!e||typeof(e)!="object"){return}for(var f in e){BX.PopupWindow.options[f]=e[f]}};BX.PopupWindow.getOption=function(f,e){if(typeof(BX.PopupWindow.options[f])!="undefined"){return BX.PopupWindow.options[f]}else{if(typeof(e)!="undefined"){return e}else{return BX.PopupWindow.defaultOptions[f]}}};BX.PopupWindowButton=function(f){this.popupWindow=null;this.params=f||{};this.text=this.params.text||"";this.id=this.params.id||"";this.className=this.params.className||"";this.events=this.params.events||{};this.contextEvents={};for(var e in this.events){this.contextEvents[e]=BX.proxy(this.events[e],this)}this.nameNode=BX.create("span",{props:{className:"popup-window-button-text"},text:this.text});this.buttonNode=BX.create("span",{props:{className:"popup-window-button"+(this.className.length>0?" "+this.className:""),id:this.id},children:[BX.create("span",{props:{className:"popup-window-button-left"}}),this.nameNode,BX.create("span",{props:{className:"popup-window-button-right"}})],events:this.contextEvents})};BX.PopupWindowButton.prototype.render=function(){return this.buttonNode};BX.PopupWindowButton.prototype.setName=function(e){this.text=e||"";if(this.nameNode){BX.cleanNode(this.nameNode);BX.adjust(this.nameNode,{text:this.text})}};BX.PopupWindowButton.prototype.setClassName=function(e){if(this.buttonNode){if(BX.type.isString(this.className)&&(this.className!="")){BX.removeClass(this.buttonNode,this.className)}BX.addClass(this.buttonNode,e)}this.className=e};BX.PopupWindowButtonLink=function(e){BX.PopupWindowButtonLink.superclass.constructor.apply(this,arguments);this.nameNode=BX.create("span",{props:{className:"popup-window-button-link-text"},text:this.text,events:this.contextEvents});this.buttonNode=BX.create("span",{props:{className:"popup-window-button popup-window-button-link"+(this.className.length>0?" "+this.className:""),id:this.id},children:[this.nameNode]})};BX.extend(BX.PopupWindowButtonLink,BX.PopupWindowButton);BX.PopupMenu={Data:{},currentItem:null,show:function(h,e,f,g){if(this.currentItem!==null){this.currentItem.popupWindow.close()}this.currentItem=this.create(h,e,f,g);this.currentItem.popupWindow.show()},create:function(h,e,f,g){if(!this.Data[h]){this.Data[h]=new BX.PopupMenuWindow(h,e,f,g)}return this.Data[h]},getCurrentMenu:function(){return this.currentItem},getMenuById:function(e){return this.Data[e]?this.Data[e]:null},destroy:function(f){var e=this.getMenuById(f);if(e){if(this.currentItem==e){this.currentItem=null}e.popupWindow.destroy();delete this.Data[f]}}};BX.PopupMenuWindow=function(j,e,g,h){this.id=j;this.bindElement=e;this.menuItems=[];this.itemsContainer=null;if(g&&BX.type.isArray(g)){for(var f=0;f<g.length;f++){this.__addMenuItem(g[f],null)}}this.params=h&&typeof(h)=="object"?h:{};this.popupWindow=this.__createPopup()};BX.PopupMenuWindow.prototype.__createItem=function(f,e){if(e>0){f.layout.hr=BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]})}if(f.delimiter){f.layout.item=BX.create("span",{props:{className:"popup-window-delimiter"},html:"<i></i>"})}else{f.layout.item=BX.create(!!f.href?"a":"span",{props:{className:"menu-popup-item"+(BX.type.isNotEmptyString(f.className)?" "+f.className:" menu-popup-no-icon")},attrs:{title:f.title?f.title:"",onclick:f.onclick&&BX.type.isString(f.onclick)?f.onclick:""},events:f.onclick&&BX.type.isFunction(f.onclick)?{click:BX.proxy(this.onItemClick,{obj:this,item:f})}:null,children:[BX.create("span",{props:{className:"menu-popup-item-left"}}),BX.create("span",{props:{className:"menu-popup-item-icon"}}),(f.layout.text=BX.create("span",{props:{className:"menu-popup-item-text"},html:f.text})),BX.create("span",{props:{className:"menu-popup-item-right"}})]});if(f.href){f.layout.item.href=f.href}}return f};BX.PopupMenuWindow.prototype.__createPopup=function(){var e=[];for(var h=0;h<this.menuItems.length;h++){this.__createItem(this.menuItems[h],h);if(this.menuItems[h].layout.hr!=null){e.push(this.menuItems[h].layout.hr)}e.push(this.menuItems[h].layout.item)}var g=new BX.PopupWindow("menu-popup-"+this.id,this.bindElement,{closeByEsc:typeof(this.params.closeByEsc)!="undefined"?this.params.closeByEsc:false,bindOptions:typeof(this.params.bindOptions)=="object"?this.params.bindOptions:{},angle:typeof(this.params.angle)!="undefined"?this.params.angle:false,zIndex:this.params.zIndex?this.params.zIndex:0,overlay:typeof(this.params.overlay)=="object"?this.params.overlay:null,autoHide:typeof(this.params.autoHide)!="undefined"?this.params.autoHide:true,offsetTop:this.params.offsetTop?this.params.offsetTop:1,offsetLeft:this.params.offsetLeft?this.params.offsetLeft:0,lightShadow:typeof(this.params.lightShadow)!="undefined"?this.params.lightShadow:true,content:BX.create("div",{props:{className:"menu-popup"},children:[(this.itemsContainer=BX.create("div",{props:{className:"menu-popup-items"},children:e}))]})});if(this.params&&this.params.events){for(var f in this.params.events){if(this.params.events.hasOwnProperty(f)){BX.addCustomEvent(g,f,this.params.events[f])}}}return g};BX.PopupMenuWindow.prototype.onItemClick=function(e){e=e||a.event;this.item.onclick.call(this.obj,e,this.item)};BX.PopupMenuWindow.prototype.addMenuItem=function(h,g){var e=this.__addMenuItem(h,g);if(e<0){return false}this.__createItem(h,e);var f=this.getMenuItem(g);if(f!=null){if(f.layout.hr==null){f.layout.hr=BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]});this.itemsContainer.insertBefore(f.layout.hr,f.layout.item)}if(h.layout.hr!=null){this.itemsContainer.insertBefore(h.layout.hr,f.layout.hr)}this.itemsContainer.insertBefore(h.layout.item,f.layout.hr)}else{if(h.layout.hr!=null){this.itemsContainer.appendChild(h.layout.hr)}this.itemsContainer.appendChild(h.layout.item)}return true};BX.PopupMenuWindow.prototype.__addMenuItem=function(g,f){if(!g||(!g.delimiter&&!BX.type.isNotEmptyString(g.text))||(g.id&&this.getMenuItem(g.id)!=null)){return -1}g.layout={item:null,text:null,hr:null};var e=this.getMenuItemPosition(f);if(e>=0){this.menuItems=BX.util.insertIntoArray(this.menuItems,e,g)}else{this.menuItems.push(g);e=this.menuItems.length-1}return e};BX.PopupMenuWindow.prototype.removeMenuItem=function(g){var f=this.getMenuItem(g);if(!f){return}for(var e=0;e<this.menuItems.length;e++){if(this.menuItems[e]==f){this.menuItems=BX.util.deleteFromArray(this.menuItems,e);break}}if(e==0){if(this.menuItems[0]){this.menuItems[0].layout.hr.parentNode.removeChild(this.menuItems[0].layout.hr);this.menuItems[0].layout.hr=null}}else{f.layout.hr.parentNode.removeChild(f.layout.hr)}f.layout.item.parentNode.removeChild(f.layout.item);f.layout.item=null};BX.PopupMenuWindow.prototype.getMenuItem=function(f){for(var e=0;e<this.menuItems.length;e++){if(this.menuItems[e].id&&this.menuItems[e].id==f){return this.menuItems[e]}}return null};BX.PopupMenuWindow.prototype.getMenuItemPosition=function(f){if(f){for(var e=0;e<this.menuItems.length;e++){if(this.menuItems[e].id&&this.menuItems[e].id==f){return e}}}return -1};a.BXInputPopup=function(e){this.id=e.id||"bx-inp-popup-"+Math.round(Math.random()*1000000);this.handler=e.handler||false;this.values=e.values||false;this.pInput=e.input;this.bValues=!!this.values;this.defaultValue=e.defaultValue||"";this.openTitle=e.openTitle||"";this.className=e.className||"";this.noMRclassName=e.noMRclassName||"ec-no-rm";this.emptyClassName=e.noMRclassName||"ec-label";var f=this;this.curInd=false;if(this.bValues){this.pInput.onfocus=this.pInput.onclick=function(g){if(this.value==f.defaultValue){this.value="";this.className=f.className}f.ShowPopup();return BX.PreventDefault(g)};this.pInput.onblur=function(){if(f.bShowed){setTimeout(function(){f.ClosePopup(true)},200)}f.OnChange()}}else{this.pInput.className=this.noMRclassName;this.pInput.onblur=BX.proxy(this.OnChange,this)}};BXInputPopup.prototype={ShowPopup:function(){if(this.bShowed){return}var j=this;if(!this.oPopup){var h,g=BX.create("DIV",{props:{className:"bxecpl-loc-popup "+this.className}});for(var f=0,e=this.values.length;f<e;f++){h=g.appendChild(BX.create("DIV",{props:{id:"bxecmr_"+f},text:this.values[f].NAME,events:{mouseover:function(){BX.addClass(this,"bxecplloc-over")},mouseout:function(){BX.removeClass(this,"bxecplloc-over")},click:function(){var i=this.id.substr("bxecmr_".length);j.pInput.value=j.values[i].NAME;j.curInd=i;j.OnChange();j.ClosePopup(true)}}}));if(this.values[f].DESCRIPTION){h.title=this.values[f].DESCRIPTION}if(this.values[f].CLASS_NAME){BX.addClass(h,this.values[f].CLASS_NAME)}if(this.values[f].URL){h.appendChild(BX.create("A",{props:{href:this.values[f].URL,className:"bxecplloc-view",target:"_blank",title:this.openTitle}}))}}this.oPopup=new BX.PopupWindow(this.id,this.pInput,{autoHide:true,offsetTop:1,offsetLeft:0,lightShadow:true,closeByEsc:true,content:g});BX.addCustomEvent(this.oPopup,"onPopupClose",BX.proxy(this.ClosePopup,this))}this.oPopup.show();this.pInput.select();this.bShowed=true;BX.onCustomEvent(this,"onInputPopupShow",[this])},ClosePopup:function(e){this.bShowed=false;if(this.pInput.value==""){this.OnChange()}BX.onCustomEvent(this,"onInputPopupClose",[this]);if(e===true){this.oPopup.close()}},OnChange:function(){var e=this.pInput.value;if(this.bValues){if(this.pInput.value==""||this.pInput.value==this.defaultValue){this.pInput.value=this.defaultValue;this.pInput.className=this.emptyClassName;e=""}else{this.pInput.className=""}}if(isNaN(parseInt(this.curInd))||this.curInd!==false&&e!=this.values[this.curInd].NAME){this.curInd=false}else{this.curInd=parseInt(this.curInd)}BX.onCustomEvent(this,"onInputPopupChanged",[this,this.curInd,e]);if(this.handler&&typeof this.handler=="function"){this.handler({ind:this.curInd,value:e})}},Set:function(f,g,e){this.curInd=f;if(this.curInd!==false){this.pInput.value=this.values[this.curInd].NAME}else{this.pInput.value=g}if(e!==false){this.OnChange()}},Get:function(e){var f=false;if(typeof e=="undefined"){e=this.curInd}if(e!==false&&this.values[e]){f=this.values[e].ID}return f},GetIndex:function(g){for(var f=0,e=this.values.length;f<e;f++){if(this.values[f].ID==g){return f}}return false},Deactivate:function(e){if(this.pInput.value==""||this.pInput.value==this.defaultValue){if(e){this.pInput.value="";this.pInput.className=this.noMRclassName}else{if(this.oEC.bUseMR){this.pInput.value=this.defaultValue;this.pInput.className=this.emptyClassName}}}this.pInput.disabled=e}};var d=-1,c=null;function b(g,f){if(g===false){if(c&&c.length>0){for(var e=0;e<c.length;e++){c[e]()}c=null;d=-1}}else{if(c===null){c=[];d=-1;BX.defer(b)(false)}if(g>d){d=g;c=[f]}else{if(g==d){c.push(f)}}}}})(window);if(!BXRL){var BXRL={};var BXRLW=null}RatingLike=function(b,g,d,a,f,e,i,c,h){this.enabled=true;this.likeId=b;this.entityTypeId=g;this.entityId=d;this.available=a=="Y"?true:false;this.userId=f;this.localize=e;this.template=i;this.pathToUserProfile=c;this.pathToAjax=typeof(h)=="string"?h:"/bitrix/components/bitrix/rating.vote/vote.ajax.php";this.box=BX("bx-ilike-button-"+b);if(this.box===null){this.enabled=false;return false}this.button=BX.findChild(this.box,{className:"bx-ilike-left-wrap"},true,false);this.buttonText=BX.findChild(this.button,{className:"bx-ilike-text"},true,false);this.count=BX.findChild(this.box,{tagName:"span",className:"bx-ilike-right-wrap"},true,false);this.countText=BX.findChild(this.count,{tagName:"span",className:"bx-ilike-right"},true,false);this.popup=null;this.popupId=null;this.popupOpenId=null;this.popupTimeoutId=null;this.popupContent=BX.findChild(BX("bx-ilike-popup-cont-"+b),{tagName:"span",className:"bx-ilike-popup"},true,false);this.popupContentPage=1;this.popupListProcess=false;this.popupTimeout=false;this.likeTimeout=false;this.lastVote=BX.hasClass(i=="standart"?this.button:this.count,"bx-you-like")?"plus":"cancel"};RatingLike.LiveUpdate=function(c){if(c.USER_ID==BX.message("USER_ID")){return false}for(var b in BXRL){if(BXRL[b].entityTypeId==c.ENTITY_TYPE_ID&BXRL[b].entityId==c.ENTITY_ID){var a=BXRL[b];a.countText.innerHTML=parseInt(c.TOTAL_POSITIVE_VOTES);a.count.insertBefore(BX.create("span",{props:{className:"bx-ilike-plus-one"},style:{width:(a.countText.clientWidth-8)+"px",height:(a.countText.clientHeight-8)+"px"},html:(c.TYPE=="ADD"?"+1":"-1")}),a.count.firstChild);if(a.popup){a.popup.close();a.popupContentPage=1}}}};RatingLike.Set=function(c,h,e,a,g,f,j,d,i){if(j===undefined){j="standart"}if(!BXRL[c]||BXRL[c].tryToSet<=5){var b=BXRL[c]&&BXRL[c].tryToSet?BXRL[c].tryToSet:1;BXRL[c]=new RatingLike(c,h,e,a,g,f,j,d,i);if(BXRL[c].enabled){RatingLike.Init(c)}else{setTimeout(function(){BXRL[c].tryToSet=b+1;RatingLike.Set(c,h,e,a,g,f,j,d,i)},500)}}};RatingLike.Init=function(a){if(BXRL[a].available){BX.bind(BXRL[a].template=="standart"?BXRL[a].button:BXRL[a].buttonText,"click",function(b){clearTimeout(BXRL[a].likeTimeout);if(BX.hasClass(BXRL[a].template=="standart"?this:BXRL[a].count,"bx-you-like")){BXRL[a].buttonText.innerHTML=BXRL[a].localize.LIKE_N;BXRL[a].countText.innerHTML=parseInt(BXRL[a].countText.innerHTML)-1;BX.removeClass(BXRL[a].template=="standart"?this:BXRL[a].count,"bx-you-like");BXRL[a].likeTimeout=setTimeout(function(){if(BXRL[a].lastVote!="cancel"){RatingLike.Vote(a,"cancel")}},1000)}else{BXRL[a].buttonText.innerHTML=BXRL[a].localize.LIKE_Y;BXRL[a].countText.innerHTML=parseInt(BXRL[a].countText.innerHTML)+1;BX.addClass(BXRL[a].template=="standart"?this:BXRL[a].count,"bx-you-like");BXRL[a].likeTimeout=setTimeout(function(){if(BXRL[a].lastVote!="plus"){RatingLike.Vote(a,"plus")}},1000)}BX.removeClass(this.box,"bx-ilike-button-hover");BX.PreventDefault(b)});BX.bind(BXRL[a].box,"mouseover",function(){BX.addClass(this,"bx-ilike-button-hover")});BX.bind(BXRL[a].box,"mouseout",function(){BX.removeClass(this,"bx-ilike-button-hover")})}else{if(BXRL[a].buttonText!=undefined){BXRL[a].buttonText.innerHTML=BXRL[a].localize.LIKE_D}}RatingLike.PopupScroll(a);BX.bind(BXRL[a].count,"mouseover",function(){clearTimeout(BXRL[a].popupTimeoutId);BXRL[a].popupTimeoutId=setTimeout(function(){if(BXRLW==a){return false}if(BXRL[a].popupContentPage==1){RatingLike.List(a,1)}BXRL[a].popupTimeoutId=setTimeout(function(){RatingLike.OpenWindow(a)},400)},400)});BX.bind(BXRL[a].count,"mouseout",function(){clearTimeout(BXRL[a].popupTimeoutId)});BX.bind(BXRL[a].count,"click",function(){clearTimeout(BXRL[a].popupTimeoutId);if(BXRL[a].popupContentPage==1){RatingLike.List(a,1)}RatingLike.OpenWindow(a)});BX.bind(BXRL[a].box,"mouseout",function(){clearTimeout(BXRL[a].popupTimeout);BXRL[a].popupTimeout=setTimeout(function(){if(BXRL[a].popup!==null){BXRL[a].popup.close();BXRLW=null}},1000)});BX.bind(BXRL[a].box,"mouseover",function(){clearTimeout(BXRL[a].popupTimeout)})};RatingLike.OpenWindow=function(a){if(parseInt(BXRL[a].countText.innerHTML)==0){return false}if(BXRL[a].popup==null){BXRL[a].popup=new BX.PopupWindow("ilike-popup-"+a,(BXRL[a].template=="standart"?BXRL[a].count:BXRL[a].box),{lightShadow:true,offsetLeft:5,autoHide:true,closeByEsc:true,zIndex:2005,bindOptions:{position:"top"},events:{onPopupClose:function(){BXRLW=null},onPopupDestroy:function(){}},content:BX("bx-ilike-popup-cont-"+a)});BXRL[a].popup.setAngle({});BX.bind(BX("ilike-popup-"+a),"mouseout",function(){clearTimeout(BXRL[a].popupTimeout);BXRL[a].popupTimeout=setTimeout(function(){BXRL[a].popup.close()},1000)});BX.bind(BX("ilike-popup-"+a),"mouseover",function(){clearTimeout(BXRL[a].popupTimeout)})}if(BXRLW!=null){BXRL[BXRLW].popup.close()}BXRLW=a;BXRL[a].popup.show();RatingLike.AdjustWindow(a)};RatingLike.Vote=function(b,a){BX.ajax({url:BXRL[b].pathToAjax,method:"POST",dataType:"json",data:{RATING_VOTE:"Y",RATING_VOTE_TYPE_ID:BXRL[b].entityTypeId,RATING_VOTE_ENTITY_ID:BXRL[b].entityId,RATING_VOTE_ACTION:a,sessid:BX.bitrix_sessid()},onsuccess:function(c){BXRL[b].lastVote=c.action;BXRL[b].countText.innerHTML=c.items_all;BXRL[b].popupContentPage=1;BXRL[b].popupContent.innerHTML="";spanTag0=document.createElement("span");spanTag0.className="bx-ilike-wait";BXRL[b].popupContent.appendChild(spanTag0);RatingLike.AdjustWindow(b);if(BX("ilike-popup-"+b)&&BX("ilike-popup-"+b).style.display=="block"){RatingLike.List(b,null)}},onfailure:function(c){}});return false};RatingLike.List=function(b,a){if(parseInt(BXRL[b].countText.innerHTML)==0){return false}if(a==null){a=BXRL[b].popupContentPage}BXRL[b].popupListProcess=true;BX.ajax({url:BXRL[b].pathToAjax,method:"POST",dataType:"json",data:{RATING_VOTE_LIST:"Y",RATING_VOTE_TYPE_ID:BXRL[b].entityTypeId,RATING_VOTE_ENTITY_ID:BXRL[b].entityId,RATING_VOTE_LIST_PAGE:a,PATH_TO_USER_PROFILE:BXRL[b].pathToUserProfile,sessid:BX.bitrix_sessid()},onsuccess:function(d){BXRL[b].countText.innerHTML=d.items_all;if(parseInt(d.items_page)==0){return false}if(a==1){BXRL[b].popupContent.innerHTML="";spanTag0=document.createElement("span");spanTag0.className="bx-ilike-bottom_scroll";BXRL[b].popupContent.appendChild(spanTag0)}BXRL[b].popupContentPage+=1;for(var c=0;c<d.items.length;c++){BXRL[b].popupContent.appendChild(BX.create("a",{attrs:{href:d.items[c]["URL"],target:"_blank"},props:{className:"bx-ilike-popup-img"},children:[BX.create("span",{props:{className:"bx-ilike-popup-avatar"},html:d.items[c]["PHOTO"]}),BX.create("span",{props:{className:"bx-ilike-popup-name"},html:d.items[c]["FULL_NAME"]})]}))}RatingLike.AdjustWindow(b);RatingLike.PopupScroll(b);BXRL[b].popupListProcess=false},onfailure:function(c){}});return false};RatingLike.AdjustWindow=function(a){if(BXRL[a].popup!=null){BXRL[a].popup.bindOptions.forceBindPosition=true;BXRL[a].popup.adjustPosition();BXRL[a].popup.bindOptions.forceBindPosition=false}};RatingLike.PopupScroll=function(a){BX.bind(BXRL[a].popupContent,"scroll",function(){if(this.scrollTop>(this.scrollHeight-this.offsetHeight)/1.5){RatingLike.List(a,null);BX.unbindAll(this)}})};(function(window){if(BX.tooltip){return}var arTooltipIndex={},bDisable=false;BX.tooltip=function(user_id,anchor_name,loader,rootClassName,bForceUseLoader){if(BX.message("TOOLTIP_ENABLED")!="Y"){return}if(BX.browser.IsAndroid()||BX.browser.IsIOS()){return}BX.ready(function(){var anchor=BX(anchor_name);if(null==anchor){return}var tooltipId=user_id;if(bForceUseLoader&&BX.type.isNotEmptyString(loader)){var loaderHash=0;for(var i=0,len=loader.length;i<len;i++){loaderHash=(31*loaderHash+loader.charCodeAt(i))<<0}tooltipId=loaderHash+user_id}if(null==arTooltipIndex[tooltipId]){arTooltipIndex[tooltipId]=new BX.CTooltip(user_id,anchor,loader,rootClassName,bForceUseLoader)}else{arTooltipIndex[tooltipId].ANCHOR=anchor;arTooltipIndex[tooltipId].rootClassName=rootClassName;arTooltipIndex[tooltipId].LOADER=(bForceUseLoader&&BX.type.isNotEmptyString(loader))?loader:"/bitrix/tools/tooltip.php";arTooltipIndex[tooltipId].Create()}})};BX.tooltip.disable=function(){bDisable=true};BX.tooltip.enable=function(){bDisable=false};BX.CTooltip=function(user_id,anchor,loader,rootClassName,bForceUseLoader){this.LOADER=(bForceUseLoader&&BX.type.isNotEmptyString(loader))?loader:"/bitrix/tools/tooltip.php";this.USER_ID=user_id;this.ANCHOR=anchor;this.rootClassName="";if(rootClassName!="undefined"&&rootClassName!=null&&rootClassName.length>0){this.rootClassName=rootClassName}var old=document.getElementById("user_info_"+this.USER_ID);if(null!=old){if(null!=old.parentNode){old.parentNode.removeChild(old)}old=null}var _this=this;this.INFO=null;this.width=393;this.height=302;this.CoordsLeft=0;this.CoordsTop=0;this.AnchorRight=0;this.AnchorBottom=0;this.DIV=null;this.ROOT_DIV=null;if(BX.browser.IsIE()){this.IFRAME=null}this.v_delta=0;this.classNameAnim=false;this.classNameFixed=false;this.left=0;this.top=0;this.tracking=false;this.active=false;this.showed=false;this.Create=function(){_this.ANCHOR.onmouseover=function(){if(!bDisable){_this.StartTrackMouse(this)}};_this.ANCHOR.onmouseout=function(){_this.StopTrackMouse(this)}};this.Create();this.TrackMouse=function(e){if(!_this.tracking){return}var current;if(e&&e.pageX){current={x:e.pageX,y:e.pageY}}else{current={x:e.clientX+document.body.scrollLeft,y:e.clientY+document.body.scrollTop}}if(current.x<0){current.x=0}if(current.y<0){current.y=0}current.time=_this.tracking;if(!_this.active){_this.active=current}else{if(_this.active.x>=(current.x-1)&&_this.active.x<=(current.x+1)&&_this.active.y>=(current.y-1)&&_this.active.y<=(current.y+1)){if((_this.active.time+20)<=current.time){_this.ShowTooltip()}}else{_this.active=current}}};this.ShowTooltip=function(){var old=document.getElementById("user_info_"+_this.USER_ID);if(bDisable||old&&old.style.display=="block"){return}var bIE=(BX.browser.IsIE()&&!BX.browser.IsIE10());if(null==_this.DIV&&null==_this.ROOT_DIV){_this.ROOT_DIV=document.body.appendChild(document.createElement("DIV"));_this.ROOT_DIV.style.position="absolute";_this.DIV=_this.ROOT_DIV.appendChild(document.createElement("DIV"));if(bIE){_this.DIV.className="bx-user-info-shadow-ie"}else{_this.DIV.className="bx-user-info-shadow"}_this.DIV.style.width=_this.width+"px";_this.DIV.style.height=_this.height+"px"}var left=_this.CoordsLeft;var top=_this.CoordsTop+30;var arScroll=jsUtils.GetWindowScrollPos();var body=document.body;var h_mirror=false;var v_mirror=false;if((body.clientWidth+arScroll.scrollLeft)<(left+_this.width)){left=_this.AnchorRight-_this.width;h_mirror=true}if((top-arScroll.scrollTop)<0){top=_this.AnchorBottom-5;v_mirror=true;_this.v_delta=40}else{_this.v_delta=0}_this.ROOT_DIV.style.left=parseInt(left)+"px";_this.ROOT_DIV.style.top=parseInt(top)+"px";_this.ROOT_DIV.style.zIndex=1200;BX.bind(BX(_this.ROOT_DIV),"click",BX.eventCancelBubble);if(this.rootClassName!="undefined"&&this.rootClassName!=null&&this.rootClassName.length>0){_this.ROOT_DIV.className=this.rootClassName}if(""==_this.DIV.innerHTML){var url;if(_this.LOADER.indexOf("?")>=0){url=_this.LOADER+"&MUL_MODE=INFO&USER_ID="+_this.USER_ID+"&site="+(BX.message("SITE_ID")||"")}else{url=_this.LOADER+"?MUL_MODE=INFO&USER_ID="+_this.USER_ID+"&site="+(BX.message("SITE_ID")||"")}BX.ajax.get(url,_this.InsertData);_this.DIV.id="user_info_"+_this.USER_ID;_this.DIV.innerHTML='<div class="bx-user-info-wrap"><div class="bx-user-info-leftcolumn"><div class="bx-user-photo" id="user-info-photo-'+_this.USER_ID+'"><div class="bx-user-info-data-loading">'+BX.message("JS_CORE_LOADING")+'</div></div><div class="bx-user-tb-control bx-user-tb-control-left" id="user-info-toolbar-'+_this.USER_ID+'"></div></div><div class="bx-user-info-data"><div id="user-info-data-card-'+_this.USER_ID+'"></div><div class="bx-user-info-data-tools"><div class="bx-user-tb-control bx-user-tb-control-right" id="user-info-toolbar2-'+_this.USER_ID+'"></div><div class="bx-user-info-data-clear"></div></div></div></div><div class="bx-user-info-bottomarea"></div>'}if(bIE){_this.DIV.className="bx-user-info-shadow-ie";_this.classNameAnim="bx-user-info-shadow-anim-ie";_this.classNameFixed="bx-user-info-shadow-ie"}else{_this.DIV.className="bx-user-info-shadow";_this.classNameAnim="bx-user-info-shadow-anim";_this.classNameFixed="bx-user-info-shadow"}_this.filterFixed="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/components/bitrix/main.user.link/templates/.default/images/cloud-left-top.png', sizingMethod = 'crop' );";if(h_mirror&&v_mirror){if(BX.browser.IsIE6()){_this.DIV.className="bx-user-info-shadow-hv-ie6";_this.classNameAnim="bx-user-info-shadow-hv-anim-ie6";_this.classNameFixed="bx-user-info-shadow-hv-ie6"}else{if(bIE){_this.DIV.className="bx-user-info-shadow-hv-ie";_this.classNameAnim="bx-user-info-shadow-hv-anim-ie";_this.classNameFixed="bx-user-info-shadow-hv-ie"}else{_this.DIV.className="bx-user-info-shadow-hv";_this.classNameAnim="bx-user-info-shadow-hv-anim";_this.classNameFixed="bx-user-info-shadow-hv"}}_this.filterFixed="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/components/bitrix/main.user.link/templates/.default/images/cloud-right-bottom.png', sizingMethod = 'crop' );"}else{if(h_mirror){if(bIE){_this.DIV.className="bx-user-info-shadow-h-ie";_this.classNameAnim="bx-user-info-shadow-h-anim-ie";_this.classNameFixed="bx-user-info-shadow-h-ie"}else{_this.DIV.className="bx-user-info-shadow-h";_this.classNameAnim="bx-user-info-shadow-h-anim";_this.classNameFixed="bx-user-info-shadow-h"}_this.filterFixed="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/components/bitrix/main.user.link/templates/.default/images/cloud-right-top.png', sizingMethod = 'crop' );"}if(v_mirror){if(BX.browser.IsIE6()){_this.DIV.className="bx-user-info-shadow-v-ie6";_this.classNameAnim="bx-user-info-shadow-v-anim-ie6";_this.classNameFixed="bx-user-info-shadow-v-ie6"}else{if(bIE){_this.DIV.className="bx-user-info-shadow-v-ie";_this.classNameAnim="bx-user-info-shadow-v-anim-ie";_this.classNameFixed="bx-user-info-shadow-v-ie"}else{_this.DIV.className="bx-user-info-shadow-v";_this.classNameAnim="bx-user-info-shadow-v-anim";_this.classNameFixed="bx-user-info-shadow-v"}}_this.filterFixed="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/components/bitrix/main.user.link/templates/.default/images/cloud-left-bottom.png', sizingMethod = 'crop' );"}}if(BX.browser.IsIE()&&null==_this.IFRAME){_this.IFRAME=document.body.appendChild(document.createElement("IFRAME"));_this.IFRAME.id=_this.DIV.id+"_frame";_this.IFRAME.style.position="absolute";_this.IFRAME.style.width=(_this.width-60)+"px";_this.IFRAME.style.height=(_this.height-100)+"px";_this.IFRAME.style.borderStyle="solid";_this.IFRAME.style.borderWidth="0px";_this.IFRAME.style.zIndex=550;_this.IFRAME.style.display="none"}if(BX.browser.IsIE()){_this.IFRAME.style.left=(parseInt(left)+25)+"px";_this.IFRAME.style.top=(parseInt(top)+30+_this.v_delta)+"px"}_this.DIV.style.display="none";_this.ShowOpacityEffect({func:_this.SetVisible,obj:_this.DIV,arParams:[]},0);document.getElementById("user_info_"+_this.USER_ID).onmouseover=function(){_this.StartTrackMouse(this)};document.getElementById("user_info_"+_this.USER_ID).onmouseout=function(){_this.StopTrackMouse(this)}};this.InsertData=function(data){if(null!=data&&data.length>0){eval("_this.INFO = "+data);var cardEl=document.getElementById("user-info-data-card-"+_this.USER_ID);cardEl.innerHTML=_this.INFO.RESULT.Card;var photoEl=document.getElementById("user-info-photo-"+_this.USER_ID);photoEl.innerHTML=_this.INFO.RESULT.Photo;var toolbarEl=document.getElementById("user-info-toolbar-"+_this.USER_ID);toolbarEl.innerHTML=_this.INFO.RESULT.Toolbar;var toolbar2El=document.getElementById("user-info-toolbar2-"+_this.USER_ID);toolbar2El.innerHTML=_this.INFO.RESULT.Toolbar2}}};BX.CTooltip.prototype.StartTrackMouse=function(ob){var _this=this;if(!this.tracking){var elCoords=jsUtils.GetRealPos(ob);this.CoordsLeft=elCoords.left+0;this.CoordsTop=elCoords.top-325;this.AnchorRight=elCoords.right;this.AnchorBottom=elCoords.bottom;this.tracking=1;jsUtils.addEvent(document,"mousemove",_this.TrackMouse);setTimeout(function(){_this.tickTimer()},500)}};BX.CTooltip.prototype.StopTrackMouse=function(){var _this=this;if(this.tracking){jsUtils.removeEvent(document,"mousemove",_this.TrackMouse);this.active=false;setTimeout(function(){_this.HideTooltip()},500);this.tracking=false}};BX.CTooltip.prototype.tickTimer=function(){var _this=this;if(this.tracking){this.tracking++;if(this.active){if((this.active.time+5)<=this.tracking){this.ShowTooltip()}}setTimeout(function(){_this.tickTimer()},100)}};BX.CTooltip.prototype.HideTooltip=function(){if(!this.tracking){this.ShowOpacityEffect({func:this.SetInVisible,obj:this.DIV,arParams:[]},1)}};BX.CTooltip.prototype.ShowOpacityEffect=function(oCallback,bFade){var steps=3;var period=1;var delta=1/steps;var i=0,op,_this=this;if(BX.browser.IsIE()&&_this.DIV){_this.DIV.className=_this.classNameAnim}var show=function(){i++;if(i>steps){clearInterval(intId);if(!oCallback.arParams){oCallback.arParams=[]}if(oCallback.func&&oCallback.obj){oCallback.func.apply(oCallback.obj,oCallback.arParams)}return}op=bFade?1-i*delta:i*delta;if(_this.DIV!=null){try{_this.DIV.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+(op*100)+")";_this.DIV.style.opacity=op;_this.DIV.style.MozOpacity=op;_this.DIV.style.KhtmlOpacity=op}catch(e){}finally{if(!bFade&&i==1){_this.DIV.style.display="block"}if(bFade&&i==steps&&_this.DIV){_this.DIV.style.display="none"}if(jsUtils.IsIE()&&i==1&&bFade&&_this.IFRAME){_this.IFRAME.style.display="none"}if(jsUtils.IsIE()&&i==steps&&_this.DIV){if(!bFade){_this.IFRAME.style.display="block"}_this.DIV.style.filter=_this.filterFixed;_this.DIV.className=_this.classNameFixed;_this.DIV.innerHTML=""+_this.DIV.innerHTML}}}};var intId=setInterval(show,period)}})(window);(function(a){BX.DD=function(b){return new BX.DD.dragdrop(b)};BX.DD.allowSelection=function(){document.onmousedown=null;var c=document.body;c.ondrag=null;c.onselectstart=null;c.style.MozUserSelect=""};BX.DD.denySelection=function(){document.onmousedown=BX.False;var c=document.body;c.ondrag=BX.False;c.onselectstart=BX.False;c.style.MozUserSelect="none"};BX.DD.dragdrop=function(b){};BX.DD.dropFiles=function(b){if(BX.type.isElementNode(b)&&this.supported()){b.setAttribute("dropzone","copy f:*/*");this.DIV=b;this._timer=null;this._initEvents();this._cancelLeave=function(){if(this._timer!=null){clearTimeout(this._timer);this._timer=null}};this._prepareLeave=function(){this._cancelLeave();this._timer=setTimeout(BX.delegate(function(){BX.onCustomEvent(this,"dragLeave")},this),100)};return this}return false};BX.DD.dropFiles.prototype._initEvents=function(){BX.bind(this.DIV,"dragover",BX.proxy(this._dragOver,this));BX.bind(this.DIV,"dragenter",BX.proxy(this._dragEnter,this));BX.bind(this.DIV,"dragleave",BX.proxy(this._dragLeave,this));BX.bind(this.DIV,"dragexit",BX.proxy(this._dragExit,this));BX.bind(this.DIV,"drop",BX.proxy(this._drop,this))};BX.DD.dropFiles.prototype._dragEnter=function(b){BX.PreventDefault(b);this._cancelLeave();BX.onCustomEvent(this,"dragEnter");return true};BX.DD.dropFiles.prototype._dragExit=function(b){BX.PreventDefault(b);this._prepareLeave();return false};BX.DD.dropFiles.prototype._dragLeave=function(b){BX.PreventDefault(b);this._prepareLeave();return false};BX.DD.dropFiles.prototype._dragOver=function(b){BX.PreventDefault(b);this._cancelLeave();return true};BX.DD.dropFiles.prototype._drop=function(d){BX.PreventDefault(d);var c=d.dataTransfer;var b=c.files;BX.onCustomEvent(this,"dropFiles",[b]);BX.onCustomEvent(this,"dragLeave");return false};BX.DD.dropFiles.prototype.isEventSupported=function(d){var e=BX.create("DIV");var c="on"+d;var b=(c in e);if(!b&&e.setAttribute&&e.removeAttribute){e.setAttribute(c,"");b=(typeof e[c]==="function")}e=null;return b};BX.DD.dropFiles.prototype.supported=function(){return((!!a.FileReader)&&this.isEventSupported("dragstart")&&this.isEventSupported("drop"))}})(window);(function(c){if(BX.CAutoSave&&top.BX.CAutoSave){return}BX.CAutoSave=function(e){this.FORM_NAME=e.form;this.FORM_MARKER=e.form_marker;this.FORM_ID=e.form_id;this.PERIOD=e.period||[4001,20990];this.RESTORE_DATA=null;this.TIMERS=[null,null];this.bInited=false;this.bRestoreInProgress=false;this.DISABLE_STANDARD_NOTIFY=e.DISABLE_STANDARD_NOTIFY;this.NOTIFY_CONTEXT=null;BX.ready(BX.defer(this.Prepare,this));BX.garbage(BX.delegate(this.Clear,this))};BX.CAutoSave.prototype.Prepare=function(){var e;if(this.FORM_NAME&&BX.type.isString(this.FORM_NAME)){this.FORM=document.forms[this.FORM_NAME]}else{if(this.FORM_MARKER&&BX.type.isString(this.FORM_MARKER)){this.FORM=(BX(this.FORM_MARKER)||{form:null}).form}}if(!BX.type.isDomNode(this.FORM)){return}this.FORM.BXAUTOSAVE=this;BX.bind(this.FORM,"submit",BX.proxy(this.ClearTimers,this));for(e=0;e<this.FORM.elements.length;e++){this.RegisterInput(this.FORM.elements[e])}setTimeout(BX.delegate(this._PrepareAfter,this),10)};BX.CAutoSave.prototype.RegisterInput=function(e){if(BX.type.isString(e)){setTimeout(BX.delegate(function(){this.RegisterInput(this.FORM[e]||BX(e))},this),10)}else{if(BX.type.isDomNode(e)){if(e.type!="button"&&e.type!="submit"&&e.type!="reset"&&e.type!="image"&&e.type!="hidden"){BX.bind(e,"change",BX.proxy(this.Init,this));if(e.type=="text"||e.type=="textarea"){BX.bind(e,"keyup",BX.proxy(this.Init,this))}if(e.type=="checkbox"||e.type=="radio"){BX.bind(e,"click",BX.proxy(this.Init,this))}}}}};BX.CAutoSave.prototype.UnRegisterInput=function(e){if(BX.type.isString(e)){e=this.FORM[e]||BX(e)}if(BX.type.isDomNode(e)){BX.unbind(e,"change",BX.proxy(this.Init,this));BX.unbind(e,"keyup",BX.proxy(this.Init,this));BX.unbind(e,"click",BX.proxy(this.Init,this))}};BX.CAutoSave.prototype._PrepareAfter=function(){BX.onCustomEvent(this.FORM,"onAutoSavePrepare",[this,BX.proxy(this.Init,this)]);if(this.RESTORE_DATA){var f=this.FORM.name||Math.random();BX.addCustomEvent("onExtAutoSaveRestoreClick_"+f,BX.proxy(this.Restore,this));var e=this._NotifyContext();if(e){e.Notify(BX.message("AUTOSAVE")+' <a href="javascript:void(0)" onclick="BX.CAutoSave.Restore(\''+BX.util.urlencode(f)+"', this); return false;\">"+BX.message("AUTOSAVE_R")+"</a>")}BX.onCustomEvent(this.FORM,"onAutoSaveRestoreFound",[this,this.RESTORE_DATA])}};BX.CAutoSave.prototype.Init=function(){if(this.TIMERS[0]){clearTimeout(this.TIMERS[0]);this.TIMERS[0]=null}this.TIMERS[0]=setTimeout(BX.proxy(this.TimerHandler,this),this.PERIOD[0]);if(!this.TIMERS[1]){this.TIMERS[1]=setInterval(BX.proxy(this.Save,this),this.PERIOD[1])}BX.onCustomEvent(this.FORM,"onAutoSaveInit",[this])};BX.CAutoSave.prototype.TimerHandler=function(){if(this.TIMERS[1]){clearInterval(this.TIMERS[1]);this.TIMERS[1]=null}this.Save()};BX.CAutoSave.prototype.Save=function(){if(this.FORM&&BX.isNodeInDom(this.FORM)){var h,f,k,l={autosave_id:this.FORM_ID,form_data:{}};for(h=0;h<this.FORM.elements.length;h++){k=this.FORM.elements[h];if(k.name&&k.name!="sessid"&&k.name!="lang"&&k.name!="autosave_id"){var m=k.name,e="",g=k.type.toLowerCase();switch(g){case"button":case"submit":case"reset":case"image":case"file":case"password":break;case"radio":case"checkbox":if(k.checked){e=k.value||"on"}break;case"select-multiple":m=m.substring(0,m.length-2);e=[];for(f=0;f<k.options.length;f++){if(k.options[f].selected){e.push(k.options[f].value)}}break;default:e=k.value}if(m.indexOf("[]")>0){m=d(m);if(typeof(l.form_data[m])=="undefined"){l.form_data[m]=[e]}else{l.form_data[m].push(e)}}else{l.form_data[d(m)]=e}}}BX.onCustomEvent(this.FORM,"onAutoSave",[this,l.form_data]);BX.ajax.post("/bitrix/tools/autosave.php?bxsender=core_autosave&sessid="+BX.bitrix_sessid(),l,BX.proxy(this._Save,this))}else{this.Clear()}};BX.CAutoSave.prototype._Save=function(e){BX.onCustomEvent(this.FORM,"onAutoSaveFinished",[this,e])};BX.CAutoSave.prototype.Restore=function(p,g){if(p){this.RESTORE_DATA=b(p)}else{if(this.FORM&&this.RESTORE_DATA){BX.onCustomEvent(this.FORM,"onAutoSaveRestore",[this,this.RESTORE_DATA]);this.bRestoreInProgress=true;for(var r=0;r<this.FORM.elements.length;r++){var k=this.FORM.elements[r];if(k&&BX.type.isDomNode(k)&&k.name){var s=undefined,l=k.name;if(k.type=="select-multiple"){l=k.name.substring(0,k.name.length-2)}s=this.RESTORE_DATA[l];if(l.indexOf("[]")>0&&BX.type.isArray(s)){s=this.RESTORE_DATA[l].shift()}if(k.type!="checkbox"&&typeof s=="undefined"){continue}var e=false;switch(k.type){case"radio":if(!k.checked&&!!(s==k.value)){e=true;BX.fireEvent(k,"click")}break;case"checkbox":if(k.checked!=!!(s==k.value)){e=true;BX.fireEvent(k,"click")}break;case"select-one":for(var m=0;m<k.options.length;m++){var f=k.options[m].selected;k.options[m].selected=!!(s==k.options[m].value);e|=k.options[m].selected!=f}break;case"select-multiple":s=this.RESTORE_DATA[k.name.substring(0,k.name.length-2)];for(m=0;m<k.options.length;m++){f=k.options[m].selected;k.options[m].selected=!!(BX.type.isArray(s)&&BX.util.in_array(k.options[m].value,s));e|=k.options[m].selected!=f}break;case"file":case"button":case"image":case"submit":case"reset":case"password":break;default:e=s!=k.value;k.value=s}if(e){BX.fireEvent(k,"change")}}}var h=this._NotifyContext();if(h){h.hideNotify(g.parentNode.parentNode)}this.bRestoreInProgress=false;BX.onCustomEvent(this.FORM,"onAutoSaveRestoreFinished",[this,this.RESTORE_DATA])}}};BX.CAutoSave.prototype._NotifyContext=function(){var e=null;if(!this.DISABLE_STANDARD_NOTIFY){if(this.NOTIFY_CONTEXT){e=this.NOTIFY_CONTEXT}else{if(BX.WindowManager&&BX.WindowManager.Get()){e=BX.WindowManager.Get()}else{if(BX.adminPanel){e=BX.adminPanel}else{if(BX.admin&&BX.admin.panel){e=BX.admin.panel}}}}this.NOTIFY_CONTEXT=e}return e};BX.CAutoSave.prototype.ClearTimers=function(){if(this.TIMERS){clearTimeout(this.TIMERS[0]);clearInterval(this.TIMERS[1])}};BX.CAutoSave.prototype.Clear=function(){if(this.FORM){this.FORM.BXAUTOSAVE=null;for(var e=0;e<this.FORM.elements.length;e++){this.UnRegisterInput(this.FORM.elements[e])}}this.ClearTimers();BX.onCustomEvent(this.FORM,"onAutoSaveClear",[this]);this.FORM=null;this.TIMERS=null};BX.CAutoSave.Restore=function(f,e){BX.onCustomEvent("onExtAutoSaveRestoreClick_"+f,[null,e])};function d(f){var e;while(e=/[^a-zA-Z0-9_\-]/.exec(f)){f=f.replace(e[0],"X"+BX.util.str_pad_left(e[0].charCodeAt(0).toString(),6,"0")+"X")}return f}function a(f){var e;while(e=/X[\d]{6}X/.exec(f)){f=f.replace(e[0],String.fromCharCode(parseInt(e[0].replace(/(^X[0]*)|(X$)/g,""))))}return f}function b(f){var g={};for(var e in f){g[a(e)]=f[e]}return g}top.BX.CAutoSave=BX.CAutoSave})(window);(function(){if(BX.date){return}BX.date={};BX.date.format=function(u,e,d,b){var w=BX.type.isDate(e)?new Date(e.getTime()):BX.type.isNumber(e)?new Date(e*1000):new Date();var q=BX.type.isDate(d)?new Date(d.getTime()):BX.type.isNumber(d)?new Date(d*1000):new Date();var c=!!b;if(BX.type.isArray(u)){return s(u,w,q,c)}else{if(!BX.type.isNotEmptyString(u)){return""}}var t=/\\?(sago|iago|isago|Hago|dago|mago|Yago|sdiff|idiff|Hdiff|ddiff|mdiff|Ydiff|yesterday|today|tommorow|[a-z])/gi;var p={d:function(){return BX.util.str_pad_left(l(w).toString(),2,"0")},D:function(){return BX.message("DOW_"+i(w))},j:function(){return l(w)},l:function(){return BX.message("DAY_OF_WEEK_"+i(w))},N:function(){return i(w)||7},S:function(){if(l(w)%10==1&&l(w)!=11){return"st"}else{if(l(w)%10==2&&l(w)!=12){return"nd"}else{if(l(w)%10==3&&l(w)!=13){return"rd"}else{return"th"}}}},w:function(){return i(w)},z:function(){var A=new Date(m(w),0,1);var B=new Date(m(w),k(w),l(w));return Math.ceil((B-A)/(24*3600*1000))},W:function(){var B=new Date(w.getTime());var D=(i(w)+6)%7;f(B,l(B)-D+3);var C=B.getTime();j(B,0,1);if(i(B)!=4){j(B,0,1+((4-i(B))+7)%7)}var A=1+Math.ceil((C-B)/(7*24*3600*1000));return BX.util.str_pad_left(A.toString(),2,"0")},F:function(){return BX.message("MONTH_"+(k(w)+1)+"_S")},f:function(){return BX.message("MONTH_"+(k(w)+1))},m:function(){return BX.util.str_pad_left((k(w)+1).toString(),2,"0")},M:function(){return BX.message("MON_"+(k(w)+1))},n:function(){return k(w)+1},t:function(){var A=c?new Date(Date.UTC(m(w),k(w)+1,0)):new Date(m(w),k(w)+1,0);return l(A)},L:function(){var A=m(w);return(A%4==0&&A%100!=0||A%400==0?1:0)},o:function(){var A=new Date(w.getTime());f(A,l(A)-((i(w)+6)%7)+3);return m(A)},Y:function(){return m(w)},y:function(){return m(w).toString().slice(2)},a:function(){return h(w)>11?"pm":"am"},A:function(){return h(w)>11?"PM":"AM"},B:function(){var A=((w.getUTCHours()+1)%24)+w.getUTCMinutes()/60+w.getUTCSeconds()/3600;return BX.util.str_pad_left(Math.floor(A*1000/24).toString(),3,"0")},g:function(){return h(w)%12||12},G:function(){return h(w)},h:function(){return BX.util.str_pad_left((h(w)%12||12).toString(),2,"0")},H:function(){return BX.util.str_pad_left(h(w).toString(),2,"0")},i:function(){return BX.util.str_pad_left(y(w).toString(),2,"0")},s:function(){return BX.util.str_pad_left(g(w).toString(),2,"0")},u:function(){return BX.util.str_pad_left((x(w)*1000).toString(),6,"0")},e:function(){if(c){return"UTC"}return""},I:function(){if(c){return 0}var B=new Date(m(w),0,1);var D=Date.UTC(m(w),0,1);var C=new Date(m(w),6,0);var A=Date.UTC(m(w),6,0);return 0+((B-D)!==(C-A))},O:function(){if(c){return"+0000"}var B=w.getTimezoneOffset();var A=Math.abs(B);return(B>0?"-":"+")+BX.util.str_pad_left((Math.floor(A/60)*100+A%60).toString(),4,"0")},P:function(){if(c){return"+00:00"}var A=this.O();return A.substr(0,3)+":"+A.substr(3)},Z:function(){if(c){return 0}return -w.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(t,o)},r:function(){return"D, d M Y H:i:s O".replace(t,o)},U:function(){return Math.floor(w.getTime()/1000)},sago:function(){return v(z((q-w)/1000),{"0":"FD_SECOND_AGO_0","1":"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},sdiff:function(){return v(z((q-w)/1000),{"0":"FD_SECOND_DIFF_0","1":"FD_SECOND_DIFF_1","10_20":"FD_SECOND_DIFF_10_20",MOD_1:"FD_SECOND_DIFF_MOD_1",MOD_2_4:"FD_SECOND_DIFF_MOD_2_4",MOD_OTHER:"FD_SECOND_DIFF_MOD_OTHER"})},iago:function(){return v(z((q-w)/60/1000),{"0":"FD_MINUTE_AGO_0","1":"FD_MINUTE_AGO_1","10_20":"FD_MINUTE_AGO_10_20",MOD_1:"FD_MINUTE_AGO_MOD_1",MOD_2_4:"FD_MINUTE_AGO_MOD_2_4",MOD_OTHER:"FD_MINUTE_AGO_MOD_OTHER"})},idiff:function(){return v(z((q-w)/60/1000),{"0":"FD_MINUTE_DIFF_0","1":"FD_MINUTE_DIFF_1","10_20":"FD_MINUTE_DIFF_10_20",MOD_1:"FD_MINUTE_DIFF_MOD_1",MOD_2_4:"FD_MINUTE_DIFF_MOD_2_4",MOD_OTHER:"FD_MINUTE_DIFF_MOD_OTHER"})},isago:function(){var B=z((q-w)/60/1000);var A=v(B,{"0":"FD_MINUTE_0","1":"FD_MINUTE_1","10_20":"FD_MINUTE_10_20",MOD_1:"FD_MINUTE_MOD_1",MOD_2_4:"FD_MINUTE_MOD_2_4",MOD_OTHER:"FD_MINUTE_MOD_OTHER"});A+=" ";var C=z((q-w)/1000)-(B*60);A+=v(C,{"0":"FD_SECOND_AGO_0","1":"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"});return A},Hago:function(){return v(z((q-w)/60/60/1000),{"0":"FD_HOUR_AGO_0","1":"FD_HOUR_AGO_1","10_20":"FD_HOUR_AGO_10_20",MOD_1:"FD_HOUR_AGO_MOD_1",MOD_2_4:"FD_HOUR_AGO_MOD_2_4",MOD_OTHER:"FD_HOUR_AGO_MOD_OTHER"})},Hdiff:function(){return v(z((q-w)/60/60/1000),{"0":"FD_HOUR_DIFF_0","1":"FD_HOUR_DIFF_1","10_20":"FD_HOUR_DIFF_10_20",MOD_1:"FD_HOUR_DIFF_MOD_1",MOD_2_4:"FD_HOUR_DIFF_MOD_2_4",MOD_OTHER:"FD_HOUR_DIFF_MOD_OTHER"})},yesterday:function(){return BX.message("FD_YESTERDAY")},today:function(){return BX.message("FD_TODAY")},tommorow:function(){return BX.message("FD_TOMORROW")},dago:function(){return v(z((q-w)/60/60/24/1000),{"0":"FD_DAY_AGO_0","1":"FD_DAY_AGO_1","10_20":"FD_DAY_AGO_10_20",MOD_1:"FD_DAY_AGO_MOD_1",MOD_2_4:"FD_DAY_AGO_MOD_2_4",MOD_OTHER:"FD_DAY_AGO_MOD_OTHER"})},ddiff:function(){return v(z((q-w)/60/60/24/1000),{"0":"FD_DAY_DIFF_0","1":"FD_DAY_DIFF_1","10_20":"FD_DAY_DIFF_10_20",MOD_1:"FD_DAY_DIFF_MOD_1",MOD_2_4:"FD_DAY_DIFF_MOD_2_4",MOD_OTHER:"FD_DAY_DIFF_MOD_OTHER"})},mago:function(){return v(z((q-w)/60/60/24/31/1000),{"0":"FD_MONTH_AGO_0","1":"FD_MONTH_AGO_1","10_20":"FD_MONTH_AGO_10_20",MOD_1:"FD_MONTH_AGO_MOD_1",MOD_2_4:"FD_MONTH_AGO_MOD_2_4",MOD_OTHER:"FD_MONTH_AGO_MOD_OTHER"})},mdiff:function(){return v(z((q-w)/60/60/24/31/1000),{"0":"FD_MONTH_DIFF_0","1":"FD_MONTH_DIFF_1","10_20":"FD_MONTH_DIFF_10_20",MOD_1:"FD_MONTH_DIFF_MOD_1",MOD_2_4:"FD_MONTH_DIFF_MOD_2_4",MOD_OTHER:"FD_MONTH_DIFF_MOD_OTHER"})},Yago:function(){return v(z((q-w)/60/60/24/365/1000),{"0":"FD_YEARS_AGO_0","1":"FD_YEARS_AGO_1","10_20":"FD_YEARS_AGO_10_20",MOD_1:"FD_YEARS_AGO_MOD_1",MOD_2_4:"FD_YEARS_AGO_MOD_2_4",MOD_OTHER:"FD_YEARS_AGO_MOD_OTHER"})},Ydiff:function(){return v(z((q-w)/60/60/24/365/1000),{"0":"FD_YEARS_DIFF_0","1":"FD_YEARS_DIFF_1","10_20":"FD_YEARS_DIFF_10_20",MOD_1:"FD_YEARS_DIFF_MOD_1",MOD_2_4:"FD_YEARS_DIFF_MOD_2_4",MOD_OTHER:"FD_YEARS_DIFF_MOD_OTHER"})},x:function(){return BX.date.format([["tommorow","tommorow, H:i"],["-",BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:s$/g,"")],["s","sago"],["i","iago"],["today","today, H:i"],["yesterday","yesterday, H:i"],["",BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:s$/g,"")]],w,q,c)},X:function(){var A=BX.date.format([["tommorow","tommorow"],["-",BX.date.convertBitrixFormat(BX.message("FORMAT_DATE"))],["today","today"],["yesterday","yesterday"],["",BX.date.convertBitrixFormat(BX.message("FORMAT_DATE"))]],w,q,c);var B=BX.date.format([["tommorow","H:i"],["today","H:i"],["yesterday","H:i"],["",""]],w,q,c);if(B.length>0){return BX.message("FD_DAY_AT_TIME").replace(/#DAY#/g,A).replace(/#TIME#/g,B)}else{return A}},Q:function(){var A=z((q-w)/60/60/24/1000);if(A==0){return BX.message("FD_DAY_DIFF_1").replace(/#VALUE#/g,1)}else{return BX.date.format([["d","ddiff"],["m","mdiff"],["","Ydiff"]],w,q)}}};var r=false;if(u[0]&&u[0]=="^"){r=true;u=u.substr(1)}var n=u.replace(t,o);if(r){n=n.replace(/\s*00:00:00\s*/g,"").replace(/(\d\d:\d\d)(:00)/g,"$1").replace(/(\s*00:00\s*)(?!:)/g,"")}return n;function s(E,P,L,A){var G=z((L-P)/1000);for(var O=0;O<E.length;O++){var M=E[O][0];var D=E[O][1];var H=null;if(M=="s"){if(G<60){return BX.date.format(D,P,L,A)}}else{if((H=/^s(\d+)/.exec(M))!=null){if(G<H[1]){return BX.date.format(D,P,L,A)}}else{if(M=="i"){if(G<60*60){return BX.date.format(D,P,L,A)}}else{if((H=/^i(\d+)/.exec(M))!=null){if(G<H[1]*60){return BX.date.format(D,P,L,A)}}else{if(M=="H"){if(G<24*60*60){return BX.date.format(D,P,L,A)}}else{if((H=/^H(\d+)/.exec(M))!=null){if(G<H[1]*60*60){return BX.date.format(D,P,L,A)}}else{if(M=="d"){if(G<31*24*60*60){return BX.date.format(D,P,L,A)}}else{if((H=/^d(\d+)/.exec(M))!=null){if(G<H[1]*60*60){return BX.date.format(D,P,L,A)}}else{if(M=="m"){if(G<365*24*60*60){return BX.date.format(D,P,L,A)}}else{if((H=/^m(\d+)/.exec(M))!=null){if(G<H[1]*31*24*60*60){return BX.date.format(D,P,L,A)}}else{if(M=="today"){var J=m(L),Q=k(L),N=l(L);var R=A?new Date(Date.UTC(J,Q,N,0,0,0,0)):new Date(J,Q,N,0,0,0,0);var F=A?new Date(Date.UTC(J,Q,N+1,0,0,0,0)):new Date(J,Q,N+1,0,0,0,0);if(P>=R&&P<F){return BX.date.format(D,P,L,A)}}else{if(M=="yesterday"){J=m(L);Q=k(L);N=l(L);var C=A?new Date(Date.UTC(J,Q,N-1,0,0,0,0)):new Date(J,Q,N-1,0,0,0,0);var B=A?new Date(Date.UTC(J,Q,N,0,0,0,0)):new Date(J,Q,N,0,0,0,0);if(P>=C&&P<B){return BX.date.format(D,P,L,A)}}else{if(M=="tommorow"){J=m(L);Q=k(L);N=l(L);var I=A?new Date(Date.UTC(J,Q,N+1,0,0,0,0)):new Date(J,Q,N+1,0,0,0,0);var K=A?new Date(Date.UTC(J,Q,N+2,0,0,0,0)):new Date(J,Q,N+2,0,0,0,0);if(P>=I&&P<K){return BX.date.format(D,P,L,A)}}else{if(M=="-"){if(G<0){return BX.date.format(D,P,L,A)}}}}}}}}}}}}}}}}return E.length>0?BX.date.format(E.pop()[1],P,L,A):""}function m(A){return c?A.getUTCFullYear():A.getFullYear()}function l(A){return c?A.getUTCDate():A.getDate()}function k(A){return c?A.getUTCMonth():A.getMonth()}function h(A){return c?A.getUTCHours():A.getHours()}function y(A){return c?A.getUTCMinutes():A.getMinutes()}function g(A){return c?A.getUTCSeconds():A.getSeconds()}function x(A){return c?A.getUTCMilliseconds():A.getMilliseconds()}function i(A){return c?A.getUTCDay():A.getDay()}function f(A,B){return c?A.setUTCDate(B):A.setDate(B)}function j(B,A,C){return c?B.setUTCMonth(A,C):B.setMonth(A,C)}function v(C,B){var D=C<100?Math.abs(C):Math.abs(C%100);var E=D%10;var A="";if(D==0){A=BX.message(B["0"])}else{if(D==1){A=BX.message(B["1"])}else{if(D>=10&&D<=20){A=BX.message(B["10_20"])}else{if(E==1){A=BX.message(B.MOD_1)}else{if(2<=E&&E<=4){A=BX.message(B.MOD_2_4)}else{A=BX.message(B.MOD_OTHER)}}}}}return A.replace(/#VALUE#/g,C)}function o(A,B){if(p[A]){return p[A]()}else{return B}}function z(A){return A>=0?Math.floor(A):Math.ceil(A)}};BX.date.convertBitrixFormat=function(b){if(!BX.type.isNotEmptyString(b)){return""}return b.replace("YYYY","Y").replace("MMMM","F").replace("MM","m").replace("M","M").replace("DD","d").replace("G","g").replace(/GG/i,"G").replace("H","h").replace(/HH/i,"H").replace("MI","i").replace("SS","s").replace("TT","A").replace("T","a")};BX.date.convertToUTC=function(b){if(!BX.type.isDate(b)){return null}return new Date(Date.UTC(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds()))};BX.date.getNewDate=function(b){return new Date(BX.date.getBrowserTimestamp(b))};BX.date.getBrowserTimestamp=function(c){c=parseInt(c,10);var b=new Date(c*1000).getTimezoneOffset()*60;return(parseInt(c,10)+parseInt(BX.message("SERVER_TZ_OFFSET"))+b)*1000};BX.date.getServerTimestamp=function(c){c=parseInt(c,10);var b=new Date(c).getTimezoneOffset()*60;return Math.round(c/1000-(parseInt(BX.message("SERVER_TZ_OFFSET"),10)+parseInt(b,10)))};var a=null;BX.calendar=function(b){return BX.calendar.get().Show(b)};BX.calendar.get=function(){if(!a){a=new BX.JCCalendar()}return a};BX.calendar.InsertDaysBack=function(b,e){if(e!=""){var c=new Date();if(e>0){c.setTime(c.valueOf()-e*86400000)}b.value=BX.date.format(BX.date.convertBitrixFormat(BX.message("FORMAT_DATE")),c,null)}else{b.value=""}};BX.calendar.ValueToString=function(c,d,b){return BX.date.format(BX.date.convertBitrixFormat(BX.message(d?"FORMAT_DATETIME":"FORMAT_DATE")),c,null,!!b)};BX.CalendarPeriod={Init:function(d,b,c){if((d.value!=""||b.value!="")&&c.value==""){c.value="interval"}c.onchange()},ChangeDirectOpts:function(c,b){var d=BX.findChild(b,{className:"adm-select adm-calendar-direction"},true);if(c=="week"){d.options[0].text=BX.message("JSADM_CALEND_PREV_WEEK");d.options[1].text=BX.message("JSADM_CALEND_CURR_WEEK");d.options[2].text=BX.message("JSADM_CALEND_NEXT_WEEK")}else{d.options[0].text=BX.message("JSADM_CALEND_PREV");d.options[1].text=BX.message("JSADM_CALEND_CURR");d.options[2].text=BX.message("JSADM_CALEND_NEXT")}},SaveAndClearInput:function(b){if(!window.SavedPeriodValues){window.SavedPeriodValues={}}window.SavedPeriodValues[b.id]=b.value;b.value=""},RestoreInput:function(b){if(!window.SavedPeriodValues||!window.SavedPeriodValues[b.id]){return}b.value=window.SavedPeriodValues[b.id];delete (window.SavedPeriodValues[b.id])},OnChangeP:function(d){var m=d.parentNode.parentNode;var l,f,k,b;l=f=k=b=false;var c=BX.findChild(m,{className:"adm-input-wrap adm-calendar-inp adm-calendar-first"});var i=BX.findChild(m,{className:"adm-input-wrap adm-calendar-second"});var j=BX.findChild(m,{className:"adm-select-wrap adm-calendar-direction"});var g=BX.findChild(m,{className:"adm-calendar-separate"});var e=BX.findChild(m,{className:"adm-input adm-calendar-from"},true);var h=BX.findChild(m,{className:"adm-input adm-calendar-to"},true);switch(d.value){case"day":case"week":case"month":case"quarter":case"year":k=true;BX.CalendarPeriod.OnChangeD(j.children[0]);break;case"before":f=true;break;case"after":l=true;break;case"exact":l=true;break;case"interval":l=f=b=true;BX.CalendarPeriod.RestoreInput(e);BX.CalendarPeriod.RestoreInput(h);break;case"":BX.CalendarPeriod.SaveAndClearInput(e);BX.CalendarPeriod.SaveAndClearInput(h);break;default:break}BX.CalendarPeriod.ChangeDirectOpts(d.value,m);c.style.display=(l?"inline-block":"none");i.style.display=(f?"inline-block":"none");j.style.display=(k?"inline-block":"none");g.style.display=(b?"inline-block":"none")},OnChangeD:function(d){var p=d.parentNode.parentNode;var e=BX.findChild(p,{className:"adm-input adm-calendar-from"},true);var g=BX.findChild(p,{className:"adm-input adm-calendar-to"},true);var o=BX.findChild(p,{className:"adm-select adm-calendar-period"},true);var f=0;switch(d.value){case"previous":f=-1;break;case"next":f=1;break;case"current":default:break}var m=false;var n=false;var j=new Date();var i=j.getFullYear();var h=j.getMonth();var k=j.getDate();var c=j.getDay();if(c==0){c=7}switch(o.value){case"day":m=new Date(i,h,k+f,0,0,0);n=new Date(i,h,k+f,23,59,59);break;case"week":m=new Date(i,h,k-c+1+f*7,0,0,0);n=new Date(i,h,k+(7-c)+f*7,23,59,59);break;case"month":m=new Date(i,h+f,1,0,0,0);n=new Date(i,h+1+f,0,23,59,59);break;case"quarter":var b=Math.floor((h/3))+f;m=new Date(i,3*(b),1,0,0,0);n=new Date(i,3*(b+1),0,23,59,59);break;case"year":m=new Date(i+f,0,1,0,0,0);n=new Date(i+1+f,0,0,23,59,59);break;default:break}var l=window[e.name+"_bTime"]?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE");if(m){e.value=BX.formatDate(m,l);BX.addClass(e,"adm-calendar-inp-setted")}if(n){g.value=BX.formatDate(n,l);BX.addClass(g,"adm-calendar-inp-setted")}}};BX.JCCalendar=function(){this.params={};this.bAmPm=BX.isAmPmMode();this.popup=null;this.popup_month=null;this.popup_year=null;this.value=null;this.control_id=Math.random();this._layers={};this._current_layer=null;this.DIV=null;this.PARTS={};this.weekStart=0;this.numRows=6;this._create=function(b){this.popup=new BX.PopupWindow("calendar_popup_"+this.control_id,b.node,{closeByEsc:true,autoHide:false,content:this._get_content(),zIndex:3000,bindOptions:{forceBindPosition:true}});BX.bind(this.popup.popupContainer,"click",this.popup.cancelBubble)};this._auto_hide_disable=function(){BX.unbind(document,"click",BX.proxy(this._auto_hide,this))};this._auto_hide_enable=function(){BX.bind(document,"click",BX.proxy(this._auto_hide,this))};this._auto_hide=function(b){this._auto_hide_disable();this.popup.close()};this._get_content=function(){var b=BX.delegate(function(f){f=f||window.event;this.SetDate(new Date(parseInt(BX.proxy_context.getAttribute("data-date"))),f.type=="dblclick")},this);this.DIV=BX.create("DIV",{props:{className:"bx-calendar"},children:[BX.create("DIV",{props:{className:"bx-calendar-header"},children:[BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-left-arrow"},events:{click:BX.proxy(this._prev,this)}}),BX.create("SPAN",{props:{className:"bx-calendar-header-content"},children:[(this.PARTS.MONTH=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-month"},events:{click:BX.proxy(this._menu_month,this)}})),(this.PARTS.YEAR=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-year"},events:{click:BX.proxy(this._menu_year,this)}}))]}),BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-right-arrow"},events:{click:BX.proxy(this._next,this)}})]}),(this.PARTS.WEEK=BX.create("DIV",{props:{className:"bx-calendar-name-day-wrap"}})),(this.PARTS.LAYERS=BX.create("DIV",{props:{className:"bx-calendar-cell-block"},events:{click:BX.delegateEvent({className:"bx-calendar-cell"},b),dblclick:BX.delegateEvent({className:"bx-calendar-cell"},b)}})),(this.PARTS.TIME=BX.create("DIV",{props:{className:"bx-calendar-set-time-wrap"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._time_actions,this))},html:'<a href="javascript:void(0)" data-action="time_show" class="bx-calendar-set-time"><i></i>'+BX.message("CAL_TIME_SET")+'</a><div class="bx-calendar-form-block"><span class="bx-calendar-form-text">'+BX.message("CAL_TIME")+'</span><span class="bx-calendar-form"><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" /><span class="bx-calendar-form-separator"></span><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" />'+(this.bAmPm?'<span class="bx-calendar-AM-PM-block"><span class="bx-calendar-AM-PM-text" data-action="time_ampm"></span><span class="bx-calendar-form-arrow-r"><a href="javascript:void(0)" class="bx-calendar-form-arrow-top" data-action="time_ampm_up"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow-bottom" data-action="time_ampm_down"><i></i></a></span></span>':"")+'</span><a href="javascript:void(0)" data-action="time_hide" class="bx-calendar-form-close"><i></i></a></div>'})),BX.create("DIV",{props:{className:"bx-calendar-button-block"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._button_actions,this))},html:'<a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-select" data-action="submit"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("CAL_BUTTON")+'</span><span class="bx-calendar-button-right"></span></a><a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-cancel" data-action="cancel"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("JS_CORE_WINDOW_CLOSE")+'</span><span class="bx-calendar-button-right"></span></a>'})]});this.PARTS.TIME_INPUT_H=BX.findChild(this.PARTS.TIME,{tag:"INPUT"},true);this.PARTS.TIME_INPUT_M=this.PARTS.TIME_INPUT_H.nextSibling.nextSibling;if(this.bAmPm){this.PARTS.TIME_AMPM=this.PARTS.TIME_INPUT_M.nextSibling.firstChild}var d=(new BX.JCSpinner({input:this.PARTS.TIME_INPUT_H,callback_change:BX.proxy(this._check_time,this),bSaveValue:false})).Show();d.className="bx-calendar-form-arrow-l";this.PARTS.TIME_INPUT_H.parentNode.insertBefore(d,this.PARTS.TIME_INPUT_H);d=(new BX.JCSpinner({input:this.PARTS.TIME_INPUT_M,callback_change:BX.proxy(this._check_time,this),bSaveValue:true})).Show();d.className="bx-calendar-form-arrow-r";if(!this.PARTS.TIME_INPUT_M.nextSibling){this.PARTS.TIME_INPUT_M.parentNode.appendChild(d)}else{this.PARTS.TIME_INPUT_M.parentNode.insertBefore(d,this.PARTS.TIME_INPUT_M.nextSibling)}for(var c=0;c<7;c++){this.PARTS.WEEK.appendChild(BX.create("SPAN",{props:{className:"bx-calendar-name-day"},text:BX.message("DOW_"+((c+this.weekStart)%7))}))}return this.DIV};this._time_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"time_show":BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened");this.popup.adjustPosition();break;case"time_hide":BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened");this.popup.adjustPosition();break;case"time_ampm":this.PARTS.TIME_AMPM.innerHTML=this.PARTS.TIME_AMPM.innerHTML=="AM"?"PM":"AM";break;case"time_ampm_up":this._check_time({bSaveValue:false},null,12);return;break;case"time_ampm_down":this._check_time({bSaveValue:false},null,-12);return;break}this._check_time()};this._button_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"submit":this.SaveValue();break;case"cancel":this.Close();break}};this._check_time=function(g,e,f){var d=parseInt(this.PARTS.TIME_INPUT_H.value.substring(0,5),10)||0,b=parseInt(this.PARTS.TIME_INPUT_M.value.substring(0,5),10)||0,c=false;if(!!g&&!g.bSaveValue){this.value.setHours(this.value.getHours()+f)}else{if(!isNaN(d)){if(this.bAmPm){if(d!=12&&this.PARTS.TIME_AMPM.innerHTML=="PM"){d+=12}}c=true;this.value.setHours(d%24)}}if(!isNaN(b)){c=true;this.value.setMinutes(b%60)}if(c){this.SetValue(this.value)}};this._set_layer=function(){var b=parseInt(this.value.getFullYear()+""+BX.util.str_pad_left(this.value.getMonth()+"",2,"0"));if(!this._layers[b]){this._layers[b]=this._create_layer();this._layers[b].BXLAYERID=b}if(this._current_layer){var c=new Date(this.value.valueOf());c.setHours(0);c.setMinutes(0);var e=BX.findChild(this._layers[b],{tag:"A",className:"bx-calendar-active"},true),d=BX.findChild(this._layers[b],{tag:"A",attr:{"data-date":c.valueOf()+""}},true);if(e){BX.removeClass(e,"bx-calendar-active")}if(d){BX.addClass(d,"bx-calendar-active")}this._replace_layer(this._current_layer,this._layers[b])}else{this.PARTS.LAYERS.appendChild(this._layers[b])}this._current_layer=this._layers[b]};this._replace_layer=function(i,b){if(i!=b){if(!BX.browser.IsIE()||BX.browser.IsDoctype()){var d=i.BXLAYERID>b.BXLAYERID?1:-1;var c=0;var h=-d*i.offsetHeight;i.style.position="relative";i.style.top="0px";i.style.zIndex=5;b.style.position="absolute";b.style.top=h+"px";b.style.zIndex=6;this.PARTS.LAYERS.appendChild(b);var g=15;var e;(e=function(){h+=d*g;c+=d*g;if(d*h<0){i.style.top=c+"px";b.style.top=h+"px";setTimeout(e,10)}else{i.parentNode.removeChild(i);b.style.top="0px";b.style.position="static";b.style.zIndex=0}})()}else{this.PARTS.LAYERS.replaceChild(b,i)}}};this._create_layer=function(){var c=BX.create("DIV",{props:{className:"bx-calendar-layer"}});var g=new Date(this.value);g.setHours(0);g.setMinutes(0);g.setDate(1);if(g.getDay()!=this.weekStart){var m=g.getDay()-this.weekStart;m+=m<0?7:0;g.setDate(g.getDate()-m)}var h=this.value.getMonth(),n=this.value.getDate(),o="";for(var f=0;f<this.numRows;f++){o+='<div class="bx-calendar-range'+(f==this.numRows-1?" bx-calendar-range-noline":"")+'">';for(var e=0;e<7;e++){m=g.getDate();var b=g.getDay();var k="bx-calendar-cell";if(h!=g.getMonth()){k+=" bx-calendar-date-hidden"}else{if(n==m){k+=" bx-calendar-active"}}if(b==0||b==6){k+=" bx-calendar-weekend"}o+='<a href="javascript:void(0)" class="'+k+'" data-date="'+g.valueOf()+'">'+m+"</a>";g.setDate(g.getDate()+1)}o+="</div>"}c.innerHTML=o;return c};this._prev=function(){this.SetMonth(this.value.getMonth()-1)};this._next=function(){this.SetMonth(this.value.getMonth()+1)};this._menu_month_content=function(){var b="",d=this.value.getMonth(),c;for(c=0;c<12;c++){b+='<a href="javascript:void(0)" class="bx-calendar-month'+(c==d?" bx-calendar-month-active":"")+'" onclick="BX.calendar.get().SetMonth('+c+')">'+BX.message("MONTH_"+(c+1))+"</a>"}return'<div class="bx-calendar-month-popup"><div class="bx-calendar-month-title" onclick="BX.calendar.get().popup_month.close();">'+BX.message("MONTH_"+(this.value.getMonth()+1))+'</div><div class="bx-calendar-month-content">'+b+"</div></div>"};this._menu_month=function(){if(!this.popup_month){this.popup_month=BX.PopupWindowManager.create("calendar_popup_month_"+this.control_id,this.PARTS.MONTH,{content:this._menu_month_content(),zIndex:3001,closeByEsc:true,autoHide:true,offsetTop:-29,offsetLeft:-1});this.popup_month.BXMONTH=this.value.getMonth()}else{if(this.popup_month.BXMONTH!=this.value.getMonth()){this.popup_month.setContent(this._menu_month_content());this.popup_month.BXMONTH=this.value.getMonth()}}this.popup_month.show()};this._menu_year_content=function(){var c='<div class="bx-calendar-year-popup"><div class="bx-calendar-year-title" onclick="BX.calendar.get().popup_year.close();">'+this.value.getFullYear()+'</div><div class="bx-calendar-year-content" id="bx-calendar-year-content">';for(var b=-3;b<=3;b++){c+='<a href="javascript:void(0)" class="bx-calendar-year-number'+(b==0?" bx-calendar-year-active":"")+'" onclick="BX.calendar.get().SetYear('+(this.value.getFullYear()-b)+')">'+(this.value.getFullYear()-b)+"</a>"}c+='</div><input type="text" class="bx-calendar-year-input" onkeyup="if(this.value>=1900&&this.value<=2100)BX.calendar.get().SetYear(this.value);" maxlength="4" /></div>';return c};this._menu_year=function(){if(!this.popup_year){this.popup_year=BX.PopupWindowManager.create("calendar_popup_year_"+this.control_id,this.PARTS.YEAR,{content:this._menu_year_content(),zIndex:3001,closeByEsc:true,autoHide:true,offsetTop:-29,offsetLeft:-1});this.popup_year.BXYEAR=this.value.getFullYear()}else{if(this.popup_year.BXYEAR!=this.value.getFullYear()){this.popup_year.setContent(this._menu_year_content());this.popup_year.BXYEAR=this.value.getFullYear()}}this.popup_year.show()};this._check_date=function(b){if(BX.type.isString(b)){b=BX.parseDate(b)}if(!BX.type.isDate(b)||isNaN(b.valueOf())){b=new Date();if(this.params.bHideTime){b.setHours(0);b.setMinutes(0)}}b.setMilliseconds(0);b.setSeconds(0);b.BXCHECKED=true;return b}};BX.JCCalendar.prototype.Show=function(d){if(!BX.isReady){BX.ready(BX.delegate(function(){this.Show(d)},this));return}d.node=d.node||document.body;if(BX.type.isNotEmptyString(d.node)){var e=BX(d.node);if(!e){e=document.getElementsByName(d.node);if(e&&e.length>0){e=e[0]}}d.node=e}if(!d.node){return}if(!!d.field){if(BX.type.isString(d.field)){e=BX(d.field);if(!!e){d.field=e}else{if(d.form){if(BX.type.isString(d.form)){d.form=document.forms[d.form]}}if(BX.type.isDomNode(d.form)&&!!d.form[d.field]){d.field=d.form[d.field]}else{e=document.getElementsByName(d.field);if(e&&e.length>0){e=e[0];d.field=e}}}if(BX.type.isString(d.field)){d.field=BX(d.field)}}}var c=!this.popup||!this.popup.isShown()||this.params.node!=d.node;this.params=d;this.params.bTime=typeof this.params.bTime=="undefined"?true:!!this.params.bTime;this.params.bHideTime=typeof this.params.bHideTime=="undefined"?true:!!this.params.bHideTime;this.weekStart=parseInt(this.params.weekStart||this.params.weekStart||BX.message("WEEK_START"));if(isNaN(this.weekStart)){this.weekStart=1}if(!this.popup){this._create(this.params)}else{this.popup.setBindElement(this.params.node)}var b=!!this.params.bHideTime;if(this.params.value){this.SetValue(this.params.value);b=this.value.getHours()<=0&&this.value.getMinutes()<=0}else{if(this.params.field){this.SetValue(this.params.field.value);b=this.value.getHours()<=0&&this.value.getMinutes()<=0}else{if(!!this.params.currentTime){this.SetValue(this.params.currentTime)}else{this.SetValue(new Date())}}}if(!!this.params.bTime){BX.removeClass(this.DIV,"bx-calendar-time-disabled")}else{BX.addClass(this.DIV,"bx-calendar-time-disabled")}if(!!b){BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}else{BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}if(c){this._auto_hide_disable();this.popup.show();setTimeout(BX.proxy(this._auto_hide_enable,this),0)}this.params.bSetFocus=typeof this.params.bSetFocus=="undefined"?true:!!this.params.bSetFocus;if(this.params.bSetFocus){d.node.blur()}return this};BX.JCCalendar.prototype.SetDay=function(b){this.value.setDate(b);return this.SetValue(this.value)};BX.JCCalendar.prototype.SetMonth=function(b){if(this.popup_month){this.popup_month.close()}this.value.setMonth(b);if(b<0){b+=12}else{if(b>=12){b-=12}}while(this.value.getMonth()>b){this.value.setDate(this.value.getDate()-1)}return this.SetValue(this.value)};BX.JCCalendar.prototype.SetYear=function(b){if(this.popup_year){this.popup_year.close()}this.value.setFullYear(b);return this.SetValue(this.value)};BX.JCCalendar.prototype.SetDate=function(b,c){b=this._check_date(b);b.setHours(this.value.getHours());b.setMinutes(this.value.getMinutes());b.setSeconds(this.value.getSeconds());if(this.params.bTime&&!c){return this.SetValue(b)}else{this.SetValue(b);this.SaveValue()}};BX.JCCalendar.prototype.SetValue=function(b){this.value=(b&&b.BXCHECKED)?b:this._check_date(b);this.PARTS.MONTH.innerHTML=BX.message("MONTH_"+(this.value.getMonth()+1));this.PARTS.YEAR.innerHTML=this.value.getFullYear();if(!!this.params.bTime){var c=this.value.getHours();if(this.bAmPm){if(c>=12){this.PARTS.TIME_AMPM.innerHTML="PM";if(c!=12){c-=12}}else{this.PARTS.TIME_AMPM.innerHTML="AM";if(c==0){c=12}}}this.PARTS.TIME_INPUT_H.value=BX.util.str_pad_left(c.toString(),2,"0");this.PARTS.TIME_INPUT_M.value=BX.util.str_pad_left(this.value.getMinutes().toString(),2,"0")}this._set_layer();return this};BX.JCCalendar.prototype.SaveValue=function(){if(this.popup_month){this.popup_month.close()}if(this.popup_year){this.popup_year.close()}var d=true;if(!!this.params.callback){var b=this.params.callback.apply(this,[this.value]);if(b===false){d=false}}if(d){var c=!!this.params.bTime&&BX.hasClass(this.PARTS.TIME,"bx-calendar-set-time-opened");if(this.params.field){this.params.field.value=BX.calendar.ValueToString(this.value,c);BX.fireEvent(this.params.field,"change")}this.popup.close();if(!!this.params.callback_after){this.params.callback_after.apply(this,[this.value,c])}}return this};BX.JCCalendar.prototype.Close=function(){if(!!this.popup){this.popup.close()}return this};BX.JCSpinner=function(b){b=b||{};this.params={input:b.input||null,delta:b.delta||1,timeout_start:b.timeout_start||1000,timeout_cont:b.timeout_cont||150,callback_start:b.callback_start||null,callback_change:b.callback_change||null,callback_finish:b.callback_finish||null,bSaveValue:typeof b.bSaveValue=="undefined"?!!b.input:!!b.bSaveValue};this.mousedown=false;this.direction=1};BX.JCSpinner.prototype.Show=function(){this.node=BX.create("span",{events:{mousedown:BX.delegateEvent({attr:"data-dir"},BX.delegate(this.Start,this))},html:'<a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-top" data-dir="1"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-bottom" data-dir="-1"><i></i></a>'});return this.node};BX.JCSpinner.prototype.Start=function(){this.mousedown=true;this.direction=BX.proxy_context.getAttribute("data-dir")>0?1:-1;BX.bind(document,"mouseup",BX.proxy(this.MouseUp,this));this.ChangeValue(true)};BX.JCSpinner.prototype.ChangeValue=function(c){if(!this.mousedown){return}if(this.params.input){var b=parseInt(this.params.input.value,10)+this.params.delta*this.direction;if(this.params.bSaveValue){this.params.input.value=b}if(!!c&&this.params.callback_start){this.params.callback_start(this.params,b,this.direction)}if(this.params.callback_change){this.params.callback_change(this.params,b,this.direction)}setTimeout(BX.proxy(this.ChangeValue,this),!!c?this.params.timeout_start:this.params.timeout_cont)}};BX.JCSpinner.prototype.MouseUp=function(){this.mousedown=false;BX.unbind(document,"mouseup",BX.proxy(this.MouseUp,this));if(this.params.callback_finish){this.params.callback_finish(this.params,this.params.input.value)}};window.jsCalendar={Show:function(h,g,f,c,i,d,e,b){return BX.calendar({node:h,field:g,form:e,bTime:!!i,currentTime:d,bHideTimebar:!!b})},ValueToString:BX.calendar.ValueToString};BX.CClockSelector=function(b){this.params=b;this.params.popup_buttons=this.params.popup_buttons||[new BX.PopupWindowButton({text:BX.message("CAL_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(this.setValue,this)}})];this.isReady=false;this.WND=new BX.PopupWindow(this.params.popup_id||"clock_selector_popup",this.params.node,this.params.popup_config||{titleBar:{content:BX.create("SPAN",{text:BX.message("CAL_TIME")})},offsetLeft:-45,offsetTop:-135,autoHide:true,closeIcon:true,closeByEsc:true,zIndex:this.params.zIndex});this.SHOW=false;BX.addCustomEvent(this.WND,"onPopupClose",BX.delegate(this.onPopupClose,this));this.obClocks={};this.CLOCK_ID=this.params.clock_id||"clock_selector"};BX.CClockSelector.prototype.Show=function(){if(!this.isReady){BX.addCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this));return BX.ajax.get("/bitrix/tools/clock_selector.php",{start_time:this.params.start_time,clock_id:this.CLOCK_ID,sessid:BX.bitrix_sessid()},BX.delegate(this.Ready,this))}this.WND.setButtons(this.params.popup_buttons);this.WND.show();this.SHOW=true;if(window["bxClock_"+this.obClocks[this.CLOCK_ID]]){setTimeout("window['bxClock_"+this.obClocks[this.CLOCK_ID]+"'].CalculateCoordinates()",40)}return true};BX.CClockSelector.prototype.onClockRegister=function(b){if(b[this.CLOCK_ID]){this.obClocks[this.CLOCK_ID]=b[this.CLOCK_ID];BX.removeCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this))}};BX.CClockSelector.prototype.Ready=function(b){this.content=this.CreateContent(b);this.WND.setContent(this.content);this.isReady=true;setTimeout(BX.proxy(this.Show,this),30)};BX.CClockSelector.prototype.CreateContent=function(b){return BX.create("DIV",{events:{click:BX.PreventDefault},html:'<div class="bx-tm-popup-clock">'+b+"</div>"})};BX.CClockSelector.prototype.setValue=function(c){if(this.params.callback){var b=BX.findChild(this.content,{tagName:"INPUT"},true);this.params.callback.apply(this.params.node,[b.value])}return BX.PreventDefault(c)};BX.CClockSelector.prototype.closeWnd=function(b){this.WND.close();return(b||window.event)?BX.PreventDefault(b):true};BX.CClockSelector.prototype.setNode=function(b){this.WND.setBindElement(b)};BX.CClockSelector.prototype.setTime=function(b){this.params.start_time=b;if(window["bxClock_"+this.obClocks[this.CLOCK_ID]]){window["bxClock_"+this.obClocks[this.CLOCK_ID]].SetTime(parseInt(b/3600),parseInt((b%3600)/60))}};BX.CClockSelector.prototype.setCallback=function(b){this.params.callback=b};BX.CClockSelector.prototype.onPopupClose=function(){this.SHOW=false}})();