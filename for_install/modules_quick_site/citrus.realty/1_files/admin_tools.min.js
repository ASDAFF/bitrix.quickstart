var phpVars;if(!phpVars){phpVars={ADMIN_THEME_ID:".default",LANGUAGE_ID:"en",FORMAT_DATE:"DD.MM.YYYY",FORMAT_DATETIME:"DD.MM.YYYY HH:MI:SS",opt_context_ctrl:false,cookiePrefix:"BITRIX_SM",titlePrefix:"",bitrix_sessid:"",messHideMenu:"",messShowMenu:"",messHideButtons:"",messShowButtons:"",messFilterInactive:"",messFilterActive:"",messFilterLess:"",messLoading:"Loading...",messMenuLoading:"",messMenuLoadingTitle:"",messNoData:"",messExpandTabs:"",messCollapseTabs:"",messPanelFixOn:"",messPanelFixOff:"",messPanelCollapse:"",messPanelExpand:"",messFavAddSucc:"",messFavAddErr:"",messFavDelSucc:"",messFavDelErr:""}}function JCSplitter(a){this.params=a;this.Highlight=function(b){var c=document.getElementById(this.params.control);var d=document.getElementById(this.params.divShown);if(d.style.display!="none"){c.className=this.params.classShown+(b?"sel":"")}else{c.className=this.params.classHidden+(b?"sel":"")}};this.Toggle=function(){var b=jsUtils.ToggleDiv(this.params.divShown);jsUtils.ToggleDiv(this.params.divHidden);this.Highlight(false);document.getElementById(this.params.control).title=(b?this.params.messHide:this.params.messShow);return b}}function JCAdminMenu(b){var d=this;this.sMenuSelected="";this.x=0;this.divToResize=null;this.divToBound=null;this.toggle=false;this.oSections={};this.request=new JCHttpRequest();var c=b.split(",");for(var a in c){this.oSections[c[a]]=true}this.verSplitter=new JCSplitter({control:"vdividercell",divShown:"menudiv",divHidden:"hiddenmenucontainer",messHide:phpVars.messHideMenu,messShow:phpVars.messShowMenu,classShown:"vdividerknob vdividerknobleft",classHidden:"vdividerknob vdividerknobright"});this.horSplitter=new JCSplitter({control:"hdividercell",divShown:"buttonscontainer",divHidden:"smbuttonscontainer",messHide:phpVars.messHideButtons,messShow:phpVars.messShowButtons,classShown:"hdividerknob hdividerknobup",classHidden:"hdividerknob hdividerknobdown"});this.verSplitterToggle=function(){var e=this.verSplitter.Toggle();jsUserOptions.SaveOption("admin_menu","pos","ver",(e?"on":"off"))};this.horSplitterToggle=function(){var e=this.horSplitter.Toggle();jsUserOptions.SaveOption("admin_menu","pos","hor",(e?"on":"off"))};this.ToggleMenu=function(f,e){var g=document.getElementById(f);if(g.style.display!="none"){return}if(this.sMenuSelected!=""){document.getElementById(this.sMenuSelected).style.display="none"}g.style.display="block";document.getElementById("menutitle").innerHTML=e;document.getElementById("btn_"+this.sMenuSelected).className="button";document.getElementById("smbtn_"+this.sMenuSelected).className="smbutton";document.getElementById("btn_"+f).className="button buttonsel";document.getElementById("smbtn_"+f).className="smbutton smbuttonsel";this.sMenuSelected=f};this.StartDrag=function(){if(this.toggle){return}if(document.getElementById("menudiv").style.display=="none"){return}this.divToBound=document.getElementById("menu_min_width");this.divToResize=document.getElementById("menucontainer");this.x=this.divToResize.offsetWidth;jsUtils.addEvent(document,"mousemove",d.ResizeMenu);document.onmouseup=this.StopDrag;var e=document.body;e.ondrag=jsUtils.False;e.onselectstart=jsUtils.False;e.style.MozUserSelect="none";e.style.cursor="e-resize"};this.StopDrag=function(g){jsUtils.removeEvent(document,"mousemove",d.ResizeMenu);document.onmouseup=null;var f=document.body;f.ondrag=null;f.onselectstart=null;f.style.MozUserSelect="";f.style.cursor="";if(window.onresize){window.onresize()}jsUserOptions.SaveOption("admin_menu","pos","width",parseInt(d.divToResize.style.width))};this.ResizeMenu=function(h){var f=h.clientX+document.body.scrollLeft;if(d.x==f){return}var i=d.divToResize;var g=d.divToBound;if(f<g.offsetWidth){i.style.width=g.offsetWidth+"px";d.x=f;return}i.style.width=i.offsetWidth+(f-d.x)+"px";d.x=f};this.ToggleSection=function(e,h,j){if(jsUtils.ToggleDiv(h)){if(j<=2){this.oSections[h]=true}e.className="sign signminus"}else{this.oSections[h]=false;e.className="sign signplus"}if(j<=2){var f="";for(var g in this.oSections){if(this.oSections[g]==true){f+=(f!=""?",":"")+g}}jsUserOptions.SaveOption("admin_menu","pos","sections",f)}};this.ToggleDynSection=function(e,f,g,j){function h(m){var l="";for(var k=0;k<j;k++){l+='<td><div class="menuindent"></div></td>\n'}return('<div class="menuline"><table cellspacing="0">	<tr>'+l+'		<td class="menutext menutext-loading">'+m+"</td>	</tr></table></div>")}var i=document.getElementById(g);if(i.innerHTML==""){i.innerHTML=h(phpVars.messMenuLoading);this.request.Action=function(k){k=jsUtils.trim(k);i.innerHTML=(k!=""?k:h(phpVars.messNoData))};this.request.Send("/bitrix/admin/get_menu.php?lang="+phpVars.LANGUAGE_ID+"&admin_mnu_module_id="+f+"&admin_mnu_menu_id="+encodeURIComponent(g))}this.ToggleSection(e,g,j)}}function JCAdminList(b){var a=this;this.table_id=b;this.InitTable=function(){var e=document.getElementById(this.table_id);if(!e||e.rows.length<1||e.rows[0].cells.length<1){return}var f;var k=e.rows[0].cells.length;var l=-1;for(f=0;f<k;f++){var d;var h=e.rows[1].cells[f];var m=jsUtils.FindChildObject(h,"table","sorting");for(d=0;d<2;d++){var p=e.rows[d].cells[f];p.onmouseover=function(){a.HighlightGutter(this,true)};p.onmouseout=function(){a.HighlightGutter(this,false)};if(m){p.onclick=m.onclick;p.title=m.title;p.style.cursor="pointer";if(d==0){var o=m.rows[0].cells[1].className.toLowerCase();if(o=="sign up"||o=="sign down"){p.className+=" sorted";l=f}}}}if(m){m.onclick=null}}var c=e.rows.length;for(f=0;f<c;f++){var q=e.rows[f];q.cells[0].className+=" left";q.cells[q.cells.length-1].className+=" right";if(q.className&&q.className=="footer"){continue}if(l!=-1&&l<q.cells.length){q.cells[l].className+=" sorted"}if(f>=2){var g=q.cells[0].childNodes[0];if(g&&g.tagName&&g.tagName.toUpperCase()=="INPUT"&&g.type.toUpperCase()=="CHECKBOX"){g.onclick=function(){a.SelectRow(this);a.EnableActions()};jsUtils.addEvent(q,"click",a.OnClickRow)}q.onmouseover=function(){a.HighlightRow(this,true)};q.onmouseout=function(){a.HighlightRow(this,false)};if(f%2==0){q.className+=" odd"}else{q.className+=" even"}if(q.oncontextmenu){jsUtils.addEvent(q,"contextmenu",function(n){if(!n){n=window.event}if(!phpVars.opt_context_ctrl&&n.ctrlKey||phpVars.opt_context_ctrl&&!n.ctrlKey){return}var j;if(n.target){j=n.target}else{if(n.srcElement){j=n.srcElement}}while(j&&!j.oncontextmenu){j=jsUtils.FindParentObject(j,"tr")}var i=n.clientX+document.body.scrollLeft;var t=n.clientY+document.body.scrollTop;var s={};s.left=s.right=i;s.top=s.bottom=t;var r=window[a.table_id+"_menu"];r.PopupHide();r.SetItems(j.oncontextmenu());r.BuildItems();r.PopupShow(s);n.returnValue=false;if(n.preventDefault){n.preventDefault()}})}}}if(e.rows.length>2){e.rows[2].className+=" top";e.rows[e.rows.length-1].className+=" bottom"}};this.Destroy=function(k){var e=document.getElementById(this.table_id);if(!e||e.rows.length<1||e.rows[0].cells.length<1){return}var f;var h=e.rows[0].cells.length;for(f=0;f<h;f++){var d;for(d=0;d<2;d++){var l=e.rows[d].cells[f];l.onmouseover=null;l.onmouseout=null;l.onclick=null}}var c=e.rows.length;for(f=0;f<c;f++){var m=e.rows[f];var g=m.cells[0].childNodes[0];if(g&&g.onclick){g.onclick=null}m.onmouseover=null;m.onmouseout=null;jsUtils.removeAllEvents(m)}if(k==true){a=null}};this.HighlightGutter=function(c,d){var e=c.parentNode.parentNode.parentNode;var f=e.rows[0].cells[c.cellIndex];if(d){f.className+=" over"}else{f.className=f.className.replace(/\s*over/i,"")}};this.HighlightRow=function(d,c){if(c){d.className+=" over"}else{d.className=d.className.replace(/\s*over/i,"")}};this.SelectRow=function(f){var h=f.parentNode.parentNode;var g=h.parentNode.parentNode;var e=document.getElementById(g.id+"_selected_span");var d=parseInt(e.innerHTML);if(f.checked){h.className+=" selected";d++}else{h.className=h.className.replace(/\s*selected/ig,"");d--}e.innerHTML=d;var c=document.getElementById(g.id+"_check_all");if(d==g.rows.length-2){c.checked=true}else{c.checked=false}};this.OnClickRow=function(f){if(!f){var f=window.event}if(!f.ctrlKey){return}var d=(f.target?f.target:(f.srcElement?f.srcElement:null));if(!d){return}if(!d.parentNode.cells){return}var c=d.parentNode.cells[0].childNodes[0];if(c&&c.tagName&&c.tagName.toUpperCase()=="INPUT"&&c.type.toUpperCase()=="CHECKBOX"&&!c.disabled){c.checked=!c.checked;a.SelectRow(c)}a.EnableActions()};this.SelectAllRows=function(e){var f=e.parentNode.parentNode.parentNode.parentNode;var h=e.checked;var c;var g=f.rows.length;for(c=2;c<g;c++){var d=f.rows[c].cells[0].childNodes[0];if(d&&d.tagName&&d.tagName.toUpperCase()=="INPUT"&&d.type.toUpperCase()=="CHECKBOX"){if(d.checked!=h&&!d.disabled){d.checked=h;this.SelectRow(d)}}}this.EnableActions()};this.EnableActions=function(){var e=document.forms["form_"+this.table_id];if(!e){return}var f=this.IsActionEnabled();var d=this.IsActionEnabled("edit");if(e.apply){e.apply.disabled=!f}var c=document.getElementById("action_edit_button");if(c){c.className="context-button icon action-edit-button"+(d?"":"-dis")}c=document.getElementById("action_delete_button");if(c){c.className="context-button icon action-delete-button"+(f?"":"-dis")}};this.IsActionEnabled=function(e){var d=document.forms["form_"+this.table_id];if(!d){return}var f=false;var c=document.getElementById(this.table_id+"_selected_span");if(c&&parseInt(c.innerHTML)>0){f=true}if(e=="edit"){return !(d.action_target&&d.action_target.checked)&&f}else{return(d.action_target&&d.action_target.checked)||f}};this.SetActiveResult=function(d,c){CHttpRequest.Action=function(e){CloseWaitWindow();a.Destroy(false);document.getElementById(a.table_id+"_result_div").innerHTML=e;a.InitTable();jsAdminChain.AddItems(a.table_id+"_navchain_div");if(d){d(c)}}};this.GetAdminList=function(c,f){ShowWaitWindow();var d=new RegExp("&mode=list&table_id="+escape(a.table_id),"g");c=c.replace(d,"");var e=document.getElementById("navchain-link");if(e){e.href=c}if(c.indexOf("?")>=0){c+="&mode=list&table_id="+escape(a.table_id)}else{c+="?&mode=list&table_id="+escape(a.table_id)}a.SetActiveResult(f,c);CHttpRequest.Send(c)};this.Sort=function(f,g,d){if(g==true){var h=null,c=false;if(d.length>0){h=d[0]}if(!h){h=window.event}if(h){c=h.ctrlKey}f+=(c?"desc":"asc")}this.GetAdminList(f)};this.PostAdminList=function(c){if(c.indexOf("?")>=0){c+="&mode=frame&table_id="+escape(this.table_id)}else{c+="?mode=frame&table_id="+escape(this.table_id)}var d=document.getElementById("form_"+this.table_id);try{d.action.act.parentNode.removeChild(d.action)}catch(f){}d.action=c;d.onsubmit();d.submit()};this.ShowSettings=function(c){if(document.getElementById("settings_float_div")){return}CHttpRequest.Action=function(d){CloseWaitWindow();if(d==""){return}var g=document.body.appendChild(document.createElement("DIV"));g.id="settings_float_div";g.className="settings-float-form";g.style.position="absolute";g.style.zIndex=1000;g.innerHTML=d;var f=parseInt(document.body.scrollLeft+document.body.clientWidth/2-g.offsetWidth/2);var e=parseInt(document.body.scrollTop+document.body.clientHeight/2-g.offsetHeight/2);jsFloatDiv.Show(g,f,e);jsUtils.addEvent(document,"keypress",a.SettingsOnKeyPress)};ShowWaitWindow();CHttpRequest.Send(c)};this.CloseSettings=function(){jsUtils.removeEvent(document,"keypress",a.SettingsOnKeyPress);var c=document.getElementById("settings_float_div");jsFloatDiv.Close(c);c.parentNode.removeChild(c)};this.SettingsOnKeyPress=function(c){if(!c){c=window.event}if(!c){return}if(c.keyCode==27){a.CloseSettings()}};this.SaveSettings=function(){ShowWaitWindow();var d="",k="",h="",e="";var g=document.list_settings.selected_columns;var f=g.length;for(var j=0;j<f;j++){d+=(d!=""?",":"")+g[j].value}g=document.list_settings.order_field;if(g){k=g[g.selectedIndex].value}g=document.list_settings.order_direction;if(g){h=g[g.selectedIndex].value}g=document.list_settings.nav_page_size;e=g[g.selectedIndex].value;var l=(document.list_settings.set_default&&document.list_settings.set_default.checked);jsUserOptions.SaveOption("list",this.table_id,"columns",d,l);jsUserOptions.SaveOption("list",this.table_id,"by",k,l);jsUserOptions.SaveOption("list",this.table_id,"order",h,l);jsUserOptions.SaveOption("list",this.table_id,"page_size",e,l);var c=window.location.href;jsUserOptions.SendData(function(){a.GetAdminList(c,a.CloseSettings)})};this.DeleteSettings=function(d){ShowWaitWindow();var c=window.location.href;jsUserOptions.DeleteOption("list",this.table_id,d,function(){a.GetAdminList(c,a.CloseSettings)})}}function TabControl(name,unique_name,aTabs){var _this=this;this.name=name;this.unique_name=unique_name;this.aTabs=aTabs;this.aTabsDisabled={};this.bExpandTabs=false;this.AUTOSAVE=null;var auto_lnk=BX(this.name+"_autosave_link");if(auto_lnk){auto_lnk.title=BX.message("AUTOSAVE_T");BX.addCustomEvent("onAutoSavePrepare",function(ob,h){BX.bind(auto_lnk,"click",BX.proxy(ob.Save,ob))});BX.addCustomEvent("onAutoSave",function(){auto_lnk.className="context-button bx-core-autosave bx-core-autosave-saving"});BX.addCustomEvent("onAutoSaveFinished",function(ob,t){t=parseInt(t);if(!isNaN(t)){setTimeout(function(){auto_lnk.className="context-button bx-core-autosave bx-core-autosave-ready"},1000);auto_lnk.title=BX.message("AUTOSAVE_L").replace("#DATE#",BX.formatDate(new Date(t*1000)))}});BX.addCustomEvent("onAutoSaveInit",function(){auto_lnk.className="context-button bx-core-autosave bx-core-autosave-edited"})}this.NextTab=function(){var SelectedTab=BX.findChild(document,{className:"tab-selected"},true);if(SelectedTab){var CurrentTab=SelectedTab.id.substr(4)}else{var SelectedTab=BX.findChild(document,{className:"tab-container-selected"},true);var CurrentTab=SelectedTab.id.substr(9)}var NextTab="";for(var i=0;i<this.aTabs.length;i++){if(CurrentTab==this.aTabs[i]["DIV"]){if(i>=(this.aTabs.length-1)){NextTab=this.aTabs[0]}else{NextTab=this.aTabs[i+1]}}}if(NextTab.DIV){this.SelectTab(NextTab.DIV)}};this.SelectTab=function(tab_id){var div=document.getElementById(tab_id);if(div.style.display!="none"){return}for(var i=0,cnt=this.aTabs.length;i<cnt;i++){var tab=document.getElementById(this.aTabs[i]["DIV"]);if(tab.style.display!="none"){this.ShowTab(this.aTabs[i]["DIV"],false);tab.style.display="none";break}}this.ShowTab(tab_id,true);div.style.display="block";document.getElementById(this.name+"_active_tab").value=tab_id;for(var i=0,cnt=this.aTabs.length;i<cnt;i++){if(this.aTabs[i]["DIV"]==tab_id){this.aTabs[i]["_ACTIVE"]=true;if(this.aTabs[i]["ONSELECT"]){eval(this.aTabs[i]["ONSELECT"])}break}}};this.ShowTab=function(tab_id,on){var sel=(on?"-selected":"");try{document.getElementById("tab_cont_"+tab_id).className="tab-container"+sel;document.getElementById("tab_left_"+tab_id).className="tab-left"+sel;document.getElementById("tab_"+tab_id).className="tab"+sel;if(tab_id!=this.aTabs[this.aTabs.length-1]["DIV"]){document.getElementById("tab_right_"+tab_id).className="tab-right"+sel}else{document.getElementById("tab_right_"+tab_id).className="tab-right-last"+sel}}catch(e){}};this.HoverTab=function(tab_id,on){var tab=document.getElementById("tab_"+tab_id);if(tab.className=="tab-selected"){return}document.getElementById("tab_left_"+tab_id).className=(on?"tab-left-hover":"tab-left");tab.className=(on?"tab-hover":"tab");var tab_right=document.getElementById("tab_right_"+tab_id);if(tab_id!=this.aTabs[this.aTabs.length-1]["DIV"]){tab_right.className=(on?"tab-right-hover":"tab-right")}else{tab_right.className=(on?"tab-right-last-hover":"tab-right-last")}};this.InitEditTables=function(){for(var tab=0,cnt=this.aTabs.length;tab<cnt;tab++){var div=document.getElementById(this.aTabs[tab]["DIV"]);var tbl=jsUtils.FindChildObject(div.firstChild,"table","edit-table");if(!tbl){var tbl=jsUtils.FindChildObject(div,"table","edit-table");if(!tbl){continue}}var n=tbl.rows.length;for(var i=0;i<n;i++){if(tbl.rows[i].cells.length>1){tbl.rows[i].cells[0].className="field-name"}}}};this.DisableTab=function(tab_id){this.aTabsDisabled[tab_id]=true;this.ShowDisabledTab(tab_id,true);if(this.bExpandTabs){var div=document.getElementById(tab_id);div.style.display="none"}};this.EnableTab=function(tab_id){this.aTabsDisabled[tab_id]=false;this.ShowDisabledTab(tab_id,this.bExpandTabs);if(this.bExpandTabs){var div=document.getElementById(tab_id);div.style.display="block"}};this.ShowDisabledTab=function(tab_id,disabled){var tab=document.getElementById("tab_cont_"+tab_id);if(disabled){tab.className="tab-container-disabled";tab.onclick=null;tab.onmouseover=null;tab.onmouseout=null}else{tab.className="tab-container";tab.onclick=function(){_this.SelectTab(tab_id)};tab.onmouseover=function(){_this.HoverTab(tab_id,true)};tab.onmouseout=function(){_this.HoverTab(tab_id,false)}}};this.Destroy=function(){for(var i=0,cnt=this.aTabs.length;i<cnt;i++){var tab=document.getElementById("tab_cont_"+this.aTabs[i]["DIV"]);if(!tab){continue}tab.onclick=null;tab.onmouseover=null;tab.onmouseout=null}_this=null};this.ToggleTabs=function(){this.bExpandTabs=!this.bExpandTabs;var a=document.getElementById(this.name+"_expand_link");a.title=(this.bExpandTabs?phpVars.messCollapseTabs:phpVars.messExpandTabs);a.className=(this.bExpandTabs?a.className.replace(/\s*down/ig," up"):a.className.replace(/\s*up/ig," down"));for(var i in this.aTabs){var tab_id=this.aTabs[i]["DIV"];this.ShowTab(tab_id,false);this.ShowDisabledTab(tab_id,(this.bExpandTabs||this.aTabsDisabled[tab_id]));var div=document.getElementById(tab_id);div.style.display=(this.bExpandTabs&&!this.aTabsDisabled[tab_id]?"block":"none");if(i>0){var tbl=jsUtils.FindChildObject(div.firstChild,"table","edit-tab-title");if(this.bExpandTabs){try{tbl.rows[0].style.display="table-row"}catch(e){tbl.rows[0].style.display="block"}}else{tbl.rows[0].style.display="none"}}}if(!this.bExpandTabs){this.ShowTab(this.aTabs[0]["DIV"],true);var div=document.getElementById(this.aTabs[0]["DIV"]);div.style.display="block"}jsUserOptions.SaveOption("edit",this.unique_name,"expand",(this.bExpandTabs?"on":"off"));jsUtils.onCustomEvent("OnToggleTabs")};this.ShowWarnings=function(form_name,warnings){var form=document.forms[form_name];if(!form){return}for(var i in warnings){var e=form.elements[warnings[i]["name"]];if(!e){continue}var type=(e.type?e.type.toLowerCase():"");var bBefore=false;if(e.length>1&&type!="select-one"&&type!="select-multiple"){e=e[0];bBefore=true}if(type=="textarea"||type=="select-multiple"){bBefore=true}var td=e.parentNode;var img;if(bBefore){img=td.insertBefore(new Image(),e);td.insertBefore(document.createElement("BR"),e)}else{img=td.insertBefore(new Image(),e.nextSibling);img.hspace=2;img.vspace=2;img.style.verticalAlign="bottom"}img.src="/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/images/icon_warn.gif";img.title=warnings[i]["title"]}};this.ShowSettings=function(url){if(document.getElementById("settings_float_div")){return}CHttpRequest.Action=function(result){CloseWaitWindow();if(result==""){return}var div=document.body.appendChild(document.createElement("DIV"));div.id="settings_float_div";div.className="settings-float-form";div.style.position="absolute";div.style.zIndex=1000;div.innerHTML=result;var left=parseInt(document.body.scrollLeft+document.body.clientWidth/2-div.offsetWidth/2);var top=parseInt(document.body.scrollTop+document.body.clientHeight/2-div.offsetHeight/2);jsFloatDiv.Show(div,left,top);jsUtils.addEvent(document,"keypress",_this.SettingsOnKeyPress)};ShowWaitWindow();CHttpRequest.Send(url)};this.CloseSettings=function(){jsUtils.removeEvent(document,"keypress",_this.SettingsOnKeyPress);var div=document.getElementById("settings_float_div");jsFloatDiv.Close(div);div.parentNode.removeChild(div)};this.SettingsOnKeyPress=function(e){if(!e){e=window.event}if(!e){return}if(e.keyCode==27){_this.CloseSettings()}};this.SaveSettings=function(){ShowWaitWindow();var sTabs="",s="";var oFieldsSelect;var oSelect=document.getElementById("selected_tabs");if(oSelect){var k=oSelect.length;for(var i=0;i<k;i++){s=oSelect[i].value+"--#--"+oSelect[i].text;oFieldsSelect=document.getElementById("selected_fields["+oSelect[i].value+"]");if(oFieldsSelect){var n=oFieldsSelect.length;for(var j=0;j<n;j++){s+="--,--"+oFieldsSelect[j].value+"--#--"+jsUtils.trim(oFieldsSelect[j].text)}}sTabs+=s+"--;--"}}var bCommon=(document.form_settings.set_default&&document.form_settings.set_default.checked);var request=new JCHttpRequest;request.Action=function(){BX.reload()};var sParam="";sParam+="&p[0][c]=form";sParam+="&p[0][n]="+encodeURIComponent(this.name);if(bCommon){sParam+="&p[0][d]=Y"}sParam+="&p[0][v][tabs]="+encodeURIComponent(sTabs);var options_url="/bitrix/admin/user_options.php?lang="+phpVars.LANGUAGE_ID+"&sessid="+phpVars.bitrix_sessid;options_url+="&action=delete&c=form&n="+this.name+"_disabled";request.Post(options_url,sParam)};this.DeleteSettings=function(bCommon){ShowWaitWindow();jsUserOptions.DeleteOption("form",this.name,bCommon,function(){BX.reload()})};this.DisableSettings=function(){var request=new JCHttpRequest;request.Action=function(){BX.reload()};var sParam="";sParam+="&p[0][c]=form";sParam+="&p[0][n]="+encodeURIComponent(this.name+"_disabled");sParam+="&p[0][v][disabled]=Y";request.Send("/bitrix/admin/user_options.php?lang="+phpVars.LANGUAGE_ID+sParam+"&sessid="+phpVars.bitrix_sessid)};this.EnableSettings=function(){var request=new JCHttpRequest;request.Action=function(){BX.reload()};var sParam="";sParam+="&c=form";sParam+="&n="+encodeURIComponent(this.name)+"_disabled";sParam+="&action=delete";request.Send("/bitrix/admin/user_options.php?lang="+phpVars.LANGUAGE_ID+sParam+"&sessid="+phpVars.bitrix_sessid)}}function ViewTabControl(aTabs){var _this=this;this.aTabs=aTabs;this.SelectTab=function(tab_id){var div=document.getElementById(tab_id);if(div.style.display!="none"){return}for(var i in this.aTabs){var tab_div=document.getElementById(this.aTabs[i]["DIV"]);if(tab_div.style.display!="none"){var tab=document.getElementById("view_tab_"+this.aTabs[i]["DIV"]);tab.innerHTML=this.aTabs[i]["HTML"];tab.className="view-tab";this.ToggleDelimiter(tab,true);tab_div.style.display="none";break}}var active_tab=document.getElementById("view_tab_"+tab_id);active_tab.className="view-tab view-tab-active";this.ToggleDelimiter(active_tab,false);div.style.display="block";this.RebuildTabs();for(var i in this.aTabs){if(this.aTabs[i]["DIV"]==tab_id){this.ReplaceAnchor(this.aTabs[i]);if(this.aTabs[i]["ONSELECT"]){eval(this.aTabs[i]["ONSELECT"])}break}}};this.ToggleDelimiter=function(tab,on){var d;if((d=jsUtils.FindNextSibling(tab,"div"))&&d.className.indexOf("view-tab-delimiter")!=-1){d.className="view-tab-delimiter"+(on?"":" view-tab-hide-delimiter")}if((d=jsUtils.FindPreviousSibling(tab,"div"))&&d.className.indexOf("view-tab-delimiter")!=-1){d.className="view-tab-delimiter"+(on?"":" view-tab-hide-delimiter")}};this.DisableTab=function(tab_id){};this.EnableTab=function(tab_id){};this.ReplaceAnchor=function(tab){var tab_div=document.getElementById("view_tab_"+tab.DIV);tab.HTML=tab_div.innerHTML;var a=jsUtils.FindChildObject(tab_div,"a");tab_div.innerHTML=a.innerHTML};this.RebuildTabs=function(){var container=jsUtils.FindParentObject(document.getElementById("view_tab_"+_this.aTabs[0]["DIV"]),"div");var aPos=[0];var selectedIndex=-1;var prevTop=-1;var last;var n=container.childNodes.length;for(var i=0;i<n;i++){var div=container.childNodes[i];if(!div.id){continue}if(prevTop>-1&&div.offsetTop>prevTop){aPos[aPos.length]=i}prevTop=div.offsetTop;if(selectedIndex==-1&&div.className.indexOf("view-tab-active")!=-1){selectedIndex=aPos.length-1}last=div}if(selectedIndex<aPos.length&&selectedIndex>-1){var aDiv=new Array();var div=container.childNodes[aPos[selectedIndex]];for(var i=aPos[selectedIndex];i<aPos[selectedIndex+1];i++){aDiv[aDiv.length]=div;div=div.nextSibling}if(aDiv.length>0){for(var i in aDiv){container.removeChild(aDiv[i])}while(last.nextSibling){last=last.nextSibling;if(last.tagName&&last.tagName.toUpperCase()=="BR"&&last.className&&last.className=="tab-break"){break}}var br=document.createElement("BR");br.style.clear="both";container.insertBefore(br,last);for(var i in aDiv){if(aDiv[i].tagName&&aDiv[i].tagName.toUpperCase()=="BR"){continue}container.insertBefore(aDiv[i],last)}}}};this.Init=function(){if(this.aTabs.length==0){return}for(var i in this.aTabs){var div=document.getElementById(this.aTabs[i]["DIV"]);if(div.style.display!="none"){this.ReplaceAnchor(this.aTabs[i]);this.ToggleDelimiter(document.getElementById("view_tab_"+this.aTabs[i]["DIV"]),false);break}}setTimeout(this.RebuildTabs,10);window.onresize=this.RebuildTabs};this.Init()}var jsAdminChain={_chain:"",AddItems:function(a){var b=document.getElementById("main_navchain");if(!b){return}if(this._chain==""){this._chain=b.innerHTML}else{b.innerHTML=this._chain}var c=document.getElementById(a);if(!c){return}b.innerHTML+='<span class="adm-navchain-delimiter"></span>';b.innerHTML+=c.innerHTML}};function JCHttpRequest(){this.Action=null;this._OnDataReady=function(a){if(this.Action){this.Action(a)}};this._CreateHttpObject=function(){var b=null;if(window.XMLHttpRequest){try{b=new XMLHttpRequest()}catch(a){}}else{if(window.ActiveXObject){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}if(!b){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}}}}return b};this._SetHandler=function(a){var b=this;a.onreadystatechange=function(){if(a.readyState==4){var f=a.responseText;var g=[];var h,c;while((h=f.indexOf("<script>"))!=-1){var c=f.indexOf("<\/script>",h);if(c==-1){break}g[g.length]=f.substr(h+8,c-h-8);f=f.substr(0,h)+f.substr(c+9)}b._OnDataReady(f);for(var e=0,d=g.length;e<d;e++){if(g[e]!=""){jsUtils.EvalGlobal(g[e])}}}}};this.Send=function(b){var a=this._CreateHttpObject();if(a){a.open("GET",b,true);this._SetHandler(a);return a.send("")}};this.Post=function(b,c){var a=this._CreateHttpObject();if(a){a.open("POST",b,true);this._SetHandler(a);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");return a.send(c)}}}var CHttpRequest=new JCHttpRequest();function JCUserOptions(){var a=this;this.options=null;this.bSend=false;this.request=new JCHttpRequest();this.GetParams=function(){if(BX&&BX.userOptions){a.GetParams=BX.userOptions.__get;return a.GetParams.apply(BX.userOptions,arguments)}var b="";var f=-1;var e="";for(var c in a.options){var d=a.options[c];if(e!=d[0]+"."+d[1]){f++;b+="&p["+f+"][c]="+encodeURIComponent(d[0]);b+="&p["+f+"][n]="+encodeURIComponent(d[1]);if(d[4]==true){b+="&p["+f+"][d]=Y"}e=d[0]+"."+d[1]}b+="&p["+f+"][v]["+encodeURIComponent(d[2])+"]="+encodeURIComponent(d[3])}return b.substr(1)};this.SaveOption=function(f,g,e,c,d){if(BX&&BX.userOptions){a.SaveOption=BX.userOptions.save;return a.SaveOption.apply(BX.userOptions,arguments)}if(!this.options){this.options=new Object()}if(d!=true){d=false}this.options[f+"."+g+"."+e]=[f,g,e,c,d];var b=this.GetParams();if(b!=""){document.cookie=phpVars.cookiePrefix+"_LAST_SETTINGS="+b+"&sessid="+phpVars.bitrix_sessid+"; expires=Thu, 31 Dec 2020 23:59:59 GMT; path=/;"}if(!this.bSend){this.bSend=true;setTimeout(function(){a.SendData(null)},5000)}};this.SendData=function(c){if(BX&&BX.userOptions){a.SendData=BX.userOptions.send;return a.SendData.apply(BX.userOptions,arguments)}var b=a.GetParams();a.options=null;a.bSend=false;if(b!=""){document.cookie=phpVars.cookiePrefix+"_LAST_SETTINGS=; path=/;";a.request.Action=c;a.request.Send("/bitrix/admin/user_options.php?"+b+"&sessid="+phpVars.bitrix_sessid)}};this.DeleteOption=function(c,d,b,e){if(BX&&BX.userOptions){a.DeleteOption=BX.userOptions.del;return a.DeleteOption.apply(BX.userOptions,arguments)}a.request.Action=e;a.request.Send("/bitrix/admin/user_options.php?action=delete&c="+c+"&n="+d+(b==true?"&common=Y":"")+"&sessid="+phpVars.bitrix_sessid)}}var jsUserOptions=new JCUserOptions();function JCPanel(){var a=this;this.FixPanel=function(){var c=document.getElementById("admin_panel_fix_link");var b=document.getElementById("bx_top_panel_container");var i=document.getElementById("bx_top_panel_back");var f=(b.style.position=="fixed"||b.style.position=="absolute");var d=jsUtils.IsIE();if(d){try{b.style.removeExpression("top")}catch(g){d=false}}if(f){c.title=phpVars.messPanelFixOn;c.className="fix-link fix-on";b.style.position="";i.style.display="none";if(d){b.style.removeExpression("top");b.style.removeExpression("left");b.style.removeExpression("width");b.style.width="100%";var h=document.getElementById("admin_panel_frame");if(h){h.style.visibility="hidden"}}}else{this.ShowOn();if(d){var h=document.getElementById("admin_panel_frame");if(h){h.style.visibility="visible"}else{this.CreateFrame(b)}}}jsUserOptions.SaveOption("admin_panel","settings","fix",(f?"off":"on"))};this.ShowOn=function(){var c=document.getElementById("admin_panel_fix_link");var b=document.getElementById("bx_top_panel_container");var g=document.getElementById("bx_top_panel_back");var d=jsUtils.IsIE();if(d){try{b.style.setExpression("top","0")}catch(f){d=false}}c.title=phpVars.messPanelFixOff;c.className="fix-link fix-off";b.style.position=(d?"absolute":"fixed");b.style.left="0px";b.style.top="0px";b.style.zIndex="1000";if(d){if(document.body.currentStyle.backgroundImage=="none"){document.body.style.backgroundImage="url(/bitrix/images/1.gif)";document.body.style.backgroundAttachment="fixed";document.body.style.backgroundRepeat="no-repeat"}b.style.setExpression("top","eval((document.documentElement && document.documentElement.scrollTop) ? document.documentElement.scrollTop : document.body.scrollTop)");b.style.setExpression("left","eval((document.documentElement && document.documentElement.scrollLeft) ? document.documentElement.scrollLeft : document.body.scrollLeft)");b.style.setExpression("width","eval((document.documentElement && document.documentElement.clientWidth) ? document.documentElement.clientWidth : document.body.clientWidth)")}g.style.height=b.offsetHeight+"px";g.style.display="block"};this.FixOn=function(){this.ShowOn();jsUtils.addEvent(window,"load",this.AdjustBackDiv)};this.AdjustBackDiv=function(){var b=document.getElementById("bx_top_panel_container");var f=document.getElementById("bx_top_panel_back");var c=jsUtils.IsIE();if(c){try{f.style.setExpression("height","0")}catch(d){c=false}}f.style.height=b.offsetHeight+"px";if(c){a.CreateFrame(b)}};this.CreateFrame=function(b){var c=document.createElement("IFRAME");c.src="javascript:void(0)";c.id="admin_panel_frame";c.style.position="absolute";c.style.overflow="hidden";c.style.zIndex=parseInt(b.currentStyle.zIndex)-1;c.style.height=b.offsetHeight+"px";document.body.appendChild(c);c.style.setExpression("top","eval(document.body.scrollTop)");c.style.setExpression("left","eval(document.body.scrollLeft)");c.style.setExpression("width","eval(document.body.clientWidth)");return c};this.IsFixed=function(){var b=document.getElementById("bx_top_panel_container");return(b&&(b.style.position=="fixed"||b.style.position=="absolute"))};this.DisplayPanel=function(c){var f=document.getElementById("bx_top_panel_splitter");if(f.style.display=="none"){f.style.display="block";c.className="splitterknob";c.title=phpVars.messPanelCollapse;jsUserOptions.SaveOption("admin_panel","settings","collapsed","off")}else{f.style.display="none";c.className="splitterknob splitterknobdown";c.title=phpVars.messPanelExpand;jsUserOptions.SaveOption("admin_panel","settings","collapsed","on")}var b=document.getElementById("bx_top_panel_container");var e=document.getElementById("bx_top_panel_back");e.style.height=b.offsetHeight+"px";var d=document.getElementById("admin_panel_frame");if(d){d.style.height=b.offsetHeight+"px"}}}var jsPanel=new JCPanel();function JCDebugWindow(){var a=this;this.div_id="BX_DEBUG_WINDOW";this.div_current=null;this.div_detail_current=null;this.Show=function(f){var g=document.getElementById(this.div_id);if(g){g.style.display="block";var b=document.getElementById(f);if(b){if(this.div_current){this.div_current.style.display="none"}b.style.display="block";this.div_current=b;this.ShowDetails(f+"_1")}var c=jsUtils.GetWindowSize();var e=parseInt(c.scrollLeft+c.innerWidth/2-g.offsetWidth/2);var d=parseInt(c.scrollTop+c.innerHeight/2-g.offsetHeight/2);jsFloatDiv.Show(g,e,d);jsUtils.addEvent(document,"keypress",this.OnKeyPress)}};this.Close=function(){jsUtils.removeEvent(document,"keypress",this.OnKeyPress);var b=document.getElementById(this.div_id);jsFloatDiv.Close(b);b.style.display="none"};this.OnKeyPress=function(b){if(!b){b=window.event}if(!b){return}if(b.keyCode==27){a.Close()}};this.ShowDetails=function(b){var c=document.getElementById(b);if(c){if(this.div_detail_current){this.div_detail_current.style.display="none"}c.style.display="block";this.div_detail_current=c}}}var jsDebugWindow=new JCDebugWindow();function ImgShw(c,d,b,h){var a="no";var g=0,f=0;if(d>screen.width-10||b>screen.height-28){a="yes"}if(b<screen.height-28){g=Math.floor((screen.height-b)/2-14)}if(d<screen.width-10){f=Math.floor((screen.width-d)/2-5)}d=Math.min(d,screen.width-10);b=Math.min(b,screen.height-28);var e=window.open("","","scrollbars="+a+",resizable=yes,width="+d+",height="+b+",left="+f+",top="+g);e.document.write('<html><head><script type="text/javascript">function KeyPress(){	if(window.event.keyCode == 27) 		window.close();}<\/script><title></title></head><body topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" onKeyPress="KeyPress()"><img src="'+c+'" border="0" alt="'+h+'" /></body></html>');e.document.close()}var WizardWindow={iframe:null,messLoading:phpVars.messLoading,currentDialog:null,currentFrame:null,isClosed:false,frameLoaded:false,Open:function(a,b){this.currentDialog=new BX.CWizardDialog({width:"700",height:"400",resizable:false});this.isClosed=false;this.frameLoaded=false;BX.addCustomEvent(this.currentDialog,"onBeforeWindowClose",BX.proxy(this.onBeforeWindowClose,this));var c=Math.random();this.currentDialog.SetContent('<iframe class="content" style="background-color: transparent; height:400px;" allowtransparency="true" scrolling="no" id="wizard_iframe_'+c+'" width="100%" src="/bitrix/admin/wizard_install.php?lang='+phpVars.LANGUAGE_ID+"&wizardName="+a+"&bxsender=admin_wizard_dialog&sessid="+b+'" frameborder="0"></iframe>');this.currentDialog.Show();setTimeout(BX.proxy(function(){if(!this.frameLoaded){this.ShowWaitWindow()}},this),400);this.currentFrame=BX("wizard_iframe_"+c);BX.bind(this.currentFrame,"load",BX.proxy(this.OnFrameLoad,this))},OnFrameLoad:function(){this.frameLoaded=true;this.HideWaitWindow();var a=this.currentFrame.contentWindow;var b=null;if(this.currentFrame.contentDocument){b=this.currentFrame.contentDocument}else{b=this.currentFrame.contentWindow.document}if(a.focus){a.focus()}else{b.body.focus()}},Close:function(){if(this.currentDialog){this.isClosed=true;this.currentDialog.Close(true)}},ShowWaitWindow:function(){if(this.currentDialog&&BX.type.isDomNode(this.currentDialog.PARTS.CONTENT)){var a=document.createElement("DIV");a.id="__bx_wait_window";a.className="";a.style.position="absolute";a.style.left="40%";a.style.top="40%";a.style.zIndex="3000";a.style.padding="15px 10px 15px 35px";a.style.width="auto";a.style.fontSize="12px";a.style.borderRadius="4px";a.style.boxShadow="0 0 10px 1px #dfdfdf";a.style.border="1px solid #DCE7ED";a.style.lineHeight="9px";a.style.background="#fff url(/bitrix/panel/main/images/waiter-white.gif) 3px center no-repeat";a.innerHTML=this.messLoading;this.currentDialog.PARTS.CONTENT.appendChild(a)}},HideWaitWindow:function(){var a=BX("__bx_wait_window");if(a&&a.parentNode){a.parentNode.removeChild(a)}},onBeforeWindowClose:function(a){if(this.isClosed===false){a.denyClose=!confirm(BX.message("ADMIN_WIZARD_EXIT_ALERT"))}}};function JCStartMenu(){var menuStart=null;var request=new JCHttpRequest();var _this=this;this.EvalMenu=function(result){if(jsUtils.trim(result).length==0){return}var menuItems;try{eval(result)}catch(e){}if(!menuItems){return false}var head=document.getElementsByTagName("HEAD");if(head&&head[0]){var style=document.createElement("STYLE");head[0].appendChild(style);if(jsUtils.IsIE()){document.styleSheets[document.styleSheets.length-1].cssText=menuItems.styles}else{style.appendChild(document.createTextNode(menuItems.styles))}}return menuItems};this.ShowStartMenu=function(button,back_url){var dPos={left:0,top:0,right:0,bottom:0};if(!menuStart||!menuStart.menuItems){request.Action=function(result){var menuItems=_this.EvalMenu(result);if(menuItems){menuStart.PopupHide();menuStart.ShowMenu(button,menuItems.items,jsPanel.IsFixed(),dPos)}};menuStart=new PopupMenu("panel_start_menu");menuStart.Create(1100);menuStart.ShowMenu(button,[{TEXT:phpVars.messMenuLoading,TITLE:phpVars.messMenuLoadingTitle,ICONCLASS:"loading",AUTOHIDE:false}],jsPanel.IsFixed(),dPos);request.Send("/bitrix/admin/get_start_menu.php?lang="+phpVars.LANGUAGE_ID+(back_url?"&back_url_pub="+encodeURIComponent(back_url):"")+"&sessid="+phpVars.bitrix_sessid)}else{menuStart.ShowMenu(button,null,jsPanel.IsFixed(),dPos)}};this.PreloadMenu=function(back_url){if(!menuStart){request.Action=function(result){var menuItems=_this.EvalMenu(result);if(menuItems){menuStart.SetItems(menuItems.items);menuStart.BuildItems()}};menuStart=new PopupMenu("panel_start_menu");menuStart.Create(1100);request.Send("/bitrix/admin/get_start_menu.php?lang="+phpVars.LANGUAGE_ID+(back_url?"&back_url_pub="+encodeURIComponent(back_url):"")+"&sessid="+phpVars.bitrix_sessid)}};this.OpenDynMenu=function(menu,module_id,items_id,back_url){request.Action=function(result){if(jsUtils.trim(result).length==0){return}var menuItems;eval(result);if(menu&&menuItems){var bVisible=menu.IsVisible();menu.PopupHide();menu.SetItems(menuItems.items);menu.BuildItems();menu.parentMenu.ShowSubmenu(menu.parentItem,false,!bVisible)}};request.Send("/bitrix/admin/get_start_menu.php?mode=dynamic&lang="+phpVars.LANGUAGE_ID+"&admin_mnu_module_id="+encodeURIComponent(module_id)+"&admin_mnu_menu_id="+encodeURIComponent(items_id)+(back_url?"&back_url_pub="+encodeURIComponent(back_url):"")+"&sessid="+phpVars.bitrix_sessid)};this.OpenURL=function(item,arguments,url,back_url){var itemInfo=menuStart.GetItemInfo(item);if(itemInfo){request.Action=function(result){};request.Send("/bitrix/admin/get_start_menu.php?mode=save_recent&url="+encodeURIComponent(url)+"&text="+encodeURIComponent(itemInfo.TEXT)+"&title="+encodeURIComponent(itemInfo.TITLE)+"&icon="+itemInfo.ICON+"&sessid="+phpVars.bitrix_sessid)}if(back_url){url+=(url.indexOf("?")>=0?"&":"?")+"back_url_pub="+encodeURIComponent(back_url)}jsUtils.Redirect(arguments,url)}}var jsStartMenu=new JCStartMenu();function OnAdd(o,y){var m="cedit";if(!!y&&typeof y==="object"){if(!!y.tabPrefix){m=y.tabPrefix}}var z=document.form_settings;if(o=="tabs_add"){var g=document.getElementById("selected_tabs");if(g){var B=prompt(arFormEditMess.admin_lib_sett_tab_prompt,arFormEditMess.admin_lib_sett_tab_default_name);if(B&&B.length>0){var q=g.length;var x=0;var l=true;while(l){x++;l=false;for(var v=0;v<q;v++){if(g[v].value==m+x){l=true}}}jsSelectUtils.addNewOption("selected_tabs",m+x,B,false);var e=document.getElementById("selected_fields");var t=document.createElement("SPAN");e.appendChild(t);t.innerHTML='<select style="display:none" class="select" name="selected_fields['+m+x+']" id="selected_fields['+m+x+']" size="12" multiple onchange="Sync();"></select>';jsSelectUtils.selectOption("selected_tabs",m+x)}}}if(o=="tabs_copy"){var w=document.getElementById("available_tabs");var A=document.getElementById("selected_tabs");if(w&&A){var q=w.length;var r=A.length;var x=0;for(var v=0;v<q;v++){if(w[v].selected){var l=false;for(var u=0;u<r;u++){if(A[u].value==w[v].value){l=true}}if(!l){var e=document.getElementById("selected_fields");var t=document.createElement("SPAN");var b="selected_fields["+w[v].value+"]";e.appendChild(t);t.innerHTML='<select style="display:none" class="select" name="'+b+'" id="'+b+'" size="12" multiple onchange="Sync();"></select>';jsSelectUtils.addNewOption("selected_tabs",w[v].value,w[v].text,false);jsSelectUtils.selectAllOptions("available_fields");jsSelectUtils.addSelectedOptions(document.getElementById("available_fields"),b);jsSelectUtils.selectOption("selected_tabs",w[v].value)}}}}}if(o=="fields_add"){var g=document.getElementById("selected_tabs");var s="";if(g){for(var v=0;v<g.length;v++){if(g[v].selected){s=g[v].value}}}g=GetFieldsActiveSelect();if(g){var B=prompt(arFormEditMess.admin_lib_sett_sec_prompt,arFormEditMess.admin_lib_sett_sec_default_name);if(B&&B.length>0){var q=g.length;var x=0;var l=true;while(l){x++;l=false;for(var v=0;v<q;v++){if(g[v].value==s+"_csection"+x){l=true}}}jsSelectUtils.addNewOption(g.id,s+"_csection"+x,"--"+B,false);jsSelectUtils.selectOption(g.id,s+"_csection"+x)}}}if(o=="fields_copy"){var w=document.getElementById("available_fields");var A=GetFieldsActiveSelect();if(w&&A&&!A.disabled){var v,h=A.length-1;for(v=0;v<A.length;v++){if(A[v].selected){h=v}}var f=new Array;for(v=A.length-1;v>h;v--){var d=new Option(A[v].text,A[v].value,false,false);d.innerHTML=A[v].innerHTML;f[f.length]=d;A.remove(v)}for(v=0;v<A.length;v++){if(A[v].selected){A[v].selected=false}}var p=0,a="";for(v=0;v<w.length;v++){if(w[v].selected){jsSelectUtils.addNewOption(A.id,w[v].value,w[v].text,false);A[A.length-1].selected=true;p++;if(v<(w.length-1)){a=w[v+1].value}else{a=""}}}var q=A.length;for(v=f.length-1;v>=0;v--){A[q]=f[v];q++}if((p==1)&&a){jsSelectUtils.selectOption(w.id,a)}}}Sync()}function OnDelete(e){if(e=="tabs_delete"){var c=document.getElementById("selected_tabs");for(var b=0;b<c.length;b++){if(c[b].selected){var a=document.getElementById("selected_fields["+c[b].value+"]");var d=a.parentNode;d.removeChild(a)}}jsSelectUtils.deleteSelectedOptions(c.id);jsSelectUtils.selectOption(c.id,"")}if(e=="fields_delete"){var a=GetFieldsActiveSelect();if(a){jsSelectUtils.deleteSelectedOptions(a.id);jsSelectUtils.selectOption(a.id,"")}}Sync()}function Sync(){var u,t,p,g;var m=document.getElementById("available_tabs");var l=document.getElementById("available_fields");var b=document.getElementById("selected_tabs");var s="";for(u=0;u<m.length;u++){if(m[u].selected){s=m[u].value}}var r=new Object;for(u=0;u<l.length;u++){if(l[u].selected){r[l[u].value]=l[u].value}}jsSelectUtils.selectAllOptions(l.id);jsSelectUtils.deleteSelectedOptions(l.id);if(s){var a=new Object;for(u=0;u<b.length;u++){var h=document.getElementById("selected_fields["+b[u].value+"]");for(t=0;t<h.length;t++){a[h[t].value]=h[t].value}}p=0;for(available_field in arSystemTabsFields[s]){if(!a[available_field]){var d=new Option(arSystemFields[available_field],available_field,false,false);l.options[p]=d;l.options[p].innerHTML=arSystemFields[available_field];p++}}for(u=0;u<l.length;u++){if(r[l[u].value]){l[u].selected=true}}}g=false;for(u=0;u<b.length;u++){var h=document.getElementById("selected_fields["+b[u].value+"]");if(b[u].selected){h.style.display="block";g=true}else{h.style.display="none"}}if(g){document.getElementById("selected_fields[undef]").style.display="none"}else{document.getElementById("selected_fields[undef]").style.display="block"}var c=0;for(u=0;u<b.length;u++){if(b[u].selected){c++}}var o=0;for(u=0;u<m.length;u++){if(m[u].selected){o++}}document.getElementById("tabs_delete").disabled=c<=0;if(o<=0){document.getElementById("tabs_copy").disabled=true}else{g=false;for(u=0;u<b.length;u++){if(b[u].value==s){g=true}}document.getElementById("tabs_copy").disabled=g}document.getElementById("tabs_up").disabled=c<=0;document.getElementById("tabs_down").disabled=c<=0;document.getElementById("tabs_rename").disabled=c!=1;document.getElementById("tabs_add").disabled=false;var k=0;for(u=0;u<b.length;u++){if(b[u].selected){var h=document.getElementById("selected_fields["+b[u].value+"]");for(t=0;t<h.length;t++){if(h[t].selected){k++}}}}var f=0;for(u=0;u<l.length;u++){if(l[u].selected){f++}}document.getElementById("fields_delete").disabled=k<=0;document.getElementById("fields_copy").disabled=f<=0||c<=0;document.getElementById("fields_up").disabled=k<=0;document.getElementById("fields_down").disabled=k<=0;document.getElementById("fields_rename").disabled=k!=1;document.getElementById("fields_add").disabled=c!=1;var q=new Object;for(var v in arSystemFields){q[v]=arSystemFields[v]}for(u=0;u<b.length;u++){h=document.getElementById("selected_fields["+b[u].value+"]");for(t=0;t<h.length;t++){delete q[h[t].value]}}var e=document.getElementById("save_settings");e.disabled=false;for(var v in q){if(q[v].substring(0,1)=="*"){e.disabled=true}}}function SyncAvailableFields(){var d=document.getElementById("available_tabs");if(d){var a=d.length;for(var b=0;b<a;b++){oFieldsSelect=document.getElementById("available_fields");if(oFieldsSelect){jsSelectUtils.selectAllOptions(oFieldsSelect.id);jsSelectUtils.deleteSelectedOptions(oFieldsSelect.id);if(d[b].selected){var f=0;for(var c in arSystemTabsFields[d[b].value]){var e=new Option(arSystemFields[c],c,false,false);oFieldsSelect.options[f]=e;oFieldsSelect.options[f].innerHTML=arSystemFields[c];f++}}}}}}function GetFieldsActiveSelect(){var d;var c=document.getElementById("selected_tabs");if(c){var a=c.length;for(var b=0;b<a;b++){d=document.getElementById("selected_fields["+c[b].value+"]");if(d&&d.style.display=="block"){return d}}}return false}function OnRename(b){var k=document.form_settings;if(b=="tabs_rename"){var e=document.getElementById("selected_tabs");if(e){var d=e.length;var j=0;var f="";for(var g=0;g<d;g++){if(e[g].selected){j++;if(!f){f=e[g].text}}}if(j==1){var a=prompt(arFormEditMess.admin_lib_sett_tab_rename,f);if(a&&a.length>0){for(var g=0;g<d;g++){if(e[g].selected){e[g].text=a;break}}}}}}if(b=="fields_rename"){var e=GetFieldsActiveSelect();if(e){var d=e.length;var j=0;var f="";for(var g=0;g<d;g++){if(e[g].selected){j++;if(!f){f=e[g].innerHTML}}}if(j==1){var h="";if(f.substring(0,2)=="--"){f=f.substring(2);h="--"}else{if(f.substring(0,1)=="*"){f=f.substring(1);h="*"}else{if(f.substring(0,12)=="&nbsp;&nbsp;"){f=f.substring(12);h="&nbsp;&nbsp;"}else{while(f.substring(0,2)=="\xA0\xA0"||f.substring(0,2)=="\xC2\xA0"){f=f.substring(2);h="&nbsp;&nbsp;"}}}}var a=prompt(arFormEditMess.admin_lib_sett_sec_rename,f);if(a&&a.length>0){for(var g=0;g<d;g++){if(e[g].selected){if(h=="&nbsp;&nbsp;"){e[g].text=a;e[g].innerHTML="&nbsp;&nbsp;"+e[g].innerHTML}else{e[g].text=h+a}break}}}}}}}function FieldsUpAndDown(b){var a=GetFieldsActiveSelect();if(a){if(b=="up"){jsSelectUtils.moveOptionsUp(a)}else{jsSelectUtils.moveOptionsDown(a)}}}function exportSettingsToPhp(o,l){if(o.ctrlKey||BX.browser.IsMac()&&o.altKey){var h=[];var m="";var c="CAdminFormSettings::setTabsArray('"+l+"', array(<br>";var d=document.getElementById("selected_tabs");if(d){var e=d.length;for(var g=0;g<e;g++){m="_"+d[g].value+"_TAB_TITLE";h[h.length]={id:m,val:d[g].text};c+="\t'"+d[g].value+"' => array(<br>";c+="\t\t'TAB' => GetMessage('"+m+"'),<br>";c+="\t\t'FIELDS' => array(<br>";oFieldsSelect=document.getElementById("selected_fields["+d[g].value+"]");if(oFieldsSelect){var b=oFieldsSelect.length;for(var f=0;f<b;f++){m="_"+oFieldsSelect[f].value;h[h.length]={id:m,val:jsUtils.trim(oFieldsSelect[f].text)};c+="\t\t\t'"+oFieldsSelect[f].value+"' => GetMessage('"+m+"'),<br>"}}c+="\t\t),<br>";c+="\t),<br>"}}c+="), true);<br>";for(var g=0;g<h.length;g++){c+='$MESS["'+h[g].id+'"]="'+h[g].val+'";<br>'}var a=new BX.CDialog({content:"<pre>"+c+"</pre>",buttons:[BX.CDialog.btnOK,BX.CDialog.btnCancel],width:640,height:480});a.Show()}};