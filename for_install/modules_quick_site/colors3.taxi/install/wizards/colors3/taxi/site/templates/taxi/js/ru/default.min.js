(function(){if(!window.google||!google.gears){var d=null;if("undefined"!==typeof GearsFactory){d=new GearsFactory}else{try{d=new ActiveXObject("Gears.Factory"),-1!=d.getBuildInfo().indexOf("ie_mobile")&&d.privateSetGlobalObject(this)}catch(c){"undefined"!=typeof navigator.mimeTypes&&navigator.mimeTypes["application/x-googlegears"]&&(d=document.createElement("object"),d.style.display="none",d.width=0,d.height=0,d.type="application/x-googlegears",document.documentElement.appendChild(d),d&&"undefined"==typeof d.create&&(d=null))}}d&&(window.google||(google={}),google.gears||(google.gears={factory:d}))}})();var bb_successCallback,bb_errorCallback,bb_blackberryTimeout_id=-1;function handleBlackBerryLocationTimeout(){-1!=bb_blackberryTimeout_id&&bb_errorCallback({message:"Timeout error",code:3})}function handleBlackBerryLocation(){clearTimeout(bb_blackberryTimeout_id);bb_blackberryTimeout_id=-1;if(bb_successCallback&&bb_errorCallback){if(0==blackberry.location.latitude&&0==blackberry.location.longitude){bb_errorCallback({message:"Position unavailable",code:2})}else{var b=null;blackberry.location.timestamp&&(b=new Date(blackberry.location.timestamp));bb_successCallback({timestamp:b,coords:{latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}})}bb_errorCallback=bb_successCallback=null}}var geo_position_js=function(){var d={},c=null;d.getCurrentPosition=function(b,h,g){c.getCurrentPosition(b,h,g)};d.init=function(){try{if("undefined"!=typeof geo_position_js_simulator){c=geo_position_js_simulator}else{if("undefined"!=typeof bondi&&"undefined"!=typeof bondi.geolocation){c=bondi.geolocation}else{if("undefined"!=typeof navigator.geolocation){c=navigator.geolocation,d.getCurrentPosition=function(b,e,g){c.getCurrentPosition(function(f){"undefined"!=typeof f.latitude?b({timestamp:f.timestamp,coords:{latitude:f.latitude,longitude:f.longitude}}):b(f)},e,g)}}else{if("undefined"!=typeof window.google&&"undefined"!=typeof google.gears){c=google.gears.factory.create("beta.geolocation")}else{if("undefined"!=typeof Mojo&&"Mojo.Service.Request"!=typeof Mojo.Service.Request){c=!0,d.getCurrentPosition=function(f,e,g){parameters={};g&&(g.enableHighAccuracy&&!0==g.enableHighAccuracy&&(parameters.accuracy=1),g.maximumAge&&(parameters.maximumAge=g.maximumAge),g.responseTime&&(5>g.responseTime?parameters.responseTime=1:20>g.responseTime?parameters.responseTime=2:parameters.timeout=3));r=new Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:parameters,onSuccess:function(h){f({timestamp:h.timestamp,coords:{latitude:h.latitude,longitude:h.longitude,heading:h.heading}})},onFailure:function(b){1==b.errorCode?e({code:3,message:"Timeout"}):2==b.errorCode?e({code:2,message:"Position Unavailable"}):e({code:0,message:"Unknown Error: webOS-code"+errorCode})}})}}else{if("undefined"!=typeof device&&"undefined"!=typeof device.getServiceObject){c=device.getServiceObject("Service.Location","ILocation"),d.getCurrentPosition=function(b,e,g){c.ILocation.GetLocation({LocationInformationClass:"BasicLocationInformation"},function(f,i,h){4==i?e({message:"Position unavailable",code:2}):b({timestamp:null,coords:{latitude:h.ReturnValue.Latitude,longitude:h.ReturnValue.Longitude,altitude:h.ReturnValue.Altitude,heading:h.ReturnValue.Heading}})})}}else{if("undefined"!=typeof window.blackberry&&blackberry.location.GPSSupported){if("undefined"==typeof blackberry.location.setAidMode){return !1}blackberry.location.setAidMode(2);d.getCurrentPosition=function(f,e,g){bb_successCallback=f;bb_errorCallback=e;bb_blackberryTimeout_id=g.timeout?setTimeout("handleBlackBerryLocationTimeout()",g.timeout):setTimeout("handleBlackBerryLocationTimeout()",60000);blackberry.location.onLocationUpdate("handleBlackBerryLocation()");blackberry.location.refreshLocation()};c=blackberry.location}}}}}}}}catch(a){return alert("error="+a),"undefined"!=typeof console&&console.log(a),!1}return null!=c};return d}(),Collection=function(){var b=this;this.collection=[];return{add:function(a){b.collection.push(a)},get:function(a){for(var f,c=b.collection.length-1;0<=c;c--){b.collection[c].name===a&&(f=b.collection[c])}return f},first:function(){return b.collection[0]}}};