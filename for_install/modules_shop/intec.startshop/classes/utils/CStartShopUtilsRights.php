<? $GLOBALS['_1992036195_']=Array('intva' .'l','s' .'trva' .'l','is_array','st' .'rval','strval','in_arr' .'ay','int' .'va' .'l','strval','is_a' .'rray','strval','intval','' .'strval','in_arra' .'y','is_array','is_numeric','' .'intval','st' .'rval'); ?><? function _1558550099($i){$a=Array('GROUP','ACTION','RIGHT','|','RIGHT');return $a[$i];} ?><? class CStartShopUtilsRights{private static $sCachePath='CStartShopUtilsRights';public static function SetRights($_0,$_1,$_2,$_3=false){$_0=$GLOBALS['_1992036195_'][0]($_0);$_1=$GLOBALS['_1992036195_'][1]($_1);if(empty($_0)|| empty($_1)||!$GLOBALS['_1992036195_'][2]($_2)|| empty($_2))return false;if(!$_3){static::UnsetRights($_0,$_1);foreach($_2 as $_4){$_4=$GLOBALS['_1992036195_'][3]($_4);if(!empty($_4))CStartShopDBQueryBX::Insert()->Into('startshop_rights')->Values(array('GROUP'=> $_0,'ACTION'=> $_1,'RIGHT'=> $_4))->Execute();}}else{$_5=static::GetRights($_0,$_1);foreach($_2 as $_4){$_4=$GLOBALS['_1992036195_'][4]($_4);if(!empty($_4))if(!$GLOBALS['_1992036195_'][5]($_4,$_5))CStartShopDBQueryBX::Insert()->Into('startshop_rights')->Values(array('GROUP'=> $_0,'ACTION'=> $_1,'RIGHT'=> $_4))->Execute();}}static::ClearCacheByAction($_0,$_1);return true;}public static function SetRight($_0,$_1,$_4){if(empty($_4))return false;return static::SetRights($_0,$_1,array($_4),true);}public static function UnsetRights($_0,$_1,$_2=null){$_0=$GLOBALS['_1992036195_'][6]($_0);$_1=$GLOBALS['_1992036195_'][7]($_1);if(empty($_0)&& empty($_1))return false;$_6=array(_1558550099(0)=> $_0,_1558550099(1)=> $_1);if($GLOBALS['_1992036195_'][8]($_2)&&!empty($_2))$_6[_1558550099(2)]=$_2;CStartShopDBQueryBX::Delete()->From('startshop_rights')->Where($_6)->Execute();static::ClearCacheByAction($_0,$_1);return true;}public static function UnsetRight($_0,$_1,$_4){$_4=$GLOBALS['_1992036195_'][9]($_4);if(empty($_4))return false;return static::UnsetRights($_0,$_1,array($_4));}public static function GetRights($_0,$_1){$_0=$GLOBALS['_1992036195_'][10]($_0);$_1=$GLOBALS['_1992036195_'][11]($_1);if(empty($_0)&& empty($_1))return array();$_7=$_0 ._1558550099(3) .$_1;if(CStartShopCache::IsExists(static::$sCachePath,$_7)){return CStartShopCache::Get(static::$sCachePath,$_7);}else{$_2=array();$_8=CStartShopDBQueryBX::Select()->From('startshop_rights')->Where(array('GROUP'=> $_0,'ACTION'=> $_1))->OrderBy(array('RIGHT'=> 'ASC'))->Execute();while($_9=$_8->Fetch())$_2[]=$_9[_1558550099(4)];CStartShopCache::Create(static::$sCachePath,$_7,$_2);return $_2;}}public static function AllowedForGroup($_0,$_1,$_4){return $GLOBALS['_1992036195_'][12]($_4,static::GetRights($_0,$_1));}public static function AllowedForGroups($_10,$_1,$_4){if(!$GLOBALS['_1992036195_'][13]($_10))return false;foreach($_10 as $_0)if($GLOBALS['_1992036195_'][14]($_0)&&!empty($_0))if(static::AllowedForGroup($_0,$_1,$_4))return true;return false;}public static function ClearCacheByAction($_0,$_1){$_0=$GLOBALS['_1992036195_'][15]($_0);$_1=$GLOBALS['_1992036195_'][16]($_1);if(empty($_0)&& empty($_1))return;CStartShopCache::Clear(static::$sCachePath,$_0 .'|' .$_1);}public static function ClearCache(){CStartShopCache::ClearPath(static::$sCachePath);}} ?>
