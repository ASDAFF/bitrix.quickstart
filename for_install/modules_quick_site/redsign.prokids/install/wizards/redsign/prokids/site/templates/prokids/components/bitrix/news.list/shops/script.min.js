$(document).ready(function(){var d=$("#lovekids_shops").find(".shop_item"),c=d.children("input");arMapCoord=[0,0];c.each(function(){var e=$(this).data("coords").split(",");arMapCoord[0]=arMapCoord[0]+parseFloat(e[0]);arMapCoord[1]=arMapCoord[1]+parseFloat(e[1])});arMapCoord[0]=arMapCoord[0]/c.length;arMapCoord[1]=arMapCoord[1]/c.length;var b={},a;ymaps.ready(function(){a=new ymaps.Map("rsYMapShops",{center:arMapCoord,zoom:16,type:"yandex#publicMap",behaviors:["default","scrollZoom"]});c.each(function(){var e=$(this).data("coords").split(","),f=$(this).attr("id");e[0]=parseFloat(e[0]);e[1]=parseFloat(e[1]);b[f]=new ymaps.Placemark(e,{balloonContentHeader:$(this).next().text(),balloonContentBody:$(this).siblings(".descr").html()});a.geoObjects.add(b[f])});a.setBounds(a.geoObjects.getBounds(),{checkZoomRange:true}).controls.add("mapTools").add("zoomControl").add("typeSelector")});c.on("change",function(){var e=c.filter(":checked");if(e.length==0){for(var f in b){b[f].options.set("visible",true)}}else{c.each(function(){if($(this).is(":checked")){b[$(this).attr("id")].options.set("visible",true)}else{b[$(this).attr("id")].options.set("visible",false)}})}});d.children("label").on("mouseenter",function(){b[$(this).attr("for")].options.set("preset","twirl#redDotIcon")}).on("mouseleave",function(){b[$(this).attr("for")].options.set("preset","twirl#blueIcon")})});