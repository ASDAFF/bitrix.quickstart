function JCSmartFilter(a){this.ajaxURL=a;this.form=null;this.timer=null}JCSmartFilter.prototype.keyup=function(a){if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.delegate(function(){this.reload(a)},this),1000)};JCSmartFilter.prototype.click=function(a){if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.delegate(function(){this.reload(a)},this),1000)};JCSmartFilter.prototype.reload=function(b){this.position=BX.pos(b,true);if(this.position.top<1){this.position.top=$("#"+b.id).offset().top-150}this.form=BX.findParent(b,{tag:"form"});if(this.form){var a=new Array;a[0]={name:"ajax",value:"y"};this.gatherInputsValues(a,BX.findChildren(this.form,{tag:"input"},true));BX.ajax.loadJSON(this.ajaxURL,this.values2post(a),BX.delegate(this.postHandler,this))}};JCSmartFilter.prototype.postHandler=function(j){if(!!j&&!!j.ITEMS){for(var a in j.ITEMS){var c=j.ITEMS[a];if(c.PROPERTY_TYPE=="N"||c.PRICE){}else{if(c.VALUES){for(var g in c.VALUES){var d=c.VALUES[g];var f=BX(d.CONTROL_ID);if(f){f.parentNode.className=d.DISABLED?"disabled NiceCheck":"NiceCheck"}}}}}var h=BX("modef");var e=BX("modef_num");if(h&&e){e.innerHTML=j.ELEMENT_COUNT;if(j.INSTANT_RELOAD&&j.COMPONENT_CONTAINER_ID){var b=BX.util.htmlspecialcharsback(j.FILTER_AJAX_URL);BX.ajax.insertToNode(b,j.COMPONENT_CONTAINER_ID)}else{if(h.style.display=="none"){h.style.display="block"}}}}};JCSmartFilter.prototype.gatherInputsValues=function(a,e){if(e){for(var c=0;c<e.length;c++){var d=e[c];if(d.disabled||!d.type){continue}switch(d.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":case"select-one":if(d.value.length){a[a.length]={name:d.name,value:d.value}}break;case"radio":case"checkbox":if(d.checked){a[a.length]={name:d.name,value:d.value}}break;case"select-multiple":for(var b=0;b<d.options.length;b++){if(d.options[b].selected){a[a.length]={name:d.name,value:d.options[b].value}}}break;default:break}}}};JCSmartFilter.prototype.values2post=function(b){var e=new Array;var h=e;var d=0;while(d<b.length){var g=b[d].name.indexOf("[");if(g==-1){h[b[d].name]=b[d].value;h=e;d++}else{var c=b[d].name.substring(0,g);var f=b[d].name.substring(g+1);if(!h[c]){h[c]=new Array}var a=f.indexOf("]");if(a==-1){h=e;d++}else{if(a==0){h=h[c];b[d].name=""+h.length}else{h=h[c];b[d].name=f.substring(0,a)+f.substring(a+1)}}}}return e};function cDoubleTrackBar(e,b,d,a,c){switch(typeof e){case"string":this.Track=document.getElementById(e);break;case"object":this.Track=e;break}switch(typeof b){case"string":this.Tracker=document.getElementById(b);break;case"object":this.Tracker=b;break}switch(typeof d){case"string":this.LeftDrag=document.getElementById(d);break;case"object":this.LeftDrag=d;break}switch(typeof a){case"string":this.RightDrag=document.getElementById(a);break;case"object":this.RightDrag=a;break}if(!e||!b){return false}this.OnUpdate=c.OnUpdate;this.OnComplete=c.OnComplete;this.FingerOffset=c.FingerOffset||0;this.Min=c.Min||0;this.Max=c.Max||100;this.MinSpace=c.MinSpace||0;this.RoundTo=c.RoundTo||1;if(this.RoundTo<1){this.Precision=parseInt(c.Precision,10)||0;if(isNaN(this.Precision)){this.Precision=0}}else{this.Precision=0}this.PrecisionFactor=Math.pow(10,this.Precision);this.Disabled=(typeof c.Disabled!="undefined")?c.Disabled:false;if(this.Min>=this.Max){this.Max=this.Min+1}this.MinPos=this.Min;this.MaxPos=this.Max;if(this.Max-this.Min<this.MinSpace){this.MinSpace=this.Max-this.Min}if(this.Max-this.Min<this.RoundTo){this.RoundTo=this.Max-this.Min}this.MinSpace=Math.ceil(this.MinSpace/this.RoundTo)*this.RoundTo;this.OnTrackMouseDown=this.bindAsEventListener(this.TrackMouseDown);this.OnDocumentMouseMove=this.bindAsEventListener(this.DocumentMouseMove);this.OnDocumentMouseUp=this.bindAsEventListener(this.DocumentMouseUp);if("ontouchstart" in document.documentElement){this.bindEvent(this.Track,"touchstart",this.OnTrackMouseDown)}else{this.bindEvent(this.Track,"mousedown",this.OnTrackMouseDown)}this.TrackerLeft=0;this.MinInputId=c.MinInputId||0;this.MaxInputId=c.MaxInputId||1000;BX.defer(BX.proxy(this.startPosition,this))()}cDoubleTrackBar.prototype={TrackMouseDown:function(b){this.TrackerLeft=this.Tracker.offsetLeft;this.TrackerRight=this.TrackerLeft+this.Tracker.offsetWidth;this.TrackerOffsets=this.getOffsets(this.Track);var a=("ontouchmove" in document.documentElement)?b.targetTouches[0].pageX:b.clientX;var d=a+document.documentElement.scrollLeft;d-=this.TrackerOffsets[0];var c=Math.abs(this.TrackerLeft-d)-Math.abs(this.TrackerRight-d);if(c==0&&this.TrackerLeft==0){this.Left=false}else{this.Left=(c<=0)}if(typeof this.Disabled=="function"){if(this.Disabled.call(this)){return true}}else{if(this.Disabled){return true}}this.UpdateTracker(d);if("ontouchmove" in document.documentElement){this.bindEvent(document,"touchmove",this.OnDocumentMouseMove);this.bindEvent(document,"touchend",this.OnDocumentMouseUp)}else{this.bindEvent(document,"mousemove",this.OnDocumentMouseMove);this.bindEvent(document,"mouseup",this.OnDocumentMouseUp)}return this.stopEvent(b)},DocumentMouseMove:function(b){var a=("ontouchmove" in document.documentElement)?b.targetTouches[0].pageX:b.clientX;this.UpdateTracker(a+document.documentElement.scrollLeft-this.TrackerOffsets[0]);return this.stopEvent(b)},DocumentMouseUp:function(a){if("ontouchmove" in document.documentElement){this.unbindEvent(document,"touchmove",this.OnDocumentMouseMove);this.unbindEvent(document,"touchend",this.OnDocumentMouseUp)}else{this.unbindEvent(document,"mousemove",this.OnDocumentMouseMove);this.unbindEvent(document,"mouseup",this.OnDocumentMouseUp)}if(typeof this.OnComplete=="function"){this.OnComplete.call(this)}return this.stopEvent(a)},UpdateTracker:function(e){var b=this.Track.clientWidth;var d=Math.floor(b*this.MinSpace/(this.Max-this.Min));var a=this.MinPos;var c=this.MaxPos;if(this.Left){e+=this.FingerOffset;this.TrackerLeft=Math.max(0,Math.min(this.TrackerRight-d-1,e));this.MinPos=Math.round((this.Min+this.TrackerLeft*(this.Max-this.Min)/b)/this.RoundTo)*this.RoundTo;if(this.MinSpace>=this.MaxPos-this.MinPos){this.MinPos=this.MaxPos-this.MinSpace}if(this.Precision>0){this.MinPos=Math.round(this.MinPos*this.PrecisionFactor)/this.PrecisionFactor}this.TrackerLeft=this.price2px(this.Track,this.MinPos-this.Min);this.LeftDrag.style.left=this.px2percent(this.Track,this.TrackerLeft)+"%";this.Tracker.style.width=this.px2percent(this.Track,this.TrackerRight-this.TrackerLeft)+"%";this.Tracker.style.left=this.px2percent(this.Track,this.TrackerLeft)+"%";this.MinInputId.value=this.MinPos;smartFilter.keyup(this.MinInputId)}else{e-=this.FingerOffset;this.TrackerRight=Math.max(this.TrackerLeft+d+1,Math.min(b+1,e));this.MaxPos=Math.round((this.Min+(this.TrackerRight-1)*(this.Max-this.Min)/b)/this.RoundTo)*this.RoundTo;if(this.MinSpace>=this.MaxPos-this.MinPos){this.MaxPos=this.MinPos+this.MinSpace}if(this.Precision>0){this.MaxPos=Math.round(this.MaxPos*this.PrecisionFactor)/this.PrecisionFactor}this.TrackerRight=this.price2px(this.Track,this.MaxPos-this.Min);this.Tracker.style.left=this.px2percent(this.Track,this.TrackerLeft)+"%";this.Tracker.style.width=this.px2percent(this.Track,this.TrackerRight-this.TrackerLeft)+"%";this.RightDrag.style.left=this.px2percent(this.Track,this.TrackerRight)+"%";this.MaxInputId.value=this.MaxPos;smartFilter.keyup(this.MaxInputId)}},getOffsets:function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent}while(b);return[c,a]},bindEvent:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else{a.attachEvent("on"+b,c)}},unbindEvent:function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else{if(a.detachEvent){a.detachEvent("on"+b,c)}}},bindAsEventListener:function(b){var a=this;return function(c){return b.call(a,c||window.event)}},stopEvent:function(a){if(a.preventDefault){a.preventDefault();a.stopPropagation()}else{a.returnValue=false;a.cancelBubble=true}return false},startPosition:function(){var a=this.MinInputId.value||0,b=this.MaxInputId.value||0,d=0,c=0;if(a||b){if(!a||a<this.Min||a>this.Max){a=this.Min}if(!b||b>this.Max||b<this.Min){b=this.Max}if(a){d=this.price2px(this.Track,a-this.Min)}if(b){c=this.price2px(this.Track,b-this.Min)}this.LeftDrag.style.left=this.px2percent(this.Track,d)+"%";this.Tracker.style.left=this.px2percent(this.Track,d)+"%";this.Tracker.style.width=this.px2percent(this.Track,c-d)+"%";if(Math.round(this.px2percent(this.Track,c))<100){this.RightDrag.style.left=this.px2percent(this.Track,c)+"%"}}},px2percent:function(b,a){return a/b.clientWidth*100},price2px:function(b,a){var c=(this.Max-this.Min)/b.clientWidth;return Math.round(a/c)}};$(document).ready(function(){$(".smart_filter_props").find(".bx_filter_block").css("width",parseInt($(".smart_filter_props").width())-parseInt($(".smart_filter_props").find(".bx_filter_block").css("left"))+"px");if($(".smart_filter_props0 .bx_filter_container_title").length>0){$(".smart_filter_props0 .bx_filter_container_title").eq(0).click()}});$(window).resize(function(){$(".smart_filter_props").find(".bx_filter_block").css("width",parseInt($(".smart_filter_props").width())-parseInt($(".smart_filter_props").find(".bx_filter_block").css("left"))+"px");var a=parseInt($(".smart_filter_props0").css("height"));if(a<parseInt($(".smart_filter_props .active").find(".bx_filter_block").css("height"))){a=parseInt($(".smart_filter_props .active").find(".bx_filter_block").css("height"))}$(".smart_filter_props").stop(true,true).animate({height:a+"px"},350)});$(document).on("click",".smart_filter_props .bx_filter_container_title",function(){var b=$(this).closest(".bx_filter_container");var a=parseInt($(".smart_filter_props0").css("height"));if(!b.hasClass("active")){$(".smart_filter_props").find(".bx_filter_container").removeClass("active");$(".smart_filter_props").find(".bx_filter_block").hide();b.find(".bx_filter_block").fadeIn("fast",function(){if(a<parseInt(b.find(".bx_filter_block").css("height"))){a=parseInt(b.find(".bx_filter_block").css("height"))}$(".smart_filter_props").stop(true,true).animate({height:a+"px"},350);b.addClass("active")})}return false});$(document).on("click",".control_button_hide a",function(){$(".smart_filter").slideUp("fast");$(".bx_catalog_section_box .control_button_show").removeClass("active");return false});$(document).on("click",".control_button_show a",function(){if($(".bx_catalog_section_box .control_button_show").hasClass("active")){$(".smart_filter").slideUp("fast");$(".bx_catalog_section_box .control_button_show").removeClass("active")}else{$(".bx_catalog_section_box .control_button_show").addClass("active");$(".smart_filter").slideDown("fast")}return false});