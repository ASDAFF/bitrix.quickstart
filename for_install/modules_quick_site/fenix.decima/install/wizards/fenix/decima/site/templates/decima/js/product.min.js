$(function(){function e(){$(".loader").remove()}function f(){e();$("body").append('<div class="loader"><div></div></div>')}function a(k,h){for(var j=0;j<h.length;j++){if(k==h[j]){return true}}return false}function d(p){var o=p.PROPS;var j;for(var n in o){j=n;var m=[];for(var h=0;h<o[n].length;h++){m.push(j+"_"+o[n][h])}var l=0;$("#"+j+" option").each(function(){l++;$("#"+j).parent().find(".chosen-results li").show();if(a($(this).attr("id"),m)===false){$(this).attr("disabled","disabled");$("#"+j).trigger("chosen:updated")}else{$(this).removeAttr("disabled");$("#"+j).trigger("chosen:updated")}})}(function(){if(jQuery().chosen){var k={".chosen-select":{},".chosen-select-deselect":{allow_single_deselect:true},".chosen-select-searchless":{disable_search_threshold:10,width:"100%"},".chosen-select-searchless-deselect":{disable_search_threshold:10,width:"100%",allow_single_deselect:true}};for(var i in k){jQuery(i).chosen(k[i])}}})()}if($("select.sku").length){var c=$("select.sku").first().val();var b=c.replace(/[']/g,'"');var g=jQuery.parseJSON(b);d(g)}$("select.sku").on("change",function(){var h="";var j=$(this).val();var i=j.replace(/[']/g,'"');var k=jQuery.parseJSON(i);$("select.sku").each(function(){var l=$(this).val();if(l){var n=l.replace(/[']/g,'"');var m=jQuery.parseJSON(n);h+="."+$(this).attr("id")+"-"+m.value}});d(k);$(".offer").addClass("hide");$(h).removeClass("hide");$("#offerID").val($(h+".thumbnailSlider").attr("item"));$(".flex-active-slide").resize()});$(document).on("click","#basket_form .ui-spinner-button",function(){$(this).parents("form").find('button[name="BasketRefresh"]').click()});$(document).on("click",".close-w",function(){$(".inner, .overlay").remove();return false});$(document).on("click",".item .buybtn",function(){var h=ajaxactions+this.search;var j=sitedir+"include/ajax/success.php"+this.search;var i="";if($(this).attr("props")){i="&prop="+$(this).attr("props")}f();$.get(h+i,function(k){$(".shopping-cart-widget").html(k);$.get(j,function(l){e();if($(".inner")){$(".inner, .overlay").remove()}$("body").append(l)});$.cartrefresh()});return false});$(document).on("click",".adddelay, .adddetail",function(l){l.preventDefault();$form=$(this).parents("form");var m=$form.attr("method");var k;var i="";if($(this).attr("props")){i="&prop="+$(this).attr("props")}if($(this).hasClass("adddelay")){k="ADD2DELAY"}else{k="ADD2BASKET"}var h=ajaxactions;var j=$form.serialize();if(k=="ADD2BASKET"){f()}$.ajax({type:m,url:h+"?action="+k+i,data:j,dataType:"html",success:function(n){if(k=="ADD2BASKET"){var o=sitedir+"include/ajax/success.php?id="+$("#offerID").val();$.get(o,function(p){e();$("body").append(p)})}$(".shopping-cart-widget").html(n);$.cartrefresh()}});return false});$(document).on("submit",".shop-summary-item form, .shop-form",function(j){j.preventDefault();$form=$(this);var k=$form.attr("method");var h=ajaxactions;var i=$form.serialize();$.ajax({type:k,url:h,data:i,dataType:"html",success:function(l){$(".shopping-cart-widget").html(l);$.cartrefresh()}})});$(document).on("submit",".review-form, .review-blog",function(j){j.preventDefault();$form=$(this);var k=$form.attr("method");var h;if($form.hasClass("review-blog")){h=sitedir+"include/ajax/reviews_blog.php"}else{h=sitedir+"include/ajax/reviews.php"}var i=$form.serialize();$.ajax({type:k,url:h,data:i,dataType:"html",success:function(l){$("#reviews").html(l);$.rating()}})});$(document).on("click",".props li",function(p){var r=$(this).attr("data-element");var j={};var s=$(this).attr("data-property");var q={};var n="action";q[s]=$(this).attr("data-value-id");j={basketItemId:r,sessid:BX.bitrix_sessid(),site_id:BX.message("SITE_ID"),props:q,action_var:n,select_props:BX("column_headers").value,offers_props:BX("offers_props").value,quantity_float:BX("quantity_float").value,count_discount_4_all_quantity:BX("count_discount_4_all_quantity").value,price_vat_show_value:BX("price_vat_show_value").value,hide_coupon:BX("hide_coupon").value,use_prepayment:BX("use_prepayment").value};j[n]="select_item";var h=BX.findChildren(BX(r),{tagName:"ul",className:"sku_prop_list"},true);if(!!h&&h.length>0){for(var o=0;h.length>o;o++){if(h[o].id=="prop_"+s+"_"+r){continue}else{var k=BX.findChildren(BX(h[o].id),{tagName:"li",className:"bx_active"},true);if(!!k&&k.length>0){for(var l=0;k.length>l;l++){if(k[l].hasAttribute("data-value-id")){q[k[l].getAttribute("data-property")]=k[l].getAttribute("data-value-id")}}}}}}$.ajax({url:"/bitrix/components/bitrix/sale.basket.basket/ajax.php",method:"POST",data:j,dataType:"json",complete:function(i){$(".refresh").click()}})})});$(document).ready(function(){$(document).on("click","#show-ocb-form",function(){$("#ocb-form-wrap").show();$("#ocb-form").show();$("#ocb-form-result").hide();return !1});$(document).on("click",".ocb-form-header-close",function(){$(".ocb-error-msg").each(function(a){$(this).hide()});$(".ocb-result-icon-success").hide();$(".ocb-result-icon-fail").hide();$("#ocb-form-wrap").fadeOut();return !1});$(document).on("click","button.oneclick.disabled, .modules-button.disabled input",function(){return false});$(document).on("submit","#ocb-form",function(){$(".ocb-error-msg").each(function(g){$(this).hide()});var b,e,d=!0,a=$(this);var f=RegExp("^[0-9a-zA-Z-_.]+@[0-9a-zA-Z-]+[.]{1}[0-9a-zA-Z-]+[.]?[0-9a-zA-Z-]+$");var c=RegExp("^[+0-9-() ]+$");$('input[name^="new_order"]').each(function(){b=$(this).attr("id");e=$(this).val();if($(this).prev().children("ins").length>0){if(e==""){$("#"+b+"-error").show();d=!1}}if(b.indexOf("PHONE")!=-1&&e!=""&&!c.test(e)){$("#"+b+"-format-error").show();d=!1}if(b.indexOf("EMAIL")!=-1&&e!=""&&!f.test(e)){$("#"+b+"-error").show();d=!1}});if(!d){return !1}$(".modules-button",$(this)).addClass("disabled");$(".ocb-form-loader").show();if(0<$("#ocb_antispam_check").length&&$("#ocb-antispam").length===0){$("#ocb-params").prepend("<input id='ocb-antispam' type='hidden' name='antispam' value=''>")}$.ajax({url:$(this).attr("action"),data:$(this).serialize(),type:"POST",dataType:"json",error:function(h,i,g){$(".ocb-form-loader").hide();alert("Error connecting server or getting server response!")},success:function(g){if(g.ok!="Y"){$(".ocb-result-icon-fail").show();$(".ocb-result-text").text(g.msg)}else{$(".ocb-result-icon-success").show();if($("#cart_line").length>0){$("#cart_line").html(g.msg)}}$(".ocb-form-loader").hide();$(".modules-button",a).removeClass("disabled");$("#ocb-form").hide();$("#ocb-form-result").show();window.setTimeout(function(){$(".ocb-form-header-close").click()},3000)}});return !1})});