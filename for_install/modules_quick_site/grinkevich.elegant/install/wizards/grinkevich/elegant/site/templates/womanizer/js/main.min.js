var slider=new Array();$(function(){try{$("a[rel^='prettyPhoto']").prettyPhoto({theme:"facebook",deeplinking:false})}catch(f){}$("#zoom").click(function(){$("#main-image").click()});$("a#fn-close").live("click",function(){$.fancybox.close();return false});$("#loginFancy").fancybox({hideOnContentClick:false,zoomSpeedIn:300,zoomSpeedOut:300,overlayShow:true,margin:0,padding:0,autoScale:false,autoDimensions:true,scrolling:"no",opacity:true,showCloseButton:false,transitionIn:"elastic",transitionOut:"elastic",overlayOpacity:"0.7",overlayColor:"#000",centerOnScroll:false,enableEscapeButton:true,href:"#SITE_DIR#includes/login.php"});$(".goto-select").change(function(){document.location.href=$(this).val()});$(".chzn-select").bind("change",function(){var g=$(this).data("inpid");var e=$(this).find("OPTION:selected").data("name");var h="Y";$("#in"+g).attr("name",e);$("#in"+g).val(h)}).trigger("change");$("#filter-catalog-sections-select").change(function(){$("#smart-filter-form").attr("action",$(this).val())}).trigger("change");$("#slider").nivoSlider();var d=$("#cart-items").val();var b=d.split(",");for(var c=0;c<b.length;c++){$(".dataitem-"+b[c].replace("id","")).addClass("added");$(".added .pay a[rel="+b[c]+"]").text(lang_in_cart).addClass("payed").parent().css({width:"55px",marginRight:"10px"})}$("a.button, a.form-trigger").live("click",function(){if($(this).attr("rel")){$("#"+$(this).attr("rel")).submit()}});$(".ajax-form").bind("submit",function(){var e=$(this);var h=$(".ajax-result",e);if(e.attr("locked")==1){return false}e.attr("locked",1);var g=e.serialize();$("input",e).attr("disabled","disabled");h.hide();$.post("/api/"+e.attr("action")+"?"+Math.random(),g,function(i){e.attr("locked",0);$("input",e).removeAttr("disabled");h.addClass(i.status).html(i.message).show();if(i.status!="error"){$(".pop-form div",e).hide()}if(i.refresh){document.location.href=document.location.href}},"json");return false});$("#cart-table .count-changer").change(function(i){var j=parseInt(this.value,10);if(j){var h=$(this).attr("rel");var g=$(this).parent().next().find("strong.red strong");h=h*j;h=setBackspaces(h+"");g.text(h);k();this.value=j}else{this.value=""}function k(){var n=$("#cart-table strong.red strong");var e=$(".total-price strong");var q=0;for(var l=0;l<n.length;l++){var o=n.eq(l).text().split(" ").join("")*1;q+=o}e.text(setBackspaces(q+""))}});$("#left-menu > li i").click(function(){if(this.parentNode.className=="opened"){$("ul",this.parentNode).slideUp();this.parentNode.className=""}else{$("ul",this.parentNode).slideDown();this.parentNode.className="opened"}});$(".p-list").jcarousel({wrap:"circular",visible:3,scroll:1,initCallback:initSlider});$(".p-list li .item, #c-list li .item").hover(function(){if(!$(this).hasClass("added")){$(".pay",this).stop().animate({width:"55px",marginRight:"10px"},200)}},function(){if(!$(this).hasClass("added")){$(".pay",this).stop().animate({width:"0px",marginRight:"0px"},200)}});$("#mi-thumbs").jcarousel({wrap:"circular",visible:4,scroll:1});if(document.getElementById("min-val")!=null){numSliderInit()}$("#right-form select, #right-form input[type=checkbox]").change(function(){submit(this)});$("#right-form input[type=text]").blur(function(){submit(this)});$("#overlay, #imagePopup .image .close").click(function(){closeImagesPopup()});$(".p-list .item .pay a, #c-list .item .pay a").click(function(){animateCart(this);el=$(this).parent().parent().find("strong");var i=el.attr("pprice")*1;var h=$("#price").attr("cprice")*1;var e=$("#priceCount").attr("ccount")*1;var g=$(this).attr("rel");$("#def-cart-mess").hide();$("#tp-info").show();var j="#SITE_DIR#includes/basket_full.php?action=ADD2BASKET&id="+g.replace("id","");$.ajax({url:j,type:"GET",cache:false,success:function(k){}});if(!$(this).parents(".item").hasClass("added")){e+=1;$("#priceCount").attr("ccount",e).text(e+" "+ruscomp(e,lang_cart_products));if(!$("#cart-items").val()){$("#cart-items").val(g)}else{$("#cart-items").val($("#cart-items").val()+","+g)}h+=i;$("#price").attr("cprice",h).text(setBackspaces(h));$(".p-list .item .pay a[rel="+g+"], #c-list .item .pay a[rel="+g+"]").each(function(){$(this).text(lang_in_cart).addClass("payed").parent().css({width:"55px",marginRight:"10px"});$(this).parents(".item").addClass("added")});$.cookie("cart",$("#cart-items").val(),{expires:7,path:"/"});$.cookie("cartprice",h,{expires:7,path:"/"})}});$(".pay-buts .button:not('.notpayed')").click(function(){var j=$("#p-rice").attr("pprice")*1;var i=$("#price").attr("cprice")*1;var e=$("#priceCount").attr("ccount")*1;var g=$(this).attr("ref");$("#def-cart-mess").hide();$("#tp-info").show();var h="";$($(this).attr("props")).each(function(){h+="&"+$(this).attr("name")+"="+$(this).val()});if(!$(this).hasClass("added")){e+=1;$("#priceCount").attr("ccount",e).text(e+" "+ruscomp(e,lang_cart_products));if(!$("#cart-items").val()){$("#cart-items").val(g)}else{$("#cart-items").val($("#cart-items").val()+","+g)}i+=j;$("#price").attr("cprice",i).text(setBackspaces(i));$(this).addClass("added").removeClass("orange").find("span").text($(this).attr("settitle"));$(".lnk-q-pay").hide();var k="#SITE_DIR#includes/basket_full.php?action=ADD2BASKET&id="+g.replace("id","")+h;$.ajax({url:k,type:"GET",cache:false,success:function(l){}})}});$("#user-cabinet .lnk-change").click(function(){var e=$(this);if(e.hasClass("opened")){$("#edit-form").hide();$("#skidka").show();$("#user-info").show();e.removeClass("opened").html("<i></i>��������")}else{$("#skidka").hide();$("#user-info").hide();$("#edit-form").show();e.addClass("opened").text("������")}});$(".c-table .lnk-item").click(function(){var e=$(this).parents("tr").next().find(".subtd");if($(this).hasClass("opened")){e.find(".z-form").slideToggle(400,function(){e.hide()});$(this).removeClass("opened")}else{e.show();e.find(".z-form").slideToggle(400);$(this).addClass("opened")}});$(".button, .jcarousel-prev, .jcarousel-next").mousedown(function(){$(this).addClass("pushed")});$(".button, .jcarousel-prev, .jcarousel-next").mouseup(function(){$(this).removeClass("pushed")});$(".button, .jcarousel-prev, .jcarousel-next").mouseout(function(){$(this).removeClass("pushed")})});function ruscomp(c,b){$comp=b.split(",");if(c==0||(c%10)==0){return $comp[0]}if(c>=5&&c<=20){return $comp[0]}if(c%10>=5&&c%10<=9){return $comp[0]}if((c%10)==1){return $comp[1]}if((c%10)>=2&&(c%10)<=4){return $comp[2]}}function numSliderInit(){var b=document.getElementById("min-val").value*1;var i=document.getElementById("max-val").value*1;var f=document.getElementById("m-step").value*1;var h=document.getElementById("min-inp").value*1;var g=document.getElementById("max-inp").value*1;var d=$("#min-count").slider({value:h,min:b,max:i,step:f,slide:function(j,k){$("#min-inp").val(k.value)},change:function(){e()}});$("#min-inp").val(d.slider("value")).blur(function(){var j=this.value;if(!(+j)){j=b;this.value=b}d.slider("value",j);e()});var c=$("#max-count").slider({value:g,min:b,max:i,step:f,slide:function(j,k){$("#max-inp").val(k.value)},change:function(){e()}});$("#max-inp").val(c.slider("value")).blur(function(){var j=this.value;if(!(+j)){j=i;this.value=i}c.slider("value",j);e()});function e(){var k=d.slider("value");var j=c.slider("value");if(j<k){document.getElementById("min-inp").value=j;document.getElementById("max-inp").value=k;d.slider("value",j);c.slider("value",k)}submit(document.getElementById("max-inp"))}}var smbtTimerId;function submit(b){}var htTimerId;function ajaxEmulation(){var b=document.getElementById("rp-tooltip");$("img",b).hide();$("#rpt-col").show();htTimerId=setTimeout("hideTooltip()",3000)}function hideTooltip(){$("#rpt-col").hide();$("#rp-tooltip img").show();$("#rp-tooltip").stop().hide()}window.onresize=window.onload=function(){changeSliderWidth()};function changeSliderWidth(){var b;if($("#center-col").length>0){b=$("#center-col").width()}else{b=$("#right-wide-col").width()}var d=$("#c-list li");if(slider.length>0){for(var c=0;c<slider.length;c++){if(b>1029){slider[c].reload();slider[c].options.visible=7;slider[c].reload()}else{if(b>882){slider[c].reload();slider[c].options.visible=6;slider[c].reload()}else{if(b>735){slider[c].reload();slider[c].options.visible=5;slider[c].reload()}else{if(b>588){slider[c].reload();slider[c].options.visible=4;slider[c].reload()}else{slider[c].reload();slider[c].options.visible=3;slider[c].reload()}}}}}}if(d.length>0){if(b>1029){d.width("14%")}else{if(b>882){d.width("16%")}else{if(b>735){d.width("20%")}else{if(b>588){d.width("25%")}else{d.width("32%")}}}}}}function initSlider(b){slider.push(b)}function changeColor(b){if(b.options[b.selectedIndex].value==""){$("#color").hide()}else{$("#color").show().css("background-color",b.options[b.selectedIndex].value)}}var pop;var popLink;function getPopup(b,e,d){if(b!=null){popLink=e;pop=document.getElementById(b);pop.style.display="block";addEvent(document,"click",popClickFunc);if(d){var c=getElementPosition(e);pop.style.top=c.top-220+"px";pop.style.left=c.left-120+"px";if($(e).parents(".item").length>0){$("#quick-pay-product-id").val($(e).parents(".item").find(".pay a").attr("rel"))}else{$("#quick-pay-product-id").val($("#main-image").attr("ref"))}}if(b=="login-popup"){var c=getElementPosition(e);if($(e.parentNode).attr("id")=="lnk-cab"){pop.style.position="fixed";pop.style.top=c.top+c.height+2+"px";pop.style.left=c.left-254+$(e).width()/2+"px"}else{pop.style.top=c.top+c.height+2+"px";pop.style.left=c.left-254+$(e).width()/2+"px"}}}}function popClickFunc(c){var c=c||window.event;var b=c.target||c.srcElement;if(b!=pop&&!isChildNode(pop,b)&&b!=popLink&&!isChildNode(popLink,b)){closePopup();removeEvent(document,"click",popClickFunc)}}function closePopup(){$(".popup .pop-form div").show();$(".popup .pop-form p.ajax-result").html("").hide();$(".popup").css("display","none");$("#pop-login").show();$("#pop-remember").hide()}function getImagePopup(f,d){if(f.length>0){var c=$("#imagePopup");var e=c.find(".image");var b=$("#ip-image");$("#overlay").height(getDocumentHeight()).show();c.css("top",getBodyScrollTop()+100).show();b.attr("src",f[d]).attr("rel",0);b.load(function(){e.height("auto").css("visibility","visible")});$("#ip-prev").unbind("click").bind("click",function(){changeImage(f,"prev")});$("#ip-next").unbind("click").bind("click",function(){changeImage(f,"next")})}}function closeImagesPopup(){$("#imagePopup, #overlay").hide()}function changeImage(h,g){var c=$("#ip-image");var b=$("#imagePopup");var f=b.find(".image");var e=parseInt(c.attr("rel"));var d;if(g=="next"){if((h.length-1)>e){d=e+1}else{d=0}}else{if(e>0){d=e-1}else{d=h.length-1}}f.css("visibility","hidden");c.attr("src",h[d]).attr("rel",d);c.load(function(){f.height("auto").css("visibility","visible")})}function animateCart(d){var b=$(d).parents("li").find(".img img");var e=getElementPosition(b.get(0));var c="<div id='prod-img' style='left: "+(e.left+5)+"px; top: "+(e.top-getBodyScrollTop()+5)+"px'><img style='width: 100%; height: 100%' src='"+b.attr("src")+"' alt='' /></div>";$("body").append(c);$("#prod-img").animate({width:0,height:0,top:0,left:getClientWidth()-120},500,function(){$(this).remove()})}function setBackspaces(g){g=g.toString();m="";a=g.split(".");if(a.length>1){g=a[0];m="."+a[1]}var h=(g.length-(g.length%3))/3;if(g.length%3==0){h--}var c=1;for(var b=h;b>0;b--){var e=g.length-c-3*c;var f=g.substr(0,e+1);var d=g.substr(e+1,g.length-1);g=f+" "+d;c++}return g+m}function getElementPosition(f){var c=f.offsetWidth;var e=f.offsetHeight;var b=0;var d=0;while(f){b+=f.offsetLeft;d+=f.offsetTop;f=f.offsetParent}return{left:b,top:d,width:c,height:e}}function addEvent(d,c,b){if(d.addEventListener){d.addEventListener(c,b,false)}else{if(d.attachEvent){d.attachEvent("on"+c,b)}}}function removeEvent(d,c,b){if(d.removeEventListener){d.removeEventListener(c,b,false)}else{if(d.detachEvent){d.detachEvent("on"+c,b)}}}function isChildNode(c,d){for(var b in c.childNodes){if(c.childNodes[b].nodeType==1){if(c.childNodes[b]==d){return true}else{if(isChildNode(c.childNodes[b],d)){return true}}}}return false}function getClientWidth(){return document.compatMode=="CSS1Compat"||window.opera?document.documentElement.clientWidth:document.body.clientWidth}var ua=navigator.userAgent.toLowerCase();var isOpera=(ua.indexOf("opera")>-1);var isIE=(!isOpera&&ua.indexOf("msie")>-1);function getViewportHeight(){return((document.compatMode||isIE)&&!isOpera)?(document.compatMode=="CSS1Compat")?document.documentElement.clientHeight:document.body.clientHeight:(document.parentWindow||document.defaultView).innerHeight}function getDocumentHeight(){return Math.max(document.compatMode!="CSS1Compat"?document.body.scrollHeight:document.documentElement.scrollHeight,getViewportHeight())}function getBodyScrollTop(){return self.pageYOffset||(document.documentElement&&document.documentElement.scrollTop)||(document.body&&document.body.scrollTop)};