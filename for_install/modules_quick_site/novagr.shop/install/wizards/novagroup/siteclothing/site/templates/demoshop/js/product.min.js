var product={CHANGE_URL:0,photoFirstTime:false,colorFromUrl:false,photoBuffer:[],currentColorId:0,currentSizeId:0,currentPrice:0,currentSet:[],productUrl:"",curPhotosSmall:[],curPhotosBig:[],curPhotosMiddle:[],curPhotosBigHeight:[],ajaxUrl:"",productId:"",messages:{},siteID:0,offersSubsribed:[],isAuthorized:0,userEmail:"",subscribesFlag:false,tooltipSelector:"",tooltipText:"",shelvedItems:[],detailCardView:1,isOpt:0,getClassNotify:function(){var a="";if(product.userEmail!=""){a="authNotifySize2"}else{a="notify2"}return a},changeRealSizes:function(a){$("#myTab li").removeClass("active");$("#li_"+a).addClass("active");$("#myTabContent div.tab-pane").removeClass("active").removeClass("in");$("#myTabContent div#tab"+a).addClass("active in")},changeSize:function(a){product.currentSizeId=a;if(product.CHANGE_URL){window.history.replaceState(null,null,product.productUrl+"?cs="+product.currentSizeId+"&#color-"+product.currentColorId+"-"+product.productId)}for(var b in product.currentSet){if(product.currentSet[b].color==product.currentColorId&&product.currentSet[b].size==product.currentSizeId){$("#notify_elem_id").attr("value",b);product.changePrice(product.currentSet[b].price,b);product.curPhotosBig=product.currentSet[b].curPhotosBig;product.curPhotosSmall=product.currentSet[b].curPhotosSmall;product.curPhotosMiddle=product.currentSet[b].curPhotosMiddle;product.changePhotos();product.changeRealSizes(a);return}}product.changeRealSizes(a)},checkSize:function(a){for(var b in product.currentSet){if(product.currentSet[b].color==product.currentColorId&&product.currentSet[b].size==a){return true}}return false},changeColor:function(e,f){product.currentColorId=e;if(product.CHANGE_URL){window.history.replaceState(null,null,product.productUrl+"?cs="+product.currentSizeId+"&#color-"+product.currentColorId+"-"+product.productId)}var a="";var c=[];for(var d in product.currentSet){var j=$("#li_"+product.currentSet[d].size);if(product.currentSet[d].color==e){j.show();if(jQuery.inArray(product.currentSet[d].size,c)==-1){c.push(product.currentSet[d].size)}}}var b=false;for(var d in product.currentSet){var j=$("#li_"+product.currentSet[d].size);if(jQuery.inArray(product.currentSet[d].size,c)==-1){j.hide()}else{if(product.currentSet[d].color==e){if(product.currentSet[d].quantity<=0){if(product.subscribesFlag==true){var g="";var k=product.messages.SUBSCR_MESSAGE}else{var g="not-s-";var k=product.messages.NO_IN_STOCK}j.removeAttr("class").attr("data-placement","top").attr("rel","tooltip").attr("data-original-title",k).html('<span class="none-gt"><a data-size="'+product.currentSet[d].size+'"  href="#tab'+product.currentSet[d].size+'" class="'+g+product.getClassNotify()+'" data-elem-id="'+d+'" >'+product.currentSet[d].sizeName+"</a></span>")}else{j.removeAttr("class").removeAttr("data-placement").removeAttr("rel").removeAttr("data-original-title").html('<a data-size="'+product.currentSet[d].size+'"  href="#tab'+product.currentSet[d].size+'">'+product.currentSet[d].sizeName+"</a>")}if(f){var h=parseInt(product.currentSet[d].price);if(h==product.currentPrice&&product.currentSet[d].color==e){if(product.currentSet[d].quantity>0){if(product.currentSet[d].sizeSort>0&&a==""){a=d}else{if(a>0&&product.currentSet[d].sizeSort<product.currentSet[a].sizeSort){a=d}}}}}else{if(product.currentSet[d].size==product.currentSizeId&&product.currentSet[d].color==e){a=d}}}}}$("[rel=tooltip]").tooltip({});if(a!=""){product.changePrice(product.currentSet[a].price,a);product.curPhotosBig=product.currentSet[a].curPhotosBig;product.curPhotosSmall=product.currentSet[a].curPhotosSmall;product.curPhotosMiddle=product.currentSet[a].curPhotosMiddle;product.changePhotos();product.currentSizeId=product.currentSet[a].size;$("#li_"+product.currentSizeId).attr("class","active");$("#myTabContent div.tab-pane").removeClass("active").removeClass("in");$("#myTabContent div#tab"+product.currentSizeId).addClass("active in");b=true}if(b==false){product.chooseFirstSize();$("#myTabContent div.tab-pane").removeClass("active").removeClass("in");$("#myTabContent div#tab"+product.currentSizeId).addClass("active in")}},chooseFirstSize:function(){if(window.SET_PRODUCT_FIRST_SIZE===false){return false}$("#myTab li").each(function(b){if($(this).css("display")!=="none"){var a=$(this).find("a").data("size");product.changeSize(a);return false}})},addToSet:function(k,g,f,h,n,i,m,d,a,e,l,c,j,b){if(!l){l=0}product.currentSet[k]={price:g,color:f,size:h,colorName:n,colorPicture:i,curPhotosSmall:m,curPhotosBig:d,curPhotosBigHeight:a,sizeName:e,sizeSort:l,quantity:c,oldPrice:j,curPhotosMiddle:b}},formatPrice:function(c){var b=c.replace(".00","");b+="";x=b.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var a=/(\d+)(\d{3})/;while(a.test(x1)){x1=x1.replace(a,"$1 $2")}newPrice=x1+x2;return newPrice},checkCommentForm:function(){var c=$("#REVIEW_TEXT").val();var b=[];if($("#REVIEW_AUTHOR").length){var a=$("#REVIEW_AUTHOR").val();if(a==""){b.push(product.messages.ALERT_NAME);$("#controlGroupName").attr("class","control-group error")}else{$("#controlGroupName").attr("class","control-group")}}if(c==""){b.push(product.messages.ALERT_MESSAGE);$("#controlGroupText").attr("class","control-group error")}else{$("#controlGroupText").attr("class","control-group")}var d=b.join("<br>");if(d!=""){$("#alert").attr("class","alert alert-error").html(d);return false}showAjaxLoader();return true},setSiteID:function(a){this.siteID=a},getComments:function(b){if(!b){b=1}var a={AJAX_REFRESH:1,ELEMENT_ID:this.productId,iNumPage:b,siteID:this.siteID};$.ajax({type:"POST",url:this.ajaxUrl,data:a,dataType:"json",beforeSend:function(){showAjaxLoader()},success:function(c,d){hideAjaxLoader();if(c&&c.result){if(c.result=="OK"){$("#comments-list").html(c.commentsText);$("#controlGroupName").html(c.fields);$("#controlGroupEmail").html(c.fieldsEmail);if(c.count>0){$("#comment-refresh").show()}$("div.coment").css("display","block")}}}})},changePrice:function(c,f){var a=product.currentSet[f].oldPrice;oldPriceFloat=a.replace(/ /gi,"");oldPriceFloat=parseFloat(oldPriceFloat);priceFloat=c.replace(/ /gi,"");priceFloat=parseFloat(priceFloat);var d="default-value";if(product.currentSet[f].quantity<1){$("#notifyme").show();$("#sum").text(product.messages.NO_IN_STOCK);$("#old-price").text("");$(".addToBasket, .actual-price .basket-tab").hide();$(".oneClick").hide();d="discount"}else{$("#notifyme").hide();var g=product.formatPrice(c);$("#sum").text(g);if(oldPriceFloat>priceFloat){d="discount";var e=product.formatPrice(a);$("#old-price").text(e)}else{$("#old-price").text("")}$(".addToBasket").attr("data-elem-id",f);if(g==""&&product.isOpt==1){d="discount";$("#sum").text(product.messages.NO_IN_STOCK);$(".addToBasket, .actual-price .basket-tab").hide();$(".oneClick").hide()}else{$(".addToBasket, .actual-price .basket-tab").show();$(".oneClick").show()}}$("#sum").attr("class",d);var b=$("#shelve-product");b.attr("data-elem-id",f);if(product.elemInArray(f,product.shelvedItems)==-1){b.text(product.messages.ADD_TO_SHELVES).attr("data-action","addToShelve")}else{b.text(product.messages.DEL_FROM_SHELVES).attr("data-action","delFromShelve")}},elemInArray:function(c,a){for(var b in a){if(a[b]==c){return b}}return -1},buyClick:function(e){var f=$(e).attr("data-elem-id");if(f>0){var c={ADD2BASKET:"1",elemId:f};var d=$(e).attr("data-action");if(d=="delFromShelve"){c.act="delFromShelve";product.tooltipSelector="#box-shelve";var a=product.messages.DELETED_FROM_SHELVES;$("#shelve-product").attr("data-action","addToShelve").text(product.messages.ADD_TO_SHELVES);for(var b in product.shelvedItems){if(product.shelvedItems[b]==f){delete product.shelvedItems[b]}}}else{if(d=="addToShelve"){c.act="addToShelve";product.tooltipSelector="#box-shelve";var a=product.messages.ADDED_TO_SHELVES;$("#shelve-product").attr("data-action","delFromShelve").text(product.messages.DEL_FROM_SHELVES);product.shelvedItems.push(f)}else{product.tooltipSelector="#buy-popup";var a=product.messages.PRODUCT_ADDED_TO_CART}}$.ajax({type:"POST",url:this.ajaxUrl,data:c,dataType:"json",success:function(g,h){product.currentSet[f].quantity=1;if(g.status=="ERROR"&&g.type=="PRODUCT_EXCEEDED_LIMIT"){product.tooltipText=product.messages.PRODUCT_ALREADY_IN_CART}else{if(g.status=="ERROR"&&g.type=="PRODUCT_NOT_AVAILABLE"){product.currentSet[f].quantity=0;product.changeColor(product.currentColorId);$("#li_"+product.currentSizeId+" a").click();return}else{if(g.status=="OK"){product.tooltipText=a;$("#cart_line_1").replaceWith(g.html);$("#cart_line_1").addClass("basket-active");UpdateBasketAfterLoadOrderList();setTimeout(product.stopCartLight,2500)}}}$(product.tooltipSelector+" div").text(product.tooltipText);$(product.tooltipSelector).show();setTimeout(product.closeTooltip,2500)}})}},closeTooltip:function(){$(product.tooltipSelector).hide()},stopCartLight:function(){$("#cart_line_1").removeClass("basket-active")},enableSmiles:function(){var a=new JCommentsEditor("REVIEW_TEXT",true);a.initSmiles(JAVASCRIPT_SITE_DIR+"include/images/smiles");a.addSmile(":D","laugh.gif");a.addSmile(":lol:","lol.gif");a.addSmile(":-)","smile.gif");a.addSmile(";-)","wink.gif");a.addSmile("8)","cool.gif");a.addSmile(":-|","normal.gif");a.addSmile(":oops:","redface.gif");a.addSmile(":sad:","sad.gif");a.addSmile(":roll:","rolleyes.gif")},getSizeFromAnchorIE:function(a){var c=[];if(a!=""){var d=a.split("&");for(var e in d){if(d[e].indexOf("cs=")!=-1){var b=d[e].split("=");if(b[1]==""){break}b[1]=parseInt(b[1]);c[0]=b[1];break}}}return c},fixAnchorIE:function(a){if(a.indexOf("./")!=-1){a=""}var b=a.lastIndexOf("#");if(b!=-1){a=a.substr(b)}return a},chooseFirstColor:function(){if(window.SET_PRODUCT_FIRST_PHOTO==false){}else{var a=location.hash;a=product.fixAnchorIE(a);if(a!=""&&$(".color-ch "+a+"-set-by-hash").is("button")){$(a+"-set-by-hash").click();product.colorFromUrl=true}else{$(".color-ch button:first").click()}product.chooseFirstSize()}},getSubscribed:function(){},setFancyBox:function(){$(".fancybox").fancybox({helpers:{title:null}});return false},setFancyBoxWithZoom:function(){$(".fancybox").fancybox({helpers:{title:null},beforeShow:function(){},beforeClose:function(){$(".fancybox-inner").trigger("zoom.destroy")},onUpdate:function(){$(".fancybox-inner").zoom({callback:function(){}})}});return false},changePhotos:function(e){var e=e||0;if(product.photoFirstTime==false){product.photoBuffer=e;return}var h="",g="";var a="";var c=1;var b="";if(product.detailCardView==4){if(e!==0){b=e.big;var f="";h+='<a class="detailLink fancybox" rel="gallery" href="'+e.big+'" '+f+'><img id="detailImg'+c+'" class="" src="'+e.big+'" alt="" /></a>';g+='<img class="ajaximg ajaximgload86x114" data-big-pic="'+e.big+'" class="previewImg" src="'+e.small+'" width="90" height="120" alt="" href="'+e.middle+'"  />';c=2}for(var d in product.curPhotosBig){if(b==product.curPhotosBig[d]){continue}if(c==1){var f=""}else{var f='style="display:none;"'}h+='<a class="detailLink fancybox" rel="gallery" href="'+product.curPhotosBig[d]+'" '+f+'><img id="detailImg'+c+'" class="" src="'+product.curPhotosBig[d]+'"  alt="" /></a>';g+='<img class="ajaximg ajaximgload86x114" data-big-pic="'+product.curPhotosBig[d]+'" class="previewImg" src="'+product.curPhotosSmall[d]+'" width="90" height="120" alt="" href="'+product.curPhotosMiddle[d]+'"  />';c++}}else{if(product.detailCardView==3){if(e!==0){b=e.big;var f="";h+='<a class="detailLink fancybox" rel="gallery" href="'+e.big+'" '+f+'><img id="detailImg'+c+'" class="ajaximg ajaximgload450x580" src="'+e.middle+'" width="450" height="373" alt="" /></a>';g+='<img class="ajaximg ajaximgload86x114" data-big-pic="'+e.big+'" class="previewImg" src="'+e.small+'" width="90" height="120" alt="" href="'+e.middle+'"  />';c=2}for(var d in product.curPhotosBig){if(b==product.curPhotosBig[d]){continue}if(c==1){var f=""}else{var f='style="display:none;"'}h+='<a class="detailLink fancybox" rel="gallery" href="'+product.curPhotosBig[d]+'" '+f+'><img id="detailImg'+c+'" class="ajaximg ajaximgload450x580" src="'+product.curPhotosMiddle[d]+'" width="450" height="373" alt="" /></a>';g+='<img class="ajaximg ajaximgload86x114" data-big-pic="'+product.curPhotosBig[d]+'" class="previewImg" src="'+product.curPhotosSmall[d]+'" width="90" height="120" alt="" href="'+product.curPhotosMiddle[d]+'"  />';c++}}else{for(var d in product.curPhotosBig){if(c==1){a=product.curPhotosBig[d];h+='<a class="detailLink" id="fLinkPic" href="#myModal" role="button" ><img data-big-pic="'+product.curPhotosBig[d]+'" id="detailImg'+c+'" class="ajaximg ajaximgload450x580" src="'+product.curPhotosMiddle[d]+'" data-height="'+product.curPhotosBigHeight[d]+'" width="450" height="580" alt="'+product.messages.PRODUCT_NAME+'" /></a>'}g+='<img class="ajaximg ajaximgload86x114" data-big-pic="'+product.curPhotosBig[d]+'" class="previewImg" src="'+product.curPhotosSmall[d]+'" width="86" height="114" alt="'+product.messages.PRODUCT_NAME+'" href="'+product.curPhotosMiddle[d]+'"  />';c++}}}$("#photos").html(h);if(b==""){$("#thumbs").html(g)}if(product.detailCardView==2){$(".zoomImg").remove();$("#photos").zoom({url:a})}else{if(product.detailCardView==3){product.setFancyBox()}else{if(product.detailCardView==4){$(".zoomContainer").remove();$("#detailImg1").removeData("elevateZoom");product.setFancyBoxWithZoom();$("#detailImg1").elevateZoom()}}}},init:function(k,p,r,o,t,f,y,q,i,d,a,g,m,w,n,u,h,v,b,c,s,e,j){if(!a){a=0}var l=this;l.isOpt=e.is_opt;l.messages=u;l.ajaxUrl=w;l.productId=n;l.subscribesFlag=b;l.userEmail=JW_USER_EMAIL;l.currentPrice=parseInt(p);l.productUrl=v;l.currentColorId=r;l.currentSizeId=o;l.shelvedItems=j;l.currentSet=[];l.currentSet[k]={price:p,color:r,size:o,colorName:t,colorPicture:f,curPhotosSmall:y,curPhotosBig:q,curPhotosBigHeight:i,sizeName:d,sizeSort:a,quantity:g,oldPrice:m,curPhotosMiddle:c};l.curPhotosBig=q;l.curPhotosSmall=y;l.curPhotosBigHeight=i;l.curPhotosMiddle=c;l.detailCardView=s;if(h==1){l.enableSmiles()}$("#color-ch button").live("click",function(){var z=$(this).data("color");product.changeColor(z)});$("#shelve-product").on("click",function(){product.buyClick(this);return false});if(l.detailCardView==1){$("#fLinkPic").die("click");$("#fLinkPic").live("click",function(){showAjaxLoader();var F="";var J=[];var z=$(this).find("img").attr("data-big-pic");var G=$("#thumbs img").length;var H=$(".head-title h1").html();$("#thumbs img").each(function(K,L){J[K]=$(this).data("big-pic")});var C=1;var E=1;for(var D in J){var A="";if(J[D]==z){A="active ";E=C}F+='<div class="'+A+'item"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h3>'+H+' </h3></div><div class="modal-body"><img alt="" src="'+J[D]+'"></div><div class="modal-footer">'+product.messages.CAROUSEL_LABEL1+' <span class="curImg">'+C+"</span> "+product.messages.CAROUSEL_LABEL2+' <span class="totalImg">'+G+"</span></div></div>";++C}showHideArrows(E,G);$("#carousel-inner").html(F);var B=$("#myCarousel").carousel({interval:false});B.on("slid",function(){var K=$("#carousel-inner .active .curImg").html();showHideArrows(K,G);showAjaxLoader();var L=new Image();L.onload=function(){hideAjaxLoader();var M=((L.width+30)/2);$("#myModal").css("marginLeft","-"+M+"px")};L.src=$("#myModal .carousel-inner .active .modal-body img").attr("src")});var I=new Image();I.onload=function(){hideAjaxLoader();var K=((I.width+30)/2);$("#myModal").modal({marginLeft:K})};I.src=z;return false});$("#thumbs img").live("mouseenter",function(){$("#detailImg1").attr("src",$(this).attr("href")).attr("data-big-pic",$(this).data("big-pic"))});$("#thumbs img").die("click");$("#thumbs img").live("click",function(){$("#detailImg1").trigger("click");return false})}else{if(l.detailCardView==2){$("#thumbs img").die("mouseenter");$("#thumbs img").live("mouseenter",function(){$("#detailImg1").attr("src",$(this).attr("href")).attr("data-big-pic",$(this).data("big-pic"));$("img.zoomImg").remove();$("#photos").zoom({url:$(this).data("big-pic")})})}else{if(l.detailCardView==3){$("#thumbs img").die("mouseenter");$("#thumbs img").live("mouseenter",function(){var z=[];z.small=$(this).attr("src");z.middle=$(this).attr("href");z.big=$(this).data("big-pic");product.changePhotos(z)});$("#thumbs img").die("click");$("#thumbs img").live("click",function(){$("#detailImg1").trigger("click");return false})}else{if(l.detailCardView==4){$("#thumbs img").die("mouseenter");$("#thumbs img").live("mouseenter",function(){var z=[];z.small=$(this).attr("src");z.middle=$(this).attr("href");z.big=$(this).data("big-pic");product.changePhotos(z)});$("#thumbs img").die("click");$("#thumbs img").live("click",function(){$("#detailImg1").trigger("click");return false})}}}}}};$(document).ready(function(){$("#landingCreate").on("click",function(){var a={AJAX:1,elemID:$(this).data("elem-id"),code:$(this).data("elem-code")};$.ajax({type:"POST",url:JAVASCRIPT_SITE_DIR+"include/ajax/landingCreate.php",data:a,dataType:"json",beforeSend:function(){showAjaxLoader()},success:function(b,c){hideAjaxLoader();if(b&&b.result){if(b.result=="OK"){window.location="/bitrix/admin/iblock_element_edit.php?IBLOCK_ID="+b.iblockID+"&type=LandingPages&ID="+b.elemID+"&lang=ru&find_section_section=0&WF=Y"}}}});return false})});