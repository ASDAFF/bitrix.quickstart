<?$module_id = "byteeightlab.sitemap";IncludeModuleLangFile($_SERVER["DOCUMENT_ROOT"].BX_ROOT."/modules/main/admin/task_description.php");if(!$USER->CanDoOperation('byteeightlab_sitemap_view_all_settings')) $APPLICATION->AuthForm(GetMessage("ACCESS_DENIED"));if($REQUEST_METHOD=="GET" && $USER->CanDoOperation('byteeightlab_sitemap_edit_all_settings') && strlen($RestoreDefaults)>0 && check_bitrix_sessid()){	COption::RemoveOption($module_id);}global $MESS;IncludeModuleLangFile(__FILE__);$aTabs = array(	array("DIV" => "edit1", "TAB" => GetMessage("MAIN_TAB_SETING"), "ICON" => "", "TITLE" => GetMessage("MAIN_TAB_TITLE_SETING")),	array("DIV" => "edit2", "TAB" => GetMessage("MAIN_TAB_STATICS"), "ICON" => "", "TITLE" => GetMessage("MAIN_TAB_TITLE_STATICS")),	array("DIV" => "edit3", "TAB" => GetMessage("MAIN_TAB_IBLOCKS"), "ICON" => "", "TITLE" => GetMessage("MAIN_TAB_TITLE_IBLOCKS")),	array("DIV" => "edit4", "TAB" => GetMessage("MAIN_TAB_RIGHTS"), "ICON" => "", "TITLE" => GetMessage("MAIN_TAB_TITLE_RIGHTS")),);$tabControl = new CAdmintabControl("tabControl", $aTabs);CModule::IncludeModule("iblock");$IblockArray = array();$res = CIBlock::GetList(Array(),Array('ACTIVE'=>'Y'));while($ar_res = $res->Fetch()) $IblockArray[$ar_res['ID']] = $ar_res['NAME'];$changefreq = array(	"always" => GetMessage("CHANGEFREQ_ALWAYS"),	"hourly" => GetMessage("CHANGEFREQ_HOURLY"),	"daily" => GetMessage("CHANGEFREQ_DAILY"),	"weekly" => GetMessage("CHANGEFREQ_WEEKLY"),	"monthly" => GetMessage("CHANGEFREQ_MONTHLY"),	"yearly" => GetMessage("CHANGEFREQ_YEARLY"),	"never" => GetMessage("CHANGEFREQ_NEVER"),);if($REQUEST_METHOD == "POST" && strlen($Update)>0 && $USER->CanDoOperation('byteeightlab_sitemap_edit_all_settings') && check_bitrix_sessid()){	COption::RemoveOption($module_id,'STATIC'); COption::RemoveOption($module_id,'IBLOCK');		if(trim($_POST['SETING']['URL'])!='') COption::SetOptionString($module_id,'URL',trim($_POST['SETING']['URL']));	else COption::RemoveOption($module_id,'URL');	$_POST['SETING']['NAME'] = trim(preg_replace("/[^a-zA-Z0-9_]/","",$_POST['SETING']['NAME']));	if($_POST['SETING']['NAME']!='') COption::SetOptionString($module_id,'NAME',$_POST['SETING']['NAME']);	else COption::RemoveOption($module_id,'NAME');	$_POST['SETING']['PATH'] = trim(preg_replace("/[^a-zA-Z0-9_\/]/","",$_POST['SETING']['PATH']));	if($_POST['SETING']['PATH']!='')  COption::SetOptionString($module_id,'PATH',$_POST['SETING']['PATH']);	else COption::RemoveOption($module_id,'NAME');	if(isset($_POST['SETING']['INDEX'])) COption::SetOptionString($module_id,'INDEX','Y');	else COption::SetOptionString($module_id,'INDEX','N');	$_POST['SETING']['POSTFIX'] = trim(preg_replace("/[^a-zA-Z0-9_]/","",$_POST['SETING']['POSTFIX']));	if($_POST['SETING']['POSTFIX']!='') COption::SetOptionString($module_id,'POSTFIX',$_POST['SETING']['POSTFIX']);	else COption::RemoveOption($module_id,'POSTFIX');	if(isset($_POST['SETING']['PUBLICGENERATE'])){ 		CopyDirFiles($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/".$module_id."/install/public",$_SERVER["DOCUMENT_ROOT"]."/");		COption::SetOptionString($module_id,'PUBLICGENERATE','Y');	}else{		DeleteDirFiles($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/".$module_id."/install/public", $_SERVER["DOCUMENT_ROOT"]."/");		COption::SetOptionString($module_id,'PUBLICGENERATE','N');		}	foreach($_POST['STATIC'] as $key=>$value){		if($value['LOC']==''||isset($value['DEL'])){ 			unset($_POST['STATIC'][$key]); COption::RemoveOption($module_id,'STATIC_'.$key);		}else{			if(trim($value['LASTMOD'])!='') $value['LASTMOD'] = FormatDate("d.m.Y H:i:s",MakeTimeStamp($value['LASTMOD']));			else unset($value['LASTMOD']);			if(!isset($changefreq[$value['CHANGEFREQ']])) unset($value['CHANGEFREQ']);			if(trim($value['PRIORITY'])!=''){				$value['PRIORITY'] = number_format(floatval($value['PRIORITY']),1,'.','');				if($value['PRIORITY']>=1||$value['PRIORITY']<=0||$value['PRIORITY']=='') $value['PRIORITY'] = '0.5';			}else unset($value['PRIORITY']);			$_POST['STATIC'][$key] = $value;		}	}	if(count($_POST['STATIC'])>0){		$static_num = 0; foreach($_POST['STATIC'] as $k=>$STATIC){ 			COption::SetOptionString($module_id,'STATIC_n'.$static_num,json_encode($STATIC)); $static_num++; 		}		COption::SetOptionString($module_id,'STATIC_NUM',$static_num);	}	foreach($_POST['IBLOCK'] as $key=>$value){		$value['IBLOCK'] = intval($value['IBLOCK']);		if($value['IBLOCK']==0||isset($value['DEL'])){ 			unset($_POST['IBLOCK'][$key]);  COption::RemoveOption($module_id,'IBLOCK_'.$key);		}else{			$value['LOC'] = trim(preg_replace("/[^a-zA-Z0-9_]/","",$value['LOC']));			if($value['LOC']=='') $value['LOC'] = "DETAIL_PAGE_URL";			$value['LASTMOD_CODE'] = trim(preg_replace("/[^a-zA-Z0-9_]/","",$value['LASTMOD_CODE']));			if($value['LASTMOD_CODE']=='') $value['LASTMOD_CODE'] = "DATE_ACTIVE_FROM";			if(trim($value['LASTMOD'])!='') $value['LASTMOD'] = FormatDate("d.m.Y H:i:s",MakeTimeStamp($value['LASTMOD']));			else unset($value['LASTMOD']);			if(!isset($changefreq[$value['CHANGEFREQ']])) unset($value['CHANGEFREQ']);						if(trim($value['PRIORITY'])!=''){				$value['PRIORITY'] = number_format(floatval($value['PRIORITY']),1,'.','');				if($value['PRIORITY']>=1||$value['PRIORITY']<=0||$value['PRIORITY']=='') $value['PRIORITY'] = '0.5';			}else unset($value['PRIORITY']);						$value['FILTER'] = trim(preg_replace("/[^a-zA-Z0-9_\,=]/","",$value['FILTER']));			if($value['FILTER']=='') unset($value['FILTER']);			$value['SORT'] = trim(preg_replace("/[^a-zA-Z0-9_\,=]/","",$value['SORT']));			if($value['SORT']=='') unset($value['SORT']);								$_POST['IBLOCK'][$key] = $value;		}	}	if(count($_POST['IBLOCK'])>0){		$iblock_num = 0; foreach($_POST['IBLOCK'] as $k=>$IBLOCK){ 			COption::SetOptionString($module_id,'IBLOCK_n'.$iblock_num,json_encode($IBLOCK)); $iblock_num++; 		}		COption::SetOptionString($module_id,'IBLOCK_NUM',$iblock_num);		}		}if(strlen($strWarning)>0) CAdminMessage::ShowMessage($strWarning);if(strlen($strOK)>0) CAdminMessage::ShowNote($strOK);$tabControl->Begin();$URL = COption::GetOptionString($module_id,'URL','http://'.$_SERVER['HTTP_HOST']);$NAME = COption::GetOptionString($module_id,'NAME','sitemap');$PATH = COption::GetOptionString($module_id,'PATH','/');$INDEX = (COption::GetOptionString($module_id,'INDEX','Y')=='Y')?true:false;$POSTFIX = COption::GetOptionString($module_id,'POSTFIX','_');$PUBLICGENERATE = (COption::GetOptionString($module_id,'PUBLICGENERATE','Y')=='Y')?true:false;$STATIC = array();$STATIC_NUM = COption::GetOptionString($module_id,'STATIC_NUM',0);for($i=0;$i<$STATIC_NUM;$i++){ $STATIC['n'.$i] = (array) json_decode(COption::GetOptionString($module_id,'STATIC_n'.$i,'[]')); }$STATIC_OLD = (array) json_decode(COption::GetOptionString($module_id,'STATIC','[]'));foreach($STATIC_OLD as $key=>$value){ $STATIC['n'.$i] = (array) $value; $i++; }$IBLOCK = array();$IBLOCK_NUM = COption::GetOptionString($module_id,'IBLOCK_NUM',0);for($i=0;$i<$IBLOCK_NUM;$i++){ $IBLOCK['n'.$i] = (array) json_decode(COption::GetOptionString($module_id,'IBLOCK_n'.$i,'[]')); }$IBLOCK_OLD = (array) json_decode(COption::GetOptionString($module_id,'IBLOCK','[]'));foreach($IBLOCK_OLD as $key=>$value){ $IBLOCK['n'.$i] = (array) $value; $i++; }?><form method="POST" enctype="multipart/form-data" action="<?echo $APPLICATION->GetCurPage()?>?mid=<?=htmlspecialchars($mid)?>&lang=<?echo LANG?>&mid_menu=1"><?=bitrix_sessid_post()?><?if(strlen($_REQUEST["back_url_settings"])>0):?>	<input type="hidden" name="back_url_settings" value="<?=htmlspecialchars($_REQUEST["back_url_settings"])?>"><?endif?><?$tabControl->BeginNextTab();?><tr>	<td>		<table class="adm-detail-content-table">			<tr>				<td width="40%" class="adm-detail-content-cell-l"><?=GetMessage("EDIT1_URL")?>:</td>				<td class="adm-detail-content-cell-r">					<input type="text" name="SETING[URL]" value="<?=$URL?>" size="20" maxlength="255"><b> <?=GetMessage("EDIT1_URL_INFO")?></b>				</td>			</tr>					<tr>				<td width="40%" class="adm-detail-content-cell-l"><?=GetMessage("EDIT1_FILENAME")?>:</td>				<td class="adm-detail-content-cell-r">					<input type="text" name="SETING[NAME]" value="<?=$NAME?>" size="20" maxlength="255"><b>.xml</b>				</td>			</tr>			<tr>				<td width="40%" class="adm-detail-content-cell-l"><?=GetMessage("EDIT1_PATH")?>:</td>				<td class="adm-detail-content-cell-r">					<input type="text" name="SETING[PATH]" value="<?=$PATH?>" size="20" maxlength="255">				</td>			</tr>			<tr>				<td width="40%" class="adm-detail-content-cell-l"><?=GetMessage("EDIT1_INDEX")?>:</td>				<td class="adm-detail-content-cell-r">					<input type="checkbox" name="SETING[INDEX]" value="Y" <?if($INDEX){?>checked="" <?}?>id="SETING[INDEX]" class="adm-designed-checkbox">					<label class="adm-designed-checkbox-label" for="SETING[INDEX]" title=""></label>				</td>			</tr>			<tr>				<td width="40%" class="adm-detail-content-cell-l"><?=GetMessage("EDIT1_POSTFIX")?>:</td>				<td class="adm-detail-content-cell-r">					<input type="text" name="SETING[POSTFIX]" value="<?=$POSTFIX?>" size="20" maxlength="255"><b> <?=GetMessage("EDIT1_POSTFIX_INFO")?></b>				</td>			</tr>			<tr>				<td width="40%" class="adm-detail-content-cell-l"><?=GetMessage("EDIT1_PUBLICGENERATE")?> <b>/bel_sitemap_generator.php</b>:</td>				<td class="adm-detail-content-cell-r">					<input type="checkbox" name="SETING[PUBLICGENERATE]" value="Y" <?if($PUBLICGENERATE){?>checked="" <?}?>id="SETING[PUBLICGENERATE]" class="adm-designed-checkbox">					<label class="adm-designed-checkbox-label" for="SETING[PUBLICGENERATE]" title=""></label>				</td>			</tr>					</table>		</td></tr><?$tabControl->BeginNextTab();?><tr>	<td align="center">		<table border="0" cellspacing="0" cellpadding="0" class="internal" id="STATICTABLE">			<tr class="heading">				<td><?=GetMessage("EDIT2_URL")?></td>				<td><?=GetMessage("EDIT2_LASTMOD")?><span id="EDIT2_LASTMOD"></span><script type="text/javascript">BX.hint_replace(BX('EDIT2_LASTMOD'), '<?=GetMessage("EDIT2_LASTMOD_INFO")?>');</script></td>				<td><?=GetMessage("EDIT2_CHANGEFREQ")?></td>				<td><?=GetMessage("EDIT2_PRIORITY")?><span id="EDIT2_PRIORITY"></span><script type="text/javascript">BX.hint_replace(BX('EDIT2_PRIORITY'), '<?=GetMessage("EDIT2_PRIORITY_INFO")?>');</script></td>				<td><?=GetMessage("EDIT2_DEL")?></td>			</tr>			<?$key = -1; foreach($STATIC as $value){ $key++; 				if(!isset($value['CHANGEFREQ'])) $value['CHANGEFREQ'] = 'daily';				if(!isset($value['PRIORITY'])) $value['PRIORITY'] = '0.5';			?>				<tr>					<td align="center"><input type="text" name="STATIC[n<?=$key?>][LOC]" value="<?=$value['LOC']?>" size="60"></td>					<td align="center">						<div class="adm-input-wrap adm-input-wrap-calendar">							<input class="adm-input adm-input-calendar" type="text" name="STATIC[n<?=$key?>][LASTMOD]" size="22" value="<?=$value['LASTMOD']?>">							<span class="adm-calendar-icon" title="<?=GetMessage("EDIT2_LASTMOD_INFO1")?>" onclick="BX.calendar({node:this, field:'STATIC[n<?=$key?>][LASTMOD]', form: '', bTime: true, bHideTime: false});"></span>						</div>					</td>					<td align="center">						<select name="STATIC[n<?=$key?>][CHANGEFREQ]"> 							<?foreach($changefreq as $changefreq_k => $changefreq_v){?>								<option value="<?=$changefreq_k?>"<?=($changefreq_k==$value['CHANGEFREQ'])?" selected='selected'":"";?>><?=$changefreq_v?></option>									<?}?>						</select>					</td>					<td align="center"><input type="text" name="STATIC[n<?=$key?>][PRIORITY]" value="<?=$value['PRIORITY']?>" size="20"></td>					<td align="center">						<input type="checkbox" name="STATIC[n<?=$key?>][DEL]" value="Y" id="STATIC[n<?=$key?>][DEL]" class="adm-designed-checkbox">						<label class="adm-designed-checkbox-label" for="STATIC[n<?=$key?>][DEL]" title=""></label>										</td>				</tr>					<?} $key++; ?>			<tr>				<td align="center"><input type="text" name="STATIC[n<?=$key?>][LOC]" value="" size="60"></td>				<td align="center">					<div class="adm-input-wrap adm-input-wrap-calendar">						<input class="adm-input adm-input-calendar" type="text" name="STATIC[n<?=$key?>][LASTMOD]" size="22" value="">						<span class="adm-calendar-icon" title="<?=GetMessage("EDIT2_LASTMOD_INFO1")?>" onclick="BX.calendar({node:this, field:'STATIC[n<?=$key?>][LASTMOD]', form: '', bTime: true, bHideTime: false});"></span>					</div>				</td>				<td align="center">					<select name="STATIC[n<?=$key?>][CHANGEFREQ]"> 						<?foreach($changefreq as $changefreq_k => $changefreq_v){?>							<option value="<?=$changefreq_k?>"<?=($changefreq_k=='daily')?" selected='selected'":"";?>><?=$changefreq_v?></option>								<?}?>					</select>				</td>				<td align="center"><input type="text" name="STATIC[n<?=$key?>][PRIORITY]" value="0.5" size="20"></td>				<td align="center"></td>			</tr>			<tr>				<td align="center" colspan="6">					<input type="button" value="<?=GetMessage("BUT_ADD")?>" style="width: 60%;" onclick="addNewRow('STATICTABLE')">				</td>			</tr>		</table>	</td></tr><?$tabControl->BeginNextTab();?><tr>	<td align="center">		<table border="0" cellspacing="0" cellpadding="0" class="internal" id="IBLOCKTABLE">			<tr class="heading">				<td><?=GetMessage("EDIT3_IBLOCK")?></td>				<td colspan="2"><?=GetMessage("EDIT3_COLUMS")?><span id="EDIT3_COLUMS"></span><script type="text/javascript">BX.hint_replace(BX('EDIT3_COLUMS'), '<?=GetMessage("EDIT3_COLUMS_INFO")?>');</script></td>				<td><?=GetMessage("EDIT3_CHANGEFREQ_PRIORITY")?><span id="EDIT3_CHANGEFREQ_PRIORITY"></span><script type="text/javascript">BX.hint_replace(BX('EDIT3_CHANGEFREQ_PRIORITY'), '<?=GetMessage("EDIT3_CHANGEFREQ_PRIORITY_INFO")?>');</script></td>				<td><?=GetMessage("EDIT3_FILTER_SORT")?><span id="EDIT3_FILTER_SORT"></span><script type="text/javascript">BX.hint_replace(BX('EDIT3_FILTER_SORT'), '<?=GetMessage("EDIT3_FILTER_SORT_INFO")?>');</script></td>				<td><?=GetMessage("EDIT3_DEL")?></td>			</tr>			<?$key = -1; foreach($IBLOCK as $value){ $key++;?>				<tr>					<td align="center">						<select name="IBLOCK[n<?=$key?>][IBLOCK]"> 							<option></option>							<?foreach($IblockArray as $IblockId => $IblockName){?>								<option value="<?=$IblockId?>"<?=($value['IBLOCK']==$IblockId)?" selected='selected'":"";?>>[<?=$IblockId?>] <?=$IblockName?></option>									<?}?>						</select>									</td>					<td align="center">						<?=GetMessage("EDIT3_COLUMS_INFO1")?><br><br>						<input type="text" name="IBLOCK[n<?=$key?>][LOC]" value="<?=$value['LOC']?>" size="22">					</td>					<td align="center">						<?=GetMessage("EDIT3_COLUMS_INFO2")?><br><br>						<input type="text" name="IBLOCK[n<?=$key?>][LASTMOD_CODE]" value="<?=$value['LASTMOD_CODE']?>" size="22"><br>						<br><?=GetMessage("EDIT3_COLUMS_INFO3")?><br><br>						<div class="adm-input-wrap adm-input-wrap-calendar">							<input class="adm-input adm-input-calendar" type="text" name="IBLOCK[n<?=$key?>][LASTMOD]" size="22" value="<?=$value['LASTMOD']?>">							<span class="adm-calendar-icon" title="<?=GetMessage("EDIT3_COLUMS_INFO4")?>" onclick="BX.calendar({node:this, field:'IBLOCK[n<?=$key?>][LASTMOD]', form: '', bTime: true, bHideTime: false});"></span>						</div>					</td>									<td align="center">						<?=GetMessage("EDIT3_CHANGEFREQ_PRIORITY_INFO1")?><br><br>						<select name="IBLOCK[n<?=$key?>][CHANGEFREQ]"> 							<?foreach($changefreq as $changefreq_k => $changefreq_v){?>								<option value="<?=$changefreq_k?>"<?=($changefreq_k==$value['CHANGEFREQ'])?" selected='selected'":"";?>><?=$changefreq_v?></option>									<?}?>						</select><br>						<br><?=GetMessage("EDIT3_CHANGEFREQ_PRIORITY_INFO2")?><br><br>						<input type="text" name="IBLOCK[n<?=$key?>][PRIORITY]" value="<?=$value['PRIORITY']?>" size="20"> 					</td>					<td align="center">						<?=GetMessage("EDIT3_FILTER_SORT_INFO1")?><br><br>						<textarea name="IBLOCK[n<?=$key?>][FILTER]" style="width: 350px; height: 30px;"><?=$value['FILTER']?></textarea><br>						<br><?=GetMessage("EDIT3_FILTER_SORT_INFO2")?><br><br>						<textarea name="IBLOCK[n<?=$key?>][SORT]" style="width: 350px; height: 30px;"><?=$value['SORT']?></textarea>					</td>					<td align="center">						<input type="checkbox" name="IBLOCK[n<?=$key?>][DEL]" value="Y" id="IBLOCK[n<?=$key?>][DEL]" class="adm-designed-checkbox">						<label class="adm-designed-checkbox-label" for="IBLOCK[n<?=$key?>][DEL]" title=""></label>											</td>					</tr>			<?} $key++; ?>						<tr>				<td align="center">					<select name="IBLOCK[n<?=$key?>][IBLOCK]"> 						<option></option>						<?foreach($IblockArray as $IblockId => $IblockName){?>							<option value="<?=$IblockId?>">[<?=$IblockId?>] <?=$IblockName?></option>								<?}?>					</select>								</td>				<td align="center">					<?=GetMessage("EDIT3_COLUMS_INFO1")?><br><br>					<input type="text" name="IBLOCK[n<?=$key?>][LOC]" value="DETAIL_PAGE_URL" size="22">				</td>				<td align="center">					<?=GetMessage("EDIT3_COLUMS_INFO2")?><br><br>					<input type="text" name="IBLOCK[n<?=$key?>][LASTMOD_CODE]" value="DATE_ACTIVE_FROM" size="22"><br>					<br><?=GetMessage("EDIT3_COLUMS_INFO3")?><br><br>					<div class="adm-input-wrap adm-input-wrap-calendar">						<input class="adm-input adm-input-calendar" type="text" name="IBLOCK[n<?=$key?>][LASTMOD]" size="22" value="">						<span class="adm-calendar-icon" title="<?=GetMessage("EDIT3_COLUMS_INFO4")?>" onclick="BX.calendar({node:this, field:'IBLOCK[n<?=$key?>][LASTMOD]', form: '', bTime: true, bHideTime: false});"></span>					</div>				</td>								<td align="center">					<?=GetMessage("EDIT3_CHANGEFREQ_PRIORITY_INFO1")?><br><br>					<select name="IBLOCK[n<?=$key?>][CHANGEFREQ]"> 						<?foreach($changefreq as $changefreq_k => $changefreq_v){?>							<option value="<?=$changefreq_k?>"<?=($changefreq_k=='daily')?" selected='selected'":"";?>><?=$changefreq_v?></option>								<?}?>					</select><br>					<br><?=GetMessage("EDIT3_CHANGEFREQ_PRIORITY_INFO2")?><br><br>					<input type="text" name="IBLOCK[n<?=$key?>][PRIORITY]" value="0.5" size="20"> 				</td>				<td align="center">					<?=GetMessage("EDIT3_FILTER_SORT_INFO1")?><br><br>					<textarea name="IBLOCK[n<?=$key?>][FILTER]" style="width: 350px; height: 30px;">ACTIVE=Y,ACTIVE_DATE=Y</textarea><br>					<br><?=GetMessage("EDIT3_FILTER_SORT_INFO2")?><br><br>					<textarea name="IBLOCK[n<?=$key?>][SORT]" style="width: 350px; height: 30px;">SORT=ASC</textarea>				</td>				<td align="center"></td>			</tr>			<tr>				<td align="center" colspan="6">					<input type="button" value="<?=GetMessage("BUT_ADD")?>" style="width: 60%;" onclick="addNewRow('IBLOCKTABLE')">				</td>			</tr>		</table>	</td></tr><?$tabControl->BeginNextTab();?><?require_once($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/main/admin/group_rights2.php");?><?$tabControl->Buttons();?><script>	function RestoreDefaults(){		if(confirm('<?=AddSlashes(GetMessage("BUT_DEFAULTS_WARNING"))?>'))			window.location = "<?= $APPLICATION->GetCurPage()?>?RestoreDefaults=Y&lang=<?=LANG?>&mid=<?=urlencode($mid)?>&<?=bitrix_sessid_get()?>&mid_menu=1";	}	function GoGenerator(){		if(confirm('<?=AddSlashes(GetMessage("BUT_GENERATOR_WARNING"))?>'))			window.location = "/bitrix/admin/byteeightlab_sitemap_generator.php?lang=<?=LANG?>";	}	</script><input type="submit" <?if (!$USER->CanDoOperation('byteeightlab_sitemap_edit_all_settings')) echo "disabled" ?> name="Update" value="<?=GetMessage('BUT_SAVE')?>"><input type="reset" name="reset" value="<?=GetMessage('BUT_RESRT')?>"><input type="hidden" name="Update" value="Y"><input <?if (!$USER->CanDoOperation('byteeightlab_sitemap_edit_all_settings')) echo "disabled" ?> type="button" OnClick="RestoreDefaults();" value="<?=GetMessage('BUT_DEFAULTS')?>"><input type="button" OnClick="GoGenerator();" value="<?=GetMessage('BUT_GENERATOR')?>" class="adm-btn-save"><?$tabControl->End();?></form><div class="adm-info-message" align="left">	<h3 style="margin-top: 0;"><?=GetMessage("EDIT1_DOC_TITLE")?></h3>	<p><?=GetMessage("EDIT1_DOC")?></p></div><script>function addNewRow(tableID, row_to_clone){	var tbl = document.getElementById(tableID);	var cnt = tbl.rows.length;	if(row_to_clone == null)		row_to_clone = -2;		var oRow = tbl.insertRow(cnt+row_to_clone+1);	for(var i = tbl.rows[cnt+row_to_clone].cells.length-1; i>=0; i--){		var sHTML = tbl.rows[cnt+row_to_clone].cells[i].innerHTML;		var oCell = oRow.insertCell(0);				oCell.align = tbl.rows[cnt+row_to_clone].cells[i].align;		var s, e, n, p;		p = 0;		while(true)		{			s = sHTML.indexOf('[n',p);			if(s<0)break;			e = sHTML.indexOf(']',s);			if(e<0)break;			n = parseInt(sHTML.substr(s+2,e-s));			sHTML = sHTML.substr(0, s)+'[n'+(++n)+']'+sHTML.substr(e+1);			p=s+1;		}		p = 0;		while(true)		{			s = sHTML.indexOf('__n',p);			if(s<0)break;			e = sHTML.indexOf('_',s+2);			if(e<0)break;			n = parseInt(sHTML.substr(s+3,e-s));			sHTML = sHTML.substr(0, s)+'__n'+(++n)+'_'+sHTML.substr(e+1);			p=e+1;		}		p = 0;		while(true)		{			s = sHTML.indexOf('__N',p);			if(s<0)break;			e = sHTML.indexOf('__',s+2);			if(e<0)break;			n = parseInt(sHTML.substr(s+3,e-s));			sHTML = sHTML.substr(0, s)+'__N'+(++n)+'__'+sHTML.substr(e+2);			p=e+2;		}		p = 0;		while(true)		{			s = sHTML.indexOf('xxn',p);			if(s<0)break;			e = sHTML.indexOf('xx',s+2);			if(e<0)break;			n = parseInt(sHTML.substr(s+3,e-s));			sHTML = sHTML.substr(0, s)+'xxn'+(++n)+'xx'+sHTML.substr(e+2);			p=e+2;		}		p = 0;		while(true)		{			s = sHTML.indexOf('%5Bn',p);			if(s<0)break;			e = sHTML.indexOf('%5D',s+3);			if(e<0)break;			n = parseInt(sHTML.substr(s+4,e-s));			sHTML = sHTML.substr(0, s)+'%5Bn'+(++n)+'%5D'+sHTML.substr(e+3);			p=e+3;		}		oCell.innerHTML = sHTML;	}		var patt = new RegExp ("<"+"script"+">[^\000]*?<"+"\/"+"script"+">", "ig");	var code = sHTML.match(patt);	if(code)	{		for(var i = 0; i < code.length; i++)		{			if(code[i] != '')			{				s = code[i].substring(8, code[i].length-9);				jsUtils.EvalGlobal(s);			}		}	}	if (BX && BX.adminPanel)	{		BX.adminPanel.modifyFormElements(oRow);		BX.onCustomEvent('onAdminTabsChange');	}	setTimeout(function() {		var r = BX.findChildren(oCell, {tag: /^(input|select|textarea)$/i});		if (r && r.length > 0)		{			for (var i=0,l=r.length;i<l;i++)			{				if (r[i].form && r[i].form.BXAUTOSAVE)					r[i].form.BXAUTOSAVE.RegisterInput(r[i]);				else					break;			}		}	}, 10);}</script>