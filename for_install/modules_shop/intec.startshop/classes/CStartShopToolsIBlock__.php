<? $GLOBALS['_1099281248_']=Array('is_ar' .'ra' .'y','is_nume' .'ri' .'c','' .'is_numer' .'ic','i' .'s_n' .'umeric','is_ar' .'ray','is_a' .'r' .'r' .'a' .'y','is_' .'num' .'e' .'ric','fl' .'oatval','f' .'loatval','f' .'l' .'oatval','int' .'val','in_arr' .'ay','preg_match','' .'preg_q' .'uote','in_array','' .'preg_ma' .'tch','' .'p' .'r' .'eg_quo' .'te','in_array','is' .'_array','is_array','e' .'xec','in_a' .'rray','' .'in_ar' .'ray','i' .'n_arr' .'a' .'y','' .'array_merge','intval','intval','i' .'ntv' .'al','is_' .'numeric','' .'intval','' .'intval','' .'is' .'_' .'n' .'umeri' .'c','in' .'t' .'val','flo' .'atval','floatv' .'al','i' .'s_ar' .'r' .'ay','is_' .'numeric','floatva' .'l'); ?><? function _537036741($i){$a=Array('PREVIEW_PICTURE','DETAIL_PICTURE','PREVIEW_PICTURE','PREVIEW_PICTURE','DETAIL_PICTURE','DETAIL_PICTURE','DETAIL_PICTURE','DETAIL_PICTURE','PREVIEW_PICTURE','PREVIEW_PICTURE','ID','ID','SRC','src','HEIGHT','height','WIDTH','width','SRC','PROPERTIES','PROPERTIES','_','ID','PROPERTIES','_','ID','VALUE','PROPERTIES','_','ID','VALUE_XML_ID','TYPE','CODE','TYPE','CODE',"NAME",'N',"PROPERTY_TYPE","N","USER_TYPE","","IS_REQUIRED","Y","MULTIPLE","N","DEFAULT_VALUE","SMART_FILTER","N",'IBLOCK_ID','CODE',"NAME",'N',"PROPERTY_TYPE","N","USER_TYPE","","IS_REQUIRED","Y","MULTIPLE","N","DEFAULT_VALUE","SMART_FILTER","N",'IBLOCK_ID','CODE','_','ID',"NAME",'N',"PROPERTY_TYPE","L","LIST_TYPE","L","USER_TYPE","","IS_REQUIRED","N","MULTIPLE","N","DEFAULT_VALUE","SMART_FILTER","N",'ID','IBLOCK_ID','CODE','XML_ID','CODE',"VALUE",'[','CODE','] ','LANG','NAME',"DEF",'BASE',"SORT",'SORT','PROPERTY_ID','XML_ID','CODE','CODE','XML_ID','ID','_','ID',"NAME",'LANG','NAME',"SORT","ACTIVE",'ACTIVE',"PROPERTY_TYPE","N","USER_TYPE","","IS_REQUIRED","N","MULTIPLE","N","DEFAULT_VALUE","SMART_FILTER","Y","DISPLAY_TYPE","A",'IBLOCK_ID','CODE','/^(',')/','CODE','CODE','ID','/^(',')/','CODE','CODE','ID','STARTSHOP','OFFERS','STARTSHOP','OFFERS','STARTSHOP','PRICES','MINIMAL','VALUE','VALUE','STARTSHOP','PRICES','MINIMAL','OFFERS_IBLOCK','OFFERS_LINK_PROPERTY','OFFERS_PROPERTIES','OFFERS_PROPERTIES','PROPERTY_TYPE',"L",'USER_TYPE','MULTIPLE',"N","ID",'ID',"CODE","CODE","NAME",'NAME',"TYPE","TEXT","VALUES","XML_ID",'VALUES',"XML_ID","ID","ID","CODE","XML_ID","TEXT","VALUE",'PROPERTY_TYPE',"S",'USER_TYPE',"directory",'MULTIPLE',"N","filter","TABLE_NAME",'USER_TYPE_SETTINGS','TABLE_NAME','*','UF_XML_ID','UF_NAME','UF_FILE',"ID",'ID',"CODE","CODE","NAME",'NAME',"TYPE","PICTURE","VALUES","VALUES","UF_XML_ID","ID","ID","CODE","UF_XML_ID","TEXT","UF_NAME","PICTURE","ID",'ID',"CODE","CODE","NAME",'NAME',"TYPE","TEXT","VALUES","VALUES","UF_XML_ID","ID","ID","CODE","UF_XML_ID","TEXT","UF_NAME",'PROPERTY_TYPE',"L",'USER_TYPE','VALUE','VALUES','VALUE_XML_ID','VALUES','PROPERTY_TYPE',"S",'USER_TYPE',"directory",'VALUE','VALUES','VALUE','VALUES','VALUE','PROPERTIES','OFFERS','STARTSHOP','OFFER','PROPERTIES','PROPERTIES','STARTSHOP','OFFERS',"ID",'ID','STARTSHOP','DATA','DATA','STARTSHOP','OFFERS','ID',"OFFERS_IBLOCK","OFFERS_LINK_PROPERTY","PROPERTY_TYPE","E","USER_TYPE","MULTIPLE","N","ACTIVE","Y","ACTIVE","Y","MULTIPLE","N","ACTIVE","Y","USER_TYPE_ID","string","MULTIPLE","N","ID",'OFFERS_IBLOCK','OFFERS_LINK_PROPERTY','OFFERS_IBLOCK','OFFERS_LINK_PROPERTY','OFFERS_IBLOCK','OFFERS_LINK_PROPERTY','OFFERS_IBLOCK','OFFERS_LINK_PROPERTY','ID','IBLOCK_ID','ID','IBLOCK_ID','_','ID','_','ID',"",'ID',"",'ID','IBLOCK_ID');return $a[$i];} ?><? IncludeModuleLangFile(__FILE__);use Bitrix\Highloadblock as HLBlock;use Bitrix\Main\Entity;class CStartShopToolsIBlock{private static $PrefixQuantity="STARTSHOP_QUANTITY";private static $PrefixQuantityRatio="STARTSHOP_QUANTITY_RATIO";private static $PrefixPrice="STARTSHOP_PRICE";private static $PrefixCurrency="STARTSHOP_CURRENCY";private static $PrefixPictures="STARTSHOP_PICTURES";private static $PrefixArticle="STARTSHOP_ARTICLE";private static $PrefixTraits="STARTSHOP_TRAITS";private static $PrefixOfferLink="STARTSHOP_OFFER_LINK";private static $PrefixUserExternalId="STARTSHOP_USERID";public static function GetQuantityPrefix(){return static::$PrefixQuantity;}public static function GetQuantityRatioPrefix(){return static::$PrefixQuantityRatio;}public static function GetPricePrefix(){return static::$PrefixPrice;}public static function GetCurrencyPrefix(){return static::$PrefixCurrency;}public static function GetPicturesPrefix(){return static::$PrefixPictures;}public static function GetArticlePrefix(){return static::$PrefixArticle;}public static function GetTraitsPrefix(){return static::$PrefixTraits;}public static function GetItemPicture($_0,$_1=false,$_2=false,$_3=false,$_4=BX_RESIZE_IMAGE_PROPORTIONAL_ALT){$_5=array();if(!empty($_0[_537036741(0)])||!empty($_0[_537036741(1)])){if($_3){if(!empty($_0[_537036741(2)]))$_5=$_0[_537036741(3)];if(empty($_5)&&!empty($_0[_537036741(4)]))$_5=$_0[_537036741(5)];}else{if(!empty($_0[_537036741(6)]))$_5=$_0[_537036741(7)];if(empty($_5)&&!empty($_0[_537036741(8)]))$_5=$_0[_537036741(9)];}if($GLOBALS['_1099281248_'][0]($_5))if($GLOBALS['_1099281248_'][1]($_5[_537036741(10)])){$_5=$_5[_537036741(11)];}else{$_5=array();}if(!empty($_5)){$_5=CFile::GetByID($_5)->Fetch();if(!empty($_5)){if($GLOBALS['_1099281248_'][2]($_1)&& $GLOBALS['_1099281248_'][3]($_2)){$_6=CFile::ResizeImageGet($_5['ID'],array("width"=> $_1,"height"=> $_2),$_4,true);$_5[_537036741(12)]=$_6[_537036741(13)];$_5[_537036741(14)]=$_6[_537036741(15)];$_5[_537036741(16)]=$_6[_537036741(17)];}else{$_5[_537036741(18)]=CFile::GetPath($_5['ID']);}}else{$_5=array();}}else{$_5=array();}}CStartShopEvents::Call('OnToolsIBlockItemPictureGet',array('ITEM'=> $_0,'WIDTH'=> $_1,'HEIGHT'=> $_2,'PREVIEW_MAIN'=> $_3,'RESIZE_MODE'=> $_4,'PICTURE'=>&$_5));return $_5;}public static function GetPricesValues($_0,$_7,$_8=null,$_9=LANGUAGE_ID){$_10=array();if(!$GLOBALS['_1099281248_'][4]($_0)||!$GLOBALS['_1099281248_'][5]($_7)|| empty($_7)|| empty($_0[_537036741(19)]))return $_10;foreach($_7 as $_11){if(!empty($_0[_537036741(20)][static::$PrefixPrice ._537036741(21) .$_11[_537036741(22)]])){$_12=$_0[_537036741(23)][static::$PrefixPrice ._537036741(24) .$_11[_537036741(25)]][_537036741(26)];$_13=$_0[_537036741(27)][static::$PrefixCurrency ._537036741(28) .$_11[_537036741(29)]][_537036741(30)];if(!$GLOBALS['_1099281248_'][6]($_12))continue;$_12=$GLOBALS['_1099281248_'][7]($_12);if(!empty($_8)){$_14=CStartShopCurrency::ConvertAndFormatAsArray($_12,$_13,$_8,$_9);}else{$_14=CStartShopCurrency::FormatAsArray($_12,$_13,$_9);}$_14[_537036741(31)]=$_11[_537036741(32)];$_10[$_14[_537036741(33)]]=$_14;}}CStartShopEvents::Call('OnToolsIBlockPricesValuesGet',array('ITEM'=> $_0,'PRICES'=> $_7,'LANGUAGE_ID'=> $_9,'VALUES'=>&$_10));return $_10;}public static function GetQuantityValue($_0){$_15=$GLOBALS['_1099281248_'][8]($_0['PROPERTIES'][static::$PrefixQuantity]['VALUE']);CStartShopEvents::Call('OnToolsIBlockQuantityValueGet',array('ITEM'=> $_0,'VALUE'=>&$_15));return $_15;}public static function GetQuantityRatioValue($_0){$_15=$GLOBALS['_1099281248_'][9]($_0['PROPERTIES'][static::$PrefixQuantityRatio]['VALUE']);CStartShopEvents::Call('OnToolsIBlockQuantityRatioValueGet',array('ITEM'=> $_0,'VALUE'=>&$_15));return $_15;}public static function UpdateProperties($_16,$_9=LANGUAGE_ID){if(!CModule::IncludeModule('iblock'))return false;$_16=$GLOBALS['_1099281248_'][10]($_16);if(CStartShopCatalog::IsValid($_16)){$_17=round(0+0.2+0.2+0.2+0.2+0.2);$_18=array();$_19=CIBlockProperty::GetList(array(),array('IBLOCK_ID'=> $_16));while($_20=$_19->Fetch())$_18[$_20[_537036741(34)]]=$_20;$_21=$_18[static::$PrefixQuantity];$_22=array(_537036741(35)=> GetMessage('cstartshoptoolsiblock.properties.quantity'),"SORT"=> $_17++,"ACTIVE"=> CStartShopCatalog::IsUseQuantity($_16)?'Y':_537036741(36),_537036741(37)=> _537036741(38),_537036741(39)=> _537036741(40),_537036741(41)=> _537036741(42),_537036741(43)=> _537036741(44),_537036741(45)=> round(0),_537036741(46)=> _537036741(47));if(!empty($_21)){$_23=new CIBlockProperty();$_23->Update($_21['ID'],$_22);}else{$_23=new CIBlockProperty();$_22[_537036741(48)]=$_16;$_22[_537036741(49)]=static::$PrefixQuantity;$_23->Add($_22);}$_24=$_18[static::$PrefixQuantityRatio];$_25=array(_537036741(50)=> GetMessage('cstartshoptoolsiblock.properties.quantity_ratio'),"SORT"=> $_17++,"ACTIVE"=> 'Y',_537036741(52)=> _537036741(53),_537036741(54)=> _537036741(55),_537036741(56)=> _537036741(57),_537036741(58)=> _537036741(59),_537036741(60)=> round(0+1),_537036741(61)=> _537036741(62));if(!empty($_24)){$_23=new CIBlockProperty();$_23->Update($_24['ID'],$_25);}else{$_23=new CIBlockProperty();$_25[_537036741(63)]=$_16;$_25[_537036741(64)]=static::$PrefixQuantityRatio;$_23->Add($_25);}$_26=array();$_27=CStartShopPrice::GetList(array('SORT'=> 'ASC'));while($_28=$_27->Fetch())$_26[]=$_28;$_29=array();$_30=CStartShopCurrency::GetList(array('SORT'=> 'ASC'),array('ACTIVE'=> 'Y'));while($_31=$_30->Fetch())$_29[]=$_31;$_32=array();$_33=array();foreach($_26 as $_28){$_34=static::$PrefixCurrency ._537036741(65) .$_28[_537036741(66)];$_35=$_18[$_34];$_36=array(_537036741(67)=> GetMessage('cstartshoptoolsiblock.properties.currency',array('#PRICE_TYPE#'=> $_28['LANG'][$_9]['NAME'])),"SORT"=> $_17++,"ACTIVE"=>!empty($_29)?'Y':_537036741(68),_537036741(69)=> _537036741(70),_537036741(71)=> _537036741(72),_537036741(73)=> _537036741(74),_537036741(75)=> _537036741(76),_537036741(77)=> _537036741(78),_537036741(79)=> round(0),_537036741(80)=> _537036741(81));if(!empty($_35)){$_23=new CIBlockProperty();$_23->Update($_35['ID'],$_36);$_37=$_35[_537036741(82)];}else{$_23=new CIBlockProperty();$_36[_537036741(83)]=$_16;$_36[_537036741(84)]=$_34;$_37=$_23->Add($_36);}$_33[]=$_34;if(!empty($_37)){$_38=array();$_39=array();$_40=CIBlockPropertyEnum::GetList(array(),array('PROPERTY_ID'=> $_37));while($_41=$_40->Fetch())$_39[$_41[_537036741(85)]]=$_41;foreach($_29 as $_31){$_42=$_39[$_31[_537036741(86)]];$_43=new CIBlockPropertyEnum();$_44=array(_537036741(87)=> _537036741(88) .$_31[_537036741(89)] ._537036741(90) .$_31[_537036741(91)][$_9][_537036741(92)],_537036741(93)=> $_31[_537036741(94)],_537036741(95)=> $_31[_537036741(96)]);if(!empty($_42)){$_43->Update($_42['ID'],$_44);}else{$_44[_537036741(97)]=$_37;$_44[_537036741(98)]=$_31[_537036741(99)];$_43->Add($_44);}$_38[]=$_31[_537036741(100)];}foreach($_39 as $_41)if(!$GLOBALS['_1099281248_'][11]($_41[_537036741(101)],$_38))CIBlockPropertyEnum::Delete($_41[_537036741(102)]);}$_45=static::$PrefixPrice ._537036741(103) .$_28[_537036741(104)];$_46=$_18[$_45];$_47=array(_537036741(105)=> $_28[_537036741(106)][LANGUAGE_ID][_537036741(107)],_537036741(108)=> $_17++,_537036741(109)=> $_28[_537036741(110)],_537036741(111)=> _537036741(112),_537036741(113)=> _537036741(114),_537036741(115)=> _537036741(116),_537036741(117)=> _537036741(118),_537036741(119)=> round(0),_537036741(120)=> _537036741(121),_537036741(122)=> _537036741(123));if(!empty($_46)){$_23=new CIBlockProperty();$_23->Update($_46['ID'],$_47);}else{$_23=new CIBlockProperty();$_47[_537036741(124)]=$_16;$_47[_537036741(125)]=$_45;$_23->Add($_47);}$_32[]=$_45;}foreach($_18 as $_20){if($GLOBALS['_1099281248_'][12](_537036741(126) .$GLOBALS['_1099281248_'][13](static::$PrefixPrice) ._537036741(127),$_20[_537036741(128)]))if(!$GLOBALS['_1099281248_'][14]($_20[_537036741(129)],$_32))CIBlockProperty::Delete($_20[_537036741(130)]);if($GLOBALS['_1099281248_'][15](_537036741(131) .$GLOBALS['_1099281248_'][16](static::$PrefixCurrency) ._537036741(132),$_20[_537036741(133)]))if(!$GLOBALS['_1099281248_'][17]($_20[_537036741(134)],$_33))CIBlockProperty::Delete($_20[_537036741(135)]);}CStartShopEvents::Call('OnToolsIBlockUpdateProperties',array('IBLOCK'=> $_16,'LANGUAGE_ID'=> $_9));}}public static function UpdatePropertiesAll(){$_48=CStartShopCatalog::GetList();while($_49=$_48->Fetch()){static::UpdateProperties($_49['IBLOCK']);static::UpdateProperties($_49['OFFERS_IBLOCK']);}CStartShopEvents::Call('OnToolsIBlockUpdatePropertiesAll');}public static function GetOffersMinPrice($_0){$_50=array();if(!empty($_0[_537036741(136)][_537036741(137)]))foreach($_0[_537036741(138)][_537036741(139)]as $_51)if(empty($_50)|| $_51[_537036741(140)][_537036741(141)][_537036741(142)][_537036741(143)]<$_50[_537036741(144)])$_50=$_51[_537036741(145)][_537036741(146)][_537036741(147)];return $_50;}public static function GetOffersProperties($_52){if(!$GLOBALS['_1099281248_'][18]($_52)|| empty($_52))return CStartShopUtil::ArrayToDBResult(array());$_53=array();foreach($_52 as $_49)if(!empty($_49[_537036741(148)])&&!empty($_49[_537036741(149)])&& $GLOBALS['_1099281248_'][19]($_49[_537036741(150)]))foreach($_49[_537036741(151)]as $_54){$_55=CIBlockProperty::GetByID($_54)->Fetch();if(!empty($_55)){$_56=array();if($_55[_537036741(152)]== _537036741(153)&& $_55[_537036741(154)]== null && $_55[_537036741(155)]== _537036741(156)){$_56=array(_537036741(157)=> $_55[_537036741(158)],_537036741(159)=> $_55[_537036741(160)],_537036741(161)=> $_55[_537036741(162)],_537036741(163)=> _537036741(164),_537036741(165)=> array());$_57=CStartShopUtil::DBResultToArray(CIBlockPropertyEnum::GetList(array(),array("PROPERTY_ID"=> $_55['ID'])));foreach($_57 as $_58)if(!empty($_58[_537036741(166)]))$_56[_537036741(167)][$_58[_537036741(168)]]=array(_537036741(169)=> $_58[_537036741(170)],_537036741(171)=> $_58[_537036741(172)],_537036741(173)=> $_58[_537036741(174)]);}else if($_55[_537036741(175)]== _537036741(176)&& $_55[_537036741(177)]== _537036741(178)&& $_55[_537036741(179)]== _537036741(180)&& CModule::IncludeModule("highloadblock")){$_59=HLBlock\HighloadBlockTable::getList(array(_537036741(181)=> array(_537036741(182)=> $_55[_537036741(183)][_537036741(184)])))->Fetch();if(!empty($_59)){$_60=HLBlock\HighloadBlockTable::compileEntity($_59);$_61=$_60->getDataClass();$_62=$_60->getFields();$_63=array();foreach($_62 as $_64)$_63[]=$_64->getName();$_65=new Entity\Query($_61);$_65->setSelect(array(_537036741(185)));$_66=$_65->$GLOBALS['_1099281248_'][20]();$_57=array();while($_58=$_66->Fetch())$_57[]=$_58;if($GLOBALS['_1099281248_'][21](_537036741(186),$_63)&& $GLOBALS['_1099281248_'][22](_537036741(187),$_63))if($GLOBALS['_1099281248_'][23](_537036741(188),$_63)){$_56=array(_537036741(189)=> $_55[_537036741(190)],_537036741(191)=> $_55[_537036741(192)],_537036741(193)=> $_55[_537036741(194)],_537036741(195)=> _537036741(196),_537036741(197)=> array());foreach($_57 as $_58){$_67=CFile::GetPath($_58["UF_FILE"]);$_56[_537036741(198)][$_58[_537036741(199)]]=array(_537036741(200)=> $_58[_537036741(201)],_537036741(202)=> $_58[_537036741(203)],_537036741(204)=> $_58[_537036741(205)],_537036741(206)=>(!empty($_67)?$_67:null));}}else{$_56=array(_537036741(207)=> $_55[_537036741(208)],_537036741(209)=> $_55[_537036741(210)],_537036741(211)=> $_55[_537036741(212)],_537036741(213)=> _537036741(214),_537036741(215)=> array());foreach($_57 as $_58){$_56[_537036741(216)][$_58[_537036741(217)]]=array(_537036741(218)=> $_58[_537036741(219)],_537036741(220)=> $_58[_537036741(221)],_537036741(222)=> $_58[_537036741(223)]);}}}}if(!empty($_56))$_53[]=$_56;}}return CStartShopUtil::ArrayToDBResult($_53);}public static function ConvertToOfferProperty($_55,$_53,$_68='ID'){$_69=array();if(!empty($_68)){$_70=$_53[$_55[$_68]];if(!empty($_70))if($_55[_537036741(224)]== _537036741(225)&& $_55[_537036741(226)]== null){$_69=$_53[$_55[$_68]];$_69[_537036741(227)]=$_69[_537036741(228)][$_55[_537036741(229)]];unset($_69[_537036741(230)]);}else if($_55[_537036741(231)]== _537036741(232)&& $_55[_537036741(233)]== _537036741(234)){$_69=$_53[$_55[$_68]];$_69[_537036741(235)]=$_69[_537036741(236)][$_55[_537036741(237)]];unset($_69[_537036741(238)]);}}if(empty($_69[_537036741(239)]))$_69=array();return $_69;}public static function GetOffersJSStructure($_0){$_71=array();$_71[_537036741(240)]=array();$_71[_537036741(241)]=array();foreach($_0[_537036741(242)][_537036741(243)][_537036741(244)]as $_55){$_71[_537036741(245)][]=$_55;}foreach($_0[_537036741(246)][_537036741(247)]as $_51){$_72=$GLOBALS['_1099281248_'][24](array(_537036741(248)=> $_51[_537036741(249)]),$_51[_537036741(250)]);$_72[_537036741(251)]=$_51;unset($_72[_537036741(252)][_537036741(253)]);$_71[_537036741(254)][$_51[_537036741(255)]]=$_72;unset($_72);}return $_71;}public static function CheckOffersLink($_16,$_73=false){$_49=CStartShopCatalog::GetByIBlock($GLOBALS['_1099281248_'][25]($_16))->Fetch();if(empty($_49))$_49=CStartShopCatalog::GetByOffersIBlock($GLOBALS['_1099281248_'][26]($_16))->Fetch();if(!empty($_49)){$_74=false;if(!empty($_49[_537036741(256)]))if(CIBlock::GetByID($_49["OFFERS_IBLOCK"])->Fetch())if(!empty($_49[_537036741(257)])){$_75=CIBlockProperty::GetByID($_49["OFFERS_LINK_PROPERTY"])->Fetch();if(!empty($_75)){if($_75[_537036741(258)]== _537036741(259)&& empty($_75[_537036741(260)])&& $_75[_537036741(261)]== _537036741(262)&& $_75[_537036741(263)]== _537036741(264)){return $_75;}else{$_23=new CIBlockElement();$_23->Update($_75['ID'],array("PROPERTY_TYPE"=> "E","USER_TYPE"=> false,_537036741(265)=> _537036741(266)));if(empty($_23->_76)){unset($_23);return $_75;}$_74=true;unset($_23);}}else{$_74=true;}}else{$_74=true;}if($_74 && $_73){$_23=new CIBlockProperty();$_77=$_23->Add(array("IBLOCK_ID"=> $_49["OFFERS_IBLOCK"],"NAME"=> GetMessage("cstartshoptoolsiblock.properties.offers_link_property"),"CODE"=> static::$PrefixOfferLink,"PROPERTY_TYPE"=> "E","USER_TYPE"=> false,_537036741(267)=> _537036741(268),_537036741(269)=> _537036741(270)));if(!empty($_77)&& empty($_23->_76)){CStartShopCatalog::Update($_49['IBLOCK'],array('OFFERS_LINK_PROPERTY'=> $_77));unset($_23);return CIBlockElement::GetByID($_77)->Fetch();}unset($_23);}}return null;}public static function CheckUserFieldExternalId(){$_78=new CUserTypeEntity();$_79=$_78->GetList(array(),array("ENTITY_ID"=> "USER","USER_TYPE_ID"=> "string","FIELD_NAME"=> "UF_" .static::$PrefixUserExternalId))->Fetch();if(!empty($_79)){if($_79[_537036741(271)]== _537036741(272)&& $_79[_537036741(273)]== _537036741(274)){return $_79;}else{$_78->Delete($_79[_537036741(275)]);}}$_80=$_78->Add(array("ENTITY_ID"=> "USER","FIELD_NAME"=> "UF_" .static::$PrefixUserExternalId,"USER_TYPE_ID"=> "string","MULTIPLE"=> "N","MANDATORY"=> "N","SHOW_FILTER"=> "N","IS_SEARCHABLE"=> "N","SHOW_IN_LIST"=> "","EDIT_IN_LIST"=> "","XML_ID"=> static::$PrefixUserExternalId,"SETTINGS"=> array('DEFAULT_VALUE'=> '','SIZE'=> '20','ROWS'=> '1','MIN_LENGTH'=> '0','MAX_LENGTH'=> '0','REGEXP'=> '',)));if(!empty($_80))return $_78->GetByID($_80);return false;}public static function SetOffersLinkByOffersIBlock($_16,$_81,$_82){$_49=CStartShopCatalog::GetByOffersIBlock($GLOBALS['_1099281248_'][27]($_16))->Fetch();if(!empty($_49)&& $GLOBALS['_1099281248_'][28]($_81)&&!empty($_81)){if(!empty($_49[_537036741(276)])&&!empty($_49[_537036741(277)]))CIBlockElement::SetPropertyValuesEx($_81,$_49[_537036741(278)],array($_49[_537036741(279)]=> $GLOBALS['_1099281248_'][29]($_82)));}}public static function SetOffersLinkByIBlock($_16,$_81,$_82){$_49=CStartShopCatalog::GetByIBlock($GLOBALS['_1099281248_'][30]($_16))->Fetch();if(!empty($_49)&& $GLOBALS['_1099281248_'][31]($_81)&&!empty($_81)){if(!empty($_49[_537036741(280)])&&!empty($_49[_537036741(281)]))CIBlockElement::SetPropertyValuesEx($_81,$_49[_537036741(282)],array($_49[_537036741(283)]=> $GLOBALS['_1099281248_'][32]($_82)));}}public static function SetQuantity($_81,$_83){$_0=CIBlockElement::GetByID($_81)->Fetch();$_83=$GLOBALS['_1099281248_'][33]($_83);if(!empty($_0))CIBlockElement::SetPropertyValuesEx($_0[_537036741(284)],$_0[_537036741(285)],array(static::$PrefixQuantity => $_83));}public static function SetQuantityRatio($_81,$_84){$_0=CIBlockElement::GetByID($_81)->Fetch();$_84=$GLOBALS['_1099281248_'][34]($_84);if(!empty($_0))CIBlockElement::SetPropertyValuesEx($_0[_537036741(286)],$_0[_537036741(287)],array(static::$PrefixQuantityRatio => $_84));}public static function SetPriceCurrency($_81,$_85,$_86){static::SetPrice($_81,array($_85),false,$_86);}public static function SetPriceValue($_81,$_85,$_12){static::SetPrice($_81,array($_85),$_12,false);}public static function SetPrice($_81,$_85,$_12,$_86){static::SetPrices($_81,array($_85),$_12,$_86);}public static function SetPrices($_81,$_26=null,$_12=false,$_86=false){$_0=CIBlockElement::GetByID($_81)->Fetch();$_31=array();if(!empty($_86)&& $_86 !== null){$_31=CStartShopCurrency::GetByCode($_86)->Fetch();}else if($_86 !== false && $_86 !== null){$_31=CStartShopCurrency::GetBase()->Fetch();}if($GLOBALS['_1099281248_'][35]($_26)&&!empty($_26)){$_26=CStartShopUtil::DBResultToArray(CStartShopPrice::GetList(array(),array('CODE'=> $_26)));}else{$_26=CStartShopUtil::DBResultToArray(CStartShopPrice::GetList());}$_87=CStartShopUtil::DBResultToArray(CIBlockProperty::GetList(array(),array('IBLOCK_ID'=> $_0['IBLOCK_ID'])),'CODE');$_88=array();if(!empty($_0)&&!empty($_26))foreach($_26 as $_28){$_45=static::$PrefixPrice ._537036741(288) .$_28[_537036741(289)];$_34=static::$PrefixCurrency ._537036741(290) .$_28[_537036741(291)];if($GLOBALS['_1099281248_'][36]($_12)){$_88[$_45]=$GLOBALS['_1099281248_'][37]($_12);}else if($_12 === null){$_88[$_45]=_537036741(292);}if(!empty($_31)){$_55=$_87[$_34];if(!empty($_55)){$_89=CIBlockPropertyEnum::GetList(array(),array('PROPERTY_ID'=> $_55['ID'],'XML_ID'=> $_31['CODE']))->Fetch();if(!empty($_89))$_88[$_34]=$_89[_537036741(293)];}}else if($_86 === null){$_88[$_34]=_537036741(294);}}if(!empty($_88))CIBlockElement::SetPropertyValuesEx($_0[_537036741(295)],$_0[_537036741(296)],$_88);}} ?>
