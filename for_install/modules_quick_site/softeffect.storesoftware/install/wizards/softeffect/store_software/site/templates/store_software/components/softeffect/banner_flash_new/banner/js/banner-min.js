var iesa=iesa||{};iesa.Banner=function(c,b){var a=this;a.el=c;a.url=b||"";a.data=[];a.running=false;a.current_slide=-1;a.current_frame=null;a.next_frame=null;a.control=null;a.next_button=null;a.prev_button=null;$(window).load(function(){a.init()})};iesa.Banner.prototype={toString:function(){return"[object iesa.Banner]"},init:function(){var T=this;if(!T.url){var data=$(".data",T.el);var data=eval(data.text())}else{$.ajaxSetup({async:false});$.getJSON(T.url,null,function(data){T.data=data})}T.data=data;if(data.length){for(var i=0,l=data.length;i<l;++i){var x=new Image;x.src=T.url+data[i].image}var code='<div class="banner_content"><div class="frame"></div><div class="overframe"></div></div><div class="control_overlay"><i class="c t l"><i></i></i><i class="c t r"><i></i></i><i class="c b l"><i></i></i><i class="c b r"><i></i></i><div class="left">◄</div><ul>';for(var i=0,l=T.data.length;i<l;++i){code+="<li>"+(i+1)+"</li>"}code+='</ul><div class="right">►</div></div>';$(code).appendTo(T.el);T.current_frame=$(".frame",T.el).get(0);T.next_frame=$(".overframe",T.el).get(0);$(".control_overlay li",T.el).click(function(){T.show(parseInt($(this).text())-1)});$(".frame",T.el).click(function(){location.href=T.data[T.current_slide].link});T.show(0);T.start()}else{T.show_error()}},start:function(){var a=this},stop:function(){},show:function(b){if(this.current_slide==b){return}if(this.running){return}var c=$(".control_overlay li:eq("+this.current_slide+")",this.el);this.current_slide=b;var a=$(".control_overlay li:eq("+b+")",this.el);var e="url('"+this.url+this.data[b].image+"')";$(c).removeClass("active");$(a).addClass("active");this.next_frame.style.display="none";this.next_frame.style.backgroundImage=e;var d=this;d.running=true;$(this.next_frame).fadeIn("slow",function(){d.current_frame.style.backgroundImage=e;d.next_frame.style.display="none";d.running=false})},next:function(){this.show((this.current_slide+this.data.length+1)%this.data.length)},prev:function(){this.show((this.current_slide+this.data.length-1)%this.data.length)}};