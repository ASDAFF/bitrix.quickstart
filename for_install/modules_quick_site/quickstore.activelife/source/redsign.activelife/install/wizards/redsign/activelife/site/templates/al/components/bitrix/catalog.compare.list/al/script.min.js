!function(t){t.JCCatalogCompareList||(t.JCCatalogCompareList=function(t){this.obCompare=null,this.obAdminPanel=null,this.visual=t.VISUAL,this.visual.LIST=this.visual.ID+"_tbl",this.visual.ROW=this.visual.ID+"_row_",this.visual.COUNT=this.visual.ID+"_count",this.ajax=t.AJAX,this.position=t.POSITION,BX.ready(BX.proxy(this.init,this))},t.JCCatalogCompareList.prototype.init=function(){this.obCompare=BX(this.visual.ID),this.obCompare&&(BX.addCustomEvent(t,"OnCompareChange",BX.proxy(this.reload,this)),BX.bindDelegate(this.obCompare,"click",{tagName:"a"},BX.proxy(this.deleteCompare,this)),this.position.fixed&&"top"===this.position.align.vertical&&(this.obAdminPanel=BX("bx-panel"),this.obAdminPanel&&(this.setVerticalAlign(),BX.addCustomEvent(t,"onTopPanelCollapse",BX.proxy(this.setVerticalAlign,this)))),$(this.obCompare).find("#"+this.visual.LIST).scrollbar({}))},t.JCCatalogCompareList.prototype.reload=function(){BX.ajax.post(this.ajax.url,this.ajax.params,BX.proxy(this.reloadResult,this))},t.JCCatalogCompareList.prototype.reloadResult=function(t){BX.closeWait(this.obCompare),this.obCompare.innerHTML=t,BX.style(this.obCompare,"display","block"),$(this.obCompare).find("#"+this.visual.LIST).scrollbar({})},t.JCCatalogCompareList.prototype.deleteCompare=function(){var t,i,a=BX.proxy_context;a&&a.hasAttribute("data-id")&&(t=parseInt(a.getAttribute("data-id"),10),isNaN(t)||(BX.showWait(this.obCompare),i=this.ajax.url+this.ajax.templates.delete+t.toString(),BX.ajax.loadJSON(i,this.ajax.params,BX.proxy(this.deleteCompareResult,this))))},t.JCCatalogCompareList.prototype.deleteCompareResult=function(t){var i,a,o,s,e;if(BX.closeWait(this.obCompare),"object"==typeof t&&t.STATUS&&"OK"===t.STATUS&&t.ID&&(i=BX(this.visual.LIST))){var l=BX.findChild(i,{},!1,!0);if(l.length>1){for(o=this.visual.ROW+t.ID,a=0;a<l.length;a++)l[a].id===o&&BX.remove(l[a]);i=null,t.COUNT&&(e=parseInt(t.COUNT,10),isNaN(e)||(s=BX(this.visual.COUNT),s&&(s.innerHTML=e.toString(),s=null),BX.style(this.obCompare,"display",e>0?"block":"none")))}else this.reload()}},t.JCCatalogCompareList.prototype.setVerticalAlign=function(){var t;this.obCompare&&this.obAdminPanel&&(t=parseInt(this.obAdminPanel.offsetHeight,10),isNaN(t)&&(t=0),t+=5,BX.style(this.obCompare,"top",t.toString()+"px"))})}(window);