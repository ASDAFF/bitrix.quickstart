function JCSmartFilter(a){this.ajaxURL=a;this.form=null;this.timer=null}JCSmartFilter.prototype.keyup=function(a){if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.delegate(function(){this.reload(a)},this),1000)};JCSmartFilter.prototype.click=function(a){if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.delegate(function(){this.reload(a)},this),1000)};JCSmartFilter.prototype.reload=function(b){this.position=BX.pos(b,true);this.form=BX.findParent(b,{tag:"form"});if(this.form){var a=new Array;a[0]={name:"ajax",value:"y"};this.gatherInputsValues(a,BX.findChildren(this.form,{tag:"input"},true));BX.ajax.loadJSON(this.ajaxURL,this.values2post(a),BX.delegate(this.postHandler,this))}};JCSmartFilter.prototype.postHandler=function(k){if(!!k&&!!k.ITEMS){for(var a in k.ITEMS){var d=k.ITEMS[a];if(d.PROPERTY_TYPE=="N"||d.PRICE){}else{if(d.VALUES){for(var h in d.VALUES){var e=d.VALUES[h];var g=BX(e.CONTROL_ID);if(g){g.parentNode.className=e.DISABLED?"disabled":""}}}}}var j=BX("modef");var f=BX("modef_num");if(j&&f){f.innerHTML=k.ELEMENT_COUNT;var c=BX.findChildren(j,{tag:"A"},true);if(k.FILTER_URL&&c){c[0].href=BX.util.htmlspecialcharsback(k.FILTER_URL)}if(k.FILTER_AJAX_URL&&k.COMPONENT_CONTAINER_ID){BX.bind(c[0],"click",function(l){var i=BX.util.htmlspecialcharsback(k.FILTER_AJAX_URL);BX.ajax.insertToNode(i,k.COMPONENT_CONTAINER_ID);return BX.PreventDefault(l)})}if(k.INSTANT_RELOAD&&k.COMPONENT_CONTAINER_ID){var b=BX.util.htmlspecialcharsback(k.FILTER_AJAX_URL);BX.ajax.insertToNode(b,k.COMPONENT_CONTAINER_ID)}else{if(j.style.display=="none"){j.style.display="block"}j.style.top=this.position.top+"px"}}}};JCSmartFilter.prototype.gatherInputsValues=function(a,e){if(e){for(var c=0;c<e.length;c++){var d=e[c];if(d.disabled||!d.type){continue}switch(d.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":case"select-one":if(d.value.length){a[a.length]={name:d.name,value:d.value}}break;case"radio":case"checkbox":if(d.checked){a[a.length]={name:d.name,value:d.value}}break;case"select-multiple":for(var b=0;b<d.options.length;b++){if(d.options[b].selected){a[a.length]={name:d.name,value:d.options[b].value}}}break;default:break}}}};JCSmartFilter.prototype.values2post=function(b){var e=new Array;var h=e;var d=0;while(d<b.length){var g=b[d].name.indexOf("[");if(g==-1){h[b[d].name]=b[d].value;h=e;d++}else{var c=b[d].name.substring(0,g);var f=b[d].name.substring(g+1);if(!h[c]){h[c]=new Array}var a=f.indexOf("]");if(a==-1){h=e;d++}else{if(a==0){h=h[c];b[d].name=""+h.length}else{h=h[c];b[d].name=f.substring(0,a)+f.substring(a+1)}}}}return e};function cDoubleTrackBar(e,b,d,a,c){switch(typeof e){case"string":this.Track=document.getElementById(e);break;case"object":this.Track=e;break}switch(typeof b){case"string":this.Tracker=document.getElementById(b);break;case"object":this.Tracker=b;break}switch(typeof d){case"string":this.LeftDrag=document.getElementById(d);break;case"object":this.LeftDrag=d;break}switch(typeof a){case"string":this.RightDrag=document.getElementById(a);break;case"object":this.RightDrag=a;break}if(!e||!b){return false}this.OnUpdate=c.OnUpdate;this.OnComplete=c.OnComplete;this.FingerOffset=c.FingerOffset||0;this.Min=c.Min||0;this.Max=c.Max||100;this.MinSpace=c.MinSpace||0;this.RoundTo=c.RoundTo||1;if(this.RoundTo<1){this.Precision=parseInt(c.Precision,10)||0;if(isNaN(this.Precision)){this.Precision=0}}else{this.Precision=0}this.PrecisionFactor=Math.pow(10,this.Precision);this.Disabled=(typeof c.Disabled!="undefined")?c.Disabled:false;if(this.Min>=this.Max){this.Max=this.Min+1}this.MinPos=this.Min;this.MaxPos=this.Max;if(this.Max-this.Min<this.MinSpace){this.MinSpace=this.Max-this.Min}if(this.Max-this.Min<this.RoundTo){this.RoundTo=this.Max-this.Min}this.MinSpace=Math.ceil(this.MinSpace/this.RoundTo)*this.RoundTo;this.OnTrackMouseDown=this.bindAsEventListener(this.TrackMouseDown);this.OnDocumentMouseMove=this.bindAsEventListener(this.DocumentMouseMove);this.OnDocumentMouseUp=this.bindAsEventListener(this.DocumentMouseUp);if("ontouchstart" in document.documentElement){this.bindEvent(this.Track,"touchstart",this.OnTrackMouseDown)}else{this.bindEvent(this.Track,"mousedown",this.OnTrackMouseDown)}this.TrackerLeft=0;this.MinInputId=c.MinInputId||0;this.MaxInputId=c.MaxInputId||1000;BX.defer(BX.proxy(this.startPosition,this))()}cDoubleTrackBar.prototype={TrackMouseDown:function(b){this.TrackerLeft=this.Tracker.offsetLeft;this.TrackerRight=this.TrackerLeft+this.Tracker.offsetWidth;this.TrackerOffsets=this.getOffsets(this.Track);var a=("ontouchmove" in document.documentElement)?b.targetTouches[0].pageX:b.clientX;var d=a+document.documentElement.scrollLeft;d-=this.TrackerOffsets[0];var c=Math.abs(this.TrackerLeft-d)-Math.abs(this.TrackerRight-d);if(c==0&&this.TrackerLeft==0){this.Left=false}else{this.Left=(c<=0)}if(typeof this.Disabled=="function"){if(this.Disabled.call(this)){return true}}else{if(this.Disabled){return true}}this.UpdateTracker(d);if("ontouchmove" in document.documentElement){this.bindEvent(document,"touchmove",this.OnDocumentMouseMove);this.bindEvent(document,"touchend",this.OnDocumentMouseUp)}else{this.bindEvent(document,"mousemove",this.OnDocumentMouseMove);this.bindEvent(document,"mouseup",this.OnDocumentMouseUp)}return this.stopEvent(b)},DocumentMouseMove:function(b){var a=("ontouchmove" in document.documentElement)?b.targetTouches[0].pageX:b.clientX;this.UpdateTracker(a+document.documentElement.scrollLeft-this.TrackerOffsets[0]);return this.stopEvent(b)},DocumentMouseUp:function(a){if("ontouchmove" in document.documentElement){this.unbindEvent(document,"touchmove",this.OnDocumentMouseMove);this.unbindEvent(document,"touchend",this.OnDocumentMouseUp)}else{this.unbindEvent(document,"mousemove",this.OnDocumentMouseMove);this.unbindEvent(document,"mouseup",this.OnDocumentMouseUp)}if(typeof this.OnComplete=="function"){this.OnComplete.call(this)}return this.stopEvent(a)},UpdateTracker:function(e){var b=this.Track.clientWidth;var d=Math.floor(b*this.MinSpace/(this.Max-this.Min));var a=this.MinPos;var c=this.MaxPos;if(this.Left){e+=this.FingerOffset;this.TrackerLeft=Math.max(0,Math.min(this.TrackerRight-d-1,e));this.MinPos=Math.round((this.Min+this.TrackerLeft*(this.Max-this.Min)/b)/this.RoundTo)*this.RoundTo;if(this.MinSpace>=this.MaxPos-this.MinPos){this.MinPos=this.MaxPos-this.MinSpace}if(this.Precision>0){this.MinPos=Math.round(this.MinPos*this.PrecisionFactor)/this.PrecisionFactor}this.TrackerLeft=this.price2px(this.Track,this.MinPos-this.Min);this.LeftDrag.style.left=this.px2percent(this.Track,this.TrackerLeft)+"%";this.Tracker.style.width=this.px2percent(this.Track,this.TrackerRight-this.TrackerLeft)+"%";this.Tracker.style.left=this.px2percent(this.Track,this.TrackerLeft)+"%";this.MinInputId.value=this.MinPos;smartFilter.keyup(this.MinInputId)}else{e-=this.FingerOffset;this.TrackerRight=Math.max(this.TrackerLeft+d+1,Math.min(b+1,e));this.MaxPos=Math.round((this.Min+(this.TrackerRight-1)*(this.Max-this.Min)/b)/this.RoundTo)*this.RoundTo;if(this.MinSpace>=this.MaxPos-this.MinPos){this.MaxPos=this.MinPos+this.MinSpace}if(this.Precision>0){this.MaxPos=Math.round(this.MaxPos*this.PrecisionFactor)/this.PrecisionFactor}this.TrackerRight=this.price2px(this.Track,this.MaxPos-this.Min);this.Tracker.style.left=this.px2percent(this.Track,this.TrackerLeft)+"%";this.Tracker.style.width=this.px2percent(this.Track,this.TrackerRight-this.TrackerLeft)+"%";this.RightDrag.style.left=this.px2percent(this.Track,this.TrackerRight)+"%";this.MaxInputId.value=this.MaxPos;smartFilter.keyup(this.MaxInputId)}},getOffsets:function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent}while(b);return[c,a]},bindEvent:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else{a.attachEvent("on"+b,c)}},unbindEvent:function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else{if(a.detachEvent){a.detachEvent("on"+b,c)}}},bindAsEventListener:function(b){var a=this;return function(c){return b.call(a,c||window.event)}},stopEvent:function(a){if(a.preventDefault){a.preventDefault();a.stopPropagation()}else{a.returnValue=false;a.cancelBubble=true}return false},startPosition:function(){var a=this.MinInputId.value||0,b=this.MaxInputId.value||0,d=0,c=0;if(a||b){if(!a||a<this.Min||a>this.Max){a=this.Min}if(!b||b>this.Max||b<this.Min){b=this.Max}if(a){d=this.price2px(this.Track,a-this.Min)}if(b){c=this.price2px(this.Track,b-this.Min)}this.LeftDrag.style.left=this.px2percent(this.Track,d)+"%";this.Tracker.style.left=this.px2percent(this.Track,d)+"%";this.Tracker.style.width=this.px2percent(this.Track,c-d)+"%";if(Math.round(this.px2percent(this.Track,c))<100){this.RightDrag.style.left=this.px2percent(this.Track,c)+"%"}}},px2percent:function(b,a){return a/b.clientWidth*100},price2px:function(b,a){var c=(this.Max-this.Min)/b.clientWidth;return Math.round(a/c)}};function hideFilterProps(c){var d=c.parentNode;var a=BX.findChild(d,{className:"bx_filter_block"},true,false);if(BX.hasClass(d,"active")){var e=new BX.easing({duration:300,start:{opacity:1,height:a.offsetHeight},finish:{opacity:0,height:0},transition:BX.easing.transitions.quart,step:function(f){a.style.opacity=f.opacity;a.style.height=f.height+"px"},complete:function(){BX.removeClass(d,"active");a.style.overflow="hidden"}});e.animate()}else{a.style.display="block";a.style.opacity=0;a.style.height="auto";var b=a.offsetHeight;a.style.height=0;var e=new BX.easing({duration:300,start:{opacity:0,height:0},finish:{opacity:1,height:b},transition:BX.easing.transitions.quart,step:function(f){a.style.opacity=f.opacity;a.style.height=f.height+"px"},complete:function(){a.style.overflow="auto"}});e.animate();BX.addClass(d,"active")}};