var RS=RS||{};RS.namespace=function(c){var d=c.split("."),b=RS,a;if(d[0]==="RS"){d=d.slice(1)}for(a=0;a<d.length;a+=1){if(typeof b[d[a]]==="undefined"){b[d[a]]={}}b=d[a]}return b};RS.namespace("RS.Cookie");RS.namespace("RS.Popup");RS.namespace("RS.Download");RS.Cookie=(function(){setCookie=function(c,e){var b=new Date();if(getCookie(c)!==null){deleteCookie(c)}b.setDate(365+b.getDate());var d=window.location.hostname;var a=d.split(".");if(a[0]==="www"||a.length===4){a.shift();d=a.join(".")}if(a.length==1){d=""}document.cookie=c+"="+e+"; path=/; expires="+b.toGMTString()+"; domain="+d},setCookieList=function(a){var b=a.split(", ");if(b.length==2){setCookie("REDSIGN_CITY",b[1]+"/empty/"+b[0])}else{setCookie("REDSIGN_CITY",b[2]+"/"+b[1]+"/"+b[0])}},setCookieButtonClick=function(){var a=$(".rs-city-header").text();$.ajax({url:"http://"+window.location.host+"/bitrix/components/redsign/redsign.location/get.php?city_name="+encodeURI(a),async:false,success:function(b){var c=b.split("/");if(c.length==1||c.length==0){setCookie("REDSIGN_CITY",b+"/empty/"+a)}else{if(c.length==2){setCookie("REDSIGN_CITY",b+"/"+a)}}}})},getCookie=function(b){var d=" "+document.cookie,c=" "+b+"=",e=null,f=0,a=0;if(d.length>0){f=d.indexOf(c);if(f!=-1){f+=c.length;a=d.indexOf(";",f);if(a==-1){a=d.length}e=unescape(d.substring(f,a))}}return e},getCookieCity=function(a){var b=getCookie(a);if(b!==null){if(b.indexOf("/")==-1){return b}else{return b.split("/")[2]}}return null},getCookieCityId=function(b){var c=getCookie(b),a=Array();if(c!==null){$.ajax({url:"http://"+window.location.host+"/bitrix/components/redsign/redsign.location/get.php?city="+encodeURI(c.split("/")[2]),async:false,dataType:"json",success:function(d){a=d}});return a}},getCookieAllName=function(a){var b=getCookie(a),c=Array();if(b!==null){$.ajax({url:"http://"+window.location.host+"/bitrix/components/redsign/redsign.location/get.php?all_name="+encodeURI(b.split("/")[2]),async:false,dataType:"json",success:function(d){c=d}});return c}},getCookieProps=function(a){var b=getCookie(a),c=Array();if(b!==null){$.ajax({url:"http://"+window.location.host+"/bitrix/components/redsign/redsign.location/get.php?props="+encodeURI(b.split("/")[2]),async:false,dataType:"json",success:function(d){c=d}});return c}},deleteCookie=function(b){var a=new Date();a.setTime(a.getTime()-1);document.cookie=b+="=; expires="+a.toGMTString()};return{setCookieList:setCookieList,setCookieButtonClick:setCookieButtonClick,getCookieCity:getCookieCity,getCookieCityId:getCookieCityId,getCookieAllName:getCookieAllName,getCookieProps:getCookieProps}}());RS.Popup=(function(){var a=RS.Cookie;show=function(){var c=a.getCookieCity("REDSIGN_CITY");var b=a.getCookieAllName("REDSIGN_CITY");if(c!==null){$(".rs-city-header").text(c);$(".rscountry").text(b.country_name);$(".rsregion").text(b.region_name)}if($(".geoip_city").text()==""){$(".rs-my-city").css("display","none");$(".rs-city-header").css("display","none");$(".rs-vopros").css("display","none");$(".rs-geocountry").css("display","none")}else{$(".rs-my-city").css("display","block");$(".rs-city-header").css("display","inline");$(".rs-vopros").css("display","inline");$(".rs-geocountry").css("display","block");$(".rs-city-header-not").css("display","none")}$("#rs-location").css("display","block")},hide=function(){$("#rs-location").css("display","none");$(".rs-download").css("display","none");$("#rs-location input.txt").val("")};return{show:show,hide:hide}}());RS.Download=function(){var a=RS.Cookie,c=RS.Popup,d=0,f=null,h=Array(),e=Array(),i=0,b="",g=function(j){$.ajax({url:"http://"+window.location.host+"/bitrix/components/redsign/redsign.location/search.php?query="+encodeURI(j),dataType:"json",success:function(k){$(".rs-download").empty();for(d in k){f=k[d];e=Array();e.ID=(f.ID&&f.ID.length>0)?f.ID:i++;e.GID=b+"_"+e.ID;locName=f.NAME;if(f.REGION_NAME.length>0&&locName.length<=0){locName=f.REGION_NAME}else{if(f.REGION_NAME.length>0){locName=locName+", "+f.REGION_NAME}}if(f.COUNTRY_NAME.length>0){locName=locName+", "+f.COUNTRY_NAME}e.NAME=locName.replace(/&amp;/g,"&amp;amp;").replace(/&lt;/g,"&amp;lt;").replace(/&gt;/g,"&amp;gt;").replace(/&quot;/g,"&amp;quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");h[e.GID]=e;$(".rs-download").append("<div>"+e.NAME+"</div>").css("display","block")}$(".rs-download div").each(function(){$(this).hover(function(){$(this).addClass("rs-act-sel")},function(){$(this).removeClass("rs-act-sel")});$(this).on("click",function(){a.setCookieList($(this).text());c.hide();$("a.geoip_city").text(a.getCookieCity("REDSIGN_CITY"));$("a.geoip_city").css("display","inline");if(window.location.href.indexOf("/compare/")!=-1){window.location.reload()}})})}})};return{List:g}}();$(document).ready(function(){var g=RS.Cookie,k=RS.Popup,f=RS.Download,d=g.getCookieCity("REDSIGN_CITY"),h=g.getCookieCityId("REDSIGN_CITY"),i=g.getCookieProps("REDSIGN_CITY"),e,b,a,l,j,c;if(d===null){k.show()}else{$("a.geoip_city").text(d);$("a.geoip_city").css("display","inline");l=$("#LOCATION_ORDER_PROP_"+i.type1);b="ORDER_PROP_"+i.type1;if(l.length!=0){l.empty();e={CITY_INPUT_NAME:b,COUNTRY:h.country_id,REGION:h.region_id,CITY_OUT_LOCATION:"Y",ALLOW_EMPTY_CITY:"Y"};if($("[id^=ID_PAY_SYSTEM_ID]").length!=0){e.ONCITYCHANGE="submitForm()"}$.ajax({type:"POST",url:"http://"+window.location.host+"/bitrix/components/bitrix/sale.ajax.locations/templates/.default/ajax.php",data:e,async:false,success:function(m){l.prepend(m);$('select[name="'+b+'"]').val(h.city_id).change()}});$(document).on("click","#PERSON_TYPE_1",function(){setTimeout(function(){l=$("#LOCATION_ORDER_PROP_"+i.type1);b="ORDER_PROP_"+i.type1;$.ajax({type:"POST",url:"http://"+window.location.host+"/bitrix/components/bitrix/sale.ajax.locations/templates/.default/ajax.php",data:{CITY_INPUT_NAME:b,ONCITYCHANGE:"submitForm()",COUNTRY:h.country_id,REGION:h.region_id,CITY_OUT_LOCATION:"Y",ALLOW_EMPTY_CITY:"Y"},async:false,success:function(m){l.empty();l.prepend(m);$('select[name="'+b+'"]').val(h.city_id).change()}})},1000)});$(document).on("click","#PERSON_TYPE_2",function(){setTimeout(function(){j=$("#LOCATION_ORDER_PROP_"+i.type2);a="ORDER_PROP_"+i.type2;$.ajax({type:"POST",url:"http://"+window.location.host+"/bitrix/components/bitrix/sale.ajax.locations/templates/.default/ajax.php",data:{CITY_INPUT_NAME:a,ONCITYCHANGE:"submitForm()",COUNTRY:h.country_id,REGION:h.region_id,CITY_OUT_LOCATION:"Y",ALLOW_EMPTY_CITY:"Y"},async:false,success:function(m){j.empty();j.prepend(m);$('select[name="'+a+'"]').val(h.city_id).change()}})},1000)})}else{if($("#ORDER_PROP_"+i.type1+"_val").length!=0){$.ajax({url:"http://"+window.location.host+"/bitrix/components/redsign/redsign.location/search.php?query="+encodeURI(d),dataType:"json",success:function(m){$("#ORDER_PROP_"+i.type1+"_val").attr("value",m[0]["NAME"]+", "+m[0]["REGION_NAME"]+", "+m[0]["COUNTRY_NAME"]);$("#ORDER_PROP_"+i.type1).val(m[0]["ID"])}});$(document).on("click","#PERSON_TYPE_1",function(){setTimeout(function(){$.ajax({url:"http://"+window.location.host+"/bitrix/components/redsign/redsign.location/search.php?query="+encodeURI(d),dataType:"json",success:function(m){$("#ORDER_PROP_"+i.type1+"_val").attr("value",m[0]["NAME"]+", "+m[0]["REGION_NAME"]+", "+m[0]["COUNTRY_NAME"]);$("#ORDER_PROP_"+i.type1).val(m[0]["ID"])}})},1000)});$(document).on("click","#PERSON_TYPE_2",function(){setTimeout(function(){$.ajax({url:"http://"+window.location.host+"/bitrix/components/redsign/redsign.location/search.php?query="+encodeURI(d),dataType:"json",success:function(m){$("#ORDER_PROP_"+i.type2+"_val").attr("value",m[0]["NAME"]+", "+m[0]["REGION_NAME"]+", "+m[0]["COUNTRY_NAME"]);$("#ORDER_PROP_"+i.type2).val(m[0]["ID"])}})},1000)})}}}$(document).on("click","a.geoip_city",function(){k.show()});$(document).on("click","a.close",function(){k.hide()});$(document).on("click",".rs-my-city .button",function(){g.setCookieButtonClick();k.hide();$("a.geoip_city").text(g.getCookieCity("REDSIGN_CITY"));$("a.geoip_city").css("display","inline")});$(document).on("keyup",".txt",function(){if($(this).val().length>1){f.List($(this).val())}else{if($(this).val().length<=1){$(".rs-download").css("display","none")}}})});