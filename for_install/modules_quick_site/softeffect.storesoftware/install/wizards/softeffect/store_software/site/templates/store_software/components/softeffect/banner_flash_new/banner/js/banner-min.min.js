var iesa=iesa||{};iesa.Banner=function(f,d){var e=this;e.el=f;e.url=d||"";e.data=[];e.running=false;e.current_slide=-1;e.current_frame=null;e.next_frame=null;e.control=null;e.next_button=null;e.prev_button=null;$(window).load(function(){e.init()})};iesa.Banner.prototype={toString:function(){return"[object iesa.Banner]"},init:function(){var T=this;if(!T.url){var data=$(".data",T.el);var data=eval(data.text())}else{$.ajaxSetup({async:false});$.getJSON(T.url,null,function(data){T.data=data})}T.data=data;if(data.length){for(var i=0,l=data.length;i<l;++i){var x=new Image;x.src=T.url+data[i].image}var code='<div class="banner_content"><div class="frame"></div><div class="overframe"></div></div><div class="control_overlay"><i class="c t l"><i></i></i><i class="c t r"><i></i></i><i class="c b l"><i></i></i><i class="c b r"><i></i></i><div class="left">◄</div><ul>';for(var i=0,l=T.data.length;i<l;++i){code+="<li>"+(i+1)+"</li>"}code+='</ul><div class="right">►</div></div>';$(code).appendTo(T.el);T.current_frame=$(".frame",T.el).get(0);T.next_frame=$(".overframe",T.el).get(0);$(".control_overlay li",T.el).click(function(){T.show(parseInt($(this).text())-1)});$(".frame",T.el).click(function(){location.href=T.data[T.current_slide].link});T.show(0);T.start()}else{T.show_error()}},start:function(){var b=this},stop:function(){},show:function(f){if(this.current_slide==f){return}if(this.running){return}var j=$(".control_overlay li:eq("+this.current_slide+")",this.el);this.current_slide=f;var g=$(".control_overlay li:eq("+f+")",this.el);var h="url('"+this.url+this.data[f].image+"')";$(j).removeClass("active");$(g).addClass("active");this.next_frame.style.display="none";this.next_frame.style.backgroundImage=h;var i=this;i.running=true;$(this.next_frame).fadeIn("slow",function(){i.current_frame.style.backgroundImage=h;i.next_frame.style.display="none";i.running=false})},next:function(){this.show((this.current_slide+this.data.length+1)%this.data.length)},prev:function(){this.show((this.current_slide+this.data.length-1)%this.data.length)}};