$.fn.onlyDigits=function(a){return this.each(function(){$(this).keydown(function(b){if($.inArray(b.keyCode,[46,8,9,27,13,110,190])!==-1||(b.keyCode==65&&b.ctrlKey===true)||(b.keyCode>=35&&b.keyCode<=40)){return}if((b.shiftKey||(b.keyCode<48||b.keyCode>57))&&(b.keyCode<96||b.keyCode>105)){b.preventDefault()}})})};function Wm_calucate(d,f,a,e){if(d>f){return 0}var g=(f-d)*-1;var b=e/1200;var h=a;var c=b*g*Math.pow((1+b),h)/(1-Math.pow((1+b),h));return c}function Wm_payment(a){if(typeof a=="undefined"){a=false}var b=Wm_calucate(parseInt($("input[name=fpay]").val()),parseInt($("input[name=price]").val()),parseInt($("input[name=month]").val()),wm.percent);summa.options.duration=a?100:0;summa.options.animation=a?"slide":"count";summa.options.format="( ddd)";summa.update(b);$("input[name=monthpay]").val(b)}function Wm_firstpay(d){var b,c=parseInt(d*wm.fpay/100),b=parseInt(d*0.1);fpay=$("#credit-fpay");fpay.noUiSlider({start:b,range:[0,c],handles:1,step:10,slide:function(){Wm_update_fpay()}},true);var a=accounting.formatMoney(fpay.val(),moneyOptions);fpay.find(".noUi-handle").append('<input name="credpay" class="slider-input" maxlength="9" autocomplete="off">');fpay.find(".noUi-handle input:text").val(a);$("[name=credpay]").onlyDigits();$("[name=credpay]").on("mousedown",function(f){f.stopPropagation()});$("[name=credpay]").on("blur",function(){var e=accounting.unformat($(this).val());fpay.val(e);Wm_update_fpay()});$("[name=credpay]").on("focusin",function(){var e=$(this).val();$(this).val(accounting.unformat(e))}).on("focusout",function(){var e=$(this).val();$(this).val(accounting.formatMoney(e,moneyOptions))});$("input[name=fpay]").val(fpay.val())}function Wm_update_month(){monthSlider.find(".noUi-handle input").val(parseInt(monthSlider.val()));$("input[name=month]").val(monthSlider.val());Wm_payment()}function Wm_update_fpay(){var a=accounting.unformat(fpay.val());var b=accounting.formatMoney(fpay.val(),moneyOptions);fpay.find(".noUi-handle input:text").val(b);$("input[name=fpay]").val(a);Wm_payment()}function Wm_set_product(a){a.closest(".carousel").find(".product").removeClass("active-item");a.addClass("active-item");$("#carimage").fadeOut(200,function(){$("#carimage").attr("src",a.data("img")).fadeIn(200)});$("#modeltext").html(a.data("descr"));$("[name=price]").val(a.data("price"));$("[name=model_id]").val(a.data("id"));$("[name=mark]").val(a.data("vendor"));$("[name=model]").val(a.data("model"));$("#carname").html(a.data("model"));$("#modhref span").html(a.data("modif"));$("input[name=mod]").val(a.data("modif"));Wm_firstpay(a.data("price"));Wm_payment(true);$("#detail-modal .modal-body").html(a.find(".detail").html())}function Wm_correct_price(b){var a={symbol:"руб.",decimal:".",thousand:" ",precision:0,format:"%v %s"};return accounting.formatMoney(b,a)}function Wm_switch_button(a){if(a){$("#btn-send").removeClass("disabled").prop("disabled",false)}else{$("#btn-send").addClass("disabled").prop("disabled",true)}}var monthSlider,fpay,summa,moneyOptions={symbol:"",decimal:".",thousand:" ",precision:0,format:"%v"};window.odometerOptions={duration:500,theme:"default"};$(function(){var a=$("#carousel-product");a.carousel({interval:false});a.find(".product").on("click",function(){Wm_set_product($(this))});summa=new Odometer({el:$("#summa")[0],value:0,format:"",theme:"default"});Wm_set_product(a.find(".product:first"));monthSlider=$("#credit-month");monthSlider.noUiSlider({start:wm.start_month,range:[wm.min_month,wm.max_month],handles:1,step:1,slide:function(){Wm_update_month()},set:function(){Wm_update_month()}});monthSlider.find(".noUi-handle").append('<input name="credmonth" class="slider-input" maxlength="2" autocomplete="off">');monthSlider.find(".noUi-handle input").val(parseInt(monthSlider.val()));$("[name=credmonth]").on("mousedown",function(b){b.stopPropagation()});$("[name=credmonth]").on("blur",function(){var b=$(this).val();monthSlider.val(b);Wm_update_month()});$("input[name=month]").val(monthSlider.val());$(".terms input").on("change",function(){Wm_switch_button($(this).is(":checked"))});Wm_payment();Wm_switch_button(false);$("[name=credmonth]").onlyDigits()});