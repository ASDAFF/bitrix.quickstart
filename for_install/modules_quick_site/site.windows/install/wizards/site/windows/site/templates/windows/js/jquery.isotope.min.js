(function(P,R){var k=P.document,Q=P.Modernizr,o=function(f){return f.charAt(0).toUpperCase()+f.slice(1)},b=["Moz","Webkit","O","Ms"],M=function(l){var f=k.documentElement.style,q;if("string"===typeof f[l]){return l}l=o(l);for(var n=0,m=b.length;n<m;n++){if(q=b[n]+l,"string"===typeof f[q]){return q}}},j=M("transform"),a=M("transitionProperty"),K={csstransforms:function(){return !!j},csstransforms3d:function(){var l=!!M("perspective");if(l){var l="@media ("+" -o- -moz- -ms- -webkit- -khtml- ".split(" ").join("transform-3d),(")+"modernizr)",f=R("<style>"+l+"{#modernizr{height:3px}}</style>").appendTo("head"),m=R('<div id="modernizr" />').appendTo("html"),l=3===m.height();m.remove();f.remove()}return l},csstransitions:function(){return !!a}},O;if(Q){for(O in K){Q.hasOwnProperty(O)||Q.addTest(O,K[O])}}else{var Q=P.Modernizr={_version:"1.6ish: miniModernizr for Isotope"},h=" ",e;for(O in K){e=K[O](),Q[O]=e,h+=" "+(e?"":"no-")+O}R("html").addClass(h)}if(Q.csstransforms){var i=Q.csstransforms3d?{translate:function(f){return"translate3d("+f[0]+"px, "+f[1]+"px, 0) "},scale:function(f){return"scale3d("+f+", "+f+", 1) "}}:{translate:function(f){return"translate("+f[0]+"px, "+f[1]+"px) "},scale:function(f){return"scale("+f+") "}},N=function(l,f,s){var r=R.data(l,"isoTransform")||{},q={},n,m={};q[f]=s;R.extend(r,q);for(n in r){f=r[n],m[n]=i[n](f)}n=(m.translate||"")+(m.scale||"");R.data(l,"isoTransform",r);l.style[j]=n};R.cssNumber.scale=!0;R.cssHooks.scale={set:function(l,f){N(l,"scale",f)},get:function(f){return(f=R.data(f,"isoTransform"))&&f.scale?f.scale:1}};R.fx.step.scale=function(f){R.cssHooks.scale.set(f.elem,f.now+f.unit)};R.cssNumber.translate=!0;R.cssHooks.translate={set:function(l,f){N(l,"translate",f)},get:function(f){return(f=R.data(f,"isoTransform"))&&f.translate?f.translate:[0,0]}}}var L,J;Q.csstransitions&&(L={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd otransitionend",transitionProperty:"transitionend"}[a],J=M("transitionDuration"));var I=R.event,g=R.event.handle?"handle":"dispatch",c;I.special.smartresize={setup:function(){R(this).bind("resize",I.special.smartresize.handler)},teardown:function(){R(this).unbind("resize",I.special.smartresize.handler)},handler:function(l,f){var n=this,m=arguments;l.type="smartresize";c&&clearTimeout(c);c=setTimeout(function(){I[g].apply(n,m)},"execAsap"===f?0:100)}};R.fn.smartresize=function(f){return f?this.bind("smartresize",f):this.trigger("smartresize",["execAsap"])};R.Isotope=function(l,f,m){this.element=R(f);this._create(l);this._init(m)};var d=["width","height"],p=R(P);R.Isotope.settings={resizable:!0,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:0.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:!1,duration:800},sortBy:"original-order",sortAscending:!0,resizesContainer:!0,transformsEnabled:!0,itemPositionDataEnabled:!1};R.Isotope.prototype={_create:function(l){this.options=R.extend({},R.Isotope.settings,l);this.styleQueue=[];this.elemCount=0;l=this.element[0].style;this.originalStyle={};var f=d.slice(0),r;for(r in this.options.containerStyle){f.push(r)}for(var q=0,n=f.length;q<n;q++){r=f[q],this.originalStyle[r]=l[r]||""}this.element.css(this.options.containerStyle);this._updateAnimationEngine();this._updateUsingTransforms();this.options.getSortData=R.extend(this.options.getSortData,{"original-order":function(s,t){t.elemCount++;return t.elemCount},random:function(){return Math.random()}});this.reloadItems();this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var m=this;setTimeout(function(){m.element.addClass(m.options.containerClass)},0);this.options.resizable&&p.bind("smartresize.isotope",function(){m.resize()});this.element.delegate("."+this.options.hiddenClass,"click",function(){return !1})},_getAtoms:function(l){var f=this.options.itemSelector;l=f?l.filter(f).add(l.find(f)):l;f={position:"absolute"};l=l.filter(function(n,m){return 1===m.nodeType});this.usingTransforms&&(f.left=0,f.top=0);l.css(f).addClass(this.options.itemClass);this.updateSortData(l,!0);return l},_init:function(f){this.$filteredAtoms=this._filter(this.$allAtoms);this._sort();this.reLayout(f)},option:function(l){if(R.isPlainObject(l)){this.options=R.extend(!0,this.options,l);for(var f in l){if(l="_update"+o(f),this[l]){this[l]()}}}},_updateAnimationEngine:function(){var f;switch(this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,"")){case"css":case"none":f=!1;break;case"jquery":f=!0;break;default:f=!Q.csstransitions}this.isUsingJQueryAnimation=f;this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var f=this.usingTransforms=this.options.transformsEnabled&&Q.csstransforms&&Q.csstransitions&&!this.isUsingJQueryAnimation;f||(delete this.options.hiddenStyle.scale,delete this.options.visibleStyle.scale);this.getPositionStyles=f?this._translate:this._positionAbs},_filter:function(l){var f=""===this.options.filter?"*":this.options.filter;if(!f){return l}var r=this.options.hiddenClass,q="."+r,n=l.filter(q),m=n;"*"!==f&&(m=n.filter(f),q=l.not(q).not(f).addClass(r),this.styleQueue.push({$el:q,style:this.options.hiddenStyle}));this.styleQueue.push({$el:m,style:this.options.visibleStyle});m.removeClass(r);return l.filter(f)},updateSortData:function(l,f){var r=this,q=this.options.getSortData,n,m;l.each(function(){n=R(this);m={};for(var s in q){m[s]=!f&&"original-order"===s?R.data(this,"isotope-sort-data")[s]:q[s](n,r)}R.data(this,"isotope-sort-data",m)})},_sort:function(){var l=this.options.sortBy,f=this._getSorter,m=this.options.sortAscending?1:-1;this.$filteredAtoms.sort(function(s,r){var n=f(s,l),q=f(r,l);n===q&&"original-order"!==l&&(n=f(s,"original-order"),q=f(r,"original-order"));return(n>q?1:n<q?-1:0)*m})},_getSorter:function(l,f){return R.data(l,"isotope-sort-data")[f]},_translate:function(l,f){return{translate:[l,f]}},_positionAbs:function(l,f){return{left:l,top:f}},_pushPosition:function(l,f,n){f=Math.round(f+this.offset.left);n=Math.round(n+this.offset.top);var m=this.getPositionStyles(f,n);this.styleQueue.push({$el:l,style:m});this.options.itemPositionDataEnabled&&l.data("isotope-item-position",{x:f,y:n})},layout:function(l,f){var m=this.options.layoutMode;this["_"+m+"Layout"](l);this.options.resizesContainer&&(m=this["_"+m+"GetContainerSize"](),this.styleQueue.push({$el:this.element,style:m}));this._processStyleQueue(l,f);this.isLaidOut=!0},_processStyleQueue:function(B,A){var z=!this.isLaidOut?"css":this.isUsingJQueryAnimation?"animate":"css",y=this.options.animationOptions,x=this.options.onLayout,w,v,t,u;v=function(n,m){m.$el[z](m.style,y)};if(this._isInserting&&this.isUsingJQueryAnimation){v=function(n,m){w=m.$el.hasClass("no-transition")?"css":z;m.$el[w](m.style,y)}}else{if(A||x||y.complete){var s=!1,r=[A,x,y.complete],f=this;t=!0;u=function(){if(!s){for(var m,q=0,n=r.length;q<n;q++){m=r[q],"function"===typeof m&&m.call(f.element,B,f)}s=!0}};if(this.isUsingJQueryAnimation&&"animate"===z){y.complete=u,t=!1}else{if(Q.csstransitions){for(var x=0,l=this.styleQueue[0],l=l&&l.$el;!l||!l.length;){l=this.styleQueue[x++];if(!l){return}l=l.$el}0<parseFloat(getComputedStyle(l[0])[J])&&(v=function(n,m){m.$el[z](m.style,y).one(L,u)},t=!1)}}}}R.each(this.styleQueue,v);t&&u();this.styleQueue=[]},resize:function(){this["_"+this.options.layoutMode+"ResizeChanged"]()&&this.reLayout()},reLayout:function(f){this["_"+this.options.layoutMode+"Reset"]();this.layout(this.$filteredAtoms,f)},addItems:function(l,f){var m=this._getAtoms(l);this.$allAtoms=this.$allAtoms.add(m);f&&f(m)},insert:function(l,f){this.element.append(l);var m=this;this.addItems(l,function(n){n=m._filter(n);m._addHideAppended(n);m._sort();m.reLayout();m._revealAppended(n,f)})},appended:function(l,f){var m=this;this.addItems(l,function(n){m._addHideAppended(n);m.layout(n);m._revealAppended(n,f)})},_addHideAppended:function(f){this.$filteredAtoms=this.$filteredAtoms.add(f);f.addClass("no-transition");this._isInserting=!0;this.styleQueue.push({$el:f,style:this.options.hiddenStyle})},_revealAppended:function(l,f){var m=this;setTimeout(function(){l.removeClass("no-transition");m.styleQueue.push({$el:l,style:m.options.visibleStyle});m._isInserting=!1;m._processStyleQueue(l,f)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function(l,f){this.$allAtoms=this.$allAtoms.not(l);this.$filteredAtoms=this.$filteredAtoms.not(l);var n=this,m=function(){l.remove();f&&f.call(n.element)};l.filter(":not(."+this.options.hiddenClass+")").length?(this.styleQueue.push({$el:l,style:this.options.hiddenStyle}),this._sort(),this.reLayout(m)):m()},shuffle:function(f){this.updateSortData(this.$allAtoms);this.options.sortBy="random";this._sort();this.reLayout(f)},destroy:function(){var l=this.usingTransforms,f=this.options;this.$allAtoms.removeClass(f.hiddenClass+" "+f.itemClass).each(function(){var q=this.style;q.position="";q.top="";q.left="";q.opacity="";l&&(q[j]="")});var n=this.element[0].style,m;for(m in this.originalStyle){n[m]=this.originalStyle[m]}this.element.unbind(".isotope").undelegate("."+f.hiddenClass,"click").removeClass(f.containerClass).removeData("isotope");p.unbind(".isotope")},_getSegments:function(l){var f=this.options.layoutMode,q=l?"rowHeight":"columnWidth",n=l?"height":"width";l=l?"rows":"cols";var m=this.element[n](),n=this.options[f]&&this.options[f][q]||this.$filteredAtoms["outer"+o(n)](!0)||m,m=Math.floor(m/n),m=Math.max(m,1);this[f][l]=m;this[f][q]=n},_checkIfSegmentsChanged:function(l){var f=this.options.layoutMode,n=l?"rows":"cols",m=this[f][n];this._getSegments(l);return this[f][n]!==m},_masonryReset:function(){this.masonry={};this._getSegments();var f=this.masonry.cols;for(this.masonry.colYs=[];f--;){this.masonry.colYs.push(0)}},_masonryLayout:function(l){var f=this,m=f.masonry;l.each(function(){var n=R(this),u=Math.ceil(n.outerWidth(!0)/m.columnWidth),u=Math.min(u,m.cols);if(1===u){f._masonryPlaceBrick(n,m.colYs)}else{var t=m.cols+1-u,s=[],q,r;for(r=0;r<t;r++){q=m.colYs.slice(r,r+u),s[r]=Math.max.apply(Math,q)}f._masonryPlaceBrick(n,s)}})},_masonryPlaceBrick:function(m,l){for(var s=Math.min.apply(Math,l),r=0,q=0,n=l.length;q<n;q++){if(l[q]===s){r=q;break}}this._pushPosition(m,this.masonry.columnWidth*r,s);s+=m.outerHeight(!0);n=this.masonry.cols+1-n;for(q=0;q<n;q++){this.masonry.colYs[r+q]=s}},_masonryGetContainerSize:function(){return{height:Math.max.apply(Math,this.masonry.colYs)}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function(l){var f=this,n=this.element.width(),m=this.fitRows;l.each(function(){var q=R(this),s=q.outerWidth(!0),r=q.outerHeight(!0);0!==m.x&&s+m.x>n&&(m.x=0,m.y=m.height);f._pushPosition(q,m.x,m.y);m.height=Math.max(m.y+r,m.height);m.x+=s})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return !0},_cellsByRowReset:function(){this.cellsByRow={index:0};this._getSegments();this._getSegments(!0)},_cellsByRowLayout:function(l){var f=this,m=this.cellsByRow;l.each(function(){var n=R(this),r=Math.floor(m.index/m.cols),q=(m.index%m.cols+0.5)*m.columnWidth-n.outerWidth(!0)/2,r=(r+0.5)*m.rowHeight-n.outerHeight(!0)/2;f._pushPosition(n,q,r);m.index++})},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.$filteredAtoms.length/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.offset.top}},_cellsByRowResizeChanged:function(){return this._checkIfSegmentsChanged()},_straightDownReset:function(){this.straightDown={y:0}},_straightDownLayout:function(l){var f=this;l.each(function(){var m=R(this);f._pushPosition(m,0,f.straightDown.y);f.straightDown.y+=m.outerHeight(!0)})},_straightDownGetContainerSize:function(){return{height:this.straightDown.y}},_straightDownResizeChanged:function(){return !0},_masonryHorizontalReset:function(){this.masonryHorizontal={};this._getSegments(!0);var f=this.masonryHorizontal.rows;for(this.masonryHorizontal.rowXs=[];f--;){this.masonryHorizontal.rowXs.push(0)}},_masonryHorizontalLayout:function(l){var f=this,m=f.masonryHorizontal;l.each(function(){var n=R(this),u=Math.ceil(n.outerHeight(!0)/m.rowHeight),u=Math.min(u,m.rows);if(1===u){f._masonryHorizontalPlaceBrick(n,m.rowXs)}else{var t=m.rows+1-u,s=[],q,r;for(r=0;r<t;r++){q=m.rowXs.slice(r,r+u),s[r]=Math.max.apply(Math,q)}f._masonryHorizontalPlaceBrick(n,s)}})},_masonryHorizontalPlaceBrick:function(m,l){for(var s=Math.min.apply(Math,l),r=0,q=0,n=l.length;q<n;q++){if(l[q]===s){r=q;break}}this._pushPosition(m,s,this.masonryHorizontal.rowHeight*r);s+=m.outerWidth(!0);n=this.masonryHorizontal.rows+1-n;for(q=0;q<n;q++){this.masonryHorizontal.rowXs[r+q]=s}},_masonryHorizontalGetContainerSize:function(){return{width:Math.max.apply(Math,this.masonryHorizontal.rowXs)}},_masonryHorizontalResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0}},_fitColumnsLayout:function(l){var f=this,n=this.element.height(),m=this.fitColumns;l.each(function(){var q=R(this),s=q.outerWidth(!0),r=q.outerHeight(!0);0!==m.y&&r+m.y>n&&(m.x=m.width,m.y=0);f._pushPosition(q,m.x,m.y);m.width=Math.max(m.x+s,m.width);m.y+=r})},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResizeChanged:function(){return !0},_cellsByColumnReset:function(){this.cellsByColumn={index:0};this._getSegments();this._getSegments(!0)},_cellsByColumnLayout:function(l){var f=this,m=this.cellsByColumn;l.each(function(){var n=R(this),r=m.index%m.rows,q=(Math.floor(m.index/m.rows)+0.5)*m.columnWidth-n.outerWidth(!0)/2,r=(r+0.5)*m.rowHeight-n.outerHeight(!0)/2;f._pushPosition(n,q,r);m.index++})},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.$filteredAtoms.length/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth}},_cellsByColumnResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_straightAcrossReset:function(){this.straightAcross={x:0}},_straightAcrossLayout:function(l){var f=this;l.each(function(){var m=R(this);f._pushPosition(m,f.straightAcross.x,0);f.straightAcross.x+=m.outerWidth(!0)})},_straightAcrossGetContainerSize:function(){return{width:this.straightAcross.x}},_straightAcrossResizeChanged:function(){return !0}};R.fn.imagesLoaded=function(l){function f(){l.call(s,r)}function t(u){u=u.target;u.src!==n&&-1===R.inArray(u,m)&&(m.push(u),0>=--q&&(setTimeout(f),r.unbind(".imagesLoaded",t)))}var s=this,r=s.find("img").add(s.filter("img")),q=r.length,n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",m=[];q||f();r.bind("load.imagesLoaded error.imagesLoaded",t).each(function(){var u=this.src;this.src=n;this.src=u});return s};R.fn.isotope=function(l,f){if("string"===typeof l){var m=Array.prototype.slice.call(arguments,1);this.each(function(){var n=R.data(this,"isotope");n?!R.isFunction(n[l])||"_"===l.charAt(0)?P.console&&P.console.error("no such method '"+l+"' for isotope instance"):n[l].apply(n,m):P.console&&P.console.error("cannot call methods on isotope prior to initialization; attempted to call method '"+l+"'")})}else{this.each(function(){var n=R.data(this,"isotope");n?(n.option(l),n._init(f)):R.data(this,"isotope",new R.Isotope(l,this,f))})}return this}})(window,jQuery);