function CancelBubble(a){if(a.stopPropagation){a.preventDefault();a.stopPropagation()}else{a.cancelBubble=true;a.returnValue=false}}function htmlspecialchars(a){if(typeof(a)!="string"){return a}a=a.replace(/&/g,"&amp;");a=a.replace(/"/g,"&quot;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a}function strip_tags(a){return a.replace(/<\/?[^>]+>/gi,"")}function CAjaxForm(b,d,a){var c=document.forms[b];if(!c){c=document.getElementById(b)}this.nextStep=c.elements[a];this.nextStepStage=c.elements[a+"Stage"];this.iframe=document.getElementById(d);this.form=c;this.form.target=d;var e=this;if(this.iframe.attachEvent){this.iframe.attachEvent("onload",function(){e.AjaxHandler()})}else{this.iframe.onload=function(){e.AjaxHandler()}}this.percent=null;this.indicator=null;this.status=null}CAjaxForm.prototype.AjaxHandler=function(){if(this.iframe.contentDocument){var iframeDocument=this.iframe.contentDocument}else{var iframeDocument=this.iframe.contentWindow.document}var response=iframeDocument.body.innerHTML;if(response.length==0||iframeDocument.getElementById("bitrix_install_template")){this.ShowError("Connection error. Empty response.");return}var regexpStart=new RegExp("\\[response\\]","i");var regexpEnd=new RegExp("\\[/response\\]","i");var matchResponse=response.match(regexpStart);if(matchResponse===null){this.ShowError(response);return}var start=matchResponse.index+matchResponse[0].length;var end=response.search(regexpEnd);if(end==-1){this.ShowError(response);return}response=response.substr(start,end-start);window.eval(response)};CAjaxForm.prototype.ShowError=function(d){var a=document.getElementById("error_container");var e=document.getElementById("error_text");if(!a||!e){return}var f=document.getElementById("wait");if(f){f.style.display="none"}a.style.display="block";e.innerHTML=strip_tags(d);var g=document.getElementById("error_retry_button");var i=document.getElementById("error_skip_button");var c=this;var b=this.nextStep.value;var h=this.nextStepStage.value;g.onclick=function(){c.HideError();c.Post(b,h,"")};if(b=="main"){i.onclick=function(){c.HideError();c.Post(b,h,"")}}else{i.onclick=function(){c.HideError();c.Post(b,"skip","")}}};CAjaxForm.prototype.HideError=function(){var b=document.getElementById("error_container");var a=document.getElementById("error_text");if(!b||!a){return}while(a.firstChild){a.removeChild(a.firstChild)}b.style.display="none";var c=document.getElementById("wait");if(c){c.style.display="block"}};CAjaxForm.prototype.Post=function(a,c,b){if(a){this.nextStep.value=a}if(c){this.nextStepStage.value=c}this.form.submit();if(!this.status){this.status=document.getElementById("status")}if(b.length>0){this.status.innerHTML=b+"..."}};CAjaxForm.prototype.StopAjax=function(){this.iframe.onload=null;this.form.target="_self"};CAjaxForm.prototype.SetStatus=function(a){if(!this.percent){this.percent=document.getElementById("percent")}if(!this.indicator){this.indicator=document.getElementById("indicator")}this.percent.innerHTML=a+"%";this.indicator.style.width=a+"%"};function PreloadImages(d){var b=["prev.gif","error.gif","wait.gif","admin.gif","public.gif"];for(var a=0;a<b.length;a++){var c=new Image();c.src=d+b[a]}};