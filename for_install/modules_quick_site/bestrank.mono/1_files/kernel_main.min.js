(function(window){if(!!window.BX&&!!window.BX.extend){return}var _bxtmp;if(!!window.BX){_bxtmp=window.BX}window.BX=function(e,t){if(BX.type.isNotEmptyString(e)){var n;if(!!t&&null!=NODECACHE[e]){n=NODECACHE[e]}n=n||document.getElementById(e);if(!!t){NODECACHE[e]=n}return n}else{if(BX.type.isDomNode(e)){return e}else{if(BX.type.isFunction(e)){return BX.ready(e)}}}return null};BX.message=function(e){if(BX.type.isString(e)){if(typeof BX.message[e]=="undefined"){BX.onCustomEvent("onBXMessageNotFound",[e]);if(typeof BX.message[e]=="undefined"){BX.debug("message undefined: "+e);BX.message[e]=""}}return BX.message[e]}else{for(var t in e){if(e.hasOwnProperty(t)){BX.message[t]=e[t]}}return true}};if(!!_bxtmp){for(var i in _bxtmp){if(_bxtmp.hasOwnProperty(i)){if(!BX[i]){BX[i]=_bxtmp[i]}else{if(i=="message"){for(var j in _bxtmp[i]){if(_bxtmp[i].hasOwnProperty(j)){BX.message[j]=_bxtmp[i][j]}}}}}}_bxtmp=null}var __readyHandler=null,readyBound=false,readyList=[],proxySalt=Math.random(),proxyId=1,proxyList=[],NODECACHE={},deniedEvents=[],eventsList=[],customEvents={},garbageCollectors=[],cssList=[],cssInit=false,jsList=[],jsInit=false,bSafari=navigator.userAgent.toLowerCase().indexOf("webkit")!=-1,bOpera=navigator.userAgent.toLowerCase().indexOf("opera")!=-1,bFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")!=-1,bChrome=navigator.userAgent.toLowerCase().indexOf("chrome")!=-1,bIE=document.attachEvent&&!bOpera,r={script:/<script([^>]*)>/gi,script_end:/<\/script>/gi,script_src:/src=["\']([^"\']+)["\']/i,script_type:/type=["\']([^"\']+)["\']/i,space:/\s+/,ltrim:/^[\s\r\n]+/g,rtrim:/[\s\r\n]+$/g,style:/<link.*?(rel="stylesheet"|type="text\/css")[^>]*>/i,style_href:/href=["\']([^"\']+)["\']/i},eventTypes={click:"MouseEvent",dblclick:"MouseEvent",mousedown:"MouseEvent",mousemove:"MouseEvent",mouseout:"MouseEvent",mouseover:"MouseEvent",mouseup:"MouseEvent",focus:"MouseEvent",blur:"MouseEvent"},lastWait=[],CHECK_FORM_ELEMENTS={tagName:/^INPUT|SELECT|TEXTAREA|BUTTON$/i},PRELOADING=1,PRELOADED=2,LOADING=3,LOADED=4,assets={},isAsync=null;BX.MSLEFT=1;BX.MSMIDDLE=2;BX.MSRIGHT=4;BX.ext=function(e){for(var t in e){if(e.hasOwnProperty(t)){this[t]=e[t]}}};BX.extend=function(e,t){var n=function(){};n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e;e.superclass=t.prototype;if(t.prototype.constructor==Object.prototype.constructor){t.prototype.constructor=t}};BX.namespace=function(e){var t=e.split(".");var n=BX;if(t[0]==="BX"){t=t.slice(1)}for(var i=0;i<t.length;i++){if(typeof n[t[i]]==="undefined"){n[t[i]]={}}n=n[t[i]]}return n};BX.debug=function(){if(BX.debugStatus()){if(window.console&&window.console.log){window.console.log("BX.debug: ",arguments.length>0?arguments:arguments[0])}if(window.console&&window.console.trace){console.trace()}}};BX.debugEnable=function(e){e=typeof e=="boolean"?e:true;BX.debugEnableFlag=e;console.info("Debug mode is "+(BX.debugEnableFlag?"ON":"OFF"))};BX.debugStatus=function(){return BX.debugEnableFlag||false};BX.is_subclass_of=function(e,t){if(e instanceof t){return true}if(t.superclass){return BX.is_subclass_of(e,t.superclass)}return false};BX.clearNodeCache=function(){NODECACHE={};return false};BX.bitrix_sessid=function(){return BX.message("bitrix_sessid")};BX.create=function(e,t,n){n=n||document;if(null==t&&typeof e=="object"&&e.constructor!==String){t=e;e=e.tag}var i;if(BX.browser.IsIE()&&!BX.browser.IsIE9()&&null!=t&&null!=t.props&&(t.props.name||t.props.id)){i=n.createElement("<"+e+(t.props.name?' name="'+t.props.name+'"':"")+(t.props.id?' id="'+t.props.id+'"':"")+">")}else{i=n.createElement(e)}return t?BX.adjust(i,t):i};BX.adjust=function(e,t){var n,i;if(!e.nodeType){return null}if(e.nodeType==9){e=e.body}if(t.attrs){for(n in t.attrs){if(t.attrs.hasOwnProperty(n)){if(n=="class"||n=="className"){e.className=t.attrs[n]}else{if(n=="for"){e.htmlFor=t.attrs[n]}else{if(t.attrs[n]==""){e.removeAttribute(n)}else{e.setAttribute(n,t.attrs[n])}}}}}}if(t.style){for(n in t.style){if(t.style.hasOwnProperty(n)){e.style[n]=t.style[n]}}}if(t.props){for(n in t.props){if(t.props.hasOwnProperty(n)){e[n]=t.props[n]}}}if(t.events){for(n in t.events){if(t.events.hasOwnProperty(n)){BX.bind(e,n,t.events[n])}}}if(t.children&&t.children.length>0){for(n=0,i=t.children.length;n<i;n++){if(BX.type.isNotEmptyString(t.children[n])){e.innerHTML+=t.children[n]}else{if(BX.type.isElementNode(t.children[n])){e.appendChild(t.children[n])}}}}else{if(t.text){BX.cleanNode(e);e.appendChild((e.ownerDocument||document).createTextNode(t.text))}else{if(t.html){e.innerHTML=t.html}}}return e};BX.remove=function(e){if(e&&null!=e.parentNode){e.parentNode.removeChild(e)}e=null;return null};BX.cleanNode=function(e,t){e=BX(e);t=!!t;if(e&&e.childNodes){while(e.childNodes.length>0){e.removeChild(e.firstChild)}}if(e&&t){e=BX.remove(e)}return e};BX.html=function(e,t,n){if(typeof t=="undefined"){return e.innerHTML}if(typeof n=="undefined"){n={}}t=BX.processHTML(t.toString());var i=[];var r=[];if(typeof t.STYLE!="undefined"&&t.STYLE.length>0){for(var o in t.STYLE){i.push(t.STYLE[o])}}if(typeof t.SCRIPT!="undefined"&&t.SCRIPT.length>0){for(var o in t.SCRIPT){if(t.SCRIPT[o].isInternal){r.push(t.SCRIPT[o].JS)}else{i.push(t.SCRIPT[o].JS)}}}if(n.htmlFirst&&typeof t.HTML!="undefined"){e.innerHTML=t.HTML}var s=function(){if(!n.htmlFirst&&typeof t.HTML!="undefined"){e.innerHTML=t.HTML}for(var i in r){BX.evalGlobal(r[i])}if(BX.type.isFunction(n.callback)){n.callback()}};if(i.length>0){BX.load(i,s)}else{s()}};BX.insertAfter=function(e,t){t.parentNode.insertBefore(e,t.nextSibling)};BX.prepend=function(e,t){t.insertBefore(e,t.firstChild)};BX.append=function(e,t){t.appendChild(e)};BX.addClass=function(e,t){var n;e=BX(e);t=BX.util.trim(t);if(t==""){return e}if(e){if(!e.className){e.className=t}else{if(!!e.classList&&t.indexOf(" ")<0){e.classList.add(t)}else{n=(t||"").split(r.space);var i=" "+e.className+" ";for(var o=0,s=n.length;o<s;o++){if(i.indexOf(" "+n[o]+" ")<0){e.className+=" "+n[o]}}}}}return e};BX.removeClass=function(e,t){e=BX(e);if(e){if(e.className&&!!t){if(BX.type.isString(t)){if(!!e.classList&&t.indexOf(" ")<0){e.classList.remove(t)}else{var n=t.split(r.space),i=" "+e.className+" ";for(var o=0,s=n.length;o<s;o++){i=i.replace(" "+n[o]+" "," ")}e.className=BX.util.trim(i)}}else{e.className=""}}}return e};BX.toggleClass=function(e,t){var n;e=BX(e);if(BX.type.isArray(t)){n=" "+e.className+" ";for(var i=0,r=t.length;i<r;i++){if(BX.hasClass(e,t[i])){n=(" "+n+" ").replace(" "+t[i]+" "," ");n+=" "+t[i>=r-1?0:i+1];i--;break}}if(i==r){e.className+=" "+t[0]}else{e.className=n}e.className=BX.util.trim(e.className)}else{if(BX.type.isNotEmptyString(t)){if(!!e.classList){e.classList.toggle(t)}else{n=e.className;if(BX.hasClass(e,t)){n=(" "+n+" ").replace(" "+t+" "," ")}else{n+=" "+t}e.className=BX.util.trim(n)}}}return e};BX.hasClass=function(e,t){e=BX(e);if(!e||!BX.type.isDomNode(e)){BX.debug(e);return false}if(!e.className||!t){return false}if(!!e.classList&&!!t&&t.indexOf(" ")<0){return e.classList.contains(BX.util.trim(t))}else{return(" "+e.className+" ").indexOf(" "+t+" ")>=0}};BX.setOpacity=function(e,t){if(e.style.filter!=null){e.style.zoom="100%";if(t==100){e.style.filter=""}else{e.style.filter="alpha(opacity="+t.toString()+")"}}else{if(e.style.opacity!=null){e.style.opacity=(t/100).toString()}else{if(e.style.MozOpacity!=null){e.style.MozOpacity=(t/100).toString()}}}};BX.hoverEvents=function(e){if(e){return BX.adjust(e,{events:BX.hoverEvents()})}else{return{mouseover:BX.hoverEventsHover,mouseout:BX.hoverEventsHout}}};BX.hoverEventsHover=function(){BX.addClass(this,"bx-hover");this.BXHOVER=true};BX.hoverEventsHout=function(){BX.removeClass(this,"bx-hover");this.BXHOVER=false};BX.focusEvents=function(e){if(e){return BX.adjust(e,{events:BX.focusEvents()})}else{return{mouseover:BX.focusEventsFocus,mouseout:BX.focusEventsBlur}}};BX.focusEventsFocus=function(){BX.addClass(this,"bx-focus");this.BXFOCUS=true};BX.focusEventsBlur=function(){BX.removeClass(this,"bx-focus");this.BXFOCUS=false};BX.setUnselectable=function(e){e.style.userSelect=e.style.MozUserSelect=e.style.WebkitUserSelect=e.style.KhtmlUserSelect=e.style="none";e.setAttribute("unSelectable","on")};BX.setSelectable=function(e){e.style.userSelect=e.style.MozUserSelect=e.style.WebkitUserSelect=e.style.KhtmlUserSelect=e.style="";e.removeAttribute("unSelectable")};BX.styleIEPropertyName=function(e){if(e=="float"){e=BX.browser.IsIE()?"styleFloat":"cssFloat"}else{var t=BX.browser.isPropertySupported(e);if(t){e=t}else{var n=/(\-([a-z]){1})/g;if(n.test(e)){e=e.replace(n,function(){return arguments[2].toUpperCase()})}}}return e};BX.style=function(e,t,n){if(!BX.type.isElementNode(e)){return null}if(n==null){var i;if(e.currentStyle){i=e.currentStyle[BX.styleIEPropertyName(t)]}else{if(window.getComputedStyle){var r=BX.browser.isPropertySupported(t,true);if(!!r){t=r}i=BX.GetContext(e).getComputedStyle(e,null).getPropertyValue(t)}}if(!i){i=""}return i}else{e.style[BX.styleIEPropertyName(t)]=n;return e}};BX.focus=function(e){try{e.focus();return true}catch(t){return false}};BX.firstChild=function(e){var t=e.firstChild;while(t&&!BX.type.isElementNode(t)){t=t.nextSibling}return t};BX.lastChild=function(e){var t=e.lastChild;while(t&&!BX.type.isElementNode(t)){t=t.previousSibling}return t};BX.previousSibling=function(e){var t=e.previousSibling;while(t&&!BX.type.isElementNode(t)){t=t.previousSibling}return t};BX.nextSibling=function(e){var t=e.nextSibling;while(t&&!BX.type.isElementNode(t)){t=t.nextSibling}return t};BX.findChildrenByClassName=function(e,t,n){if(!e||!e.childNodes){return null}var r=[];if(typeof e.getElementsByClassName=="undefined"){n=n!==false;r=BX.findChildren(e,{className:t},n)}else{var o=e.getElementsByClassName(t);for(i=0,l=o.length;i<l;i++){r[i]=o[i]}}return r};BX.findChildByClassName=function(e,t,n){if(!e||!e.childNodes){return null}var i=null;if(typeof e.getElementsByClassName=="undefined"){n=n!==false;i=BX.findChild(e,{className:t},n)}else{var r=e.getElementsByClassName(t);if(r&&typeof r[0]!="undefined"){i=r[0]}else{i=null}}return i};BX.findChildren=function(e,t,n){return BX.findChild(e,t,n,true)};BX.findChild=function(e,t,n,i){if(!e||!e.childNodes){return null}n=!!n;i=!!i;var r=e.childNodes.length,o=[];for(var s=0;s<r;s++){var a=e.childNodes[s];if(_checkNode(a,t)){if(i){o.push(a)}else{return a}}if(n==true){var l=BX.findChild(a,t,n,i);if(l){if(i){o=BX.util.array_merge(o,l)}else{return l}}}}if(i||o.length>0){return o}else{return null}};BX.findParent=function(e,t,n){if(!e){return null}var i=e;while(i.parentNode){var r=i.parentNode;if(_checkNode(r,t)){return r}i=r;if(!!n&&(BX.type.isFunction(n)||typeof n=="object")){if(BX.type.isElementNode(n)){if(i==n){break}}else{if(_checkNode(i,n)){break}}}}return null};BX.findNextSibling=function(e,t){if(!e){return null}var n=e;while(n.nextSibling){var i=n.nextSibling;if(_checkNode(i,t)){return i}n=i}return null};BX.findPreviousSibling=function(e,t){if(!e){return null}var n=e;while(n.previousSibling){var i=n.previousSibling;if(_checkNode(i,t)){return i}n=i}return null};BX.checkNode=function(e,t){return _checkNode(e,t)};BX.findFormElements=function(e){if(BX.type.isString(e)){e=document.forms[e]||BX(e)}var t=[];if(BX.type.isElementNode(e)){if(e.tagName.toUpperCase()=="FORM"){t=e.elements}else{t=BX.findChildren(e,CHECK_FORM_ELEMENTS,true)}}return t};BX.isParentForNode=function(e,t){if(!BX.type.isDomNode(e)||!BX.type.isDomNode(t)){return false}while(true){if(e==t){return true}if(t&&t.parentNode){t=t.parentNode}else{break}}return false};BX.clone=function(e,t){var n,i,r;if(t!==false){t=true}if(e===null){return null}if(BX.type.isDomNode(e)){n=e.cloneNode(t)}else{if(typeof e=="object"){if(BX.type.isArray(e)){n=[];for(i=0,r=e.length;i<r;i++){if(typeof e[i]=="object"&&t){n[i]=BX.clone(e[i],t)}else{n[i]=e[i]}}}else{n={};if(e.constructor){if(e.constructor===Date){n=new Date(e)}else{n=new e.constructor}}for(i in e){if(typeof e[i]=="object"&&t){n[i]=BX.clone(e[i],t)}else{n[i]=e[i]}}}}else{n=e}}return n};BX.merge=function(){var e=Array.prototype.slice.call(arguments);if(e.length<2){return{}}var t=e.shift();for(var n=0;n<e.length;n++){for(var i in e[n]){if(typeof e[n]=="undefined"||e[n]==null){continue}if(e[n].hasOwnProperty(i)){if(typeof e[n][i]=="undefined"||e[n][i]==null){continue}if(typeof e[n][i]=="object"&&!BX.type.isDomNode(e[n][i])&&typeof e[n][i]["isUIWidget"]=="undefined"){var r="length" in e[n][i];if(typeof t[i]!="object"){t[i]=r?[]:{}}if(r){BX.util.array_merge(t[i],e[n][i])}else{BX.merge(t[i],e[n][i])}}else{t[i]=e[n][i]}}}}return t};BX.bind=function(e,t,n){if(!e){return}if(t==="mousewheel"){BX.bind(e,"DOMMouseScroll",n)}else{if(t==="transitionend"){BX.bind(e,"webkitTransitionEnd",n);BX.bind(e,"msTransitionEnd",n);BX.bind(e,"oTransitionEnd",n)}else{if(t==="bxchange"){BX.bind(e,"change",n);BX.bind(e,"cut",n);BX.bind(e,"paste",n);BX.bind(e,"drop",n);BX.bind(e,"keyup",n);return}}}if(e.addEventListener){e.addEventListener(t,n,false)}else{if(e.attachEvent){e.attachEvent("on"+t,BX.proxy(n,e))}else{e["on"+t]=n}}eventsList[eventsList.length]={element:e,event:t,fn:n}};BX.unbind=function(e,t,n){if(!e){return}if(t==="mousewheel"){BX.unbind(e,"DOMMouseScroll",n)}else{if(t==="transitionend"){BX.unbind(e,"webkitTransitionEnd",n);BX.unbind(e,"msTransitionEnd",n);BX.unbind(e,"oTransitionEnd",n)}else{if(t==="bxchange"){BX.unbind(e,"change",n);BX.unbind(e,"cut",n);BX.unbind(e,"paste",n);BX.unbind(e,"drop",n);BX.unbind(e,"keyup",n);return}}}if(e.removeEventListener){e.removeEventListener(t,n,false)}else{if(e.detachEvent){e.detachEvent("on"+t,BX.proxy(n,e))}else{e["on"+t]=null}}};BX.getEventButton=function(e){e=e||window.event;var t=0;if(typeof e.which!="undefined"){switch(e.which){case 1:t=t|BX.MSLEFT;break;case 2:t=t|BX.MSMIDDLE;break;case 3:t=t|BX.MSRIGHT;break}}else{if(typeof e.button!="undefined"){t=event.button}}return t||BX.MSLEFT};BX.unbindAll=function(e){if(!e){return}for(var t=0,n=eventsList.length;t<n;t++){try{if(eventsList[t]&&(null==e||e==eventsList[t].element)){BX.unbind(eventsList[t].element,eventsList[t].event,eventsList[t].fn);eventsList[t]=null}}catch(i){}}if(null==e){eventsList=[]}};var captured_events=null,_bind=null;BX.CaptureEvents=function(e,t){if(_bind){return}_bind=BX.bind;captured_events=[];BX.bind=function(n,i,r){if(n===e&&i===t){captured_events.push(r)}_bind.apply(this,arguments)}};BX.CaptureEventsGet=function(){if(_bind){BX.bind=_bind;var e=captured_events;_bind=null;captured_events=null;return e}return null};BX.fireEvent=function(e,t){var n=false,i=null;if(BX.type.isDomNode(e)){n=true;if(document.createEventObject){if(eventTypes[t]!="MouseEvent"){i=document.createEventObject();i.type=t;n=e.fireEvent("on"+t,i)}if(e[t]){e[t]()}}else{i=null;switch(eventTypes[t]){case"MouseEvent":i=document.createEvent("MouseEvent");i.initMouseEvent(t,true,true,top,1,0,0,0,0,0,0,0,0,0,null);break;default:i=document.createEvent("Event");i.initEvent(t,true,true)}n=e.dispatchEvent(i)}}return n};BX.getWheelData=function(e){e=e||window.event;e.wheelData=e.detail?e.detail*-1:e.wheelDelta/40;return e.wheelData};BX.proxy_context=null;BX.delegate=function(e,t){if(!e||!t){return e}return function(){var n=BX.proxy_context;BX.proxy_context=this;var i=e.apply(t,arguments);BX.proxy_context=n;return i}};BX.delegateLater=function(e,t,n){return function(){if(t[e]){var i=BX.proxy_context;BX.proxy_context=this;var r=t[e].apply(n||t,arguments);BX.proxy_context=i;return r}return null}};BX._initObjectProxy=function(e){if(typeof e["__proxy_id_"+proxySalt]=="undefined"){e["__proxy_id_"+proxySalt]=proxyList.length;proxyList[e["__proxy_id_"+proxySalt]]={}}};BX.proxy=function(e,t){if(!e||!t){return e}BX._initObjectProxy(t);if(typeof e["__proxy_id_"+proxySalt]=="undefined"){e["__proxy_id_"+proxySalt]=proxyId++}if(!proxyList[t["__proxy_id_"+proxySalt]][e["__proxy_id_"+proxySalt]]){proxyList[t["__proxy_id_"+proxySalt]][e["__proxy_id_"+proxySalt]]=BX.delegate(e,t)}return proxyList[t["__proxy_id_"+proxySalt]][e["__proxy_id_"+proxySalt]]};BX.defer=function(e,t){if(!!t){return BX.defer_proxy(e,t)}else{return function(){var t=arguments;setTimeout(function(){e.apply(this,t)},10)}}};BX.defer_proxy=function(e,t){if(!e||!t){return e}BX.proxy(e,t);this._initObjectProxy(t);if(typeof e["__defer_id_"+proxySalt]=="undefined"){e["__defer_id_"+proxySalt]=proxyId++}if(!proxyList[t["__proxy_id_"+proxySalt]][e["__defer_id_"+proxySalt]]){proxyList[t["__proxy_id_"+proxySalt]][e["__defer_id_"+proxySalt]]=BX.defer(BX.delegate(e,t))}return proxyList[t["__proxy_id_"+proxySalt]][e["__defer_id_"+proxySalt]]};BX.once=function(e,t,n){if(typeof n["__once_id_"+t+"_"+proxySalt]=="undefined"){n["__once_id_"+t+"_"+proxySalt]=proxyId++}this._initObjectProxy(e);if(!proxyList[e["__proxy_id_"+proxySalt]][n["__once_id_"+t+"_"+proxySalt]]){var i=function(){BX.unbind(e,t,i);n.apply(this,arguments)};proxyList[e["__proxy_id_"+proxySalt]][n["__once_id_"+t+"_"+proxySalt]]=i}return proxyList[e["__proxy_id_"+proxySalt]][n["__once_id_"+t+"_"+proxySalt]]};BX.bindDelegate=function(e,t,n,i){var r=BX.delegateEvent(n,i);BX.bind(e,t,r);return r};BX.delegateEvent=function(e,t){return function(n){n=n||window.event;var i=n.target||n.srcElement;while(i!=this){if(_checkNode(i,e)){return t.call(i,n)}if(i&&i.parentNode){i=i.parentNode}else{break}}return null}};BX.False=function(){return false};BX.DoNothing=function(){};BX.denyEvent=function(e,t){deniedEvents.push([e,t,e["on"+t]]);e["on"+t]=BX.DoNothing};BX.allowEvent=function(e,t){for(var n=0,i=deniedEvents.length;n<i;n++){if(deniedEvents[n][0]==e&&deniedEvents[n][1]==t){e["on"+t]=deniedEvents[n][2];BX.util.deleteFromArray(deniedEvents,n);return}}};BX.fixEventPageXY=function(e){BX.fixEventPageX(e);BX.fixEventPageY(e);return e};BX.fixEventPageX=function(e){if(e.pageX==null&&e.clientX!=null){e.pageX=e.clientX+(document.documentElement&&document.documentElement.scrollLeft||document.body&&document.body.scrollLeft||0)-(document.documentElement.clientLeft||0)}return e};BX.fixEventPageY=function(e){if(e.pageY==null&&e.clientY!=null){e.pageY=e.clientY+(document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0)-(document.documentElement.clientTop||0)}return e};BX.PreventDefault=function(e){if(!e){e=window.event}if(e.stopPropagation){e.preventDefault();e.stopPropagation()}else{e.cancelBubble=true;e.returnValue=false}return false};BX.eventReturnFalse=function(e){e=e||window.event;if(e&&e.preventDefault){e.preventDefault()}else{e.returnValue=false}return false};BX.eventCancelBubble=function(e){e=e||window.event;if(e&&e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}};BX.addCustomEvent=function(e,t,n){if(BX.type.isString(e)){n=t;t=e;e=window}t=t.toUpperCase();if(!customEvents[t]){customEvents[t]=[]}customEvents[t].push({handler:n,obj:e})};BX.removeCustomEvent=function(e,t,n){if(BX.type.isString(e)){n=t;t=e;e=window}t=t.toUpperCase();if(!customEvents[t]){return}for(var i=0,r=customEvents[t].length;i<r;i++){if(!customEvents[t][i]){continue}if(customEvents[t][i].handler==n&&customEvents[t][i].obj==e){delete customEvents[t][i];return}}};BX.onCustomEvent=function(e,t,n,i){if(BX.type.isString(e)){i=n;n=t;t=e;e=window}t=t.toUpperCase();if(!customEvents[t]){return}if(!n){n=[]}var r;for(var o=0,s=customEvents[t].length;o<s;o++){r=customEvents[t][o];if(!r||!r.handler){continue}if(r.obj==window||r.obj==e){r.handler.apply(e,!!i?BX.clone(n):n)}}};BX.bindDebouncedChange=function(e,t,n,i,r){r=r||window;i=i||300;var o="bx-dc-previous-value";BX.data(e,o,e.value);var s=function(t,n){var i=BX.data(e,o);if(typeof i=="undefined"||i!=n){if(typeof r!="object"){t(n)}else{t.apply(r,[n])}}};var a=BX.debounce(function(){var n=e.value;s(t,n);BX.data(e,o,n)},i);BX.bind(e,"keyup",a);BX.bind(e,"change",a);BX.bind(e,"input",a);if(BX.type.isFunction(n)){var l=function(){s(n,e.value)};BX.bind(e,"keyup",l);BX.bind(e,"change",l);BX.bind(e,"input",l)}};BX.parseJSON=function(data,context){var result=null;if(BX.type.isString(data)){try{if(data.indexOf("\n")>=0){eval("result = "+data)}else{result=new Function("return "+data)()}}catch(e){BX.onCustomEvent(context,"onParseJSONFailure",[data,context])}}return result};BX.isReady=false;BX.ready=function(e){bindReady();if(!BX.type.isFunction(e)){BX.debug("READY: not a function! ",e)}else{if(BX.isReady){e.call(document)}else{if(readyList){readyList.push(e)}}}};BX.submit=function(e,t,n,i){t=t||"save";if(!e["BXFormSubmit_"+t]){e["BXFormSubmit_"+t]=e.appendChild(BX.create("INPUT",{props:{type:"submit",name:t,value:n||"Y"},style:{display:"none"}}))}if(e.sessid){e.sessid.value=BX.bitrix_sessid()}setTimeout(BX.delegate(function(){BX.fireEvent(this,"click");if(i){i()}},e["BXFormSubmit_"+t]),10)};BX.debounce=function(e,t,n){var i=0;return function(){n=n||this;var r=arguments;clearTimeout(i);i=setTimeout(function(){e.apply(n,r)},t)}};BX.throttle=function(e,t,n){var i=0,r=null,o;return function(){n=n||this;r=arguments;o=true;if(!i){var s=function(){if(o){e.apply(n,r);o=false;i=setTimeout(s,t)}else{i=null}};s()}}};BX.browser={IsIE:function(){return bIE},IsIE6:function(){return/MSIE 6/i.test(navigator.userAgent)},IsIE7:function(){return/MSIE 7/i.test(navigator.userAgent)},IsIE8:function(){return/MSIE 8/i.test(navigator.userAgent)},IsIE9:function(){return !!document.documentMode&&document.documentMode>=9},IsIE10:function(){return !!document.documentMode&&document.documentMode>=10},IsIE11:function(){return BX.browser.DetectIeVersion()>=11},IsOpera:function(){return bOpera},IsSafari:function(){return bSafari},IsFirefox:function(){return bFirefox},IsChrome:function(){return bChrome},IsMac:function(){return/Macintosh/i.test(navigator.userAgent)},IsAndroid:function(){return/Android/i.test(navigator.userAgent)},IsIOS:function(){return/(iPad;)|(iPhone;)/i.test(navigator.userAgent)},IsMobile:function(){return/(ipad|iphone|android|mobile|touch)/i.test(navigator.userAgent)},DetectIeVersion:function(){if(BX.browser.IsOpera()||BX.browser.IsSafari()||BX.browser.IsFirefox()||BX.browser.IsChrome()){return -1}var e=-1;if(!!window.MSStream&&!window.ActiveXObject&&"ActiveXObject" in window){e=11}else{if(BX.browser.IsIE10()){e=10}else{if(BX.browser.IsIE9()){e=9}else{if(BX.browser.IsIE()){e=8}}}}if(e==-1||e==8){var t;if(navigator.appName=="Microsoft Internet Explorer"){t=new RegExp("MSIE ([0-9]+[.0-9]*)");if(t.exec(navigator.userAgent)!=null){e=parseFloat(RegExp.$1)}}else{if(navigator.appName=="Netscape"){e=11;t=new RegExp("Trident/.*rv:([0-9]+[.0-9]*)");if(t.exec(navigator.userAgent)!=null){e=parseFloat(RegExp.$1)}}}}return e},IsDoctype:function(e){e=e||document;if(e.compatMode){return e.compatMode=="CSS1Compat"}return e.documentElement&&e.documentElement.clientHeight},SupportLocalStorage:function(){return !!BX.localStorage&&!!BX.localStorage.checkBrowser()},addGlobalClass:function(){var e="bx-core";if(BX.hasClass(document.documentElement,e)){return}if(BX.browser.IsIOS()){e+=" bx-ios"}else{if(BX.browser.IsMac()){e+=" bx-mac"}else{if(BX.browser.IsAndroid()){e+=" bx-android"}}}e+=BX.browser.IsMobile()?" bx-touch":" bx-no-touch";e+=BX.browser.isRetina()?" bx-retina":" bx-no-retina";var t=-1;if(/AppleWebKit/.test(navigator.userAgent)){e+=" bx-chrome"}else{if((t=BX.browser.DetectIeVersion())>0){e+=" bx-ie bx-ie"+t;if(t>7&&t<10&&!BX.browser.IsDoctype()){e+=" bx-quirks"}}else{if(/Opera/.test(navigator.userAgent)){e+=" bx-opera"}else{if(/Gecko/.test(navigator.userAgent)){e+=" bx-firefox"}}}}BX.addClass(document.documentElement,e)},isPropertySupported:function(e,t){if(!BX.type.isNotEmptyString(e)){return false}var n=e.indexOf("-")>-1?f(e):e;t=!!t;var i=n.charAt(0).toUpperCase()+n.slice(1);var r=(n+" "+["Webkit","Moz","O","ms"].join(i+" ")+i).split(" ");var o=document.body||document.documentElement;for(var s=0;s<r.length;s++){var a=r[s];if(o.style[a]!==undefined){var l=a==n?"":"-"+a.substr(0,a.length-n.length).toLowerCase()+"-";return t?l+u(n):a}}function u(e){return e.replace(/([A-Z])/g,function(){return"-"+arguments[1].toLowerCase()})}function f(e){var t=/(\-([a-z]){1})/g;if(t.test(e)){return e.replace(t,function(){return arguments[2].toUpperCase()})}else{return e}}return false},addGlobalFeatures:function(e,t){if(!BX.type.isArray(e)){return}var n=[];for(var i=0;i<e.length;i++){var r=!!BX.browser.isPropertySupported(e[i]);n.push("bx-"+(r?"":"no-")+e[i].toLowerCase())}BX.addClass(document.documentElement,n.join(" "))},isRetina:function(){return window.devicePixelRatio&&window.devicePixelRatio>=2}};BX.show=function(e,t){if(e.BXDISPLAY||!_checkDisplay(e,t)){e.style.display=e.BXDISPLAY}};BX.hide=function(e,t){if(!e.BXDISPLAY){_checkDisplay(e,t)}e.style.display="none"};BX.toggle=function(e,t){if(!t&&BX.type.isElementNode(e)){var n=true;if(e.BXDISPLAY){n=!_checkDisplay(e)}else{n=e.style.display=="none"}if(n){BX.show(e)}else{BX.hide(e)}}else{if(BX.type.isArray(t)){for(var i=0,r=t.length;i<r;i++){if(e==t[i]){e=t[i==r-1?0:i+1];break}}if(i==r){e=t[0]}}}return e};BX.util={array_values:function(e){if(!BX.type.isArray(e)){return BX.util._array_values_ob(e)}var t=[];for(var n=0,i=e.length;n<i;n++){if(e[n]!==null&&typeof e[n]!="undefined"){t.push(e[n])}}return t},_array_values_ob:function(e){var t=[];for(var n in e){if(e[n]!==null&&typeof e[n]!="undefined"){t.push(e[n])}}return t},array_keys:function(e){if(!BX.type.isArray(e)){return BX.util._array_keys_ob(e)}var t=[];for(var n=0,i=e.length;n<i;n++){if(e[n]!==null&&typeof e[n]!="undefined"){t.push(n)}}return t},_array_keys_ob:function(e){var t=[];for(var n in e){if(e[n]!==null&&typeof e[n]!="undefined"){t.push(n)}}return t},object_keys:function(e){var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n)}}return t},array_merge:function(e,t){if(!BX.type.isArray(e)){e=[]}if(!BX.type.isArray(t)){t=[]}var n=e.length,i=0;if(typeof t.length==="number"){for(var r=t.length;i<r;i++){e[n++]=t[i]}}else{while(t[i]!==undefined){e[n++]=t[i++]}}e.length=n;return e},array_unique:function(e){var t=0,n,i=e.length;if(i<2){return e}for(;t<i-1;t++){for(n=t+1;n<i;n++){if(e[t]==e[n]){e.splice(n--,1);i--}}}return e},in_array:function(e,t){for(var n=0;n<t.length;n++){if(t[n]==e){return true}}return false},array_search:function(e,t){for(var n=0;n<t.length;n++){if(t[n]==e){return n}}return -1},object_search_key:function(e,t){if(typeof t[e]!="undefined"){return t[e]}for(var n in t){if(typeof t[n]=="object"){var i=BX.util.object_search_key(e,t[n]);if(i!==false){return i}}}return false},trim:function(e){if(BX.type.isString(e)){return e.replace(r.ltrim,"").replace(r.rtrim,"")}else{return e}},urlencode:function(e){return encodeURIComponent(e)},deleteFromArray:function(e,t){return e.slice(0,t).concat(e.slice(t+1))},insertIntoArray:function(e,t,n){return e.slice(0,t).concat([n]).concat(e.slice(t))},htmlspecialchars:function(e){if(!e.replace){return e}return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlspecialcharsback:function(e){if(!e.replace){return e}return e.replace(/\&quot;/g,'"').replace(/&#39;/g,"'").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&amp;/g,"&")},preg_quote:function(e,t){if(!e.replace){return e}return e.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(t||"")+"-]","g"),"\\$&")},jsencode:function(e){if(!e||!e.replace){return e}var t=[{c:"\\\\",r:"\\\\"},{c:"\\t",r:"\\t"},{c:"\\n",r:"\\n"},{c:"\\r",r:"\\r"},{c:'"',r:'\\"'},{c:"'",r:"\\'"},{c:"<",r:"\\x3C"},{c:">",r:"\\x3E"},{c:"\\u2028",r:"\\u2028"},{c:"\\u2029",r:"\\u2029"}];for(var n=0;n<t.length;n++){e=e.replace(new RegExp(t[n].c,"g"),t[n].r)}return e},str_pad:function(e,t,n,i){n=n||" ";i=i||"right";e=e.toString();if(i=="left"){return BX.util.str_pad_left(e,t,n)}else{return BX.util.str_pad_right(e,t,n)}},str_pad_left:function(e,t,n){var i=e.length,r=n.length;if(i>=t){return e}for(;i<t;i+=r){e=n+e}return e},str_pad_right:function(e,t,n){var i=e.length,r=n.length;if(i>=t){return e}for(;i<t;i+=r){e+=n}return e},strip_tags:function(e){return e.split(/<[^>]+>/g).join("")},strip_php_tags:function(e){return e.replace(/<\?(.|[\r\n])*?\?>/g,"")},popup:function(e,t,n){var i,r;if(BX.browser.IsOpera()){i=document.body.offsetWidth;r=document.body.offsetHeight}else{i=screen.width;r=screen.height}return window.open(e,"","status=no,scrollbars=yes,resizable=yes,width="+t+",height="+n+",top="+Math.floor((r-n)/2-14)+",left="+Math.floor((i-t)/2-5))},objectSort:function(e,t,n){n=n=="asc"?"asc":"desc";var i=[],r;for(r in e){if(e.hasOwnProperty(r)&&e[r][t]){i.push([r,e[r][t]])}}if(n=="asc"){i.sort(function(e,t){var n,i;if(!isNaN(e[1])&&!isNaN(t[1])){n=parseInt(e[1]);i=parseInt(t[1])}else{n=e[1].toString().toLowerCase();i=t[1].toString().toLowerCase()}if(n>i){return 1}else{if(n<i){return -1}else{return 0}}})}else{i.sort(function(e,t){var n,i;if(!isNaN(e[1])&&!isNaN(t[1])){n=parseInt(e[1]);i=parseInt(t[1])}else{n=e[1].toString().toLowerCase();i=t[1].toString().toLowerCase()}if(n<i){return 1}else{if(n>i){return -1}else{return 0}}})}var o=Array();for(r=0;r<i.length;r++){o.push(e[i[r][0]])}return o},hex2rgb:function(e){var t=e.replace(/[# ]/g,"").replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3").match(/.{2}/g);for(var n=0;n<3;n++){t[n]=parseInt(t[n],16)}return{r:t[0],g:t[1],b:t[2]}},remove_url_param:function(e,t){if(BX.type.isArray(t)){for(var n=0;n<t.length;n++){e=BX.util.remove_url_param(e,t[n])}}else{var i,r;if((i=e.indexOf("?"))>=0&&i!=e.length-1){r=e.substr(i+1);e=e.substr(0,i+1);r=r.replace(new RegExp("(^|&)"+t+"=[^&#]*","i"),"");r=r.replace(/^&/,"");e=e+r}}return e},add_url_param:function(e,t){var n;var i="";var r="";var o;for(n in t){e=this.remove_url_param(e,n);i+=(i!=""?"&":"")+n+"="+t[n]}if((o=e.indexOf("#"))>=0){r=e.substr(o);e=e.substr(0,o)}if((o=e.indexOf("?"))>=0){e=e+(o!=e.length-1?"&":"")+i+r}else{e=e+"?"+i+r}return e},even:function(e){return parseInt(e)%2==0},hashCode:function(e){if(!BX.type.isNotEmptyString(e)){return 0}var t=0;for(var n=0;n<e.length;n++){var i=e.charCodeAt(n);t=(t<<5)-t+i;t=t&t}return t},getRandomString:function(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var n=t.length;e=parseInt(e);if(isNaN(e)||e<=0){e=8}var i="";for(var r=0;r<e;r++){i+=t.charAt(Math.floor(Math.random()*n))}return i},number_format:function(e,t,n,i){var r,o,s,a,l,u="";t=Math.abs(t);if(isNaN(t)||t<0){t=2}n=n||",";i=i||".";e=(+e||0).toFixed(t);if(e<0){u="-";e=-e}r=parseInt(e,10)+"";o=r.length>3?r.length%3:0;l=o?r.substr(0,o)+i:"";s=r.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+i);a=t?n+Math.abs(e-r).toFixed(t).replace(/-/,"0").slice(2):"";return u+l+s+a},getExtension:function(e){e=e||"";var t=e.split("?")[0].split(".");return t[t.length-1].toLowerCase()},addObjectToForm:function(e,t,n){if(!BX.type.isString(n)){n=""}for(var i in e){if(!e.hasOwnProperty(i)){continue}var r=e[i];var o=n!==""?n+"["+i+"]":i;if(BX.type.isArray(r)){for(var s=0;s<r.length;s++){BX.util.addObjectToForm(r[s],t,o+"["+s.toString()+"]")}}else{if(BX.type.isPlainObject(r)){BX.util.addObjectToForm(r,t,o)}else{r=BX.type.isFunction(r.toString)?r.toString():"";if(r!==""){t.appendChild(BX.create("INPUT",{attrs:{type:"hidden",name:o,value:r}}))}}}}},observe:function(e,t){if(!BX.browser.IsChrome()||typeof e!="object"){return false}t=t!==false;var n=function(e){e.forEach(function(e){var t=e.name+" changed";console.groupCollapsed(t);console.log("Old value: ",e.oldValue);console.log("New value: ",e.object[e.name]);console.groupEnd(t)})};if(t){Object.observe(e,n)}else{Object.unobserve(e,n)}return t}};BX.type={isString:function(e){return e===""?true:e?typeof e=="string"||e instanceof String:false},isNotEmptyString:function(e){return BX.type.isString(e)?e.length>0:false},isBoolean:function(e){return e===true||e===false},isNumber:function(e){return e===0?true:e?typeof e=="number"||e instanceof Number:false},isFunction:function(e){return e===null?false:typeof e=="function"||e instanceof Function},isElementNode:function(e){return e&&typeof e=="object"&&"nodeType" in e&&e.nodeType==1&&e.tagName&&e.tagName.toUpperCase()!="SCRIPT"&&e.tagName.toUpperCase()!="STYLE"&&e.tagName.toUpperCase()!="LINK"},isDomNode:function(e){return e&&typeof e=="object"&&"nodeType" in e},isArray:function(e){return e&&Object.prototype.toString.call(e)=="[object Array]"},isDate:function(e){return e&&Object.prototype.toString.call(e)=="[object Date]"},isPlainObject:function(e){if(!e||typeof e!=="object"||e.nodeType){return false}var t=Object.prototype.hasOwnProperty;try{if(e.constructor&&!t.call(e,"constructor")&&!t.call(e.constructor.prototype,"isPrototypeOf")){return false}}catch(n){return false}var i;for(i in e){}return typeof i==="undefined"||t.call(e,i)}};BX.isNodeInDom=function(e,t){return e===(t||document)?true:e.parentNode?BX.isNodeInDom(e.parentNode):false};BX.isNodeHidden=function(e){if(e===document){return false}else{if(BX.style(e,"display")=="none"){return true}else{return e.parentNode?BX.isNodeHidden(e.parentNode):true}}};BX.evalPack=function(e){while(e.length>0){var t=e.shift();if(t.TYPE=="SCRIPT_EXT"||t.TYPE=="SCRIPT_SRC"){BX.loadScript(t.DATA,function(){BX.evalPack(e)});return}else{if(t.TYPE=="SCRIPT"){BX.evalGlobal(t.DATA)}}}};BX.evalGlobal=function(e){if(e){var t=document.getElementsByTagName("head")[0]||document.documentElement,n=document.createElement("script");n.type="text/javascript";if(!BX.browser.IsIE()){n.appendChild(document.createTextNode(e))}else{n.text=e}t.insertBefore(n,t.firstChild);t.removeChild(n)}};BX.processHTML=function(e,t){var n,i,o,s,a,l=[],u=[];var f=[];var d=r.script.lastIndex=r.script_end.lastIndex=0;while((n=r.script.exec(e))!==null){r.script_end.lastIndex=r.script.lastIndex;var c=r.script_end.exec(e);if(c===null){break}var p=false;if((a=n[1].match(r.script_type))!==null){if(a[1]=="text/html"||a[1]=="text/template"){p=true}}if(p){f.push([d,r.script_end.lastIndex-d])}else{f.push([d,n.index-d]);var h=t||n[1].indexOf("bxrunfirst")!="-1";if((o=n[1].match(r.script_src))!==null){l.push({bRunFirst:h,isInternal:false,JS:o[1]})}else{var m=n.index+n[0].length;var y=e.substr(m,c.index-m);l.push({bRunFirst:h,isInternal:true,JS:y})}}d=c.index+9;r.script.lastIndex=d}f.push([d,d===0?e.length:e.length-d]);var B="";for(var X=0,g=f.length;X<g;X++){B+=e.substr(f[X][0],f[X][1])}while((i=B.match(r.style))!==null){if((s=i[0].match(r.style_href))!==null&&i[0].indexOf('media="')<0){u.push(s[1])}B=B.replace(i[0],"")}return{HTML:B,SCRIPT:l,STYLE:u}};BX.garbage=function(e,t){garbageCollectors.push({callback:e,context:t})};BX.GetDocElement=function(e){e=e||document;return BX.browser.IsDoctype(e)?e.documentElement:e.body};BX.GetContext=function(e){if(BX.type.isElementNode(e)){return e.ownerDocument.parentWindow||e.ownerDocument.defaultView||window}else{if(BX.type.isDomNode(e)){return e.parentWindow||e.defaultView||window}else{return window}}};BX.GetWindowInnerSize=function(e){var t,n;e=e||document;if(window.innerHeight){t=BX.GetContext(e).innerWidth;n=BX.GetContext(e).innerHeight}else{if(e.documentElement&&(e.documentElement.clientHeight||e.documentElement.clientWidth)){t=e.documentElement.clientWidth;n=e.documentElement.clientHeight}else{if(e.body){t=e.body.clientWidth;n=e.body.clientHeight}}}return{innerWidth:t,innerHeight:n}};BX.GetWindowScrollPos=function(e){var t,n;e=e||document;if(window.pageYOffset){t=BX.GetContext(e).pageXOffset;n=BX.GetContext(e).pageYOffset}else{if(e.documentElement&&(e.documentElement.scrollTop||e.documentElement.scrollLeft)){t=e.documentElement.scrollLeft;n=e.documentElement.scrollTop}else{if(e.body){t=e.body.scrollLeft;n=e.body.scrollTop}}}return{scrollLeft:t,scrollTop:n}};BX.GetWindowScrollSize=function(e){var t,n;if(!e){e=document}if(e.compatMode&&e.compatMode=="CSS1Compat"){t=e.documentElement.scrollWidth;n=e.documentElement.scrollHeight}else{if(e.body.scrollHeight>e.body.offsetHeight){n=e.body.scrollHeight}else{n=e.body.offsetHeight}if(e.body.scrollWidth>e.body.offsetWidth||e.compatMode&&e.compatMode=="BackCompat"||e.documentElement&&!e.documentElement.clientWidth){t=e.body.scrollWidth}else{t=e.body.offsetWidth}}return{scrollWidth:t,scrollHeight:n}};BX.GetWindowSize=function(e){var t=this.GetWindowInnerSize(e);var n=this.GetWindowScrollPos(e);var i=this.GetWindowScrollSize(e);return{innerWidth:t.innerWidth,innerHeight:t.innerHeight,scrollLeft:n.scrollLeft,scrollTop:n.scrollTop,scrollWidth:i.scrollWidth,scrollHeight:i.scrollHeight}};BX.scrollTop=function(e,t){if(typeof t!="undefined"){if(e==window){throw new Error("scrollTop() for window is not implemented")}else{e.scrollTop=parseInt(t)}}else{if(e==window){return BX.GetWindowScrollPos().scrollTop}return e.scrollTop}};BX.scrollLeft=function(e,t){if(typeof t!="undefined"){if(e==window){throw new Error("scrollLeft() for window is not implemented")}else{e.scrollLeft=parseInt(t)}}else{if(e==window){return BX.GetWindowScrollPos().scrollLeft}return e.scrollLeft}};BX.hide_object=function(e){e=BX(e);e.style.position="absolute";e.style.top="-1000px";e.style.left="-1000px";e.style.height="10px";e.style.width="10px"};BX.is_relative=function(e){var t=BX.style(e,"position");return t=="relative"||t=="absolute"};BX.is_float=function(e){var t=BX.style(e,"float");return t=="right"||t=="left"};BX.is_fixed=function(e){var t=BX.style(e,"position");return t=="fixed"};BX.pos=function(e,t){var n={top:0,right:0,bottom:0,left:0,width:0,height:0};t=!!t;if(!e){return n}if(typeof e.getBoundingClientRect!="undefined"&&e.ownerDocument==document&&!t){var i={};try{i=e.getBoundingClientRect()}catch(r){i={top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight,right:e.offsetLeft+e.offsetWidth,bottom:e.offsetTop+e.offsetHeight}}var o=document.documentElement;var s=document.body;n.top=i.top+(o.scrollTop||s.scrollTop);n.left=i.left+(o.scrollLeft||s.scrollLeft);n.width=i.right-i.left;n.height=i.bottom-i.top;n.right=i.right+(o.scrollLeft||s.scrollLeft);n.bottom=i.bottom+(o.scrollTop||s.scrollTop)}else{var a=0,l=0,u=e.offsetWidth,f=e.offsetHeight;var d=true;for(;e!=null;e=e.offsetParent){if(!d&&t&&BX.is_relative(e)){break}a+=e.offsetLeft;l+=e.offsetTop;if(d){d=false;continue}var c=parseInt(BX.style(e,"border-left-width")),p=parseInt(BX.style(e,"border-top-width"));if(!isNaN(c)&&c>0){a+=c}if(!isNaN(p)&&p>0){l+=p}}n.top=l;n.left=a;n.width=u;n.height=f;n.right=n.left+u;n.bottom=n.top+f}for(var h in n){if(n.hasOwnProperty(h)){n[h]=Math.round(n[h])}}return n};BX.width=function(e,t){if(typeof t!="undefined"){BX.style(e,"width",parseInt(t)+"px")}else{if(e==window){return window.innerWidth}return BX.pos(e).width}};BX.height=function(e,t){if(typeof t!="undefined"){BX.style(e,"height",parseInt(t)+"px")}else{if(e==window){return window.innerHeight}return BX.pos(e).height}};BX.align=function(e,t,n,i){if(i){i=i.toLowerCase()}else{i=""}var r=document;if(BX.type.isElementNode(e)){r=e.ownerDocument;e=BX.pos(e)}var o=e.left,s=e.bottom;var a=BX.GetWindowScrollPos(r);var l=BX.GetWindowInnerSize(r);if(l.innerWidth+a.scrollLeft-(e.left+t)<0){if(e.right-t>=0){o=e.right-t}else{o=a.scrollLeft}}if(l.innerHeight+a.scrollTop-(e.bottom+n)<0||~i.indexOf("top")){if(e.top-n>=0||~i.indexOf("top")){s=e.top-n}else{s=a.scrollTop}}return{left:o,top:s}};BX.scrollToNode=function(e){var t=BX(e);if(t.scrollIntoView){t.scrollIntoView(true)}else{var n=BX.pos(t);window.scrollTo(n.left,n.top)}};BX.showWait=function(e,t){e=BX(e)||document.body||document.documentElement;t=t||BX.message("JS_CORE_LOADING");var n=e.id||Math.random();var i=e.bxmsg=document.body.appendChild(BX.create("DIV",{props:{id:"wait_"+n},style:{background:'url("/bitrix/js/main/core/images/wait.gif") no-repeat scroll 10px center #fcf7d1',border:"1px solid #E1B52D",color:"black",fontFamily:"Verdana,Arial,sans-serif",fontSize:"11px",padding:"10px 30px 10px 37px",position:"absolute",zIndex:"10000",textAlign:"center"},text:t}));setTimeout(BX.delegate(_adjustWait,e),10);lastWait[lastWait.length]=i;return i};BX.closeWait=function(e,t){if(e&&!t){t=e.bxmsg}if(e&&!t&&BX.hasClass(e,"bx-core-waitwindow")){t=e}if(e&&!t){t=BX("wait_"+e.id)}if(!t){t=lastWait.pop()}if(t&&t.parentNode){for(var n=0,i=lastWait.length;n<i;n++){if(t==lastWait[n]){lastWait=BX.util.deleteFromArray(lastWait,n);break}}t.parentNode.removeChild(t);if(e){e.bxmsg=null}BX.cleanNode(t,true)}};BX.setJSList=function(e){if(BX.type.isArray(e)){jsList=e}};BX.getJSList=function(){initJsList();return jsList};BX.setCSSList=function(e){if(BX.type.isArray(e)){cssList=e}};BX.getCSSList=function(){initCssList();return cssList};BX.getJSPath=function(e){return e.replace(/^(http[s]*:)*\/\/[^\/]+/i,"")};BX.getCSSPath=function(e){return e.replace(/^(http[s]*:)*\/\/[^\/]+/i,"")};BX.getCDNPath=function(e){return e};BX.loadScript=function(e,t,n){if(!BX.isReady){var i=arguments;BX.ready(function(){BX.loadScript.apply(this,i)});return}n=n||document;if(BX.type.isString(e)){e=[e]}var r=function(){return t&&BX.type.isFunction(t)?t():null};var o=function(t){if(t>=e.length){return r()}if(!!e[t]){var i=BX.getJSPath(e[t]);if(isScriptLoaded(i)){o(++t)}else{var s=n.getElementsByTagName("head")[0]||n.documentElement;var a=n.createElement("script");a.src=e[t];var l=false;a.onload=a.onreadystatechange=function(){if(!l&&(!a.readyState||a.readyState=="loaded"||a.readyState=="complete")){l=true;setTimeout(function(){o(++t)},50);a.onload=a.onreadystatechange=null;if(s&&a.parentNode){s.removeChild(a)}}};jsList.push(i);return s.insertBefore(a,s.firstChild)}}else{o(++t)}return null};o(0)};BX.loadCSS=function(e,t,n){if(!BX.isReady){var i=arguments;BX.ready(function(){BX.loadCSS.apply(this,i)});return null}var r=false;if(BX.type.isString(e)){r=true;e=[e]}var o,s=e.length,a=null,l=[];if(s==0){return null}t=t||document;n=n||window;if(!n.bxhead){var u=t.getElementsByTagName("HEAD");n.bxhead=u[0];if(!n.bxhead){return null}}for(o=0;o<s;o++){var f=BX.getCSSPath(e[o]);if(isCssLoaded(f)){continue}a=document.createElement("LINK");a.href=e[o];a.rel="stylesheet";a.type="text/css";var d=getTemplateLink(n.bxhead);if(d!==null){d.parentNode.insertBefore(a,d)}else{n.bxhead.appendChild(a)}l.push(a);cssList.push(f)}if(r){return a}return l};BX.load=function(e,t,n){if(!BX.isReady){var i=arguments;BX.ready(function(){BX.load.apply(this,i)});return null}n=n||document;if(isAsync===null){isAsync="async" in n.createElement("script")||"MozAppearance" in n.documentElement.style||window.opera}return isAsync?loadAsync(e,t,n):loadAsyncEmulation(e,t,n)};BX.convert={nodeListToArray:function(e){try{return Array.prototype.slice.call(e,0)}catch(t){var n=[];for(var i=0,r=e.length;i<r;i++){n.push(e[i])}return n}}};function loadAsync(e,t,n){if(!BX.type.isArray(e)){return}function i(e){e=e||assets;for(var t in e){if(e.hasOwnProperty(t)&&e[t].state!==LOADED){return false}}return true}function r(e){e=e||BX.DoNothing;if(e._done){return}e();e._done=1}if(!BX.type.isFunction(t)){t=null}var o={},s,a;for(a=0;a<e.length;a++){s=e[a];s=getAsset(s);o[s.name]=s}for(a=0;a<e.length;a++){s=e[a];s=getAsset(s);load(s,function(){if(i(o)){r(t)}},n)}}function loadAsyncEmulation(e,t,n){function i(e){e.state=PRELOADED;if(BX.type.isArray(e.onpreload)&&e.onpreload){for(var t=0;t<e.onpreload.length;t++){e.onpreload[t].call()}}}function r(e){if(e.state===undefined){e.state=PRELOADING;e.onpreload=[];loadAsset({url:e.url,type:"cache",ext:e.ext},function(){i(e)},n)}}if(!BX.type.isArray(e)){return}if(!BX.type.isFunction(t)){t=null}var o=[].slice.call(e,1);for(var s=0;s<o.length;s++){r(getAsset(o[s]))}load(getAsset(e[0]),e.length===1?t:function(){loadAsyncEmulation.apply(null,[o,t,n])},n)}function load(e,t,n){t=t||BX.DoNothing;if(e.state===LOADED){t();return}if(e.state===PRELOADING){e.onpreload.push(function(){load(e,t,n)});return}e.state=LOADING;loadAsset(e,function(){e.state=LOADED;t()},n)}function loadAsset(e,t,n){t=t||BX.DoNothing;function i(e){s.onload=s.onreadystatechange=s.onerror=null;t()}function r(i){i=i||window.event;if(i.type==="load"||/loaded|complete/.test(s.readyState)&&(!n.documentMode||n.documentMode<9)){window.clearTimeout(e.errorTimeout);window.clearTimeout(e.cssTimeout);s.onload=s.onreadystatechange=s.onerror=null;t()}}function o(){if(e.state!==LOADED&&e.cssRetries<=20){for(var t=0,i=n.styleSheets.length;t<i;t++){if(n.styleSheets[t].href===s.href){r({type:"load"});return}}e.cssRetries++;e.cssTimeout=window.setTimeout(o,250)}}var s;var a=BX.type.isNotEmptyString(e.ext)?e.ext:BX.util.getExtension(e.url);if(a==="css"){s=n.createElement("link");s.type="text/"+(e.type||"css");s.rel="stylesheet";s.href=e.url;e.cssRetries=0;e.cssTimeout=window.setTimeout(o,500)}else{s=n.createElement("script");s.type="text/"+(e.type||"javascript");s.src=e.url}s.onload=s.onreadystatechange=r;s.onerror=i;s.async=false;s.defer=false;e.errorTimeout=window.setTimeout(function(){i({type:"timeout"})},7000);if(a==="css"){cssList.push(BX.getCSSPath(e.url))}else{jsList.push(BX.getJSPath(e.url))}var l=null;var u=n.head||n.getElementsByTagName("head")[0];if(a==="css"&&(l=getTemplateLink(u))!==null){l.parentNode.insertBefore(s,l)}else{u.insertBefore(s,u.lastChild)}}function getAsset(e){var t={};if(typeof e==="object"){t=e;t.name=t.name?t.name:BX.util.hashCode(e.url)}else{t={name:BX.util.hashCode(e),url:e}}var n=BX.type.isNotEmptyString(t.ext)?t.ext:BX.util.getExtension(t.url);if(n==="css"&&isCssLoaded(t.url)||isScriptLoaded(t.url)){t.state=LOADED}var i=assets[t.name];if(i&&i.url===t.url){return i}assets[t.name]=t;return t}function isCssLoaded(e){initCssList();return BX.util.in_array(BX.getCSSPath(e),cssList)}function initCssList(){if(!cssInit){var e=document.getElementsByTagName("link");if(!!e&&e.length>0){for(var t=0;t<e.length;t++){var n=e[t].getAttribute("href");if(BX.type.isNotEmptyString(n)){cssList.push(BX.getCSSPath(n))}}}cssInit=true}}function getTemplateLink(e){var t=function(t){var n=e.getElementsByTagName(t);for(var i=0,r=n.length;i<r;i++){var o=n[i].getAttribute("data-template-style");if(BX.type.isNotEmptyString(o)&&o=="true"){return n[i]}}return null};var n=t("link");if(n===null){n=t("style")}return n}function isScriptLoaded(e){initJsList();return BX.util.in_array(BX.getJSPath(e),jsList)}function initJsList(){if(!jsInit){var e=document.getElementsByTagName("script");if(!!e&&e.length>0){for(var t=0;t<e.length;t++){var n=e[t].getAttribute("src");if(BX.type.isNotEmptyString(n)){jsList.push(BX.getJSPath(n))}}}jsInit=true}}BX.reload=function(e,t){if(e===true){t=true;e=null}var n=e||top.location.href;var i=n.indexOf("#"),r="";if(i!=-1){r=n.substr(i);n=n.substr(0,i)}if(t&&n.indexOf("clear_cache=Y")<0){n+=(n.indexOf("?")==-1?"?":"&")+"clear_cache=Y"}if(r){if(t&&(r.substr(0,5)=="view/"||r.substr(0,6)=="#view/")&&r.indexOf("clear_cache%3DY")<0){r+=(r.indexOf("%3F")==-1?"%3F":"%26")+"clear_cache%3DY"}n=n.replace(/(\?|\&)_r=[\d]*/,"");n+=(n.indexOf("?")==-1?"?":"&")+"_r="+Math.round(Math.random()*10000)+r}top.location.href=n};BX.clearCache=function(){BX.showWait();BX.reload(true)};BX.template=function(e,t,n){BX.ready(function(){_processTpl(BX(e),t,n)})};BX.isAmPmMode=function(){return BX.message("FORMAT_DATETIME").match("T")!=null};BX.formatDate=function(e,t){e=e||new Date;var n=e.getHours()||e.getMinutes()||e.getSeconds(),i=!!t?t:n?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE");return i.replace(/YYYY/gi,e.getFullYear()).replace(/MMMM/gi,BX.util.str_pad_left((e.getMonth()+1).toString(),2,"0")).replace(/MM/gi,BX.util.str_pad_left((e.getMonth()+1).toString(),2,"0")).replace(/DD/gi,BX.util.str_pad_left(e.getDate().toString(),2,"0")).replace(/HH/gi,BX.util.str_pad_left(e.getHours().toString(),2,"0")).replace(/MI/gi,BX.util.str_pad_left(e.getMinutes().toString(),2,"0")).replace(/SS/gi,BX.util.str_pad_left(e.getSeconds().toString(),2,"0"))};BX.getNumMonth=function(e){var t=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];var n=["january","february","march","april","may","june","july","august","september","october","november","december"];var r=e.toUpperCase();for(i=1;i<=12;i++){if(r==BX.message("MON_"+i).toUpperCase()||r==BX.message("MONTH_"+i).toUpperCase()||r==t[i-1].toUpperCase()||r==n[i-1].toUpperCase()){return i}}return e};BX.parseDate=function(e,t){if(BX.type.isNotEmptyString(e)){var n="";for(s=1;s<=12;s++){n=n+"|"+BX.message("MON_"+s)}var i=new RegExp("([0-9]+|[a-z]+"+n+")","ig");var r=e.match(i),o=BX.message("FORMAT_DATE").match(/(DD|MI|MMMM|MM|M|YYYY)/gi),s,a,l=[],u=[],f={};if(!r){return null}if(r.length>o.length){o=BX.message("FORMAT_DATETIME").match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(s=0,a=r.length;s<a;s++){if(BX.util.trim(r[s])!=""){l[l.length]=r[s]}}for(s=0,a=o.length;s<a;s++){if(BX.util.trim(o[s])!=""){u[u.length]=o[s]}}var d=BX.util.array_search("MMMM",u);if(d>0){l[d]=BX.getNumMonth(l[d]);u[d]="MM"}else{d=BX.util.array_search("M",u);if(d>0){l[d]=BX.getNumMonth(l[d]);u[d]="MM"}}for(s=0,a=u.length;s<a;s++){var c=u[s].toUpperCase();f[c]=c=="T"||c=="TT"?l[s]:parseInt(l[s],10)}if(f.DD>0&&f.MM>0&&f.YYYY>0){var p=new Date;if(t){p.setUTCDate(1);p.setUTCFullYear(f.YYYY);p.setUTCMonth(f.MM-1);p.setUTCDate(f.DD);p.setUTCHours(0,0,0)}else{p.setDate(1);p.setFullYear(f.YYYY);p.setMonth(f.MM-1);p.setDate(f.DD);p.setHours(0,0,0)}if((!isNaN(f.HH)||!isNaN(f.GG)||!isNaN(f.H)||!isNaN(f.G))&&!isNaN(f.MI)){if(!isNaN(f.H)||!isNaN(f.G)){var h=(f.T||f.TT||"am").toUpperCase()=="PM";var m=parseInt(f.H||f.G||0,10);if(h){f.HH=m+(m==12?0:12)}else{f.HH=m<12?m:0}}else{f.HH=parseInt(f.HH||f.GG||0,10)}if(isNaN(f.SS)){f.SS=0}if(t){p.setUTCHours(f.HH,f.MI,f.SS)}else{p.setHours(f.HH,f.MI,f.SS)}}return p}}return null};BX.selectUtils={addNewOption:function(e,t,n,i,r){e=BX(e);if(e){var o=e.length;if(r!==false){for(var s=0;s<o;s++){if(e[s].value==t){return}}}e.options[o]=new Option(n,t,false,false)}if(i===true){this.sortSelect(e)}},deleteOption:function(e,t){e=BX(e);if(e){for(var n=0;n<e.length;n++){if(e[n].value==t){e.remove(n);break}}}},deleteSelectedOptions:function(e){e=BX(e);if(e){var t=0;while(t<e.length){if(e[t].selected){e[t].selected=false;e.remove(t)}else{t++}}}},deleteAllOptions:function(e){e=BX(e);if(e){for(var t=e.length-1;t>=0;t--){e.remove(t)}}},optionCompare:function(e,t){var n=e.optText.toLowerCase();var i=t.optText.toLowerCase();if(n>i){return 1}if(n<i){return -1}return 0},sortSelect:function(e){e=BX(e);if(e){var t=[];var n=e.options.length;var i;for(i=0;i<n;i++){t[i]={optText:e[i].text,optValue:e[i].value}}t.sort(this.optionCompare);e.length=0;n=t.length;for(i=0;i<n;i++){e[i]=new Option(t[i].optText,t[i].optValue,false,false)}}},selectAllOptions:function(e){e=BX(e);if(e){var t=e.length;for(var n=0;n<t;n++){e[n].selected=true}}},selectOption:function(e,t){e=BX(e);if(e){var n=e.length;for(var i=0;i<n;i++){e[i].selected=e[i].value==t}}},addSelectedOptions:function(e,t,n,i){e=BX(e);if(!e){return}var r=e.length;for(var o=0;o<r;o++){if(e[o].selected){this.addNewOption(t,e[o].value,e[o].text,i,n)}}},moveOptionsUp:function(e){e=BX(e);if(!e){return}var t=e.length;for(var n=0;n<t;n++){if(e[n].selected&&n>0&&e[n-1].selected==false){var i=new Option(e[n].text,e[n].value);e[n]=new Option(e[n-1].text,e[n-1].value);e[n].selected=false;e[n-1]=i;e[n-1].selected=true}}},moveOptionsDown:function(e){e=BX(e);if(!e){return}var t=e.length;for(var n=t-1;n>=0;n--){if(e[n].selected&&n<t-1&&e[n+1].selected==false){var i=new Option(e[n].text,e[n].value);e[n]=new Option(e[n+1].text,e[n+1].value);e[n].selected=false;e[n+1]=i;e[n+1].selected=true}}}};BX.getEventTarget=function(e){if(e.target){return e.target}else{if(e.srcElement){return e.srcElement}}return null};BX.hint=function(e,t,n,i){if(null==n){n=t;t=""}if(null==e.BXHINT){e.BXHINT=new BX.CHint({parent:e,hint:n,title:t,id:i});e.BXHINT.Show()}};BX.hint_replace=function(e,t,n){if(null==n){n=t;t=""}if(!e||!e.parentNode||!n){return null}var i=new BX.CHint({hint:n,title:t});i.CreateParent();e.parentNode.insertBefore(i.PARENT,e);e.parentNode.removeChild(e);i.PARENT.style.marginLeft="5px";return e};BX.CHint=function(e){this.PARENT=BX(e.parent);this.HINT=e.hint;this.HINT_TITLE=e.title;this.PARAMS={};for(var t in this.defaultSettings){if(null==e[t]){this.PARAMS[t]=this.defaultSettings[t]}else{this.PARAMS[t]=e[t]}}if(null!=e.id){this.ID=e.id}this.timer=null;this.bInited=false;this.msover=true;if(this.PARAMS.showOnce){this.__show();this.msover=false;this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)}else{if(this.PARENT){BX.bind(this.PARENT,"mouseover",BX.proxy(this.Show,this));BX.bind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))}}BX.addCustomEvent("onMenuOpen",BX.delegate(this.disable,this));BX.addCustomEvent("onMenuClose",BX.delegate(this.enable,this))};BX.CHint.prototype.defaultSettings={show_timeout:1000,hide_timeout:500,dx:2,showOnce:false,preventHide:true,min_width:250};BX.CHint.prototype.CreateParent=function(e,t){if(this.PARENT){BX.unbind(this.PARENT,"mouseover",BX.proxy(this.Show,this));BX.unbind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))}if(!t){t={}}var n="icon";if(t.type&&(t.type=="link"||t.type=="icon")){n=t.type}if(e){n="element"}if(n=="icon"){e=BX.create("IMG",{props:{src:t.iconSrc?t.iconSrc:"/bitrix/js/main/core/images/hint.gif"}})}else{if(n=="link"){e=BX.create("A",{props:{href:"javascript:void(0)"},html:"[?]"})}}this.PARENT=e;BX.bind(this.PARENT,"mouseover",BX.proxy(this.Show,this));BX.bind(this.PARENT,"mouseout",BX.proxy(this.Hide,this));return this.PARENT};BX.CHint.prototype.Show=function(){this.msover=true;if(null!=this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.proxy(this.__show,this),this.PARAMS.show_timeout)};BX.CHint.prototype.Hide=function(){this.msover=false;if(null!=this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)};BX.CHint.prototype.__show=function(){if(!this.msover||this.disabled){return}if(!this.bInited){this.Init()}if(this.prepareAdjustPos()){this.DIV.style.display="block";this.adjustPos();BX.bind(window,"scroll",BX.proxy(this.__onscroll,this));if(this.PARAMS.showOnce){this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)}}};BX.CHint.prototype.__onscroll=function(){if(!BX.admin||!BX.admin.panel||!BX.admin.panel.isFixed()){return}if(this.scrollTimer){clearTimeout(this.scrollTimer)}this.DIV.style.display="none";this.scrollTimer=setTimeout(BX.proxy(this.Reopen,this),this.PARAMS.show_timeout)};BX.CHint.prototype.Reopen=function(){if(null!=this.timer){clearTimeout(this.timer)}this.timer=setTimeout(BX.proxy(this.__show,this),50)};BX.CHint.prototype.__hide=function(){if(this.msover){return}if(!this.bInited){return}BX.unbind(window,"scroll",BX.proxy(this.Reopen,this));if(this.PARAMS.showOnce){this.Destroy()}else{this.DIV.style.display="none"}};BX.CHint.prototype.__hide_immediately=function(){this.msover=false;this.__hide()};BX.CHint.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip"},style:{display:"none"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-top-border"},html:'<div class="bx-panel-tooltip-corner bx-panel-tooltip-left-corner"></div><div class="bx-panel-tooltip-border"></div><div class="bx-panel-tooltip-corner bx-panel-tooltip-right-corner"></div>'}),this.CONTENT=BX.create("DIV",{props:{className:"bx-panel-tooltip-content"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-underlay"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-underlay-bg"}})]})]}),BX.create("DIV",{props:{className:"bx-panel-tooltip-bottom-border"},html:'<div class="bx-panel-tooltip-corner bx-panel-tooltip-left-corner"></div><div class="bx-panel-tooltip-border"></div><div class="bx-panel-tooltip-corner bx-panel-tooltip-right-corner"></div>'})]}));if(this.ID){this.CONTENT.insertBefore(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-panel-tooltip-close"},events:{click:BX.delegate(this.Close,this)}}),this.CONTENT.firstChild)}if(this.HINT_TITLE){this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-title"},text:this.HINT_TITLE}))}if(this.HINT){this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-text"}})).appendChild(BX.create("SPAN",{html:this.HINT}))}if(this.PARAMS.preventHide){BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this));BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))}this.bInited=true};BX.CHint.prototype.setContent=function(e){this.HINT=e;if(this.CONTENT_TEXT){this.CONTENT_TEXT.innerHTML=this.HINT}else{this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-text"}})).appendChild(BX.create("SPAN",{html:this.HINT}))}};BX.CHint.prototype.prepareAdjustPos=function(){this._wnd={scrollPos:BX.GetWindowScrollPos(),scrollSize:BX.GetWindowScrollSize()};return BX.style(this.PARENT,"display")!="none"};BX.CHint.prototype.getAdjustPos=function(){var e={},t=BX.pos(this.PARENT),n=0;e.top=t.bottom+this.PARAMS.dx;if(BX.admin&&BX.admin.panel.DIV){n=BX.admin.panel.DIV.offsetHeight+this.PARAMS.dx;if(BX.admin.panel.isFixed()){n+=this._wnd.scrollPos.scrollTop}}if(e.top<n){e.top=n}else{if(e.top+this.DIV.offsetHeight>this._wnd.scrollSize.scrollHeight){e.top=t.top-this.PARAMS.dx-this.DIV.offsetHeight}}e.left=t.left;if(t.left<this.PARAMS.dx){t.left=this.PARAMS.dx}else{var i=this.DIV.offsetWidth;var r=this._wnd.scrollSize.scrollWidth-i-this.PARAMS.dx;if(e.left>r){e.left=r}}return e};BX.CHint.prototype.adjustWidth=function(){if(this.bWidthAdjusted){return}var e=this.DIV.offsetWidth,t=this.DIV.offsetHeight;if(e>this.PARAMS.min_width){e=Math.round(Math.sqrt(1.618*e*t))}if(e<this.PARAMS.min_width){e=this.PARAMS.min_width}this.DIV.style.width=e+"px";if(this._adjustWidthInt){clearInterval(this._adjustWidthInt)}this._adjustWidthInt=setInterval(BX.delegate(this._adjustWidthInterval,this),5);this.bWidthAdjusted=true};BX.CHint.prototype._adjustWidthInterval=function(){if(!this.DIV||this.DIV.style.display=="none"){clearInterval(this._adjustWidthInt)}var e=20,t=1500,n=this.DIV.offsetWidth,i=this.CONTENT_TEXT.offsetWidth;if(n>0&&i>0&&n-i<e&&n<t){this.DIV.style.width=n+e+"px";return}clearInterval(this._adjustWidthInt)};BX.CHint.prototype.adjustPos=function(){this.adjustWidth();var e=this.getAdjustPos();this.DIV.style.top=e.top+"px";this.DIV.style.left=e.left+"px"};BX.CHint.prototype.Close=function(){if(this.ID&&BX.WindowManager){BX.WindowManager.saveWindowOptions(this.ID,{display:"off"})}this.__hide_immediately();this.Destroy()};BX.CHint.prototype.Destroy=function(){if(this.PARENT){BX.unbind(this.PARENT,"mouseover",BX.proxy(this.Show,this));BX.unbind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))}if(this.DIV){BX.unbind(this.DIV,"mouseover",BX.proxy(this.Show,this));BX.unbind(this.DIV,"mouseout",BX.proxy(this.Hide,this));BX.cleanNode(this.DIV,true)}};BX.CHint.prototype.enable=function(){this.disabled=false};BX.CHint.prototype.disable=function(){this.__hide_immediately();this.disabled=true};if(document.addEventListener){__readyHandler=function(){document.removeEventListener("DOMContentLoaded",__readyHandler,false);runReady()}}else{if(document.attachEvent){__readyHandler=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",__readyHandler);runReady()}}}}function bindReady(){if(!readyBound){readyBound=true;if(document.readyState==="complete"){return runReady()}if(document.addEventListener){document.addEventListener("DOMContentLoaded",__readyHandler,false);window.addEventListener("load",runReady,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",__readyHandler);window.attachEvent("onload",runReady);var e=false;try{e=window.frameElement==null}catch(t){}if(document.documentElement.doScroll&&e){doScrollCheck()}}}}return null}function runReady(){if(!BX.isReady){if(!document.body){return setTimeout(runReady,15)}BX.isReady=true;if(readyList&&readyList.length>0){var e,t=0;while(readyList&&(e=readyList[t++])){try{e.call(document)}catch(n){BX.debug("BX.ready error: ",n)}}readyList=null}}return null}function doScrollCheck(){if(BX.isReady){return}try{document.documentElement.doScroll("left")}catch(e){setTimeout(doScrollCheck,1);return}runReady()}function _adjustWait(){if(!this.bxmsg){return}var e=BX.pos(this),t=e.top;if(t<BX.GetDocElement().scrollTop){t=BX.GetDocElement().scrollTop+5}this.bxmsg.style.top=t+5+"px";if(this==BX.GetDocElement()){this.bxmsg.style.right="5px"}else{this.bxmsg.style.left=e.right-this.bxmsg.offsetWidth-5+"px"}}function _checkDisplay(e,t){if(typeof t!="undefined"){e.BXDISPLAY=t}var n=e.style.display||BX.style(e,"display");if(n!="none"){e.BXDISPLAY=e.BXDISPLAY||n;return true}else{e.BXDISPLAY=e.BXDISPLAY||"block";return false}}function _processTpl(e,t,n){if(e){if(n){e.parentNode.removeChild(e)}var i={},r=BX.findChildren(e,{attribute:"data-role"},true);for(var o=0,s=r.length;o<s;o++){i[r[o].getAttribute("data-role")]=r[o]}t.apply(e,[i])}}function _checkNode(e,t){t=t||{};if(BX.type.isFunction(t)){return t.call(window,e)}if(!t.allowTextNodes&&!BX.type.isElementNode(e)){return false}var n,i,r;for(n in t){if(t.hasOwnProperty(n)){switch(n){case"tag":case"tagName":if(BX.type.isString(t[n])){if(e.tagName.toUpperCase()!=t[n].toUpperCase()){return false}}else{if(t[n] instanceof RegExp){if(!t[n].test(e.tagName)){return false}}}break;case"class":case"className":if(BX.type.isString(t[n])){if(!BX.hasClass(e,t[n])){return false}}else{if(t[n] instanceof RegExp){if(!BX.type.isString(e.className)||!t[n].test(e.className)){return false}}}break;case"attr":case"attribute":if(BX.type.isString(t[n])){if(!e.getAttribute(t[n])){return false}}else{if(BX.type.isArray(t[n])){for(i=0,r=t[n].length;i<r;i++){if(t[n]&&!e.getAttribute(t[n])){return false}}}else{for(i in t[n]){if(t[n].hasOwnProperty(i)){var o=e.getAttribute(i);if(t[n][i] instanceof RegExp){if(!BX.type.isString(o)||!t[n][i].test(o)){return false}}else{if(o!=""+t[n][i]){return false}}}}}}break;case"property":if(BX.type.isString(t[n])){if(!e[t[n]]){return false}}else{if(BX.type.isArray(t[n])){for(i=0,r=t[n].length;i<r;i++){if(t[n]&&!e[t[n]]){return false}}}else{for(i in t[n]){if(BX.type.isString(t[n][i])){if(e[i]!=t[n][i]){return false}}else{if(t[n][i] instanceof RegExp){if(!BX.type.isString(e[i])||!t[n][i].test(e[i])){return false}}}}}}break;case"callback":return t[n](e)}}}return true}function Trash(){var e,t;for(e=0,t=garbageCollectors.length;e<t;e++){try{garbageCollectors[e].callback.apply(garbageCollectors[e].context||window);delete garbageCollectors[e];garbageCollectors[e]=null}catch(n){}}try{BX.unbindAll()}catch(n){}}if(window.attachEvent){window.attachEvent("onunload",Trash)}else{if(window.addEventListener){window.addEventListener("unload",Trash,false)}else{window.onunload=Trash}}BX(BX.DoNothing);window.BX=BX;BX.browser.addGlobalClass();BX.data=function(e,t,n){if(typeof e=="undefined"){return undefined}if(typeof t=="undefined"){return undefined}if(typeof n!="undefined"){dataStorage.set(e,t,n)}else{var i=undefined;if((i=dataStorage.get(e,t))!=undefined){return i}else{if("getAttribute" in e&&(i=e.getAttribute("data-"+t.toString()))){return i}}return undefined}};BX.DataStorage=function(){this.keyOffset=1;this.data={};this.uniqueTag="BX-"+Math.random();this.resolve=function(e,t){if(typeof e[this.uniqueTag]=="undefined"){if(t){try{Object.defineProperty(e,this.uniqueTag,{value:this.keyOffset++})}catch(n){e[this.uniqueTag]=this.keyOffset++}}else{return undefined}}return e[this.uniqueTag]};this.get=function(e,t){if(e!=document&&!BX.type.isElementNode(e)||typeof t=="undefined"){return undefined}e=this.resolve(e,false);if(typeof e=="undefined"||typeof this.data[e]=="undefined"){return undefined}return this.data[e][t]};this.set=function(e,t,n){if(e!=document&&!BX.type.isElementNode(e)||typeof n=="undefined"){return}var i=this.resolve(e,true);if(typeof this.data[i]=="undefined"){this.data[i]={}}this.data[i][t]=n}};var dataStorage=new BX.DataStorage;BX.LazyLoad={images:[],imageStatus:{hidden:-2,error:-1,undefined:0,inited:1,loaded:2},imageTypes:{image:1,background:2},registerImage:function(e,t){if(BX.type.isNotEmptyString(e)){this.images.push({id:e,node:null,src:null,type:null,func:BX.type.isFunction(t)?t:null,status:this.imageStatus.undefined})}},registerImages:function(e,t){if(BX.type.isArray(e)){for(var n=0,i=e.length;n<i;n++){this.registerImage(e[n],t)}}},showImages:function(e){var t=null;var n=false;e=e===false?false:true;for(var i=0,r=this.images.length;i<r;i++){t=this.images[i];if(t.status==this.imageStatus.undefined){this.initImage(t)}if(t.status!==this.imageStatus.inited){continue}if(!t.node||!t.node.parentNode){t.node=null;t.status=this.imageStatus.error;continue}n=true;if(e&&t.func){n=t.func(t)}if(n===true&&this.isElementVisibleOnScreen(t.node)){if(t.type==this.imageTypes.image){t.node.src=t.src}else{t.node.style.backgroundImage="url('"+t.src+"')"}t.node.setAttribute("data-src","");t.status=this.imageStatus.loaded}}},initImage:function(e){e.status=this.imageStatus.error;var t=BX(e.id);if(t){var n=t.getAttribute("data-src");if(BX.type.isNotEmptyString(n)){e.node=t;e.src=n;e.status=this.imageStatus.inited;e.type=e.node.tagName.toLowerCase()=="img"?this.imageTypes.image:this.imageTypes.background}}},isElementVisibleOnScreen:function(e){var t=this.getElementCoords(e);var n=window.pageYOffset||document.documentElement.scrollTop;var i=n+document.documentElement.clientHeight;t.bottom=t.top+e.offsetHeight;var r=t.top>n&&t.top<i;var o=t.bottom<i&&t.bottom>n;return r||o},isElementVisibleOn2Screens:function(e){var t=this.getElementCoords(e);var n=document.documentElement.clientHeight;var i=window.pageYOffset||document.documentElement.scrollTop;var r=i+n;t.bottom=t.top+e.offsetHeight;i-=n;r+=n;var o=t.top>i&&t.top<r;var s=t.bottom<r&&t.bottom>i;return o||s},getElementCoords:function(e){var t=e.getBoundingClientRect();return{originTop:t.top,originLeft:t.left,top:t.top+window.pageYOffset,left:t.left+window.pageXOffset}},onScroll:function(){BX.LazyLoad.showImages()},clearImages:function(){this.images=[]}};BX.getCookie=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):undefined};BX.FixFontSize=function(e){this.node=null;this.prevWindowSize=0;this.mainWrapper=null;this.textWrapper=null;this.objList=e.objList;this.minFontSizeList=[];this.minFontSize=0;if(e.onresize){this.prevWindowSize=window.innerWidth||document.documentElement.clientWidth;BX.bind(window,"resize",BX.proxy(BX.throttle(this.onResize,350),this))}this.createTestNodes();this.decrease()};BX.FixFontSize.prototype={createTestNodes:function(){this.textWrapper=BX.create("div",{style:{display:"inline-block",whiteSpace:"nowrap"}});this.mainWrapper=BX.create("div",{style:{height:0,overflow:"hidden"},children:[this.textWrapper]})},insertTestNodes:function(){document.body.appendChild(this.mainWrapper)},removeTestNodes:function(){document.body.removeChild(this.mainWrapper)},decrease:function(){var e,t;this.insertTestNodes();for(var n=this.objList.length-1;n>=0;n--){e=parseInt(getComputedStyle(this.objList[n].node)["width"]);t=parseInt(getComputedStyle(this.objList[n].node)["font-size"]);this.textWrapperSetStyle(this.objList[n].node);if(this.textWrapperInsertText(this.objList[n].node)){while(this.textWrapper.offsetWidth>e&&t>0){this.textWrapper.style.fontSize=--t+"px"}if(this.objList[n].smallestValue){this.minFontSize=this.minFontSize?Math.min(this.minFontSize,t):t;this.minFontSizeList.push(this.objList[n].node)}else{this.objList[n].node.style.fontSize=t+"px"}}}if(this.minFontSizeList.length>0){this.setMinFont()}this.removeTestNodes()},increase:function(){this.insertTestNodes();var e,t;this.insertTestNodes();for(var n=this.objList.length-1;n>=0;n--){e=parseInt(getComputedStyle(this.objList[n].node)["width"]);t=parseInt(getComputedStyle(this.objList[n].node)["font-size"]);this.textWrapperSetStyle(this.objList[n].node);if(this.textWrapperInsertText(this.objList[n].node)){while(this.textWrapper.offsetWidth<e&&t<this.objList[n].maxFontSize){this.textWrapper.style.fontSize=++t+"px"}if(this.objList[n].smallestValue){this.minFontSize=this.minFontSize?Math.min(this.minFontSize,t):t;this.minFontSizeList.push(this.objList[n].node)}else{this.objList[n].node.style.fontSize=t+"px"}}}if(this.minFontSizeList.length>0){this.setMinFont()}this.removeTestNodes()},setMinFont:function(){for(var e=this.minFontSizeList.length-1;e>=0;e--){this.minFontSizeList[e].style.fontSize=this.minFontSize+"px"}this.minFontSize=0},onResize:function(){var e=window.innerWidth||document.documentElement.clientWidth;if(this.prevWindowSize>e){this.decrease()}else{if(this.prevWindowSize<e){this.increase()}}this.prevWindowSize=e},textWrapperInsertText:function(e){if(e.textContent){this.textWrapper.textContent=e.textContent;return true}else{if(e.innerText){this.textWrapper.innerText=e.innerText;return true}else{return false}}},textWrapperSetStyle:function(e){this.textWrapper.style.fontFamily=getComputedStyle(e)["font-family"];this.textWrapper.style.fontSize=getComputedStyle(e)["font-size"];this.textWrapper.style.fontStyle=getComputedStyle(e)["font-style"];this.textWrapper.style.fontWeight=getComputedStyle(e)["font-weight"];this.textWrapper.style.lineHeight=getComputedStyle(e)["line-height"]}};BX.FixFontSize.init=function(e){return new BX.FixFontSize(e)}})(window);(function(g){if(g.BX.ajax){return}var h=g.BX,k={},b={method:"GET",dataType:"html",timeout:0,async:true,processData:true,scriptsRunFirst:false,emulateOnload:true,skipAuthCheck:false,start:true,cache:true,preparePost:true,headers:false,lsTimeout:30,lsForce:false},c=null,f={},m=[],d={url_utf:/[^\034-\254]+/g,script_self:/\/bitrix\/js\/main\/core\/core(_ajax)*.js$/i,script_self_window:/\/bitrix\/js\/main\/core\/core_window.js$/i,script_self_admin:/\/bitrix\/js\/main\/core\/core_admin.js$/i,script_onload:/window.onload/g};h.ajax=function(t){var a,p;if(!t||!t.url||!h.type.isString(t.url)){return false}for(var y in k){if(typeof t[y]=="undefined"){t[y]=k[y]}}k={};for(y in b){if(typeof t[y]=="undefined"){t[y]=b[y]}}t.method=t.method.toUpperCase();if(!h.localStorage){t.lsId=null}if(h.browser.IsIE()){var x=d.url_utf.exec(t.url);if(x){do{t.url=t.url.replace(x,h.util.urlencode(x));x=d.url_utf.exec(t.url)}while(x)}}if(t.dataType=="json"){t.emulateOnload=false}if(!t.cache&&t.method=="GET"){t.url=h.ajax._uncache(t.url)}if(t.method=="POST"&&t.preparePost){t.data=h.ajax.prepareData(t.data)}var n=true;if(t.lsId&&!t.lsForce){var w=h.localStorage.get("ajax-"+t.lsId);if(w!==null){n=false;var r=function(e){if(e.key=="ajax-"+t.lsId&&e.value!="BXAJAXWAIT"){var i=e.value,s=!!e.oldValue&&i==null;if(!s){h.ajax.__run(t,i)}else{if(t.onfailure){t.onfailure("timeout")}}h.removeCustomEvent("onLocalStorageChange",r)}};if(w=="BXAJAXWAIT"){h.addCustomEvent("onLocalStorageChange",r)}else{setTimeout(function(){r({key:"ajax-"+t.lsId,value:w})},10)}}}if(n){t.xhr=h.ajax.xhr();if(!t.xhr){return}if(t.lsId){h.localStorage.set("ajax-"+t.lsId,"BXAJAXWAIT",t.lsTimeout)}t.xhr.open(t.method,t.url,t.async);if(!t.skipBxHeader&&!h.ajax.isCrossDomain(t.url)){t.xhr.setRequestHeader("Bx-ajax","true")}if(t.method=="POST"&&t.preparePost){t.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(typeof t.headers=="object"){for(y=0;y<t.headers.length;y++){t.xhr.setRequestHeader(t.headers[y].name,t.headers[y].value)}}if(!!t.onprogress){h.bind(t.xhr,"progress",t.onprogress)}var q=false;var v=t.xhr.onreadystatechange=function(o){if(q){return}if(o==="timeout"){if(t.onfailure){t.onfailure("timeout")}h.onCustomEvent(t.xhr,"onAjaxFailure",["timeout","",t]);t.xhr.onreadystatechange=h.DoNothing;t.xhr.abort();if(t.async){t.xhr=null}}else{if(t.xhr.readyState==4||o=="run"){a=h.ajax.xhrSuccess(t.xhr)?"success":"error";q=true;t.xhr.onreadystatechange=h.DoNothing;if(a=="success"){var s=!!t.skipAuthCheck||h.ajax.isCrossDomain(t.url)?false:t.xhr.getResponseHeader("X-Bitrix-Ajax-Status");if(!!s&&s=="Authorize"){if(t.onfailure){t.onfailure("auth",t.xhr.status)}h.onCustomEvent(t.xhr,"onAjaxFailure",["auth",t.xhr.status,t])}else{var e=t.xhr.responseText;if(t.lsId){h.localStorage.set("ajax-"+t.lsId,e,t.lsTimeout)}h.ajax.__run(t,e)}}else{if(t.onfailure){t.onfailure("status",t.xhr.status)}h.onCustomEvent(t.xhr,"onAjaxFailure",["status",t.xhr.status,t])}if(t.async){t.xhr=null}}}};if(t.async&&t.timeout>0){setTimeout(function(){if(t.xhr&&!q){v("timeout")}},t.timeout*1000)}if(t.start){t.xhr.send(t.data);if(!t.async){v("run")}}return t.xhr}};h.ajax.xhr=function(){if(g.XMLHttpRequest){try{return new XMLHttpRequest}catch(e){}}else{if(g.ActiveXObject){try{return new g.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new g.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new g.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new g.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")}}return null};h.ajax.isCrossDomain=function(a,e){e=e||g.location;if(a.indexOf("//")===0){a=e.protocol+a}if(a.indexOf("http")!==0){return false}var i=g.document.createElement("a");i.href=a;return i.protocol!==e.protocol||i.hostname!==e.hostname||h.ajax.getHostPort(i.protocol,i.host)!==h.ajax.getHostPort(e.protocol,e.host)};h.ajax.getHostPort=function(o,i){var n=/:(\d+)$/.exec(i);if(n){return n[1]}else{if(o==="http:"){return"80"}else{if(o==="https:"){return"443"}}}return""};h.ajax.__prepareOnload=function(e){if(e.length>0){h.ajax["onload_"+c]=null;for(var n=0,a=e.length;n<a;n++){if(e[n].isInternal){e[n].JS=e[n].JS.replace(d.script_onload,"BX.ajax.onload_"+c)}}}h.CaptureEventsGet();h.CaptureEvents(g,"load")};h.ajax.__runOnload=function(){if(null!=h.ajax["onload_"+c]){h.ajax["onload_"+c].apply(g);h.ajax["onload_"+c]=null}var a=h.CaptureEventsGet();if(a){for(var e=0;e<a.length;e++){a[e].apply(g)}}};h.ajax.__run=function(i,a){if(!i.processData){if(i.onsuccess){i.onsuccess(a)}h.onCustomEvent(i.xhr,"onAjaxSuccess",[a,i])}else{a=h.ajax.processRequestData(a,i)}};h.ajax._onParseJSONFailure=function(a){this.jsonFailure=true;this.jsonResponse=a;this.jsonProactive=/^\[WAF\]/.test(a)};h.ajax.processRequestData=function(v,y){var a,q=[],z=[];switch(y.dataType.toUpperCase()){case"JSON":h.addCustomEvent(y.xhr,"onParseJSONFailure",h.proxy(h.ajax._onParseJSONFailure,y));a=h.parseJSON(v,y.xhr);h.removeCustomEvent(y.xhr,"onParseJSONFailure",h.proxy(h.ajax._onParseJSONFailure,y));break;case"SCRIPT":q.push({isInternal:true,JS:v,bRunFirst:y.scriptsRunFirst});a=v;break;default:var o=h.processHTML(v,y.scriptsRunFirst);a=o.HTML;q=o.SCRIPT;z=o.STYLE;break}var x=false;if(null==c){c=parseInt(Math.random()*1000000);x=true}if(z.length>0){h.loadCSS(z)}if(y.emulateOnload){h.ajax.__prepareOnload(q)}var p=h.DoNothing;if(y.emulateOnload||x){p=h.defer(function(){if(y.emulateOnload){h.ajax.__runOnload()}if(x){c=null}h.onCustomEvent(y.xhr,"onAjaxSuccessFinish",[y])})}try{if(!!y.jsonFailure){throw {type:"json_failure",data:y.jsonResponse,bProactive:y.jsonProactive}}y.scripts=q;h.ajax.processScripts(y.scripts,true);if(y.onsuccess){y.onsuccess(a)}h.onCustomEvent(y.xhr,"onAjaxSuccess",[a,y]);h.ajax.processScripts(y.scripts,false,p)}catch(w){if(y.onfailure){y.onfailure("processing",w)}h.onCustomEvent(y.xhr,"onAjaxFailure",["processing",w,y])}};h.ajax.processScripts=function(x,q,w){var y=[],p="";w=w||h.DoNothing;for(var v=0,z=x.length;v<z;v++){if(typeof q!="undefined"&&q!=!!x[v].bRunFirst){continue}if(x[v].isInternal){p+=";"+x[v].JS}else{y.push(x[v].JS)}}y=h.util.array_unique(y);var a=p.length>0?function(){h.evalGlobal(p)}:h.DoNothing;if(y.length>0){h.load(y,function(){a();w()})}else{a();w()}};h.ajax.prepareData=function(q,n){var p="";if(h.type.isString(q)){p=q}else{if(null!=q){for(var s in q){if(q.hasOwnProperty(s)){if(p.length>0){p+="&"}var a=h.util.urlencode(s);if(n){a=n+"["+a+"]"}if(typeof q[s]=="object"){p+=h.ajax.prepareData(q[s],a)}else{p+=a+"="+h.util.urlencode(q[s])}}}}}return p};h.ajax.xhrSuccess=function(a){return a.status>=200&&a.status<300||a.status===304||a.status===1223||a.status===0};h.ajax.Setup=function(n,i){i=!!i;for(var p in n){if(i){k[p]=n[p]}else{b[p]=n[p]}}};h.ajax.replaceLocalStorageValue=function(n,a,i){if(!!h.localStorage){h.localStorage.set("ajax-"+n,a,i)}};h.ajax._uncache=function(a){return a+((a.indexOf("?")!==-1?"&":"?")+"_="+(new Date).getTime())};h.ajax.get=function(n,a,i){if(h.type.isFunction(a)){i=a;a=""}a=h.ajax.prepareData(a);if(a){n+=(n.indexOf("?")!==-1?"&":"?")+a;a=""}return h.ajax({method:"GET",dataType:"html",url:n,data:"",onsuccess:i})};h.ajax.getCaptcha=function(a){return h.ajax.loadJSON("/bitrix/tools/ajax_captcha.php",a)};h.ajax.insertToNode=function(p,n){n=h(n);if(!!n){var q={cancel:false};h.onCustomEvent("onAjaxInsertToNode",[{url:p,node:n,eventArgs:q}]);if(q.cancel===true){return}var a=null;if(!k.denyShowWait){a=h.showWait(n);delete k.denyShowWait}return h.ajax.get(p,function(i){n.innerHTML=i;h.closeWait(n,a)})}};h.ajax.post=function(n,a,i){a=h.ajax.prepareData(a);return h.ajax({method:"POST",dataType:"html",url:n,data:a,onsuccess:i})};h.ajax.loadScriptAjax=function(q,i,p){if(h.type.isArray(q)){for(var v=0,n=q.length;v<n;v++){h.ajax.loadScriptAjax(q[v],i,p)}}else{var a=q.replace(/\.js\?.*/,".js");if(d.script_self.test(a)){return}if(d.script_self_window.test(a)&&h.CWindow){return}if(d.script_self_admin.test(a)&&h.admin){return}if(typeof f[a]=="undefined"){if(!!p){f[a]="";return h.loadScript(q)}else{return h.ajax({url:q,method:"GET",dataType:"script",processData:true,emulateOnload:false,scriptsRunFirst:true,async:false,start:true,onsuccess:function(o){f[a]=o;if(i){i(o)}}})}}else{if(i){i(f[a])}}}};h.ajax.loadJSON=function(n,a,i,p){if(h.type.isFunction(a)){p=i;i=a;a=""}a=h.ajax.prepareData(a);if(a){n+=(n.indexOf("?")!==-1?"&":"?")+a;a=""}return h.ajax({method:"GET",dataType:"json",url:n,onsuccess:i,onfailure:p})};h.ajax.load=function(u,n){if(!h.type.isArray(u)){u=[u]}var q=0;if(!h.type.isFunction(n)){n=h.DoNothing}var v=function(i){if(h.type.isFunction(this.callback)){this.callback(i)}if(++q>=p){n()}};for(var a=0,p=u.length;a<p;a++){switch(u[a].type.toUpperCase()){case"SCRIPT":h.loadScript([u[a].url],h.proxy(v,u[a]));break;case"CSS":h.loadCSS([u[a].url]);if(++q>=p){n()}break;case"JSON":h.ajax.loadJSON(u[a].url,h.proxy(v,u[a]));break;default:h.ajax.get(u[a].url,"",h.proxy(v,u[a]));break}}};h.ajax.submit=function(n,a){if(!n.target){if(null==n.BXFormTarget){var i="formTarget_"+Math.random();n.BXFormTarget=document.body.appendChild(h.create("IFRAME",{props:{name:i,id:i,src:"javascript:void(0)"},style:{display:"none"}}))}n.target=n.BXFormTarget.name}n.BXFormCallback=a;h.bind(n.BXFormTarget,"load",h.proxy(h.ajax._submit_callback,n));h.submit(n);return false};h.ajax.submitComponentForm=function(e,p,q){if(!e.target){if(null==e.BXFormTarget){var a="formTarget_"+Math.random();e.BXFormTarget=document.body.appendChild(h.create("IFRAME",{props:{name:a,id:a,src:"javascript:void(0)"},style:{display:"none"}}))}e.target=e.BXFormTarget.name}if(!!q){var n=h.showWait(p)}e.BXFormCallback=function(r){if(!!q){h.closeWait(n)}var o=function(){if(!!g.bxcompajaxframeonload){setTimeout(function(){g.bxcompajaxframeonload();g.bxcompajaxframeonload=null},10)}};h(p).innerHTML=r;h.onCustomEvent("onAjaxSuccess",[null,null,o])};h.bind(e.BXFormTarget,"load",h.proxy(h.ajax._submit_callback,e));return true};h.ajax._submit_callback=function(){try{if(this.BXFormTarget.contentWindow.location.href.indexOf("http")!=0){return}}catch(a){return}if(this.BXFormCallback){this.BXFormCallback.apply(this,[this.BXFormTarget.contentWindow.document.body.innerHTML])}h.unbindAll(this.BXFormTarget)};h.ajax.prepareForm=function(C,F){F=!!F?F:{};var H,q,w,z=[],I=C.elements.length,x=0,G=0;if(!!C){for(H=0;H<I;H++){w=C.elements[H];if(w.disabled){continue}switch(w.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":case"select-one":z.push({name:w.name,value:w.value});G+=w.name.length+w.value.length;break;case"file":if(!!w.files){for(q=0;q<w.files.length;q++){x++;z.push({name:w.name,value:w.files[q],file:true});G+=w.files[q].size}}break;case"radio":case"checkbox":if(w.checked){z.push({name:w.name,value:w.value});G+=w.name.length+w.value.length}break;case"select-multiple":for(var y=0;y<w.options.length;y++){if(w.options[y].selected){z.push({name:w.name,value:w.options[y].value});G+=w.name.length+w.options[y].length}}break;default:break}}H=0;G=0;var E=F;while(H<z.length){var B=z[H].name.indexOf("[");if(B==-1){E[z[H].name]=z[H].value;E=F;H++}else{var A=z[H].name.substring(0,B);var D=z[H].name.substring(B+1);if(!E[A]){E[A]=[]}var v=D.indexOf("]");if(v==-1){E=F;H++}else{if(v==0){E=E[A];z[H].name=""+E.length}else{E=E[A];z[H].name=D.substring(0,v)+D.substring(v+1)}}}}}return{data:F,filesCount:x,roughSize:G}};h.ajax.submitAjax=function(p,v){v=!!v&&typeof v=="object"?v:{};v.url=v.url||p.getAttribute("action");v.data=h.ajax.prepareForm(p).data;if(!g.FormData){h.ajax(v)}else{var w=function(n){var i=Object.prototype.toString.call(n);return i=="[object File]"||i=="[object Blob]"},e=function(s,i,n){if(!!n&&typeof n=="object"&&!w(n)){for(var o in n){if(n.hasOwnProperty(o)){e(s,i==""?o:i+"["+o+"]",n[o])}}}else{s.append(i,!!n?n:"")}},q=function(s){var i={};if(null!=s){if(typeof s=="object"){for(var n in s){if(s.hasOwnProperty(n)){var u=h.util.urlencode(n);if(typeof s[n]=="object"&&s[n]["file"]!==true){i[u]=q(s[n])}else{if(s[n]["file"]===true){i[u]=s[n]["value"]}else{i[u]=h.util.urlencode(s[n])}}}}}else{i=h.util.urlencode(s)}}return i},x=new g.FormData;if(v.method!=="POST"){v.data=h.ajax.prepareData(v.data);if(v.data){v.url+=(v.url.indexOf("?")!==-1?"&":"?")+v.data;v.data=""}}else{if(v.preparePost===true){v.data=q(v.data)}e(x,"",v.data);v.data=x}v.preparePost=false;v.start=false;var a=h.ajax(v);if(!!v.onprogress){a.upload.addEventListener("progress",function(n){var i=null;if(n.lengthComputable&&(n.total||n.totalSize)){i=n.loaded*100/(n.total||n.totalSize)}v.onprogress(n,i)})}a.send(x)}};h.ajax.UpdatePageData=function(n){if(n.TITLE){h.ajax.UpdatePageTitle(n.TITLE)}if(n.WINDOW_TITLE||n.TITLE){h.ajax.UpdateWindowTitle(n.WINDOW_TITLE||n.TITLE)}if(n.NAV_CHAIN){h.ajax.UpdatePageNavChain(n.NAV_CHAIN)}if(n.CSS&&n.CSS.length>0){h.loadCSS(n.CSS)}if(n.SCRIPTS&&n.SCRIPTS.length>0){var a=function(q,t,e){if(!!t&&h.type.isArray(t.scripts)){for(var p=0,u=n.SCRIPTS.length;p<u;p++){t.scripts.push({isInternal:false,JS:n.SCRIPTS[p]})}}else{h.loadScript(n.SCRIPTS,e)}h.removeCustomEvent("onAjaxSuccess",a)};h.addCustomEvent("onAjaxSuccess",a)}else{var i=function(q,p,r){if(h.type.isFunction(r)){r()}h.removeCustomEvent("onAjaxSuccess",i)};h.addCustomEvent("onAjaxSuccess",i)}};h.ajax.UpdatePageTitle=function(i){var a=h("pagetitle");if(a){a.removeChild(a.firstChild);if(!a.firstChild){a.appendChild(document.createTextNode(i))}else{a.insertBefore(document.createTextNode(i),a.firstChild)}}};h.ajax.UpdateWindowTitle=function(a){document.title=a};h.ajax.UpdatePageNavChain=function(i){var a=h("navigation");if(a){a.innerHTML=i}};h.userOptions={options:null,bSend:false,delay:5000,path:"/bitrix/admin/user_options.php?"};h.userOptions.setAjaxPath=function(a){h.userOptions.path=a.indexOf("?")==-1?a+"?":a+"&"};h.userOptions.save=function(u,n,q,v,a){if(null==h.userOptions.options){h.userOptions.options={}}a=!!a;h.userOptions.options[u+"."+n+"."+q]=[u,n,q,v,a];var p=h.userOptions.__get();if(p!=""){document.cookie=h.message("COOKIE_PREFIX")+"_LAST_SETTINGS="+p+"&sessid="+h.bitrix_sessid()+"; expires=Thu, 31 Dec 2020 23:59:59 GMT; path=/;"}if(!h.userOptions.bSend){h.userOptions.bSend=true;setTimeout(function(){h.userOptions.send(null)},h.userOptions.delay)}};h.userOptions.send=function(i){var a=h.userOptions.__get();h.userOptions.options=null;h.userOptions.bSend=false;if(a!=""){document.cookie=h.message("COOKIE_PREFIX")+"_LAST_SETTINGS=; path=/;";h.ajax({method:"GET",dataType:"html",processData:false,cache:false,url:h.userOptions.path+a+"&sessid="+h.bitrix_sessid(),onsuccess:i})}};h.userOptions.del=function(n,a,i,p){h.ajax.get(h.userOptions.path+"action=delete&c="+n+"&n="+a+(i==true?"&common=Y":"")+"&sessid="+h.bitrix_sessid(),p)};h.userOptions.__get=function(){if(!h.userOptions.options){return""}var q="",n=-1,p="",s,a;for(a in h.userOptions.options){if(h.userOptions.options.hasOwnProperty(a)){s=h.userOptions.options[a];if(p!=s[0]+"."+s[1]){n++;q+="&p["+n+"][c]="+h.util.urlencode(s[0]);q+="&p["+n+"][n]="+h.util.urlencode(s[1]);if(s[4]==true){q+="&p["+n+"][d]=Y"}p=s[0]+"."+s[1]}q+="&p["+n+"][v]["+h.util.urlencode(s[2])+"]="+h.util.urlencode(s[3])}}return q.substr(1)};h.ajax.history={expected_hash:"",obParams:null,obFrame:null,obImage:null,obTimer:null,bInited:false,bHashCollision:false,bPushState:!!(history.pushState&&h.type.isFunction(history.pushState)),startState:null,init:function(a){if(h.ajax.history.bInited){return}this.obParams=a;var e=this.obParams.getState();if(h.ajax.history.bPushState){h.ajax.history.expected_hash=g.location.pathname;if(g.location.search){h.ajax.history.expected_hash+=g.location.search}h.ajax.history.put(e,h.ajax.history.expected_hash,"",true);setTimeout(function(){h.bind(g,"popstate",h.ajax.history.__hashListener)},500)}else{h.ajax.history.expected_hash=g.location.hash;if(!h.ajax.history.expected_hash||h.ajax.history.expected_hash=="#"){h.ajax.history.expected_hash="__bx_no_hash__"}j.put(h.ajax.history.expected_hash,e);h.ajax.history.obTimer=setTimeout(h.ajax.history.__hashListener,500);if(h.browser.IsIE()){h.ajax.history.obFrame=document.createElement("IFRAME");h.hide_object(h.ajax.history.obFrame);document.body.appendChild(h.ajax.history.obFrame);h.ajax.history.obFrame.contentWindow.document.open();h.ajax.history.obFrame.contentWindow.document.write(h.ajax.history.expected_hash);h.ajax.history.obFrame.contentWindow.document.close()}else{if(h.browser.IsOpera()){h.ajax.history.obImage=document.createElement("IMG");h.hide_object(h.ajax.history.obImage);document.body.appendChild(h.ajax.history.obImage);h.ajax.history.obImage.setAttribute("src","javascript:location.href = 'javascript:BX.ajax.history.__hashListener();';")}}}h.ajax.history.bInited=true},__hashListener:function(e){e=e||g.event||{state:false};if(h.ajax.history.bPushState){h.ajax.history.obParams.setState(e.state||h.ajax.history.startState)}else{if(h.ajax.history.obTimer){g.clearTimeout(h.ajax.history.obTimer);h.ajax.history.obTimer=null}var n;if(null!=h.ajax.history.obFrame){n=h.ajax.history.obFrame.contentWindow.document.body.innerText}else{n=g.location.hash}if(!n||n=="#"){n="__bx_no_hash__"}if(n.indexOf("#")==0){n=n.substring(1)}if(n!=h.ajax.history.expected_hash){var p=j.get(n);if(p){h.ajax.history.obParams.setState(p);h.ajax.history.expected_hash=n;if(null!=h.ajax.history.obFrame){var a=n=="__bx_no_hash__"?"":n;if(g.location.hash!=a&&g.location.hash!="#"+a){g.location.hash=a}}}}h.ajax.history.obTimer=setTimeout(h.ajax.history.__hashListener,500)}},put:function(e,n,p,a){if(this.bPushState){if(!a){history.pushState(e,"",n)}else{h.ajax.history.startState=e}}else{if(typeof p!="undefined"){n=p}else{n="view"+n}j.put(n,e);h.ajax.history.expected_hash=n;g.location.hash=h.util.urlencode(n);if(null!=h.ajax.history.obFrame){h.ajax.history.obFrame.contentWindow.document.open();h.ajax.history.obFrame.contentWindow.document.write(n);h.ajax.history.obFrame.contentWindow.document.close()}}},checkRedirectStart:function(e,n){var p=g.location.hash;if(p.substring(0,1)=="#"){p=p.substring(1)}var a=p.substring(0,5);if(a=="view/"||a=="view%"){h.ajax.history.bHashCollision=true;document.write('<div id="__ajax_hash_collision_'+n+'" style="display: none;">')}},checkRedirectFinish:function(a,e){document.write("</div>");var i=g.location.hash;if(i.substring(0,1)=="#"){i=i.substring(1)}h.ready(function(){var q=i.substring(0,5);if(q=="view/"||q=="view%"){var o=h("__ajax_hash_collision_"+e);var p=o.firstChild;h.cleanNode(p);o.style.display="block";if(q!="view%"){i=h.util.urlencode(i)}i+=(i.indexOf("%3F")==-1?"%3F":"%26")+a+"="+e;var r="/bitrix/tools/ajax_redirector.php?hash="+i;h.ajax.insertToNode(r,p)}})}};h.ajax.component=function(a){this.node=a};h.ajax.component.prototype.getState=function(){var a={node:this.node,title:g.document.title,data:h(this.node).innerHTML};var e=h("navigation");if(null!=e){a.nav_chain=e.innerHTML}return a};h.ajax.component.prototype.setState=function(a){h(a.node).innerHTML=a.data;h.ajax.UpdatePageTitle(a.title);if(a.nav_chain){h.ajax.UpdatePageNavChain(a.nav_chain)}};var j={arHistory:{},put:function(n,i){this.arHistory[n]=i},get:function(a){return this.arHistory[a]}};h.ajax.FormData=function(){this.elements=[];this.files=[];this.features={};this.isSupported();this.log("BX FormData init")};h.ajax.FormData.isSupported=function(){var i=new h.ajax.FormData;var a=i.features.supported;i=null;return a};h.ajax.FormData.prototype.log=function(i){if(false){try{if(h.browser.IsIE()){i=JSON.stringify(i)}console.log(i)}catch(a){}}};h.ajax.FormData.prototype.isSupported=function(){var e={};e.fileReader=g.FileReader&&g.FileReader.prototype.readAsBinaryString;e.readFormData=e.sendFormData=!!g.FormData;e.supported=!!(e.readFormData&&e.sendFormData);this.features=e;this.log("features:");this.log(e);return e.supported};h.ajax.FormData.prototype.append=function(n,i){if(typeof i==="object"){this.files.push({name:n,value:i})}else{this.elements.push({name:n,value:i})}};h.ajax.FormData.prototype.send=function(u,n,q,v){this.log("FD send");this.xhr=h.ajax({method:"POST",dataType:"html",url:u,onsuccess:n,onfailure:v,start:false,preparePost:false});if(q){this.xhr.upload.addEventListener("progress",function(i){if(i.lengthComputable){q(i.loaded/(i.total||i.totalSize))}},false)}if(this.features.readFormData&&this.features.sendFormData){var a=new FormData;this.log("use browser formdata");for(var p in this.elements){if(this.elements.hasOwnProperty(p)){a.append(this.elements[p].name,this.elements[p].value)}}for(p in this.files){if(this.files.hasOwnProperty(p)){a.append(this.files[p].name,this.files[p].value)}}this.xhr.send(a)}return this.xhr};h.addCustomEvent("onAjaxFailure",h.debug)})(window);var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(h){if(h.BX.localStorage){return}var k=h.BX,b=null,c=null,j="_bxCurrentKey",g=false;k.localStorage=function(){this.keyChanges={};k.bind(k.browser.IsIE()&&!k.browser.IsIE9()?document:h,"storage",k.proxy(this._onchange,this));setInterval(k.delegate(this._clear,this),5000)};k.localStorage.checkBrowser=function(){return g};k.localStorage.set=function(i,a,n){return k.localStorage.instance().set(i,a,n)};k.localStorage.get=function(a){return k.localStorage.instance().get(a)};k.localStorage.remove=function(a){return k.localStorage.instance().remove(a)};k.localStorage.instance=function(){if(!b){var a=k.localStorage.checkBrowser();if(a=="native"){b=new k.localStorage}else{if(a=="ie8"){b=new k.localStorageIE8}else{if(a=="ie7"){b=new k.localStorageIE7}else{b={set:k.DoNothing,get:function(){return null},remove:k.DoNothing}}}}}return b};k.localStorage.prototype.prefix=function(){if(!c){c="bx"+k.message("USER_ID")+"-"+(k.message.SITE_ID?k.message("SITE_ID"):"admin")+"-"}return c};k.localStorage.prototype._onchange=function(a){a=a||h.event;if(!a.key){return}if(k.browser.DetectIeVersion()>0&&this.keyChanges[a.key]){this.keyChanges[a.key]=false;return}if(!!a.key&&a.key.substring(0,this.prefix().length)==this.prefix()){var e={key:a.key.substring(this.prefix().length,a.key.length),value:!!a.newValue?this._decode(a.newValue.substring(11,a.newValue.length)):null,oldValue:!!a.oldValue?this._decode(a.oldValue.substring(11,a.oldValue.length)):null};switch(e.key){case"BXGCE":if(e.value){k.onCustomEvent(e.value.e,e.value.p)}break;default:if(a.newValue){k.onCustomEvent(h,"onLocalStorageSet",[e])}if(a.oldValue&&!a.newValue){k.onCustomEvent(h,"onLocalStorageRemove",[e])}k.onCustomEvent(h,"onLocalStorageChange",[e]);break}}};k.localStorage.prototype._clear=function(){var n=+new Date,a,i;for(i=0;i<localStorage.length;i++){a=localStorage.key(i);if(a.substring(0,2)=="bx"){var p=localStorage.getItem(a).split(":",1)*1000;if(n>=p){localStorage.removeItem(a)}}}};k.localStorage.prototype._encode=function(a){if(typeof a=="object"){a=JSON.stringify(a)}else{a=a.toString()}return a};k.localStorage.prototype._decode=function(n){var a=null;if(!!n){try{a=JSON.parse(n)}catch(i){a=n}}return a};k.localStorage.prototype._trigger_error=function(p,n,q,i){k.onCustomEvent(this,"onLocalStorageError",[p,{key:n,value:q,ttl:i}])};k.localStorage.prototype.set=function(n,a,i){if(!i||i<=0){i=60}if(n==undefined||n==null||a==undefined){return false}this.keyChanges[this.prefix()+n]=true;try{localStorage.setItem(this.prefix()+n,Math.round(+new Date/1000)+i+":"+this._encode(a))}catch(p){this._trigger_error(p,n,a,i)}};k.localStorage.prototype.get=function(n){var a=localStorage.getItem(this.prefix()+n);if(a){var i=a.split(":",1)*1000;if(+new Date<=i){a=a.substring(11,a.length);return this._decode(a)}}return null};k.localStorage.prototype.remove=function(a){this.keyChanges[this.prefix()+a]=true;localStorage.removeItem(this.prefix()+a)};k.localStorageIE7=function(){this.NS="BXLocalStorage";this.__current_state={};this.keyChanges={};k.ready(k.delegate(this._Init,this))};k.extend(k.localStorageIE7,k.localStorage);k.localStorageIE7.prototype._Init=function(){this.storage_element=document.body.appendChild(k.create("DIV"));this.storage_element.addBehavior("#default#userData");this.storage_element.load(this.NS);var p=this.storage_element.xmlDocument,n=p.firstChild.attributes.length;for(var q=0;q<n;q++){if(!!p.firstChild.attributes[q]){var i=p.firstChild.attributes[q].nodeName;if(i.substring(0,this.prefix().length)==this.prefix()){this.__current_state[i]=p.firstChild.attributes[q].nodeValue}}}setInterval(k.delegate(this._Listener,this),500);setInterval(k.delegate(this._clear,this),5000)};k.localStorageIE7.prototype._Listener=function(x){this.storage_element.load(this.NS);var u=this.storage_element.xmlDocument,w=u.firstChild.attributes.length,y,p,q;var n={},v=[];for(y=0;y<w;y++){if(!!u.firstChild.attributes[y]){p=u.firstChild.attributes[y].nodeName;if(p.substring(0,this.prefix().length)==this.prefix()){q=u.firstChild.attributes[y].nodeValue;if(this.__current_state[p]!=q){v.push({key:p,newValue:q,oldValue:this.__current_state[p]})}n[p]=q;delete this.__current_state[p]}}}for(y in this.__current_state){if(this.__current_state.hasOwnProperty(y)){v.push({key:y,newValue:undefined,oldValue:this.__current_state[y]})}}this.__current_state=n;for(y=0;y<v.length;y++){this._onchange(v[y])}};k.localStorageIE7.prototype._clear=function(){this.storage_element.load(this.NS);var v=this.storage_element.xmlDocument,s=v.firstChild.attributes.length,u=+new Date,w,p,q,n;for(w=0;w<s;w++){if(!!v.firstChild.attributes[w]){p=v.firstChild.attributes[w].nodeName;if(p.substring(0,2)=="bx"){q=v.firstChild.attributes[w].nodeValue;n=q.split(":",1)*1000;if(u>=n){v.firstChild.removeAttribute(p)}}}}this.storage_element.save(this.NS)};k.localStorageIE7.prototype.set=function(q,n,p){if(!p||p<=0){p=60}try{this.storage_element.load(this.NS);var s=this.storage_element.xmlDocument;this.keyChanges[this.prefix()+q]=true;s.firstChild.setAttribute(this.prefix()+q,Math.round(+new Date/1000)+p+":"+this._encode(n));this.storage_element.save(this.NS)}catch(i){this._trigger_error(i,q,n,p)}};k.localStorageIE7.prototype.get=function(n){this.storage_element.load(this.NS);var a=this.storage_element.xmlDocument;var i=a.firstChild.getAttribute(this.prefix()+n);if(i){var p=i.split(":",1)*1000;if(+new Date<=p){i=i.substring(11,i.length);return this._decode(i)}}return null};k.localStorageIE7.prototype.remove=function(i){this.storage_element.load(this.NS);var a=this.storage_element.xmlDocument;a.firstChild.removeAttribute(this.prefix()+i);this.keyChanges[this.prefix()+i]=true;this.storage_element.save(this.NS)};k.localStorageIE8=function(){this.key=j;this.currentKey=null;this.currentValue=null;k.localStorageIE8.superclass.constructor.apply(this)};k.extend(k.localStorageIE8,k.localStorage);k.localStorageIE8.prototype._onchange=function(a){if(null==this.currentKey){this.currentKey=localStorage.getItem(this.key);if(this.currentKey){this.currentValue=localStorage.getItem(this.prefix()+this.currentKey)}}else{a={key:this.prefix()+this.currentKey,newValue:localStorage.getItem(this.prefix()+this.currentKey),oldValue:this.currentValue};this.currentKey=null;this.currentValue=null;if(this.keyChanges[a.key]){this.keyChanges[a.key]=false;return}k.localStorageIE8.superclass._onchange.apply(this,[a])}};k.localStorageIE8.prototype.set=function(p,n,q){this.currentKey=null;this.keyChanges[this.prefix()+p]=true;try{localStorage.setItem(this.key,p);k.localStorageIE8.superclass.set.apply(this,arguments)}catch(i){this._trigger_error(i,p,n,q)}};k.localStorageIE8.prototype.remove=function(a){this.currentKey=null;this.keyChanges[this.prefix()+a]=true;localStorage.setItem(this.key,a);k.localStorageIE8.superclass.remove.apply(this,arguments)};k.onGlobalCustomEvent=function(i,a,n){if(!!k.localStorage.checkBrowser()){k.localStorage.set("BXGCE",{e:i,p:a},1)}if(!n){k.onCustomEvent(i,a)}};try{g=!!localStorage.setItem}catch(f){}if(g){g="native";var m=k.browser.IsIE()&&!k.browser.IsIE9()?document:h,d=function(a){if(typeof(a||h.event).key=="undefined"){g="ie8"}k.unbind(m,"storage",d);k.localStorage.instance()};k.bind(m,"storage",d);try{localStorage.setItem(j,null)}catch(f){g=false;k.localStorage.instance()}}else{if(k.browser.IsIE7()){g="ie7";k.localStorage.instance()}}})(window);(function(b){var a={time:1,step:0.05,type:"linear",allowFloat:false};BX.fx=function(d){this.options=d;if(null!=this.options.time){this.options.originalTime=this.options.time}if(null!=this.options.step){this.options.originalStep=this.options.step}if(!this.__checkOptions()){return false}this.__go=BX.delegate(this.go,this);this.PARAMS={}};BX.fx.prototype.__checkOptions=function(){if(typeof this.options.start!=typeof this.options.finish){return false}if(null==this.options.time){this.options.time=a.time}if(null==this.options.step){this.options.step=a.step}if(null==this.options.type){this.options.type=a.type}if(null==this.options.allowFloat){this.options.allowFloat=a.allowFloat}this.options.time*=1000;this.options.step*=1000;if(typeof this.options.start!="object"){this.options.start={_param:this.options.start};this.options.finish={_param:this.options.finish}}var d;for(d in this.options.start){if(null==this.options.finish[d]){this.options.start[d]=null;delete this.options.start[d]}}if(!BX.type.isFunction(this.options.type)){if(BX.type.isFunction(b[this.options.type])){this.options.type=b[this.options.type]}else{if(BX.type.isFunction(BX.fx.RULES[this.options.type])){this.options.type=BX.fx.RULES[this.options.type]}else{this.options.type=BX.fx.RULES[a.type]}}}return true};BX.fx.prototype.go=function(){var e=(new Date).valueOf();if(e<this.PARAMS.timeFinish){for(var d in this.PARAMS.current){this.PARAMS.current[d][0]=this.options.type.apply(this,[{start_value:this.PARAMS.start[d][0],finish_value:this.PARAMS.finish[d][0],current_value:this.PARAMS.current[d][0],current_time:e-this.PARAMS.timeStart,total_time:this.options.time}])}this._callback(this.options.callback);if(!this.paused){this.PARAMS.timer=setTimeout(this.__go,this.options.step)}}else{this.stop()}};BX.fx.prototype._callback=function(f){var d={};f=f||this.options.callback;for(var g in this.PARAMS.current){d[g]=(this.options.allowFloat?this.PARAMS.current[g][0]:Math.round(this.PARAMS.current[g][0]))+this.PARAMS.current[g][1]}return f.apply(this,[null!=d._param?d._param:d])};BX.fx.prototype.start=function(){var f,d,g;this.PARAMS.start={};this.PARAMS.current={};this.PARAMS.finish={};for(f in this.options.start){d=+this.options.start[f];g=(this.options.start[f]+"").substring((d+"").length);this.PARAMS.start[f]=[d,g];this.PARAMS.current[f]=[d,g];this.PARAMS.finish[f]=[+this.options.finish[f],g]}this._callback(this.options.callback_start);this._callback(this.options.callback);this.PARAMS.timeStart=(new Date).valueOf();this.PARAMS.timeFinish=this.PARAMS.timeStart+this.options.time;this.PARAMS.timer=setTimeout(BX.delegate(this.go,this),this.options.step);return this};BX.fx.prototype.pause=function(){if(this.paused){this.PARAMS.timer=setTimeout(this.__go,this.options.step);this.paused=false}else{clearTimeout(this.PARAMS.timer);this.paused=true}};BX.fx.prototype.stop=function(d){d=!!d;if(this.PARAMS.timer){clearTimeout(this.PARAMS.timer)}if(null!=this.options.originalTime){this.options.time=this.options.originalTime}if(null!=this.options.originalStep){this.options.step=this.options.originalStep}this.PARAMS.current=this.PARAMS.finish;if(!d){this._callback(this.options.callback);this._callback(this.options.callback_complete)}};BX.fx.RULES={linear:function(d){return d.start_value+d.current_time/d.total_time*(d.finish_value-d.start_value)},decelerated:function(d){return d.start_value+Math.sqrt(d.current_time/d.total_time)*(d.finish_value-d.start_value)},accelerated:function(e){var d=e.current_time/e.total_time;return e.start_value+d*d*(e.finish_value-e.start_value)}};BX.fx.hide=function(f,d,h){f=BX(f);if(typeof d=="object"&&null==h){h=d;d=h.type}if(!BX.type.isNotEmptyString(d)){f.style.display="none";return}var g=BX.fx.EFFECTS[d](f,h,0);g.callback_complete=function(){if(h.hide!==false){f.style.display="none"}if(h.callback_complete){h.callback_complete.apply(this,arguments)}};return new BX.fx(g).start()};BX.fx.show=function(f,d,h){f=BX(f);if(typeof d=="object"&&null==h){h=d;d=h.type}if(!h){h={}}if(!BX.type.isNotEmptyString(d)){f.style.display="block";return}var g=BX.fx.EFFECTS[d](f,h,1);g.callback_complete=function(){if(h.show!==false){f.style.display="block"}if(h.callback_complete){h.callback_complete.apply(this,arguments)}};return new BX.fx(g).start()};BX.fx.EFFECTS={scroll:function(f,i,g){if(!i.direction){i.direction="vertical"}var k=i.direction=="horizontal"?"width":"height";var j=parseInt(BX.style(f,k));if(isNaN(j)){j=BX.pos(f)[k]}if(g==0){var d=j,h=i.min_height?parseInt(i.min_height):0}else{var h=j,d=i.min_height?parseInt(i.min_height):0}return{start:d,finish:h,time:i.time||a.time,type:"linear",callback_start:function(){if(BX.style(f,"position")=="static"){f.style.position="relative"}f.style.overflow="hidden";f.style[k]=d+"px";f.style.display="block"},callback:function(e){f.style[k]=e+"px"}}},fade:function(d,g,f){var h={time:g.time||a.time,type:f==0?"decelerated":"linear",start:f==0?1:0,finish:f==0?0:1,allowFloat:true};if(BX.browser.IsIE()&&!BX.browser.IsIE9()){h.start*=100;h.finish*=100;h.allowFloat=false;h.callback_start=function(){d.style.display="block";d.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity="+h.start+")"};h.callback=function(e){(d.filters["DXImageTransform.Microsoft.alpha"]||d.filters.alpha).opacity=e}}else{h.callback_start=function(){d.style.display="block"};h.callback=function(e){d.style.opacity=d.style.KhtmlOpacity=d.style.MozOpacity=e}}return h},fold:function(f,h,g){if(g!=0){return}var j=BX.pos(f);var i=j.height/(j.width+j.height);var d={time:h.time||a.time,callback_complete:h.callback_complete,hide:h.hide};h.type="scroll";h.direction="vertical";h.min_height=h.min_height||10;h.hide=false;h.time=i*d.time;h.callback_complete=function(){f.style.whiteSpace="nowrap";h.direction="horizontal";h.min_height=null;h.time=d.time-h.time;h.hide=d.hide;h.callback_complete=d.callback_complete;BX.fx.hide(f,h)};return BX.fx.EFFECTS.scroll(f,h,g)},scale:function(f,i,g){var k={width:parseInt(BX.style(f,"width")),height:parseInt(BX.style(f,"height"))};if(isNaN(k.width)||isNaN(k.height)){var j=BX.pos(f);k={width:j.width,height:j.height}}if(g==0){var d=k,h={width:0,height:0}}else{var h=k,d={width:0,height:0}}return{start:d,finish:h,time:i.time||a.time,type:"linear",callback_start:function(){f.style.position="relative";f.style.overflow="hidden";f.style.display="block";f.style.height=d.height+"px";f.style.width=d.width+"px"},callback:function(e){f.style.height=e.height+"px";f.style.width=e.width+"px"}}}};var c={arStack:{},arRules:{},globalAnimationId:0};BX.fx.colorAnimate=function(f,e,g){if(f==null){return}animationId=f.getAttribute("data-animation-id");if(animationId==null){animationId=c.globalAnimationId;f.setAttribute("data-animation-id",c.globalAnimationId++)}var j=e.split(/\s*,\s*/);for(var h=0;h<j.length;h++){e=j[h];if(!c.arRules[e]){continue}var d=0;if(!c.arStack[animationId]){c.arStack[animationId]={}}else{if(c.arStack[animationId][e]){d=c.arStack[animationId][e].i;clearInterval(c.arStack[animationId][e].tId)}}if(d==0&&g||d==c.arRules[e][3]&&!g){continue}c.arStack[animationId][e]={i:d,element:f,tId:setInterval('BX.fx.colorAnimate.run("'+animationId+'","'+e+'")',c.arRules[e][4]),back:Boolean(g)}}};BX.fx.colorAnimate.addRule=function(f,e,g,k,j,d,h){c.arRules[f]=[BX.util.hex2rgb(e),BX.util.hex2rgb(g),k.replace(/\-(.)/g,function(){return arguments[1].toUpperCase()}),j,d||1,h||false]};BX.fx.colorAnimate.run=function(f,e){element=c.arStack[f][e].element;c.arStack[f][e].i+=c.arStack[f][e].back?-1:1;var g=c.arStack[f][e].i/c.arRules[e][3];var j=1-g;var h=c.arRules[e][0];var d=c.arRules[e][1];element.style[c.arRules[e][2]]="rgb("+Math.floor(h.r*j+d.r*g)+","+Math.floor(h.g*j+d.g*g)+","+Math.floor(h.b*j+d.b*g)+")";if(c.arStack[f][e].i==c.arRules[e][3]||c.arStack[f][e].i==0){clearInterval(c.arStack[f][e].tId);if(c.arRules[e][5]){BX.fx.colorAnimate(c.arStack[f][e].element,e,true)}}};BX.easing=function(d){this.options=d;this.timer=null};BX.easing.prototype.animate=function(){if(!this.options||!this.options.start||!this.options.finish||typeof this.options.start!="object"||typeof this.options.finish!="object"){return null}for(var d in this.options.start){if(typeof this.options.finish[d]=="undefined"){delete this.options.start[d]}}this.options.progress=function(g){var f={};for(var h in this.start){f[h]=Math.round(this.start[h]+(this.finish[h]-this.start[h])*g)}if(this.step){this.step(f)}};this.animateProgress()};BX.easing.prototype.stop=function(d){if(this.timer){clearInterval(this.timer);this.timer=null;if(d){this.options.complete&&this.options.complete()}}};BX.easing.prototype.animateProgress=function(){var f=new Date;var d=this.options.transition||BX.easing.transitions.linear;var g=this.options.duration||1000;this.timer=setInterval(BX.proxy(function(){var e=(new Date-f)/g;if(e>1){e=1}this.options.progress(d(e));if(e==1){this.stop(true)}},this),this.options.delay||13)};BX.easing.makeEaseInOut=function(d){return function(e){if(e<0.5){return d(2*e)/2}else{return(2-d(2*(1-e)))/2}}};BX.easing.makeEaseOut=function(d){return function(e){return 1-d(1-e)}};BX.easing.transitions={linear:function(d){return d},quad:function(d){return Math.pow(d,2)},cubic:function(d){return Math.pow(d,3)},quart:function(d){return Math.pow(d,4)},quint:function(d){return Math.pow(d,5)},circ:function(d){return 1-Math.sin(Math.acos(d))},back:function(d){return Math.pow(d,2)*((1.5+1)*d-1.5)},elastic:function(d){return Math.pow(2,10*(d-1))*Math.cos(20*Math.PI*1.5/3*d)},bounce:function(f){for(var d=0,g=1;1;d+=g,g/=2){if(f>=(7-4*d)/11){return -Math.pow((11-6*d-11*f)/4,2)+Math.pow(g,2)}}}}})(window);(function(window){if(BX.WindowManager){return}BX.WindowManager={_stack:[],_runtime_resize:{},_delta:2,_delta_start:1000,currently_loaded:null,settings_category:"BX.WindowManager.9.5",register:function(t){this.currently_loaded=null;var e=t.Get();e.style.zIndex=t.zIndex=this.GetZIndex();t.WM_REG_INDEX=this._stack.length;this._stack.push(t);if(this._stack.length<2){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))}},unregister:function(t){if(null==t.WM_REG_INDEX){return null}var e;if(this._stack.length>0){while((e=this.__pop_stack())!=t){if(!e){e=null;break}}if(this._stack.length<=0){this.enableKeyCheck()}return e}else{return null}},__pop_stack:function(t){if(this._stack.length>0){var e=this._stack.pop();e.WM_REG_INDEX=null;BX.onCustomEvent(e,"onWindowUnRegister",[t===true]);return e}else{return null}},clean:function(){while(this.__pop_stack(true)){}this._stack=null;this.disableKeyCheck()},Get:function(){if(this.currently_loaded){return this.currently_loaded}else{if(this._stack.length>0){return this._stack[this._stack.length-1]}else{return null}}},setStartZIndex:function(t){this._delta_start=t},restoreStartZIndex:function(){this._delta_start=1000},GetZIndex:function(){var t;return null!=(t=this._stack[this._stack.length-1])?parseInt(t.Get().style.zIndex)+this._delta:this._delta_start},__get_check_url:function(t){var e=t.indexOf("?");return e==-1?t:t.substring(0,e)},saveWindowSize:function(t,e){var i=this.__get_check_url(t);if(BX.userOptions){BX.userOptions.save(this.settings_category,"size_"+i,"width",e.width);BX.userOptions.save(this.settings_category,"size_"+i,"height",e.height)}this._runtime_resize[i]=e},saveWindowOptions:function(t,e){if(BX.userOptions){for(var i in e){if(e.hasOwnProperty(i)){BX.userOptions.save(this.settings_category,"options_"+t,i,e[i])}}}},getRuntimeWindowSize:function(t){return this._runtime_resize[this.__get_check_url(t)]},disableKeyCheck:function(){BX.unbind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},enableKeyCheck:function(){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},__checkKeyPress:function(t){if(null==t){t=window.event}if(t.keyCode==27){var e=BX.WindowManager.Get();if(e&&!e.unclosable){e.Close()}}}};BX.garbage(BX.WindowManager.clean,BX.WindowManager);BX.CWindowButton=function(t){if(t.btn){this.btn=t.btn;this.parentWindow=t.parentWindow;if(/save|apply/i.test(this.btn.name)){BX.bind(this.btn,"click",BX.delegate(this.disableUntilError,this))}}else{this.title=t.title;this.hint=t.hint;this.id=t.id;this.name=t.name;this.className=t.className;this.action=t.action;this.onclick=t.onclick;if(t.Button&&BX.type.isFunction(t.Button)){this.Button=t.Button}this.btn=null}};BX.CWindowButton.prototype.disable=function(){if(this.btn){this.parentWindow.showWait(this.btn)}};BX.CWindowButton.prototype.enable=function(){if(this.btn){this.parentWindow.closeWait(this.btn)}};BX.CWindowButton.prototype.emulate=function(){if(this.btn&&this.btn.disabled){return}var t=this.action?BX.delegate(this.action,this):this.onclick?this.onclick:this.btn?this.btn.getAttribute("onclick"):"";if(t){setTimeout(t,50);if(this.btn&&/save|apply/i.test(this.btn.name)&&!this.action){this.disableUntilError()}}};BX.CWindowButton.prototype.Button=function(parentWindow){this.parentWindow=parentWindow;var btn={props:{type:"button",name:this.id?this.id:this.name,value:this.title?this.title:this.name,id:this.id}};if(this.hint){btn.props.title=this.hint}if(!!this.className){btn.props.className=this.className}if(this.action){btn.events={click:BX.delegate(this.action,this)}}else{if(this.onclick){if(BX.browser.IsIE()){btn.events={click:BX.delegate(function(){eval(this.onclick)},this)}}else{btn.attrs={onclick:this.onclick}}}}this.btn=BX.create("INPUT",btn);return this.btn};BX.CWindowButton.prototype.disableUntilError=function(){this.disable();if(!this.__window_error_handler_set){BX.addCustomEvent(this.parentWindow,"onWindowError",BX.delegate(this.enable,this));this.__window_error_handler_set=true}};BX.CWindow=function(t,e){this.DIV=t||document.createElement("DIV");this.SETTINGS={resizable:false,min_height:0,min_width:0,top:0,left:0,draggable:false,drag_restrict:true,resize_restrict:true};this.ELEMENTS={draggable:[],resizer:[],close:[]};this.type=e=="float"?"float":"dialog";BX.adjust(this.DIV,{props:{className:"bx-core-window"},style:{zIndex:0,position:"absolute",display:"none",top:this.SETTINGS.top+"px",left:this.SETTINGS.left+"px",height:"100px",width:"100px"}});this.isOpen=false;BX.addCustomEvent(this,"onWindowRegister",BX.delegate(this.onRegister,this));BX.addCustomEvent(this,"onWindowUnRegister",BX.delegate(this.onUnRegister,this));this.MOUSEOVER=null;BX.bind(this.DIV,"mouseover",BX.delegate(this.__set_msover,this));BX.bind(this.DIV,"mouseout",BX.delegate(this.__unset_msover,this));BX.ready(BX.delegate(function(){document.body.appendChild(this.DIV)},this))};BX.CWindow.prototype.Get=function(){return this.DIV};BX.CWindow.prototype.visible=function(){return this.isOpen};BX.CWindow.prototype.Show=function(t){this.DIV.style.display="block";if(!t){BX.WindowManager.register(this);BX.onCustomEvent(this,"onWindowRegister")}};BX.CWindow.prototype.Hide=function(){BX.WindowManager.unregister(this);this.DIV.style.display="none"};BX.CWindow.prototype.onRegister=function(){this.isOpen=true};BX.CWindow.prototype.onUnRegister=function(t){this.isOpen=false;if(t||this.PARAMS&&this.PARAMS.content_url){if(t){BX.onCustomEvent(this,"onWindowClose",[this,true])}if(this.DIV.parentNode){this.DIV.parentNode.removeChild(this.DIV)}}else{this.DIV.style.display="none"}};BX.CWindow.prototype.CloseDialog=BX.CWindow.prototype.Close=function(t){BX.onCustomEvent(this,"onBeforeWindowClose",[this]);if(t!==true){if(this.denyClose){return false}}BX.onCustomEvent(this,"onWindowClose",[this]);if(this.bExpanded){var e=BX.GetDocElement();BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));e.style.overflow=this.__expand_settings.overflow}BX.WindowManager.unregister(this);return true};BX.CWindow.prototype.SetResize=function(t){t.style.cursor="se-resize";BX.bind(t,"mousedown",BX.proxy(this.__startResize,this));this.ELEMENTS.resizer.push(t);this.SETTINGS.resizable=true};BX.CWindow.prototype.SetExpand=function(t,e){e=e||"click";BX.bind(t,e,BX.proxy(this.__expand,this))};BX.CWindow.prototype.__expand_onresize=function(){var t=BX.GetWindowInnerSize();this.DIV.style.width=t.innerWidth+"px";this.DIV.style.height=t.innerHeight+"px";BX.onCustomEvent(this,"onWindowResize")};BX.CWindow.prototype.__expand=function(){var t=BX.GetDocElement();if(!this.bExpanded){var e=BX.GetWindowScrollPos(),i=BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.DIV.style.width,height:this.DIV.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")};this.SETTINGS.resizable=false;this.SETTINGS.draggable=false;window.scrollTo(0,0);t.style.overflow="hidden";this.DIV.style.top="0px";this.DIV.style.left="0px";this.DIV.style.width=i.innerWidth+"px";this.DIV.style.height=i.innerHeight+"px";this.bExpanded=true;BX.onCustomEvent(this,"onWindowExpand");BX.onCustomEvent(this,"onWindowResize");BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}else{BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));this.SETTINGS.resizable=this.__expand_settings.resizable;this.SETTINGS.draggable=this.__expand_settings.draggable;t.style.overflow=this.__expand_settings.overflow;this.DIV.style.top=this.__expand_settings.top;this.DIV.style.left=this.__expand_settings.left;this.DIV.style.width=this.__expand_settings.width;this.DIV.style.height=this.__expand_settings.height;window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop);this.bExpanded=false;BX.onCustomEvent(this,"onWindowNarrow");BX.onCustomEvent(this,"onWindowResize")}};BX.CWindow.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width);var s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var o=BX.GetWindowScrollSize();if(this.pos.left+i>o.scrollWidth-this.dw){i=o.scrollWidth-this.pos.left-this.dw}}this.DIV.style.width=i+"px";this.DIV.style.height=s+"px";BX.onCustomEvent(this,"onWindowResize")};BX.CWindow.prototype.__startResize=function(t){if(!this.SETTINGS.resizable){return false}if(!t){t=window.event}this.wndSize=BX.GetWindowScrollPos();this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth;this.pos=BX.pos(this.DIV);this.x=t.clientX+this.wndSize.scrollLeft;this.y=t.clientY+this.wndSize.scrollTop;this.dx=this.pos.left+this.pos.width-this.x;this.dy=this.pos.top+this.pos.height-this.y;this.dw=this.pos.width-parseInt(this.DIV.style.width);BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="se-resize";BX.onCustomEvent(this,"onWindowResizeStart");return true};BX.CWindow.prototype.__moveResize=function(t){if(!t){t=window.event}var e=BX.GetWindowScrollPos();var i=t.clientX+e.scrollLeft;var s=t.clientY+e.scrollTop;if(this.x==i&&this.y==s){return}this.Resize(i,s);this.x=i;this.y=s};BX.CWindow.prototype.__stopResize=function(){if(document.body.releaseCapture){document.body.releaseCapture()}BX.unbind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.unbind(document,"mouseup",BX.proxy(this.__stopResize,this));document.onmousedown=null;var t=document.body;t.ondrag=t.onselectstart=null;t.style.MozUserSelect=this.DIV.style.MozUserSelect="";t.style.cursor="";BX.onCustomEvent(this,"onWindowResizeFinished")};BX.CWindow.prototype.SetClose=function(t){BX.bind(t,"click",BX.proxy(this.Close,this));this.ELEMENTS.close.push(t)};BX.CWindow.prototype.SetDraggable=function(t){BX.bind(t,"mousedown",BX.proxy(this.__startDrag,this));t.style.cursor="move";this.ELEMENTS.draggable.push(t);this.SETTINGS.draggable=true};BX.CWindow.prototype.Move=function(t,e){var i=1;var s=parseInt(this.DIV.style.left)+t;var o=parseInt(this.DIV.style.top)+e;if(this.SETTINGS.drag_restrict){if(s<0){s=0}var n=BX.GetWindowScrollSize();var r=this.DIV.offsetWidth;var a=this.DIV.offsetHeight;if(s>n.scrollWidth-r-i){s=n.scrollWidth-r-i}if(o>n.scrollHeight-a-i){o=n.scrollHeight-a-i}if(o<0){o=0}}this.DIV.style.left=s+"px";this.DIV.style.top=o+"px"};BX.CWindow.prototype.__startDrag=function(t){if(!this.SETTINGS.draggable){return false}if(!t){t=window.event}this.x=t.clientX+document.body.scrollLeft;this.y=t.clientY+document.body.scrollTop;this.__bWasDragged=false;BX.bind(document,"mousemove",BX.proxy(this.__moveDrag,this));BX.bind(document,"mouseup",BX.proxy(this.__stopDrag,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="move";return BX.PreventDefault(t)};BX.CWindow.prototype.__moveDrag=function(t){if(!t){t=window.event}var e=t.clientX+document.body.scrollLeft;var i=t.clientY+document.body.scrollTop;if(this.x==e&&this.y==i){return}this.Move(e-this.x,i-this.y);this.x=e;this.y=i;if(!this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragStart");this.__bWasDragged=true;BX.bind(BX.proxy_context,"click",BX.PreventDefault)}BX.onCustomEvent(this,"onWindowDrag")};BX.CWindow.prototype.__stopDrag=function(t){if(document.body.releaseCapture){document.body.releaseCapture()}BX.unbind(document,"mousemove",BX.proxy(this.__moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this.__stopDrag,this));document.onmousedown=null;var e=document.body;e.ondrag=e.onselectstart=null;e.style.MozUserSelect=this.DIV.style.MozUserSelect="";e.style.cursor="";if(this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragFinished");var i=BX.proxy_context;setTimeout(function(){BX.unbind(i,"click",BX.PreventDefault)},100);this.__bWasDragged=false}return BX.PreventDefault(t)};BX.CWindow.prototype.DenyClose=function(){this.denyClose=true};BX.CWindow.prototype.AllowClose=function(){this.denyClose=false};BX.CWindow.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]);if(this._wait){BX.closeWait(this._wait)}window.alert(t)};BX.CWindow.prototype.__set_msover=function(){this.MOUSEOVER=true};BX.CWindow.prototype.__unset_msover=function(){this.MOUSEOVER=false};BX.CWindowDialog=function(){var t=arguments;t[1]="dialog";BX.CWindowDialog.superclass.constructor.apply(this,t);this.DIV.style.top="10px";this.OVERLAY=null};BX.extend(BX.CWindowDialog,BX.CWindow);BX.CWindowDialog.prototype.__resizeOverlay=function(){var t=BX.GetWindowScrollSize();this.OVERLAY.style.width=t.scrollWidth+"px"};BX.CWindowDialog.prototype.CreateOverlay=function(t){if(null==this.OVERLAY){var e=BX.GetWindowScrollSize();this.OVERLAY=document.body.appendChild(BX.create("DIV",{style:{position:"absolute",top:"0px",left:"0px",zIndex:t||parseInt(this.DIV.style.zIndex)-2,width:e.scrollWidth+"px",height:e.scrollHeight+"px"}}))}return this.OVERLAY};BX.CWindowDialog.prototype.Show=function(){BX.CWindowDialog.superclass.Show.apply(this,arguments);this.CreateOverlay();this.OVERLAY.style.display="block";this.OVERLAY.style.zIndex=parseInt(this.DIV.style.zIndex)-2;BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this));BX.bind(window,"resize",BX.proxy(this.__resizeOverlay,this))};BX.CWindowDialog.prototype.onUnRegister=function(t){BX.CWindowDialog.superclass.onUnRegister.apply(this,arguments);if(this.clean){if(this.OVERLAY.parentNode){this.OVERLAY.parentNode.removeChild(this.OVERLAY)}}else{this.OVERLAY.style.display="none"}BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this))};BX.CDialog=function(t){BX.CDialog.superclass.constructor.apply(this);this._sender="core_window_cdialog";this.PARAMS=t||{};for(var e in this.defaultParams){if(typeof this.PARAMS[e]=="undefined"){this.PARAMS[e]=this.defaultParams[e]}}this.PARAMS.width=!isNaN(parseInt(this.PARAMS.width))?this.PARAMS.width:this.defaultParams.width;this.PARAMS.height=!isNaN(parseInt(this.PARAMS.height))?this.PARAMS.height:this.defaultParams.height;if(this.PARAMS.resize_id||this.PARAMS.content_url){var i=BX.WindowManager.getRuntimeWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url);if(i){this.PARAMS.width=i.width;this.PARAMS.height=i.height}}BX.addClass(this.DIV,"bx-core-adm-dialog");this.DIV.id="bx-admin-prefix";this.PARTS={};this.DIV.style.height=null;this.DIV.style.width=null;this.PARTS.TITLEBAR=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head"}}));this.PARTS.TITLE_CONTAINER=this.PARTS.TITLEBAR.appendChild(BX.create("SPAN",{props:{className:"bx-core-adm-dialog-head-inner"},text:this.PARAMS.title}));this.PARTS.TITLEBAR_ICONS=this.PARTS.TITLEBAR.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-icons"},children:this.PARAMS.resizable?[BX.create("SPAN",{props:{className:"bx-core-adm-icon-expand",title:BX.message("JS_CORE_WINDOW_EXPAND")}}),BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]:[BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]}));this.PARTS.CONTENT=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap adm-workarea"}}));this.PARTS.CONTENT_DATA=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content"},style:{height:this.PARAMS.height+"px",width:this.PARAMS.width+"px"}}));this.PARTS.HEAD=this.PARTS.CONTENT_DATA.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-block"+(this.PARAMS.icon?" "+this.PARAMS.icon:"")}}));this.SetHead(this.PARAMS.head);this.SetContent(this.PARAMS.content);this.SetTitle(this.PARAMS.title);this.SetClose(this.PARTS.TITLEBAR_ICONS.lastChild);if(this.PARAMS.resizable){this.SetExpand(this.PARTS.TITLEBAR_ICONS.firstChild);this.SetExpand(this.PARTS.TITLEBAR,"dblclick");BX.addCustomEvent(this,"onWindowExpand",BX.proxy(this.__onexpand,this));BX.addCustomEvent(this,"onWindowNarrow",BX.proxy(this.__onexpand,this))}this.PARTS.FOOT=this.PARTS.BUTTONS_CONTAINER=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-buttons"},children:this.ShowButtons()}));if(this.PARAMS.draggable){this.SetDraggable(this.PARTS.TITLEBAR)}if(this.PARAMS.resizable){this.PARTS.RESIZER=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-resizer"}}));this.SetResize(this.PARTS.RESIZER);this.SETTINGS.min_width=this.PARAMS.min_width;this.SETTINGS.min_height=this.PARAMS.min_height}this.auth_callback=BX.delegate(function(){this.PARAMS.content="";this.hideNotify();this.Show()},this)};BX.extend(BX.CDialog,BX.CWindowDialog);BX.CDialog.prototype.defaultParams={width:700,height:400,min_width:500,min_height:300,resizable:true,draggable:true,title:"",icon:""};BX.CDialog.prototype.showWait=function(t){if(BX.type.isElementNode(t)&&(t.type=="button"||t.type=="submit")){BX.defer(function(){t.disabled=true})();var e=BX.hasClass(t,"adm-btn-save")||BX.hasClass(t,"adm-btn-save"),i=BX.pos(t,true);t.bxwaiter=this.PARTS.FOOT.appendChild(BX.create("DIV",{props:{className:"adm-btn-load-img"+(e?"-green":"")},style:{top:parseInt((i.bottom+i.top)/2-10)+"px",left:parseInt((i.right+i.left)/2-10)+"px"}}));BX.addClass(t,"adm-btn-load");this.lastWaitElement=t;return t.bxwaiter}return null};BX.CDialog.prototype.closeWait=function(t){t=t||this.lastWaitElement;if(BX.type.isElementNode(t)){if(t.bxwaiter){if(t.bxwaiter.parentNode){t.bxwaiter.parentNode.removeChild(t.bxwaiter)}t.bxwaiter=null}t.disabled=false;BX.removeClass(t,"adm-btn-load");if(this.lastWaitElement==t){this.lastWaitElement=null}}};BX.CDialog.prototype.Authorize=function(t){this.bSkipReplaceContent=true;this.ShowError(BX.message("JSADM_AUTH_REQ"));BX.onCustomEvent(this,"onWindowError",[]);BX.closeWait();new BX.CAuthDialog({content_url:this.PARAMS.content_url,auth_result:t,callback:BX.delegate(function(){if(this.auth_callback){this.auth_callback()}},this)}).Show()};BX.CDialog.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]);this.closeWait();if(this._wait){BX.closeWait(this._wait)}this.Notify(t,true)};BX.CDialog.prototype.__expandGetSize=function(){var t=BX.GetDocElement();t.style.overflow="hidden";var e=BX.GetWindowInnerSize();t.scrollTop=0;this.DIV.style.top="-"+this.dxShadow+"px";this.DIV.style.left="-"+this.dxShadow+"px";return{width:e.innerWidth-parseInt(BX.style(this.PARTS.CONTENT,"padding-right"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-left"))+this.dxShadow,height:e.innerHeight-this.PARTS.TITLEBAR.offsetHeight-this.PARTS.FOOT.offsetHeight-parseInt(BX.style(this.PARTS.CONTENT,"padding-top"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-bottom"))+this.dxShadow}};BX.CDialog.prototype.__expand=function(){var t=BX.GetDocElement();this.dxShadow=2;if(!this.bExpanded){var e=BX.GetWindowScrollPos();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.PARTS.CONTENT_DATA.style.width,height:this.PARTS.CONTENT_DATA.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")};this.SETTINGS.resizable=false;this.SETTINGS.draggable=false;var i=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=i.width+"px";this.PARTS.CONTENT_DATA.style.height=i.height+"px";window.scrollTo(0,0);t.style.overflow="hidden";this.bExpanded=true;BX.onCustomEvent(this,"onWindowExpand");BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{width:i.width,height:i.height}]);BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}else{BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));this.SETTINGS.resizable=this.__expand_settings.resizable;this.SETTINGS.draggable=this.__expand_settings.draggable;t.style.overflow=this.__expand_settings.overflow;this.DIV.style.top=this.__expand_settings.top;this.DIV.style.left=this.__expand_settings.left;this.PARTS.CONTENT_DATA.style.width=this.__expand_settings.width;this.PARTS.CONTENT_DATA.style.height=this.__expand_settings.height;window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop);this.bExpanded=false;BX.onCustomEvent(this,"onWindowNarrow");BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{width:parseInt(this.__expand_settings.width),height:parseInt(this.__expand_settings.height)}])}};BX.CDialog.prototype.__expand_onresize=function(){var t=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=t.width+"px";this.PARTS.CONTENT_DATA.style.height=t.height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[t])};BX.CDialog.prototype.__onexpand=function(){var t=this.PARTS.TITLEBAR_ICONS.firstChild;t.className=BX.toggle(t.className,["bx-core-adm-icon-expand","bx-core-adm-icon-narrow"]);t.title=BX.toggle(t.title,[BX.message("JS_CORE_WINDOW_EXPAND"),BX.message("JS_CORE_WINDOW_NARROW")]);if(this.PARTS.RESIZER){this.PARTS.RESIZER.style.display=this.bExpanded?"none":"block"}};BX.CDialog.prototype.__startResize=function(t){if(!this.SETTINGS.resizable){return false}if(!t){t=window.event}this.wndSize=BX.GetWindowScrollPos();this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth;this.pos=BX.pos(this.PARTS.CONTENT_DATA);this.x=t.clientX+this.wndSize.scrollLeft;this.y=t.clientY+this.wndSize.scrollTop;this.dx=this.pos.left+this.pos.width-this.x;this.dy=this.pos.top+this.pos.height-this.y;this.dw=this.pos.width-parseInt(this.PARTS.CONTENT_DATA.style.width)+parseInt(BX.style(this.PARTS.CONTENT,"padding-right"));BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="se-resize";BX.onCustomEvent(this,"onWindowResizeStart");return true};BX.CDialog.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width);var s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var o=BX.GetWindowScrollSize();if(this.pos.left+i>o.scrollWidth-this.dw){i=o.scrollWidth-this.pos.left-this.dw}}this.PARTS.CONTENT_DATA.style.width=i+"px";this.PARTS.CONTENT_DATA.style.height=s+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{height:s,width:i}])};BX.CDialog.prototype.SetSize=function(t){this.PARTS.CONTENT_DATA.style.width=t.width+"px";this.PARTS.CONTENT_DATA.style.height=t.height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[t])};BX.CDialog.prototype.GetParameters=function(t){var e=this.GetForm();if(!e){return""}var i,s="";var o=e.elements.length;var n="";for(i=0;i<o;i++){if(s!=""){n="&"}var r=e.elements[i];if(r.disabled){continue}switch(r.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==t&&r.name.substr(r.name.length-4)=="_alt"&&e.elements[r.name.substr(0,r.name.length-4)]){break}s+=n+r.name+"="+BX.util.urlencode(r.value);break;case"radio":if(r.checked){s+=n+r.name+"="+BX.util.urlencode(r.value)}break;case"checkbox":s+=n+r.name+"="+BX.util.urlencode(r.checked?"Y":"N");break;case"select-one":var a="";if(null==t&&e.elements[r.name+"_alt"]&&r.selectedIndex==0){a=e.elements[r.name+"_alt"].value}else{a=r.value}s+=n+r.name+"="+BX.util.urlencode(a);break;case"select-multiple":var h,l=false;var p=r.options.length;for(h=0;h<p;h++){if(r.options[h].selected){s+=n+r.name+"="+BX.util.urlencode(r.options[h].value);l=true}}if(!l){s+=n+r.name+"="}break;default:break}}return s};BX.CDialog.prototype.PostParameters=function(t){var e=this.PARAMS.content_url;if(null==t){t=""}t+=(t==""?"":"&")+"bxsender="+this._sender;var i=e.indexOf("?");if(i==-1){e+="?"+t}else{e=e.substring(0,i)+"?"+t+"&"+e.substring(i+1)}BX.showWait();this.auth_callback=BX.delegate(function(){this.hideNotify();this.PostParameters(t)},this);BX.ajax.Setup({skipAuthCheck:true},true);BX.ajax.post(e,this.GetParameters(),BX.delegate(function(t){BX.closeWait();if(!this.bSkipReplaceContent){this.ClearButtons();this.SetContent(t);this.Show(true)}this.bSkipReplaceContent=false},this))};BX.CDialog.prototype.Submit=function(t,e){var i=this.GetForm();if(i){i.onsubmit=null;i.method="POST";if(!i.action||e){e=e||this.PARAMS.content_url;if(null!=t){var s=e.indexOf("?");if(s==-1){e+="?"+t}else{e=e.substring(0,s)+"?"+t+"&"+e.substring(s+1)}}i.action=e}if(!i._bxsender){i._bxsender=i.appendChild(BX.create("INPUT",{attrs:{type:"hidden",name:"bxsender",value:this._sender}}))}this._wait=BX.showWait();this.auth_callback=BX.delegate(function(){this.hideNotify();this.Submit(t)},this);BX.ajax.submit(i,BX.delegate(function(){this.closeWait()},this))}else{window.alert("no form registered!")}};BX.CDialog.prototype.GetForm=function(){if(null==this.__form){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__form=t[0]?t[0]:null}return this.__form};BX.CDialog.prototype.GetRealForm=function(){if(null==this.__rform){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__rform=t[1]?t[1]:t[0]?t[0]:null}return this.__rform};BX.CDialog.prototype._checkButton=function(t){var e=["btnSave","btnCancel","btnClose"];for(var i=0;i<e.length;i++){if(this[e[i]]&&t==this[e[i]]){return e[i]}}return false};BX.CDialog.prototype.ShowButtons=function(){var t=[];if(this.PARAMS.buttons){if(this.PARAMS.buttons.title){this.PARAMS.buttons=[this.PARAMS.buttons]}for(var e=0,i=this.PARAMS.buttons.length;e<i;e++){if(BX.type.isNotEmptyString(this.PARAMS.buttons[e])){t.push(this.PARAMS.buttons[e])}else{if(this.PARAMS.buttons[e]){if(!BX.is_subclass_of(this.PARAMS.buttons[e],BX.CWindowButton)){var s=this._checkButton(this.PARAMS.buttons[e]);this.PARAMS.buttons[e]=new BX.CWindowButton(this.PARAMS.buttons[e]);if(s){this[s]=this.PARAMS.buttons[e]}}t.push(this.PARAMS.buttons[e].Button(this))}}}}return t};BX.CDialog.prototype.setAutosave=function(){if(!this.bSetAutosaveDelay){this.bSetAutosaveDelay=true;setTimeout(BX.proxy(this.setAutosave,this),10)}};BX.CDialog.prototype.SetTitle=function(t){this.PARAMS.title=t;BX.cleanNode(this.PARTS.TITLE_CONTAINER).appendChild(document.createTextNode(this.PARAMS.title))};BX.CDialog.prototype.SetHead=function(t){this.PARAMS.head=BX.util.trim(t);this.PARTS.HEAD.innerHTML=this.PARAMS.head||"&nbsp;";this.PARTS.HEAD.style.display=this.PARAMS.head?"block":"none";this.adjustSize()};BX.CDialog.prototype.Notify=function(t,e){if(!this.PARTS.NOTIFY){this.PARTS.NOTIFY=this.DIV.insertBefore(BX.create("DIV",{props:{className:"adm-warning-block"},children:[BX.create("SPAN",{props:{className:"adm-warning-text"}}),BX.create("SPAN",{props:{className:"adm-warning-icon"}}),BX.create("SPAN",{props:{className:"adm-warning-close"},events:{click:BX.proxy(this.hideNotify,this)}})]}),this.DIV.firstChild)}if(e){BX.addClass(this.PARTS.NOTIFY,"adm-warning-block-red")}else{BX.removeClass(this.PARTS.NOTIFY,"adm-warning-block-red")}this.PARTS.NOTIFY.firstChild.innerHTML=t||"&nbsp;";this.PARTS.NOTIFY.firstChild.style.width=this.PARAMS.width-50+"px";BX.removeClass(this.PARTS.NOTIFY,"adm-warning-animate")};BX.CDialog.prototype.hideNotify=function(){BX.addClass(this.PARTS.NOTIFY,"adm-warning-animate")};BX.CDialog.prototype.__adjustHeadToIcon=function(){if(!this.PARTS.HEAD.offsetHeight){setTimeout(BX.delegate(this.__adjustHeadToIcon,this),50)}else{if(this.icon_image&&this.icon_image.height&&this.icon_image.height>this.PARTS.HEAD.offsetHeight-5){this.PARTS.HEAD.style.height=this.icon_image.height+5+"px";this.adjustSize()}this.icon_image.onload=null;this.icon_image=null}};BX.CDialog.prototype.SetIcon=function(t){if(this.PARAMS.icon!=t){if(this.PARAMS.icon){BX.removeClass(this.PARTS.HEAD,this.PARAMS.icon)}this.PARAMS.icon=t;if(this.PARAMS.icon){BX.addClass(this.PARTS.HEAD,this.PARAMS.icon);var e=BX.style(this.PARTS.HEAD,"background-image")||BX.style(this.PARTS.HEAD,"backgroundImage");if(BX.type.isNotEmptyString(e)&&e!="none"){var i=e.match(new RegExp("url\\s*\\(\\s*('|\"|)(.+?)(\\1)\\s*\\)"));if(i){e=i[2];if(BX.type.isNotEmptyString(e)){this.icon_image=new Image;this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this);this.icon_image.src=e}}}}}this.adjustSize()};BX.CDialog.prototype.SetIconFile=function(t){this.icon_image=new Image;this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this);this.icon_image.src=t;BX.adjust(this.PARTS.HEAD,{style:{backgroundImage:"url("+t+")",backgroundPosition:"right 9px"}});this.adjustSize()};BX.CDialog.prototype.SetButtons=function(t){if(BX.type.isString(t)){if(t.length>0){this.PARTS.BUTTONS_CONTAINER.innerHTML+=t;var e=this.PARTS.BUTTONS_CONTAINER.getElementsByTagName("INPUT");if(e.length>0){this.PARAMS.buttons=[];for(var i=0;i<e.length;i++){this.PARAMS.buttons.push(new BX.CWindowButton({btn:e[i],parentWindow:this}))}}}}else{this.PARAMS.buttons=t;BX.adjust(this.PARTS.BUTTONS_CONTAINER,{children:this.ShowButtons()})}this.adjustSize()};BX.CDialog.prototype.ClearButtons=function(){BX.cleanNode(this.PARTS.BUTTONS_CONTAINER);this.adjustSize()};BX.CDialog.prototype.SetContent=function(t){this.__form=null;if(BX.type.isElementNode(t)){if(t.parentNode){t.parentNode.removeChild(t)}}else{if(BX.type.isString(t)){t=BX.create("DIV",{html:t})}}this.PARAMS.content=t;BX.cleanNode(this.PARTS.CONTENT_DATA);BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARTS.HEAD,BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap-inner"},children:[this.PARAMS.content]})]});if(this.PARAMS.content_url&&this.GetForm()){this.__form.submitbtn=this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}}));this.__form.onsubmit=BX.delegate(this.__submit,this)}};BX.CDialog.prototype.__submit=function(t){for(var e=0,i=this.PARAMS.buttons.length;e<i;e++){if(this.PARAMS.buttons[e]&&(this.PARAMS.buttons[e].name&&/save|apply/i.test(this.PARAMS.buttons[e].name)||this.PARAMS.buttons[e].btn&&this.PARAMS.buttons[e].btn.name&&/save|apply/i.test(this.PARAMS.buttons[e].btn.name))){this.PARAMS.buttons[e].emulate();break}}return BX.PreventDefault(t)};BX.CDialog.prototype.SwapContent=function(t){t=BX(t);BX.cleanNode(this.PARTS.CONTENT_DATA);t.parentNode.removeChild(t);this.PARTS.CONTENT_DATA.appendChild(t);t.style.display="block";this.SetContent(t.innerHTML)};BX.CDialog.prototype.adjustSize=function(){};BX.CDialog.prototype.__adjustSize=function(){};BX.CDialog.prototype.adjustSizeEx=function(){BX.defer(this.__adjustSizeEx,this)()};BX.CDialog.prototype.__adjustSizeEx=function(){var t=this.PARTS.CONTENT_DATA.firstChild,e=0;while(t){e+=t.offsetHeight+parseInt(BX.style(t,"margin-top"))+parseInt(BX.style(t,"margin-bottom"));t=BX.nextSibling(t)}if(e){this.PARTS.CONTENT_DATA.style.height=e+"px"}};BX.CDialog.prototype.__onResizeFinished=function(){BX.WindowManager.saveWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url,{height:parseInt(this.PARTS.CONTENT_DATA.style.height),width:parseInt(this.PARTS.CONTENT_DATA.style.width)})};BX.CDialog.prototype.Show=function(t){if(!this.PARAMS.content&&this.PARAMS.content_url&&BX.ajax&&!t){var e=BX.showWait();BX.WindowManager.currently_loaded=this;this.CreateOverlay(parseInt(BX.style(e,"z-index"))-1);this.OVERLAY.style.display="block";this.OVERLAY.className="bx-core-dialog-overlay";var i="",s="GET";if(this.PARAMS.content_post){i=this.PARAMS.content_post;s="POST"}var o=this.PARAMS.content_url+(this.PARAMS.content_url.indexOf("?")<0?"?":"&")+"bxsender="+this._sender;this.auth_callback=BX.delegate(function(){this.PARAMS.content="";this.hideNotify();this.Show()},this);BX.ajax({method:s,dataType:"html",url:o,data:i,skipAuthCheck:true,onsuccess:BX.delegate(function(t){BX.closeWait(null,e);this.SetContent(t||"&nbsp;");this.Show()},this)})}else{BX.WindowManager.currently_loaded=null;BX.CDialog.superclass.Show.apply(this,arguments);this.adjustPos();this.OVERLAY.className="bx-core-dialog-overlay";this.__adjustSize();BX.addCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this));if(this.PARAMS.resizable&&(this.PARAMS.content_url||this.PARAMS.resize_id)){BX.addCustomEvent(this,"onWindowResizeFinished",BX.delegate(this.__onResizeFinished,this))}}};BX.CDialog.prototype.GetInnerPos=function(){return{width:parseInt(this.PARTS.CONTENT_DATA.style.width),height:parseInt(this.PARTS.CONTENT_DATA.style.height)}};BX.CDialog.prototype.adjustPos=function(){if(!this.bExpanded){var t=BX.GetWindowInnerSize();var e=BX.GetWindowScrollPos();BX.adjust(this.DIV,{style:{left:parseInt(e.scrollLeft+t.innerWidth/2-parseInt(this.DIV.offsetWidth)/2)+"px",top:Math.max(parseInt(e.scrollTop+t.innerHeight/2-parseInt(this.DIV.offsetHeight)/2),0)+"px"}})}};BX.CDialog.prototype.GetContent=function(){return this.PARTS.CONTENT_DATA};BX.CDialog.prototype.btnSave=BX.CDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:BX.browser.IsIE()&&BX.browser.IsDoctype()&&!BX.browser.IsIE10()?"":"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.PostParameters()}};BX.CDialog.prototype.btnCancel=BX.CDialog.btnCancel={title:BX.message("JS_CORE_WINDOW_CANCEL"),id:"cancel",name:"cancel",action:function(){this.parentWindow.Close()}};BX.CDialog.prototype.btnClose=BX.CDialog.btnClose={title:BX.message("JS_CORE_WINDOW_CLOSE"),id:"close",name:"close",action:function(){this.parentWindow.Close()}};BX.CAdminDialog=function(t){BX.CAdminDialog.superclass.constructor.apply(this,arguments);this._sender="core_window_cadmindialog";BX.addClass(this.DIV,"bx-core-adm-admin-dialog");this.PARTS.CONTENT.insertBefore(this.PARTS.HEAD,this.PARTS.CONTENT.firstChild);this.PARTS.HEAD.className="bx-core-adm-dialog-tabs"};BX.extend(BX.CAdminDialog,BX.CDialog);BX.CAdminDialog.prototype.SetHead=function(){BX.CAdminDialog.superclass.SetHead.apply(this,arguments);if(this.PARTS.HEAD.firstChild&&BX.type.isElementNode(this.PARTS.HEAD.firstChild)){var t=this.PARTS.HEAD.firstChild,e=0,i=0,s=0;while(t){i=parseInt(BX.style(t,"margin-left"),10);if(isNaN(i)){i=0}s=parseInt(BX.style(t,"margin-right"),10);if(isNaN(s)){s=0}e+=t.offsetWidth+i+s;t=BX.nextSibling(t)}this.SETTINGS.min_width=Math.max(e,this.SETTINGS.min_width)-2;if(this.PARAMS.width<this.SETTINGS.min_width){BX.adjust(this.PARTS.CONTENT_DATA,{style:{width:this.SETTINGS.min_width+"px"}})}}};BX.CAdminDialog.prototype.SetContent=function(t){this.__form=null;if(BX.type.isElementNode(t)){if(t.parentNode){t.parentNode.removeChild(t)}}this.PARAMS.content=t;BX.cleanNode(this.PARTS.CONTENT_DATA);BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARAMS.content||"&nbsp;"]});if(this.PARAMS.content_url&&this.GetForm()){this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}}));this.__form.onsubmit=BX.delegate(this.__submit,this)}};BX.CAdminDialog.prototype.__adjustSizeEx=function(){var t=this.PARTS.CONTENT_DATA.firstChild,e=0;while(t){e+=t.offsetHeight+parseInt(BX.style(t,"margin-top"))+parseInt(BX.style(t,"margin-bottom"));t=BX.nextSibling(t);if(e){this.PARTS.CONTENT_DATA.style.height=e+"px"}}};BX.CAdminDialog.prototype.__expandGetSize=function(){var t=BX.CAdminDialog.superclass.__expandGetSize.apply(this,arguments);t.width-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-right"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-left"));t.height-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-top"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-bottom"));t.height-=this.PARTS.HEAD.offsetHeight;return t};BX.CAdminDialog.prototype.Submit=function(){var t=this.GetForm();if(t&&!t.bxpublic&&!/bxpublic=/.test(t.action)){t.appendChild(BX.create("INPUT",{props:{type:"hidden",name:"bxpublic",value:"Y"}}))}return BX.CAdminDialog.superclass.Submit.apply(this,arguments)};BX.CAdminDialog.prototype.btnSave=BX.CAdminDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.Submit()}};BX.CAdminDialog.btnCancel=BX.CAdminDialog.superclass.btnCancel;BX.CAdminDialog.btnClose=BX.CAdminDialog.superclass.btnClose;BX.CDebugDialog=function(t){BX.CDebugDialog.superclass.constructor.apply(this,arguments)};BX.extend(BX.CDebugDialog,BX.CDialog);BX.CDebugDialog.prototype.ShowDetails=function(t){var e=BX(t);if(e){if(this.div_detail_current){this.div_detail_current.style.display="none"}e.style.display="block";this.div_detail_current=e}};BX.CDebugDialog.prototype.SetContent=function(t){if(!t){return}var e=t.split("#DIVIDER#");if(e.length>1){this.PARAMS.content=e[1];this.PARTS.CONTENT_DATA.style.overflow="hidden";BX.CDebugDialog.superclass.SetContent.apply(this,[e[1]]);this.PARTS.CONTENT_INNER=this.PARTS.CONTENT_DATA.firstChild.nextSibling;this.PARTS.CONTENT_TOP=this.PARTS.CONTENT_DATA.insertBefore(BX.create("DIV",{props:{className:"bx-debug-content-top"},html:e[0]}),this.PARTS.CONTENT_INNER);this.PARTS.CONTENT_INNER.style.overflow="auto"}else{BX.CDebugDialog.superclass.SetContent.apply(this,arguments)}};BX.CDebugDialog.prototype.__adjustSize=function(){BX.CDebugDialog.superclass.__adjustSize.apply(this,arguments);if(this.PARTS.CONTENT_TOP){var t=this.PARTS.CONTENT_DATA.offsetHeight-this.PARTS.HEAD.offsetHeight-this.PARTS.CONTENT_TOP.offsetHeight-38;if(t>0){this.PARTS.CONTENT_INNER.style.height=t+"px"}}};BX.CEditorDialog=function(t){BX.CEditorDialog.superclass.constructor.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap");BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content");BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner");BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons");BX.addClass(this.PARTS.CONTENT,"bx-core-editor-dialog-content-wrap");BX.addClass(this.PARTS.CONTENT_DATA,"bx-core-editor-dialog-content");BX.addClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-editor-dialog-buttons")};BX.extend(BX.CEditorDialog,BX.CDialog);BX.CEditorDialog.prototype.SetContent=function(){BX.CEditorDialog.superclass.SetContent.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner")};BX.CWizardDialog=function(t){BX.CWizardDialog.superclass.constructor.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap");BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content");BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner");BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons");BX.addClass(this.PARTS.CONTENT,"bx-core-wizard-dialog-content-wrap")};BX.extend(BX.CWizardDialog,BX.CDialog);BX.CAuthDialog=function(t){t.resizable=false;t.width=350;t.height=200;t.buttons=[this.btnSave];BX.CAuthDialog.superclass.constructor.apply(this,arguments);this._sender="core_window_cauthdialog";BX.addClass(this.DIV,"bx-core-auth-dialog");BX.AUTHAGENT=this};BX.extend(BX.CAuthDialog,BX.CDialog);BX.CAuthDialog.prototype.btnSave=BX.CAuthDialog.btnSave={title:BX.message("JS_CORE_WINDOW_AUTH"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.Submit("",this.parentWindow.PARAMS.content_url)}};BX.CAuthDialog.prototype.SetError=function(t){BX.closeWait();if(!!t){this.ShowError(t.MESSAGE||t)}};BX.CAuthDialog.prototype.setAuthResult=function(t){BX.closeWait();if(t===false){this.Close();if(this.PARAMS.callback){this.PARAMS.callback()}}else{this.SetError(t)}};BX.CWindowFloat=function(t){BX.CWindowFloat.superclass.constructor.apply(this,[t,"float"]);this.SETTINGS.resizable=false};BX.extend(BX.CWindowFloat,BX.CWindow);BX.CWindowFloat.prototype.adjustPos=function(){if(this.PARAMS.parent){this.adjustToNode()}else{if(this.PARAMS.x&&this.PARAMS.y){this.adjustToPos([this.PARAMS.x,this.PARAMS.y])}}};BX.CWindowFloat.prototype.adjustToPos=function(t){this.DIV.style.left=parseInt(t[0])+"px";this.DIV.style.top=parseInt(t[1])+"px"};BX.CWindowFloat.prototype.adjustToNodeGetPos=function(){return BX.pos(this.PARAMS.parent)};BX.CWindowFloat.prototype.adjustToNode=function(t){t=t||this.PARAMS.parent;this.PARAMS.parent=BX(t);if(this.PARAMS.parent){var e=this.adjustToNodeGetPos();this.DIV.style.top=e.top+"px";this.DIV.style.left=e.left+"px";this.PARAMS.parent.OPENER=this}};BX.CWindowFloat.prototype.Show=function(){this.adjustToPos([-1000,-1000]);BX.CWindowFloat.superclass.Show.apply(this,arguments);this.adjustPos()};BX.COpener=function(t){this.PARAMS=t||{};this.MENU=t.MENU||[];this.DIV=t.DIV;this.ATTACH=t.ATTACH||t.DIV;this.ATTACH_MODE=t.ATTACH_MODE||"bottom";this.ACTIVE_CLASS=t.ACTIVE_CLASS||"";this.LEVEL=t.LEVEL||0;this.CLOSE_ON_CLICK=typeof t.CLOSE_ON_CLICK!="undefined"?!!t.CLOSE_ON_CLICK:true;this.ADJUST_ON_CLICK=typeof t.ADJUST_ON_CLICK!="undefined"?!!t.ADJUST_ON_CLICK:true;this.TYPE=this.PARAMS.TYPE=="hover"?"hover":"click";this._openTimeout=null;if(this.PARAMS.TYPE=="hover"&&t.TIMEOUT!==0){this.TIMEOUT=t.TIMEOUT||1000}else{this.TIMEOUT=0}if(!!this.PARAMS.MENU_URL){this.bMenuLoaded=false;this.bMenuLoading=false;this.MENU=[{TEXT:BX.message("JS_CORE_LOADING"),CLOSE_ON_CLICK:false}];if(this.PARAMS.MENU_PRELOAD){BX.defer(this.Load,this)()}}BX.ready(BX.defer(this.Init,this))};BX.COpener.prototype.Init=function(){this.DIV=BX(this.DIV);switch(this.TYPE){case"hover":BX.bind(this.DIV,"mouseover",BX.proxy(this.Open,this));BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break;case"click":BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break}this.bMenuInit=false};BX.COpener.prototype.Load=function(){if(this.PARAMS.MENU_URL&&!this.bMenuLoaded){if(!this.bMenuLoading){var t=this.PARAMS.MENU_URL;if(t.indexOf("sessid=")<=0){t+=(t.indexOf("?")>0?"&":"?")+"sessid="+BX.bitrix_sessid()}this.bMenuLoading=true;BX.ajax.loadJSON(t,BX.proxy(this.SetMenu,this),BX.proxy(this.LoadFailed,this))}}};BX.COpener.prototype.SetMenu=function(t){this.bMenuLoaded=true;this.bMenuLoading=false;if(this.bMenuInit){this.MENU.setItems(t)}else{this.MENU=t}};BX.COpener.prototype.LoadFailed=function(t,e){this.bMenuLoading=false;this.SetMenu([{TEXT:BX.message("JS_CORE_NO_DATA"),CLOSE_ON_CLICK:true}]);BX.debug(arguments)};BX.COpener.prototype.checkAdminMenu=function(){if(document.documentElement.id=="bx-admin-prefix"){return true}return !!BX.findParent(this.DIV,{property:{id:"bx-admin-prefix"}})};BX.COpener.prototype.Toggle=function(t){this.__clear_timeout();if(!this.bMenuInit||!this.MENU.visible()){var e=this.TIMEOUT;this.TIMEOUT=0;this.Open(t);this.TIMEOUT=e}else{this.MENU.Close()}return !!(t||window.event)&&BX.PreventDefault(t)};BX.COpener.prototype.GetMenu=function(){if(!this.bMenuInit){if(BX.type.isArray(this.MENU)){this.MENU=new BX.CMenu({ITEMS:this.MENU,ATTACH_MODE:this.ATTACH_MODE,SET_ID:this.checkAdminMenu()?"bx-admin-prefix":"",CLOSE_ON_CLICK:!!this.CLOSE_ON_CLICK,ADJUST_ON_CLICK:!!this.ADJUST_ON_CLICK,LEVEL:this.LEVEL,parent:BX(this.DIV),parent_attach:BX(this.ATTACH)});if(this.LEVEL>0){BX.bind(this.MENU.DIV,"mouseover",BX.proxy(this._on_menu_hover,this));BX.bind(this.MENU.DIV,"mouseout",BX.proxy(this._on_menu_hout,this))}}BX.addCustomEvent(this.MENU,"onMenuOpen",BX.proxy(this.handler_onopen,this));BX.addCustomEvent(this.MENU,"onMenuClose",BX.proxy(this.handler_onclose,this));BX.addCustomEvent("onMenuItemHover",BX.proxy(this.handler_onover,this));this.bMenuInit=true}return this.MENU};BX.COpener.prototype.Open=function(){this.GetMenu();this.bOpen=true;this.__clear_timeout();if(this.TIMEOUT>0){BX.bind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this));this._openTimeout=setTimeout(BX.proxy(this.__open,this),this.TIMEOUT)}else{this.__open()}if(!!this.PARAMS.MENU_URL&&!this.bMenuLoaded){this._loadTimeout=setTimeout(BX.proxy(this.Load,this),parseInt(this.TIMEOUT/2))}return true};BX.COpener.prototype.__clear_timeout=function(){if(!!this._openTimeout){clearTimeout(this._openTimeout)}if(!!this._loadTimeout){clearTimeout(this._loadTimeout)}BX.unbind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this))};BX.COpener.prototype._on_menu_hover=function(){this.bMenuHover=true;this.__clear_timeout();if(this.ACTIVE_CLASS){BX.addClass(this.DIV,this.ACTIVE_CLASS)}};BX.COpener.prototype._on_menu_hout=function(){this.bMenuHover=false};BX.COpener.prototype.handler_onover=function(t,e){if(this.bMenuHover){return}if(e!=this&&t==this.LEVEL-1&&this.ACTIVE_CLASS){BX.removeClass(this.DIV,this.ACTIVE_CLASS)}if(this.bMenuInit&&t<=this.LEVEL-1&&this.MENU.visible()){if(e!=this){this.__clear_timeout();this._openTimeout=setTimeout(BX.proxy(this.Close,this),this.TIMEOUT)}}};BX.COpener.prototype.handler_onopen=function(){this.bOpen=true;if(this.ACTIVE_CLASS){BX.addClass(this.DIV,this.ACTIVE_CLASS)}BX.defer(function(){BX.onCustomEvent(this,"onOpenerMenuOpen")},this)()};BX.COpener.prototype.handler_onclose=function(){this.bOpen=false;BX.onCustomEvent(this,"onOpenerMenuClose");if(this.ACTIVE_CLASS){BX.removeClass(this.DIV,this.ACTIVE_CLASS)}};BX.COpener.prototype.Close=function(){if(!this.bMenuInit){return}if(!!this._openTimeout){clearTimeout(this._openTimeout)}this.bOpen=false;this.__close()};BX.COpener.prototype.__open=function(){this.__clear_timeout();if(this.bMenuInit&&this.bOpen&&!this.MENU.visible()){this.MENU.Show()}};BX.COpener.prototype.__close=function(){if(this.bMenuInit&&!this.bOpen&&this.MENU.visible()){this.MENU.Hide()}};BX.COpener.prototype.__close_immediately=function(){this.bOpen=false;this.__close()};BX.COpener.prototype.isMenuVisible=function(){return null!=this.MENU.visible&&this.MENU.visible()};BX.CMenu=function(t){BX.CMenu.superclass.constructor.apply(this);this.DIV.style.width="auto";this.DIV.style.height="auto";this.PARAMS=t||{};this.PARTS={};this.PARAMS.ATTACH_MODE=this.PARAMS.ATTACH_MODE||"bottom";this.PARAMS.CLOSE_ON_CLICK=typeof this.PARAMS.CLOSE_ON_CLICK=="undefined"?true:this.PARAMS.CLOSE_ON_CLICK;this.PARAMS.ADJUST_ON_CLICK=typeof this.PARAMS.ADJUST_ON_CLICK=="undefined"?true:this.PARAMS.ADJUST_ON_CLICK;this.PARAMS.LEVEL=this.PARAMS.LEVEL||0;this.DIV.className="bx-core-popup-menu bx-core-popup-menu-"+this.PARAMS.ATTACH_MODE+" bx-core-popup-menu-level"+this.PARAMS.LEVEL+(typeof this.PARAMS.ADDITIONAL_CLASS!="undefined"?" "+this.PARAMS.ADDITIONAL_CLASS:"");if(!!this.PARAMS.SET_ID){this.DIV.id=this.PARAMS.SET_ID}if(this.PARAMS.LEVEL==0){this.ARROW=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-core-popup-menu-angle"},style:{left:"15px"}}))}if(!!this.PARAMS.CLASS_NAME){this.DIV.className+=" "+this.PARAMS.CLASS_NAME}BX.bind(this.DIV,"click",BX.eventCancelBubble);this.ITEMS=[];this.setItems(this.PARAMS.ITEMS);BX.addCustomEvent("onMenuOpen",BX.proxy(this._onMenuOpen,this));BX.addCustomEvent("onMenuItemSelected",BX.proxy(this.Hide,this))};BX.extend(BX.CMenu,BX.CWindowFloat);BX.CMenu.broadcastCloseEvent=function(){BX.onCustomEvent("onMenuItemSelected")};BX.CMenu._toggleChecked=function(){BX.toggleClass(this,"bx-core-popup-menu-item-checked")};BX.CMenu._itemDblClick=function(){window.location.href=this.href};BX.CMenu.prototype.toggleArrow=function(t){if(!!this.ARROW){if(typeof t=="undefined"){t=this.ARROW.style.visibility=="hidden"}this.ARROW.style.visibility=!!t?"visible":"hidden"}};BX.CMenu.prototype.visible=function(){return this.DIV.style.display!=="none"};BX.CMenu.prototype._onMenuOpen=function(t,e){if(this.visible()){if(e==this.PARAMS.LEVEL&&t!=this){this.Hide()}}};BX.CMenu.prototype.onUnRegister=function(){if(!this.visible()){return}this.Hide()};BX.CMenu.prototype.setItems=function(t){this.PARAMS.ITEMS=t;BX.cleanNode(this.DIV);if(!!this.ARROW){this.DIV.appendChild(this.ARROW)}if(this.PARAMS.ITEMS){this.PARAMS.ITEMS=BX.util.array_values(this.PARAMS.ITEMS);var e=false;var i=0;for(var s=0,o=this.PARAMS.ITEMS.length;s<o;s++){if((s==0||s==o-1)&&this.PARAMS.ITEMS[s].SEPARATOR){continue}i++;if(!e){e=!!this.PARAMS.ITEMS[s].GLOBAL_ICON}this.addItem(this.PARAMS.ITEMS[s],s)}if(i===1){BX.addClass(this.DIV,"bx-core-popup-menu-single-item")}else{BX.removeClass(this.DIV,"bx-core-popup-menu-single-item")}if(!e){BX.addClass(this.DIV,"bx-core-popup-menu-no-icons")}else{BX.removeClass(this.DIV,"bx-core-popup-menu-no-icons")}}};BX.CMenu.prototype.addItem=function(t){this.ITEMS.push(t);if(t.SEPARATOR){t.NODE=BX.create("DIV",{props:{className:"bx-core-popup-menu-separator"}})}else{var e=!!t.MENU&&(BX.type.isArray(t.MENU)&&t.MENU.length>0||t.MENU instanceof BX.CMenu)||!!t.MENU_URL;if(t.DISABLED){t.CLOSE_ON_CLICK=false;t.LINK=null;t.ONCLICK=null;t.ACTION=null}t.NODE=BX.create(!!t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?"A":"SPAN",{props:{className:"bx-core-popup-menu-item"+(e?" bx-core-popup-menu-item-opener":"")+(!!t.DEFAULT?" bx-core-popup-menu-item-default":"")+(!!t.DISABLED?" bx-core-popup-menu-item-disabled":"")+(!!t.CHECKED?" bx-core-popup-menu-item-checked":""),title:!!BX.message.MENU_ENABLE_TOOLTIP||!!t.SHOW_TITLE?t.TITLE||"":"",BXMENULEVEL:this.PARAMS.LEVEL},attrs:!!t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?{href:t.LINK||"javascript:void(0)"}:{},events:{mouseover:function(){BX.onCustomEvent("onMenuItemHover",[this.BXMENULEVEL,this.OPENER])}},html:'<span class="bx-core-popup-menu-item-icon'+(t.GLOBAL_ICON?" "+t.GLOBAL_ICON:"")+'"></span><span class="bx-core-popup-menu-item-text">'+t.TEXT+"</span>"});if(e&&!t.DISABLED){t.NODE.OPENER=new BX.COpener({DIV:t.NODE,ACTIVE_CLASS:"bx-core-popup-menu-item-opened",TYPE:"hover",MENU:t.MENU,MENU_URL:t.MENU_URL,MENU_PRELOAD:!!t.MENU_PRELOAD,LEVEL:this.PARAMS.LEVEL+1,ATTACH_MODE:"right",TIMEOUT:500})}else{if(this.PARAMS.CLOSE_ON_CLICK&&(typeof t.CLOSE_ON_CLICK=="undefined"||!!t.CLOSE_ON_CLICK)){BX.bind(t.NODE,"click",BX.CMenu.broadcastCloseEvent)}else{if(this.PARAMS.ADJUST_ON_CLICK&&(typeof t.ADJUST_ON_CLICK=="undefined"||!!t.ADJUST_ON_CLICK)){BX.bind(t.NODE,"click",BX.defer(this.adjustPos,this))}}}if(e&&!!t.LINK){BX.bind(t.NODE,"dblclick",BX.CMenu._itemDblClick)}if(typeof t.CHECKED!="undefined"){BX.bind(t.NODE,"click",BX.CMenu._toggleChecked)}t.ONCLICK=t.ACTION||t.ONCLICK;if(!!t.ONCLICK){if(BX.type.isString(t.ONCLICK)){t.ONCLICK=new Function("event",t.ONCLICK)}BX.bind(t.NODE,"click",t.ONCLICK)}}this.DIV.appendChild(t.NODE)};BX.CMenu.prototype._documentClickBind=function(){this._documentClickUnBind();BX.bind(document,"click",BX.proxy(this._documentClick,this))};BX.CMenu.prototype._documentClickUnBind=function(){BX.unbind(document,"click",BX.proxy(this._documentClick,this))};BX.CMenu.prototype._documentClick=function(t){t=t||window.event;if(!!t&&!(BX.getEventButton(t)&BX.MSLEFT)){return}this.Close()};BX.CMenu.prototype.Show=function(){BX.onCustomEvent(this,"onMenuOpen",[this,this.PARAMS.LEVEL]);BX.CMenu.superclass.Show.apply(this,[]);this.bCloseEventFired=false;BX.addCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this));BX.defer(this._documentClickBind,this)()};BX.CMenu.prototype.Close=BX.CMenu.prototype.Hide=function(){if(!this.visible()){return}BX.removeCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this));this._documentClickUnBind();if(!this.bCloseEventFired){BX.onCustomEvent(this,"onMenuClose",[this,this.PARAMS.LEVEL]);this.bCloseEventFired=true}BX.CMenu.superclass.Hide.apply(this,arguments)};BX.CMenu.prototype.__adjustMenuToNode=function(){var t=BX.pos(this.PARAMS.parent_attach),e=!!BX.findParent(this.PARAMS.parent_attach,BX.is_fixed);if(e){this.DIV.style.position="fixed"}else{this.DIV.style.position="absolute"}if(!t.top){this.DIV.style.top="-1000px";this.DIV.style.left="-1000px"}if(this.bTimeoutSet){return}var i=this.DIV.offsetWidth,s=this.DIV.offsetHeight;if(!i){setTimeout(BX.delegate(function(){this.bTimeoutSet=false;this.__adjustMenuToNode()},this),100);this.bTimeoutSet=true;return}var o={},n=BX.GetWindowSize();switch(this.PARAMS.ATTACH_MODE){case"bottom":o.top=t.bottom+9;o.left=t.left;var r=0;if(!!this.ARROW){if(t.width>i){r=parseInt(i/2-7)}else{r=parseInt(Math.min(i,t.width)/2-7)}if(r<7){o.left-=15;r+=15}}if(o.left>n.scrollWidth-i-10){var a=o.left;o.left=n.scrollWidth-i-10;if(!!this.ARROW){r+=a-o.left}}if(e){o.left-=n.scrollLeft}if(!!this.ARROW){this.ARROW.style.left=r+"px"}break;case"right":o.top=t.top-1;o.left=t.right;if(o.left>n.scrollWidth-i-10){o.left=t.left-i-1}break}if(e){o.top-=n.scrollTop}if(!!this.ARROW){this.ARROW.className="bx-core-popup-menu-angle"}if(o.top+s>n.scrollTop+n.innerHeight||o.top+s>n.scrollHeight){var h=this.PARAMS.ATTACH_MODE=="bottom"?t.top-s-9:t.bottom-s+1;if(h>n.scrollTop||o.top+s>n.scrollHeight){if(o.top+s>n.scrollHeight){o.top=Math.max(0,n.scrollHeight-s);this.toggleArrow(false)}else{o.top=h;if(!!this.ARROW){this.ARROW.className="bx-core-popup-menu-angle-bottom"}}}}if(o.top+o.left==0){this.Hide()}else{this.DIV.style.top=o.top+"px";this.DIV.style.left=o.left+"px"}};BX.CMenu.prototype.adjustToNode=function(t){this.PARAMS.parent_attach=BX(t)||this.PARAMS.parent_attach||this.PARAMS.parent;this.__adjustMenuToNode()};BX.CMenuOpener=function(t){BX.CMenuOpener.superclass.constructor.apply(this);this.PARAMS=t||{};this.setParent(this.PARAMS.parent);this.PARTS={};this.SETTINGS.drag_restrict=true;this.defaultAction=null;this.timeout=500;this.DIV.className="bx-component-opener";this.DIV.ondblclick=BX.PreventDefault;if(this.PARAMS.component_id){this.PARAMS.transform=!!this.PARAMS.transform}this.OPENERS=[];this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar"+(this.PARAMS.transform?" bx-context-toolbar-vertical-mode":"")}}));this.PARTS.INNER=this.DIV.firstChild.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-inner"},html:'<span class="bx-context-toolbar-drag-icon"></span><span class="bx-context-toolbar-vertical-line"></span><br>'}));this.EXTRA_BUTTONS={};var e=0;for(var i=0,s=this.PARAMS.menu.length;i<s;i++){var o=this.addItem(this.PARAMS.menu[i]);if(null!=o){e++;this.PARTS.INNER.appendChild(o);this.PARTS.INNER.appendChild(BX.create("BR"))}}var n=e>0;this.PARTS.ICONS=this.PARTS.INNER.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-icons"}}));if(this.PARAMS.component_id){this.PARAMS.pin=!!this.PARAMS.pin;if(n){this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-separator"}}))}this.PARTS.ICON_PIN=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin"},events:{click:BX.delegate(this.__pin_btn_clicked,this)}}))}if(this.EXTRA_BUTTONS.components2_props){var r=this.EXTRA_BUTTONS.components2_props||{URL:"javascript:void(0)"};if(null==this.defaultAction){this.defaultAction=r.ONCLICK;this.defaultActionTitle=r.TITLE||r.TEXT}r.URL="javascript:"+BX.util.urlencode(r.ONCLICK);this.ATTACH=this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button bx-context-toolbar-button-settings"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"},children:[BX.create("A",{attrs:{href:r.URL},events:{mouseover:BX.proxy(this.__msover_text,this),mouseout:BX.proxy(this.__msout_text,this),mousedown:BX.proxy(this.__msdown_text,this)},html:'<span class="bx-context-toolbar-button-icon bx-context-toolbar-settings-icon"></span>'}),BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-button-arrow"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},html:'<span class="bx-context-toolbar-button-arrow"></span>'})]})]}));this.OPENER=this.ATTACH.firstChild.lastChild;var a=this.attachMenu(this.EXTRA_BUTTONS.components2_submenu["MENU"]);BX.addCustomEvent(a,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this));BX.addCustomEvent(a,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(e>1){this.PARTS.ICONS.appendChild(BX.create("span",{props:{className:"bx-context-toolbar-separator bx-context-toolbar-separator-switcher"}}));this.ICON_TRANSFORM=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-switcher"},events:{click:BX.delegate(this.__trf_btn_clicked,this)}}))}if(this.PARAMS.HINT){this.DIV.BXHINT=this.HINT=new BX.CHint({parent:this.DIV,hint:this.PARAMS.HINT.TEXT||"",title:this.PARAMS.HINT.TITLE||"",hide_timeout:this.timeout/2,preventHide:false})}BX.addCustomEvent(this,"onWindowDragFinished",BX.delegate(this.__onMoveFinished,this));BX.addCustomEvent("onDynamicModeChange",BX.delegate(this.__onDynamicModeChange,this));BX.addCustomEvent("onTopPanelCollapse",BX.delegate(this.__onPanelCollapse,this));BX.addCustomEvent("onMenuOpenerMoved",BX.delegate(this.checkPosition,this));BX.addCustomEvent("onMenuOpenerUnhide",BX.delegate(this.checkPosition,this));if(this.OPENERS){for(i=0,s=this.OPENERS.length;i<s;i++){BX.addCustomEvent(this.OPENERS[i],"onOpenerMenuOpen",BX.proxy(this.__hide_hint,this))}}};BX.extend(BX.CMenuOpener,BX.CWindowFloat);BX.CMenuOpener.prototype.setParent=function(t){t=BX(t);if(t.OPENER&&t.OPENER!=this){t.OPENER.Close();t.OPENER.clearHoverHoutEvents()}if(this.PARAMS.parent&&this.PARAMS.parent!=t){this.clearHoverHoutEvents();this.PARAMS.parent.OPENER=null}this.PARAMS.parent=t;this.PARAMS.parent.OPENER=this};BX.CMenuOpener.prototype.setHoverHoutEvents=function(t,e){if(!this.__opener_events_set){BX.bind(this.Get(),"mouseover",t);BX.bind(this.Get(),"mouseout",e);this.__opener_events_set=true}};BX.CMenuOpener.prototype.clearHoverHoutEvents=function(){if(this.Get()){BX.unbindAll(this.Get());this.__opener_events_set=false}};BX.CMenuOpener.prototype.unclosable=true;BX.CMenuOpener.prototype.__check_intersection=function(t,e){return !(e.right<=t.left||e.left>=t.right||e.bottom<=t.top||e.top>=t.bottom)};BX.CMenuOpener.prototype.__msover_text=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-hover")}};BX.CMenuOpener.prototype.__msout_text=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")}};BX.CMenuOpener.prototype.__msover_arrow=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover")}};BX.CMenuOpener.prototype.__msout_arrow=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")}};BX.CMenuOpener.prototype.__msdown_text=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-active")}};BX.CMenuOpener.prototype.__msdown_arrow=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-active")}};BX.CMenuOpener.prototype.__menu_close=function(){this._menu_open=false;this.bx_active=false;BX.removeClass(this.ATTACH,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active");if(!this.bx_hover){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover");this.bx_hover=false}};BX.CMenuOpener.prototype.__menu_open=function(){this._menu_open=true};BX.CMenuOpener.prototype.checkPosition=function(){if(this.isMenuVisible()||this.DIV.style.display=="none"||this==BX.proxy_context||BX.proxy_context.zIndex>this.zIndex){return}this.correctPosition(BX.proxy_context)};BX.CMenuOpener.prototype.correctPosition=function(t){var e=BX.pos(this.DIV),i=BX.pos(t.Get());if(this.__check_intersection(e,i)){var s=i.top-e.height;if(s<0){s=i.bottom}this.DIV.style.top=s+"px";BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));BX.onCustomEvent(this,"onMenuOpenerMoved")}};BX.CMenuOpener.prototype.restorePosition=function(){if(!this.MOUSEOVER&&!this.isMenuVisible()){if(this.originalPos){this.DIV.style.top=this.originalPos.top+"px"}BX.removeCustomEvent(BX.proxy_context,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));if(this.restore_pos_timeout){clearTimeout(this.restore_pos_timeout)}}else{this.restore_pos_timeout=setTimeout(BX.proxy(this.restorePosition,this),this.timeout)}};BX.CMenuOpener.prototype.Show=function(){BX.CMenuOpener.superclass.Show.apply(this,arguments);this.SetDraggable(this.PARTS.INNER.firstChild);this.DIV.style.width="auto";this.DIV.style.height="auto";if(!this.PARAMS.pin){this.DIV.style.left="-1000px";this.DIV.style.top="-1000px";this.Hide()}else{this.bPosAdjusted=true;this.bMoved=true;if(this.PARAMS.top){this.DIV.style.top=this.PARAMS.top+"px"}if(this.PARAMS.left){this.DIV.style.left=this.PARAMS.left+"px"}this.DIV.style.display=!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders?"block":"none";if(this.DIV.style.display=="block"){setTimeout(BX.delegate(function(){BX.onCustomEvent(this,"onMenuOpenerUnhide")},this),50)}}};BX.CMenuOpener.prototype.executeDefaultAction=function(){if(this.defaultAction){if(BX.type.isFunction(this.defaultAction)){this.defaultAction()}else{if(BX.type.isString(this.defaultAction)){BX.evalGlobal(this.defaultAction)}}}};BX.CMenuOpener.prototype.__onDynamicModeChange=function(t){this.DIV.style.display=t?"block":"none"};BX.CMenuOpener.prototype.__onPanelCollapse=function(t,e){this.DIV.style.top=parseInt(this.DIV.style.top)+e+"px";if(this.PARAMS.pin){this.__savePosition()}};BX.CMenuOpener.prototype.__onMoveFinished=function(){BX.onCustomEvent(this,"onMenuOpenerMoved");this.bMoved=true;if(this.PARAMS.pin){this.__savePosition()}};BX.CMenuOpener.prototype.__savePosition=function(){var t={};t.pin=this.PARAMS.pin;if(!this.PARAMS.pin){t.top=false;t.left=false;t.transform=false}else{t.transform=this.PARAMS.transform;if(this.bMoved){t.left=parseInt(this.DIV.style.left);t.top=parseInt(this.DIV.style.top)}}BX.WindowManager.saveWindowOptions(this.PARAMS.component_id,t)};BX.CMenuOpener.prototype.__pin_btn_clicked=function(){this.Pin()};BX.CMenuOpener.prototype.Pin=function(t){if(null==t){this.PARAMS.pin=!this.PARAMS.pin}else{this.PARAMS.pin=!!t}this.PARTS.ICON_PIN.className=this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin";this.__savePosition()};BX.CMenuOpener.prototype.__trf_btn_clicked=function(){this.Transform()};BX.CMenuOpener.prototype.Transform=function(t){var e={};if(null==t){this.PARAMS.transform=!this.PARAMS.transform}else{this.PARAMS.transform=!!t}if(this.bMoved){e=BX.pos(this.DIV)}if(this.PARAMS.transform){BX.addClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode")}else{BX.removeClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode")}if(!this.bMoved){this.adjustPos()}else{this.DIV.style.left=e.right-this.DIV.offsetWidth-(BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0)+"px"}this.__savePosition()};BX.CMenuOpener.prototype.adjustToNodeGetPos=function(){var t=BX.pos(this.PARAMS.parent);var e=BX.GetWindowScrollSize();var i=this.DIV.offsetWidth;t.left-=BX.admin.__border_dx;t.top-=BX.admin.__border_dx;if(true||!this.PARAMS.transform){t.top-=45}if(t.left>e.scrollWidth-i){t.left=e.scrollWidth-i}return t};BX.CMenuOpener.prototype.addItem=function(t){if(t.TYPE){this.EXTRA_BUTTONS[t.TYPE]=t;return null}else{var e=new BX.CMenuOpenerItem(t);if(null==this.defaultAction){if(e.item.ONCLICK){this.defaultAction=t.ONCLICK}else{if(e.item.MENU){this.defaultAction=BX.delegate(function(){this.Open()},e.item.OPENER)}}this.defaultActionTitle=t.TITLE||t.TEXT;BX.addClass(e.Get(),"bx-content-toolbar-default")}if(e.item.OPENER){this.OPENERS[this.OPENERS.length]=e.item.OPENER}return e.Get()}};BX.CMenuOpener.prototype.attachMenu=function(t){var e=new BX.COpener({DIV:this.OPENER,ATTACH:this.ATTACH,MENU:t,TYPE:"click"});this.OPENERS[this.OPENERS.length]=e;return e};BX.CMenuOpener.prototype.__hide_hint=function(){if(this.HINT){this.HINT.__hide_immediately()}};BX.CMenuOpener.prototype.isMenuVisible=function(){for(var t=0,e=this.OPENERS.length;t<e;t++){if(this.OPENERS[t].isMenuVisible()){return true}}return false};BX.CMenuOpener.prototype.Hide=function(){if(!this.PARAMS.pin){this.DIV.style.display="none";BX.onCustomEvent(this,"onMenuOpenerHide")}};BX.CMenuOpener.prototype.UnHide=function(){this.DIV.style.display="block";if(!this.bPosAdjusted&&!this.PARAMS.pin){this.adjustPos();this.bPosAdjusted=true}if(null==this.originalPos&&!this.bMoved){this.originalPos=BX.pos(this.DIV)}BX.onCustomEvent(this,"onMenuOpenerUnhide")};BX.CMenuOpenerItem=function(t){this.item=t;if(this.item.ACTION&&!this.item.ONCLICK){this.item.ONCLICK=this.item.ACTION}this.DIV=BX.create("SPAN");this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-underlay"}}));this.WRAPPER=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-wrapper"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button",title:t.TITLE},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"}})]})]}));var e=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-icon"+(this.item.ICON||this.item.ICONCLASS?" "+(this.item.ICON||this.item.ICONCLASS):"")},attrs:!(this.item.ICON||this.item.ICONCLASS)&&(this.item.SRC||this.item.IMAGE)?{style:"background: scroll transparent url("+(this.item.SRC||this.item.IMAGE)+") no-repeat center center !important;"}:{}}),i=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-text"},text:this.item.TEXT});if(this.item.ACTION&&!this.item.ONCLICK){this.item.ONCLICK=this.item.ACTION}this.bHasMenu=!!this.item.MENU;this.bHasAction=!!this.item.ONCLICK;if(this.bHasAction){this.LINK=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:this.bHasMenu?BX.proxy(this.__msover_text,this):BX.proxy(this.__msover,this),mouseout:this.bHasMenu?BX.proxy(this.__msout_text,this):BX.proxy(this.__msout,this),mousedown:this.bHasMenu?BX.proxy(this.__msdown_text,this):BX.proxy(this.__msdown,this)},children:[e,i]}));if(this.bHasMenu){this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{props:{className:"bx-context-toolbar-button-arrow"},attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-arrow"}})]}))}}else{if(this.bHasMenu){this.item.ONCLICK=null;this.LINK=this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover,this),mouseout:BX.proxy(this.__msout,this),mousedown:BX.proxy(this.__msdown,this)},children:[e,i]}));this.LINK.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-single-button-arrow"}}))}}if(this.bHasMenu){this.item.SUBMENU=new BX.CMenu({ATTACH_MODE:"bottom",ITEMS:this.item.MENU,parent:this.LINK_MENU,parent_attach:this.WRAPPER.firstChild});this.item.OPENER=new BX.COpener({DIV:this.LINK_MENU,TYPE:"click",MENU:this.item.SUBMENU});BX.addCustomEvent(this.item.OPENER,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this));BX.addCustomEvent(this.item.OPENER,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(this.bHasAction){BX.bind(this.LINK,"click",BX.delegate(this.__click,this))}};BX.CMenuOpenerItem.prototype.Get=function(){return this.DIV};BX.CMenuOpenerItem.prototype.__msover=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover")}};BX.CMenuOpenerItem.prototype.__msout=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-active")}};BX.CMenuOpenerItem.prototype.__msover_text=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover")}};BX.CMenuOpenerItem.prototype.__msout_text=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")}};BX.CMenuOpenerItem.prototype.__msover_arrow=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover")}};BX.CMenuOpenerItem.prototype.__msout_arrow=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")}};BX.CMenuOpenerItem.prototype.__msdown=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active")}};BX.CMenuOpenerItem.prototype.__msdown_text=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-active")}};BX.CMenuOpenerItem.prototype.__msdown_arrow=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-active")}};BX.CMenuOpenerItem.prototype.__menu_close=function(){this._menu_open=false;this.bx_active=false;BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active");if(!this.bx_hover){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover");this.bx_hover=false}};BX.CMenuOpenerItem.prototype.__menu_open=function(){this._menu_open=true};BX.CMenuOpenerItem.prototype.__click=function(){BX.evalGlobal(this.item.ONCLICK)};BX.CPageOpener=function(t){BX.CPageOpener.superclass.constructor.apply(this,arguments);this.timeout=505;window.PAGE_EDIT_CONTROL=this};BX.extend(BX.CPageOpener,BX.CMenuOpener);BX.CPageOpener.prototype.checkPosition=function(){if(this==BX.proxy_context){return}this.correctPosition(BX.proxy_context)};BX.CPageOpener.prototype.correctPosition=function(t){if(this.bPosCorrected){return}var e;if(this.DIV.style.display=="none"){e=this.adjustToNodeGetPos();e.bottom=e.top+30;e.right=e.left+300}else{e=BX.pos(this.DIV)}var i=BX.pos(t.Get());if(this.__check_intersection(e,i)){this.DIV.style.display="none";BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));this.bPosCorrected=true}};BX.CPageOpener.prototype.restorePosition=function(){if(BX.proxy_context&&BX.proxy_context.Get().style.display=="none"){this.bPosCorrected=false;if(this.PARAMS.parent.bx_over||this.PARAMS.pin){this.UnHide()}BX.removeCustomEvent("onMenuOpenerHide",BX.proxy(this.restorePosition,this))}};BX.CPageOpener.prototype.UnHide=function(){if(!this.bPosCorrected){BX.CPageOpener.superclass.UnHide.apply(this,arguments)}};BX.CPageOpener.prototype.Remove=function(){BX.admin.removeComponentBorder(this.PARAMS.parent);BX.userOptions.save("global","settings","page_edit_control_enable","N");this.DIV.style.display="none"};BX.CHintSimple=function(){BX.CHintSimple.superclass.constructor.apply(this,arguments)};BX.extend(BX.CHintSimple,BX.CHint);BX.CHintSimple.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-tooltip-simple"},style:{display:"none"},children:[this.CONTENT=BX.create("DIV")]}));if(this.HINT_TITLE){this.CONTENT.appendChild(BX.create("B",{text:this.HINT_TITLE}))}if(this.HINT){this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV")).appendChild(BX.create("SPAN",{html:this.HINT}))}if(this.PARAMS.preventHide){BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this));BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))}this.bInited=true};BX.adminInformer={itemsShow:3,Init:function(t){if(t){BX.adminInformer.itemsShow=t}var e=BX("admin-informer");if(e){document.body.appendChild(e)}BX.addCustomEvent("onTopPanelCollapse",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},Toggle:function(t){var e=BX("admin-informer");if(!e){return false}var i=BX.pos(t);e.style.top=parseInt(i.top)+parseInt(i.height)+7+"px";e.style.left=i.left+"px";if(!BX.hasClass(e,"adm-informer-active")){BX.adminInformer.Show(e)}else{BX.adminInformer.Hide(e)}return false},Close:function(){BX.adminInformer.Hide(BX("admin-informer"))},OnInnerClick:function(t){var e=t.target||t.srcElement;if(e.nodeName.toLowerCase()!="a"||BX.hasClass(e,"adm-informer-footer")){return BX.PreventDefault(t)}return true},ToggleExtra:function(){var t=BX("adm-informer-footer");if(BX.hasClass(t,"adm-informer-footer-collapsed")){this.ShowAll()}else{this.HideExtra()}return false},ShowAll:function(){var t=BX("admin-informer");for(var e=0;e<t.children.length;e++){if(BX.hasClass(t.children[e],"adm-informer-item")&&t.children[e].style.display=="none"){t.children[e].style.display="block"}}var i=BX("adm-informer-footer");if(i.textContent!==undefined){i.textContent=BX.message("JSADM_AI_HIDE_EXTRA")}else{i.innerText=BX.message("JSADM_AI_HIDE_EXTRA")}BX.removeClass(i,"adm-informer-footer-collapsed");return false},HideExtra:function(){var t=BX("admin-informer");var e=0;for(var i=BX.adminInformer.itemsShow+1;i<t.children.length;i++){if(BX.hasClass(t.children[i],"adm-informer-item")&&t.children[i].style.display=="block"){t.children[i].style.display="none";e++}}var s=BX("adm-informer-footer");var o=BX.message("JSADM_AI_ALL_NOTIF")+" ("+(BX.adminInformer.itemsShow+parseInt(e))+")";if(s.textContent!==undefined){s.textContent=o}else{s.innerText=o}BX.addClass(s,"adm-informer-footer-collapsed");return false},Show:function(t){var e=BX("adm-header-notif-block");if(e){BX.addClass(e,"adm-header-notif-block-active")}BX.onCustomEvent(t,"onBeforeAdminInformerShow");setTimeout(BX.proxy(function(){BX.bind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},BX.adminInformer),0);BX.addClass(t,"adm-informer-active");setTimeout(function(){BX.addClass(t,"adm-informer-animate")},0)},Hide:function(t){var e=BX("adm-header-notif-block");if(e){BX.removeClass(e,"adm-header-notif-block-active")}BX.unbind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer));BX.removeClass(t,"adm-informer-animate");if(this.IsAnimationSupported()){setTimeout(function(){BX.removeClass(t,"adm-informer-active")},300)}else{BX.removeClass(t,"adm-informer-active")}BX.onCustomEvent(t,"onAdminInformerHide")},IsAnimationSupported:function(){var t=document.body||document.documentElement;if(typeof t.style.transition=="string"){return true}else{if(typeof t.style.MozTransition=="string"){return true}else{if(typeof t.style.OTransition=="string"){return true}else{if(typeof t.style.WebkitTransition=="string"){return true}else{if(typeof t.style.msTransition=="string"){return true}}}}}return false},SetItemHtml:function(t,e){var i=BX("adm-informer-item-html-"+t);if(!i){return false}i.innerHTML=e;return true},SetItemFooter:function(t,e){var i=BX("adm-informer-item-footer-"+t);if(!i){return false}i.innerHTML=e;if(e){i.style.display="block"}else{i.style.display="none"}return true}}})(window);(function(b){if(BX.PopupWindowManager){return}BX.PopupWindowManager={_popups:[],_currentPopup:null,create:function(g,j,f){var k=-1;if((k=this._getPopupIndex(g))!==-1){return this._popups[k]}var h=new BX.PopupWindow(g,j,f);BX.addCustomEvent(h,"onPopupShow",BX.delegate(this.onPopupShow,this));BX.addCustomEvent(h,"onPopupClose",BX.delegate(this.onPopupClose,this));BX.addCustomEvent(h,"onPopupDestroy",BX.delegate(this.onPopupDestroy,this));this._popups.push(h);return h},onPopupShow:function(e){if(this._currentPopup!==null){this._currentPopup.close()}this._currentPopup=e},onPopupClose:function(e){this._currentPopup=null},onPopupDestroy:function(f){var g=-1;if((g=this._getPopupIndex(f.uniquePopupId))!==-1){this._popups=BX.util.deleteFromArray(this._popups,g)}},getCurrentPopup:function(){return this._currentPopup},isPopupExists:function(e){return this._getPopupIndex(e)!==-1},_getPopupIndex:function(g){var h=-1;for(var f=0;f<this._popups.length;f++){if(this._popups[f].uniquePopupId==g){return f}}return h}};BX.PopupWindow=function(h,f,j){BX.onCustomEvent("onPopupWindowInit",[h,f,j]);this.uniquePopupId=h;this.params=j||{};this.params.zIndex=parseInt(this.params.zIndex);this.params.zIndex=isNaN(this.params.zIndex)?0:this.params.zIndex;this.buttons=this.params.buttons&&BX.type.isArray(this.params.buttons)?this.params.buttons:[];this.offsetTop=BX.PopupWindow.getOption("offsetTop");this.offsetLeft=BX.PopupWindow.getOption("offsetLeft");this.firstShow=false;this.bordersWidth=20;this.bindElementPos=null;this.closeIcon=null;this.angle=null;this.overlay=null;this.titleBar=null;this.bindOptions=typeof this.params.bindOptions=="object"?this.params.bindOptions:{};this.isAutoHideBinded=false;this.closeByEsc=!!this.params.closeByEsc;this.isCloseByEscBinded=false;this.dragged=false;this.dragPageX=0;this.dragPageY=0;if(this.params.events){for(var g in this.params.events){BX.addCustomEvent(this,g,this.params.events[g])}}this.popupContainer=document.createElement("DIV");BX.adjust(this.popupContainer,{props:{id:h},style:{zIndex:this.getZindex(),position:"absolute",display:"none",top:"0px",left:"0px"}});if(j.darkMode){BX.addClass(this.popupContainer,"popup-window-dark")}var k="popup-window";if(j.lightShadow){k+=" popup-window-light"}if(j.titleBar){k+=j.lightShadow?" popup-window-titlebar-light":" popup-window-titlebar"}if(j.className&&BX.type.isNotEmptyString(j.className)){k+=" "+j.className}this.popupContainer.innerHTML=['<table class="',k,'" cellspacing="0"> 		<tr class="popup-window-top-row"> 			<td class="popup-window-left-column"><div class="popup-window-left-spacer"></div></td> 			<td class="popup-window-center-column">',j.titleBar?'<div class="popup-window-titlebar" id="popup-window-titlebar-'+h+'"></div>':"",'</td> 			<td class="popup-window-right-column"><div class="popup-window-right-spacer"></div></td> 		</tr> 		<tr class="popup-window-content-row"> 			<td class="popup-window-left-column"></td> 			<td class="popup-window-center-column"><div class="popup-window-content" id="popup-window-content-',h,'"> 			</div></td> 			<td class="popup-window-right-column"></td> 		</tr> 		<tr class="popup-window-bottom-row"> 			<td class="popup-window-left-column"></td> 			<td class="popup-window-center-column"></td> 			<td class="popup-window-right-column"></td> 		</tr> 	</table>'].join("");document.body.appendChild(this.popupContainer);if(j.closeIcon){this.popupContainer.appendChild(this.closeIcon=BX.create("a",{props:{className:"popup-window-close-icon"+(j.titleBar?" popup-window-titlebar-close-icon":""),href:""},style:typeof j.closeIcon=="object"?j.closeIcon:{},events:{click:BX.proxy(this._onCloseIconClick,this)}}));if(BX.browser.IsIE()){BX.adjust(this.closeIcon,{attrs:{hidefocus:"true"}})}}this.contentContainer=BX("popup-window-content-"+h);this.titleBar=BX("popup-window-titlebar-"+h);this.buttonsContainer=this.buttonsHr=null;if(j.angle){this.setAngle(j.angle)}if(j.overlay){this.setOverlay(j.overlay)}this.setOffset(this.params);this.setBindElement(f);this.setTitleBar(this.params.titleBar);this.setContent(this.params.content);this.setButtons(this.params.buttons);if(this.params.bindOnResize!==false){BX.bind(b,"resize",BX.proxy(this._onResizeWindow,this))}};BX.PopupWindow.prototype.setContent=function(e){if(!this.contentContainer||!e){return}if(BX.type.isElementNode(e)){BX.cleanNode(this.contentContainer);this.contentContainer.appendChild(e.parentNode?e.parentNode.removeChild(e):e);e.style.display="block"}else{if(BX.type.isString(e)){this.contentContainer.innerHTML=e}else{this.contentContainer.innerHTML="&nbsp;"}}};BX.PopupWindow.prototype.setButtons=function(g){this.buttons=g&&BX.type.isArray(g)?g:[];if(this.buttonsHr){BX.remove(this.buttonsHr)}if(this.buttonsContainer){BX.remove(this.buttonsContainer)}if(this.buttons.length>0&&this.contentContainer){var h=[];for(var f=0;f<this.buttons.length;f++){var j=this.buttons[f];if(j==null||!BX.is_subclass_of(j,BX.PopupWindowButton)){continue}j.popupWindow=this;h.push(j.render())}this.buttonsHr=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-hr popup-window-buttons-hr"},children:[BX.create("i",{})]}));this.buttonsContainer=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-buttons"},children:h}))}};BX.PopupWindow.prototype.setBindElement=function(e){if(!e||typeof e!="object"){return}if(BX.type.isDomNode(e)||BX.type.isNumber(e.top)&&BX.type.isNumber(e.left)){this.bindElement=e}else{if(BX.type.isNumber(e.clientX)&&BX.type.isNumber(e.clientY)){BX.fixEventPageXY(e);this.bindElement={left:e.pageX,top:e.pageY,bottom:e.pageY}}}};BX.PopupWindow.prototype.getBindElementPos=function(g){if(BX.type.isDomNode(g)){return BX.pos(g,false)}else{if(g&&typeof g=="object"){if(!BX.type.isNumber(g.bottom)){g.bottom=g.top}return g}else{var j=BX.GetWindowInnerSize();var f=BX.GetWindowScrollPos();var k=this.popupContainer.offsetWidth;var h=this.popupContainer.offsetHeight;this.bindOptions.forceTop=true;return{left:j.innerWidth/2-k/2+f.scrollLeft,top:j.innerHeight/2-h/2+f.scrollTop,bottom:j.innerHeight/2-h/2+f.scrollTop,windowSize:j,windowScroll:f,popupWidth:k,popupHeight:h}}}};BX.PopupWindow.prototype.setAngle=function(r){var k=this.params.lightShadow?"popup-window-light-angly":"popup-window-angly";if(this.angle==null){var j=this.bindOptions.position&&this.bindOptions.position=="top"?"bottom":"top";var g=BX.PopupWindow.getOption(j=="top"?"angleMinTop":"angleMinBottom");var v=BX.type.isNumber(r.offset)?r.offset:0;var h=BX.PopupWindow.getOption("angleLeftOffset",null);if(v>0&&BX.type.isNumber(h)){v+=h-BX.PopupWindow.defaultOptions.angleLeftOffset}this.angle={element:BX.create("div",{props:{className:k+" "+k+"-"+j}}),position:j,offset:0,defaultOffset:Math.max(v,g)};this.popupContainer.appendChild(this.angle.element)}if(typeof r=="object"&&r.position&&BX.util.in_array(r.position,["top","right","bottom","left","hide"])){BX.removeClass(this.angle.element,k+"-"+this.angle.position);BX.addClass(this.angle.element,k+"-"+r.position);this.angle.position=r.position}if(typeof r=="object"&&BX.type.isNumber(r.offset)){var f=r.offset;var m,q;if(this.angle.position=="top"){m=BX.PopupWindow.getOption("angleMinTop");q=this.popupContainer.offsetWidth-BX.PopupWindow.getOption("angleMaxTop");q=q<m?Math.max(m,f):q;this.angle.offset=Math.min(Math.max(m,f),q);this.angle.element.style.left=this.angle.offset+"px";this.angle.element.style.marginLeft="auto"}else{if(this.angle.position=="bottom"){m=BX.PopupWindow.getOption("angleMinBottom");q=this.popupContainer.offsetWidth-BX.PopupWindow.getOption("angleMaxBottom");q=q<m?Math.max(m,f):q;this.angle.offset=Math.min(Math.max(m,f),q);this.angle.element.style.marginLeft=this.angle.offset+"px";this.angle.element.style.left="auto"}else{if(this.angle.position=="right"){m=BX.PopupWindow.getOption("angleMinRight");q=this.popupContainer.offsetHeight-BX.PopupWindow.getOption("angleMaxRight");q=q<m?Math.max(m,f):q;this.angle.offset=Math.min(Math.max(m,f),q);this.angle.element.style.top=this.angle.offset+"px"}else{if(this.angle.position=="left"){m=BX.PopupWindow.getOption("angleMinLeft");q=this.popupContainer.offsetHeight-BX.PopupWindow.getOption("angleMaxLeft");q=q<m?Math.max(m,f):q;this.angle.offset=Math.min(Math.max(m,f),q);this.angle.element.style.top=this.angle.offset+"px"}}}}}};BX.PopupWindow.prototype.isTopAngle=function(){return this.angle!=null&&this.angle.position=="top"};BX.PopupWindow.prototype.isBottomAngle=function(){return this.angle!=null&&this.angle.position=="bottom"};BX.PopupWindow.prototype.isTopOrBottomAngle=function(){return this.angle!=null&&BX.util.in_array(this.angle.position,["top","bottom"])};BX.PopupWindow.prototype.getAngleHeight=function(){return this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleTopOffset"):0};BX.PopupWindow.prototype.setOffset=function(e){if(typeof e!="object"){return}if(e.offsetLeft&&BX.type.isNumber(e.offsetLeft)){this.offsetLeft=e.offsetLeft+BX.PopupWindow.getOption("offsetLeft")}if(e.offsetTop&&BX.type.isNumber(e.offsetTop)){this.offsetTop=e.offsetTop+BX.PopupWindow.getOption("offsetTop")}};BX.PopupWindow.prototype.setTitleBar=function(e){if(!this.titleBar||typeof e!="object"||!BX.type.isDomNode(e.content)){return}this.titleBar.innerHTML="";this.titleBar.appendChild(e.content);if(this.params.draggable){this.titleBar.parentNode.style.cursor="move";BX.bind(this.titleBar.parentNode,"mousedown",BX.proxy(this._startDrag,this))}};BX.PopupWindow.prototype.setClosingByEsc=function(e){e=!!e;if(e){this.closeByEsc=true;if(!this.isCloseByEscBinded){BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=true}}else{this.closeByEsc=false;if(this.isCloseByEscBinded){BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=false}}};BX.PopupWindow.prototype.setOverlay=function(e){if(this.overlay==null){this.overlay={element:BX.create("div",{props:{className:"popup-window-overlay",id:"popup-window-overlay-"+this.uniquePopupId}})};this.adjustOverlayZindex();this.resizeOverlay();document.body.appendChild(this.overlay.element)}if(e&&e.opacity&&BX.type.isNumber(e.opacity)&&e.opacity>=0&&e.opacity<=100){if(BX.browser.IsIE()&&!BX.browser.IsIE9()){this.overlay.element.style.filter="alpha(opacity="+e.opacity+")"}else{this.overlay.element.style.filter="none";this.overlay.element.style.opacity=parseFloat(e.opacity/100).toPrecision(3)}}if(e&&e.backgroundColor){this.overlay.element.style.backgroundColor=e.backgroundColor}};BX.PopupWindow.prototype.removeOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){BX.remove(this.overlay.element)}this.overlay=null};BX.PopupWindow.prototype.hideOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){this.overlay.element.style.display="none"}};BX.PopupWindow.prototype.showOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){this.overlay.element.style.display="block"}};BX.PopupWindow.prototype.resizeOverlay=function(){if(this.overlay!=null&&this.overlay.element!=null){var e=BX.GetWindowScrollSize();this.overlay.element.style.width=e.scrollWidth+"px";this.overlay.element.style.height=e.scrollHeight+"px"}};BX.PopupWindow.prototype.getZindex=function(){if(this.overlay!=null){return BX.PopupWindow.getOption("popupOverlayZindex")+this.params.zIndex}else{return BX.PopupWindow.getOption("popupZindex")+this.params.zIndex}};BX.PopupWindow.prototype.adjustOverlayZindex=function(){if(this.overlay!=null&&this.overlay.element!=null){this.overlay.element.style.zIndex=parseInt(this.popupContainer.style.zIndex)-1}};BX.PopupWindow.prototype.show=function(){if(!this.firstShow){BX.onCustomEvent(this,"onPopupFirstShow",[this]);this.firstShow=true}BX.onCustomEvent(this,"onPopupShow",[this]);this.showOverlay();this.popupContainer.style.display="block";this.adjustPosition();BX.onCustomEvent(this,"onAfterPopupShow",[this]);if(this.closeByEsc&&!this.isCloseByEscBinded){BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=true}if(this.params.autoHide&&!this.isAutoHideBinded){setTimeout(BX.proxy(function(){if(this.isShown()){this.isAutoHideBinded=true;BX.bind(this.popupContainer,"click",this.cancelBubble);BX.bind(document,"click",BX.proxy(this.close,this))}},this),100)}};BX.PopupWindow.prototype.isShown=function(){return this.popupContainer.style.display=="block"};BX.PopupWindow.prototype.cancelBubble=function(f){if(!f){f=b.event}if(f.stopPropagation){f.stopPropagation()}else{f.cancelBubble=true}};BX.PopupWindow.prototype.close=function(e){if(!this.isShown()){return}if(e&&!(BX.getEventButton(e)&BX.MSLEFT)){return true}BX.onCustomEvent(this,"onPopupClose",[this,e]);this.hideOverlay();this.popupContainer.style.display="none";if(this.isCloseByEscBinded){BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));this.isCloseByEscBinded=false}setTimeout(BX.proxy(this._close,this),0)};BX.PopupWindow.prototype._close=function(){if(this.params.autoHide&&this.isAutoHideBinded){this.isAutoHideBinded=false;BX.unbind(this.popupContainer,"click",this.cancelBubble);BX.unbind(document,"click",BX.proxy(this.close,this))}};BX.PopupWindow.prototype._onCloseIconClick=function(f){f=f||b.event;this.close(f);BX.PreventDefault(f)};BX.PopupWindow.prototype._onKeyUp=function(f){f=f||b.event;if(f.keyCode==27){d(this.getZindex(),BX.proxy(this.close,this))}};BX.PopupWindow.prototype.destroy=function(){BX.onCustomEvent(this,"onPopupDestroy",[this]);BX.unbindAll(this);BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this));BX.unbind(document,"click",BX.proxy(this.close,this));BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this));BX.unbind(b,"resize",BX.proxy(this._onResizeWindow,this));BX.remove(this.popupContainer);this.removeOverlay()};BX.PopupWindow.prototype.adjustPosition=function(v){if(v&&typeof v=="object"){this.bindOptions=v}var m=this.getBindElementPos(this.bindElement);if(!this.bindOptions.forceBindPosition&&this.bindElementPos!=null&&m.top==this.bindElementPos.top&&m.left==this.bindElementPos.left){return}this.bindElementPos=m;var k=m.windowSize?m.windowSize:BX.GetWindowInnerSize();var g=m.windowScroll?m.windowScroll:BX.GetWindowScrollPos();var w=m.popupWidth?m.popupWidth:this.popupContainer.offsetWidth;var h=m.popupHeight?m.popupHeight:this.popupContainer.offsetHeight;var f=BX.PopupWindow.getOption("angleTopOffset");var q=this.bindElementPos.left+this.offsetLeft-(this.isTopOrBottomAngle()?BX.PopupWindow.getOption("angleLeftOffset"):0);if(!this.bindOptions.forceLeft&&q+w+this.bordersWidth>=k.innerWidth+g.scrollLeft&&k.innerWidth+g.scrollLeft-w-this.bordersWidth>0){var r=q;q=k.innerWidth+g.scrollLeft-w-this.bordersWidth;if(this.isTopOrBottomAngle()){this.setAngle({offset:r-q+this.angle.defaultOffset})}}else{if(this.isTopOrBottomAngle()){this.setAngle({offset:this.angle.defaultOffset+(q<0?q:0)})}}if(q<0){q=0}var j=0;if(this.bindOptions.position&&this.bindOptions.position=="top"){j=this.bindElementPos.top-h-this.offsetTop-(this.isBottomAngle()?f:0);if(j<0||!this.bindOptions.forceTop&&j<g.scrollTop){j=this.bindElementPos.bottom+this.offsetTop;if(this.angle!=null){j+=f;this.setAngle({position:"top"})}}else{if(this.isTopAngle()){j=j-f+BX.PopupWindow.getOption("positionTopXOffset");this.setAngle({position:"bottom"})}else{j+=BX.PopupWindow.getOption("positionTopXOffset")}}}else{j=this.bindElementPos.bottom+this.offsetTop+this.getAngleHeight();if(!this.bindOptions.forceTop&&j+h>k.innerHeight+g.scrollTop&&this.bindElementPos.top-h-this.getAngleHeight()>=0){j=this.bindElementPos.top-h;if(this.isTopOrBottomAngle()){j-=f;this.setAngle({position:"bottom"})}j+=BX.PopupWindow.getOption("positionTopXOffset")}else{if(this.isBottomAngle()){j+=f;this.setAngle({position:"top"})}}}if(j<0){j=0}BX.adjust(this.popupContainer,{style:{top:j+"px",left:q+"px",zIndex:this.getZindex()}});this.adjustOverlayZindex()};BX.PopupWindow.prototype._onResizeWindow=function(e){if(this.isShown()){this.adjustPosition();if(this.overlay!=null){this.resizeOverlay()}}};BX.PopupWindow.prototype.move=function(g,k){var f=parseInt(this.popupContainer.style.left)+g;var m=parseInt(this.popupContainer.style.top)+k;if(typeof this.params.draggable=="object"&&this.params.draggable.restrict){if(f<0){f=0}var h=BX.GetWindowScrollSize();var q=this.popupContainer.offsetWidth;var j=this.popupContainer.offsetHeight;if(f>h.scrollWidth-q){f=h.scrollWidth-q}if(m>h.scrollHeight-j){m=h.scrollHeight-j}if(m<0){m=0}}this.popupContainer.style.left=f+"px";this.popupContainer.style.top=m+"px"};BX.PopupWindow.prototype._startDrag=function(f){f=f||b.event;BX.fixEventPageXY(f);this.dragPageX=f.pageX;this.dragPageY=f.pageY;this.dragged=false;BX.bind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.bind(document,"mouseup",BX.proxy(this._stopDrag,this));if(document.body.setCapture){document.body.setCapture()}document.body.ondrag=BX.False;document.body.onselectstart=BX.False;document.body.style.cursor="move";document.body.style.MozUserSelect="none";this.popupContainer.style.MozUserSelect="none";return BX.PreventDefault(f)};BX.PopupWindow.prototype._moveDrag=function(f){f=f||b.event;BX.fixEventPageXY(f);if(this.dragPageX==f.pageX&&this.dragPageY==f.pageY){return}this.move(f.pageX-this.dragPageX,f.pageY-this.dragPageY);this.dragPageX=f.pageX;this.dragPageY=f.pageY;if(!this.dragged){BX.onCustomEvent(this,"onPopupDragStart");this.dragged=true}BX.onCustomEvent(this,"onPopupDrag")};BX.PopupWindow.prototype._stopDrag=function(e){if(document.body.releaseCapture){document.body.releaseCapture()}BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this));document.body.ondrag=null;document.body.onselectstart=null;document.body.style.cursor="";document.body.style.MozUserSelect="";this.popupContainer.style.MozUserSelect="";BX.onCustomEvent(this,"onPopupDragEnd");this.dragged=false;return BX.PreventDefault(e)};BX.PopupWindow.options={};BX.PopupWindow.defaultOptions={angleLeftOffset:15,positionTopXOffset:0,angleTopOffset:8,popupZindex:1000,popupOverlayZindex:1100,angleMinLeft:10,angleMaxLeft:10,angleMinRight:10,angleMaxRight:10,angleMinBottom:7,angleMaxBottom:25,angleMinTop:7,angleMaxTop:25,offsetLeft:0,offsetTop:0};BX.PopupWindow.setOptions=function(f){if(!f||typeof f!="object"){return}for(var g in f){BX.PopupWindow.options[g]=f[g]}};BX.PopupWindow.getOption=function(f,g){if(typeof BX.PopupWindow.options[f]!="undefined"){return BX.PopupWindow.options[f]}else{if(typeof g!="undefined"){return g}else{return BX.PopupWindow.defaultOptions[f]}}};BX.PopupWindowButton=function(f){this.popupWindow=null;this.params=f||{};this.text=this.params.text||"";this.id=this.params.id||"";this.className=this.params.className||"";this.events=this.params.events||{};this.contextEvents={};for(var g in this.events){this.contextEvents[g]=BX.proxy(this.events[g],this)}this.nameNode=BX.create("span",{props:{className:"popup-window-button-text"},text:this.text});this.buttonNode=BX.create("span",{props:{className:"popup-window-button"+(this.className.length>0?" "+this.className:""),id:this.id},children:[BX.create("span",{props:{className:"popup-window-button-left"}}),this.nameNode,BX.create("span",{props:{className:"popup-window-button-right"}})],events:this.contextEvents})};BX.PopupWindowButton.prototype.render=function(){return this.buttonNode};BX.PopupWindowButton.prototype.setName=function(e){this.text=e||"";if(this.nameNode){BX.cleanNode(this.nameNode);BX.adjust(this.nameNode,{text:this.text})}};BX.PopupWindowButton.prototype.setClassName=function(e){if(this.buttonNode){if(BX.type.isString(this.className)&&this.className!=""){BX.removeClass(this.buttonNode,this.className)}BX.addClass(this.buttonNode,e)}this.className=e};BX.PopupWindowButtonLink=function(e){BX.PopupWindowButtonLink.superclass.constructor.apply(this,arguments);this.nameNode=BX.create("span",{props:{className:"popup-window-button-link-text"},text:this.text,events:this.contextEvents});this.buttonNode=BX.create("span",{props:{className:"popup-window-button popup-window-button-link"+(this.className.length>0?" "+this.className:""),id:this.id},children:[this.nameNode]})};BX.extend(BX.PopupWindowButtonLink,BX.PopupWindowButton);BX.PopupMenu={Data:{},currentItem:null,show:function(g,h,f,j){if(this.currentItem!==null){this.currentItem.popupWindow.close()}this.currentItem=this.create(g,h,f,j);this.currentItem.popupWindow.show()},create:function(g,h,f,j){if(!this.Data[g]){this.Data[g]=new BX.PopupMenuWindow(g,h,f,j)}return this.Data[g]},getCurrentMenu:function(){return this.currentItem},getMenuById:function(e){return this.Data[e]?this.Data[e]:null},destroy:function(f){var g=this.getMenuById(f);if(g){if(this.currentItem==g){this.currentItem=null}g.popupWindow.destroy();delete this.Data[f]}}};BX.PopupMenuWindow=function(g,j,f,k){this.id=g;this.bindElement=j;this.menuItems=[];this.itemsContainer=null;if(f&&BX.type.isArray(f)){for(var h=0;h<f.length;h++){this.__addMenuItem(f[h],null)}}this.params=k&&typeof k=="object"?k:{};this.popupWindow=this.__createPopup()};BX.PopupMenuWindow.prototype.__createItem=function(f,g){if(g>0){f.layout.hr=BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]})}if(f.delimiter){f.layout.item=BX.create("span",{props:{className:"popup-window-delimiter"},html:"<i></i>"})}else{f.layout.item=BX.create(!!f.href?"a":"span",{props:{className:"menu-popup-item"+(BX.type.isNotEmptyString(f.className)?" "+f.className:" menu-popup-no-icon")},attrs:{title:f.title?f.title:"",onclick:f.onclick&&BX.type.isString(f.onclick)?f.onclick:"",target:f.target?f.target:""},events:f.onclick&&BX.type.isFunction(f.onclick)?{click:BX.proxy(this.onItemClick,{obj:this,item:f})}:null,children:[BX.create("span",{props:{className:"menu-popup-item-left"}}),BX.create("span",{props:{className:"menu-popup-item-icon"}}),f.layout.text=BX.create("span",{props:{className:"menu-popup-item-text"},html:f.text}),BX.create("span",{props:{className:"menu-popup-item-right"}})]});if(f.href){f.layout.item.href=f.href}}return f};BX.PopupMenuWindow.prototype.__createPopup=function(){var g=[];for(var h=0;h<this.menuItems.length;h++){this.__createItem(this.menuItems[h],h);if(this.menuItems[h].layout.hr!=null){g.push(this.menuItems[h].layout.hr)}g.push(this.menuItems[h].layout.item)}var f=new BX.PopupWindow("menu-popup-"+this.id,this.bindElement,{closeByEsc:typeof this.params.closeByEsc!="undefined"?this.params.closeByEsc:false,bindOptions:typeof this.params.bindOptions=="object"?this.params.bindOptions:{},angle:typeof this.params.angle!="undefined"?this.params.angle:false,zIndex:this.params.zIndex?this.params.zIndex:0,overlay:typeof this.params.overlay=="object"?this.params.overlay:null,autoHide:typeof this.params.autoHide!="undefined"?this.params.autoHide:true,offsetTop:this.params.offsetTop?this.params.offsetTop:1,offsetLeft:this.params.offsetLeft?this.params.offsetLeft:0,lightShadow:typeof this.params.lightShadow!="undefined"?this.params.lightShadow:true,content:BX.create("div",{props:{className:"menu-popup"},children:[this.itemsContainer=BX.create("div",{props:{className:"menu-popup-items"},children:g})]})});if(this.params&&this.params.events){for(var j in this.params.events){if(this.params.events.hasOwnProperty(j)){BX.addCustomEvent(f,j,this.params.events[j])}}}return f};BX.PopupMenuWindow.prototype.onItemClick=function(f){f=f||b.event;this.item.onclick.call(this.obj,f,this.item)};BX.PopupMenuWindow.prototype.addMenuItem=function(g,h){var f=this.__addMenuItem(g,h);if(f<0){return false}this.__createItem(g,f);var j=this.getMenuItem(h);if(j!=null){if(j.layout.hr==null){j.layout.hr=BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]});this.itemsContainer.insertBefore(j.layout.hr,j.layout.item)}if(g.layout.hr!=null){this.itemsContainer.insertBefore(g.layout.hr,j.layout.hr)}this.itemsContainer.insertBefore(g.layout.item,j.layout.hr)}else{if(g.layout.hr!=null){this.itemsContainer.appendChild(g.layout.hr)}this.itemsContainer.appendChild(g.layout.item)}return true};BX.PopupMenuWindow.prototype.__addMenuItem=function(g,h){if(!g||!g.delimiter&&!BX.type.isNotEmptyString(g.text)||g.id&&this.getMenuItem(g.id)!=null){return -1}g.layout={item:null,text:null,hr:null};var f=this.getMenuItemPosition(h);if(f>=0){this.menuItems=BX.util.insertIntoArray(this.menuItems,f,g)}else{this.menuItems.push(g);f=this.menuItems.length-1}return f};BX.PopupMenuWindow.prototype.removeMenuItem=function(g){var h=this.getMenuItem(g);if(!h){return}for(var f=0;f<this.menuItems.length;f++){if(this.menuItems[f]==h){this.menuItems=BX.util.deleteFromArray(this.menuItems,f);break}}if(f==0){if(this.menuItems[0]){this.menuItems[0].layout.hr.parentNode.removeChild(this.menuItems[0].layout.hr);this.menuItems[0].layout.hr=null}}else{h.layout.hr.parentNode.removeChild(h.layout.hr)}h.layout.item.parentNode.removeChild(h.layout.item);h.layout.item=null};BX.PopupMenuWindow.prototype.getMenuItem=function(f){for(var g=0;g<this.menuItems.length;g++){if(this.menuItems[g].id&&this.menuItems[g].id==f){return this.menuItems[g]}}return null};BX.PopupMenuWindow.prototype.getMenuItemPosition=function(f){if(f){for(var g=0;g<this.menuItems.length;g++){if(this.menuItems[g].id&&this.menuItems[g].id==f){return g}}}return -1};b.BXInputPopup=function(f){this.id=f.id||"bx-inp-popup-"+Math.round(Math.random()*1000000);this.handler=f.handler||false;this.values=f.values||false;this.pInput=f.input;this.bValues=!!this.values;this.defaultValue=f.defaultValue||"";this.openTitle=f.openTitle||"";this.className=f.className||"";this.noMRclassName=f.noMRclassName||"ec-no-rm";this.emptyClassName=f.noMRclassName||"ec-label";var g=this;this.curInd=false;if(this.bValues){this.pInput.onfocus=this.pInput.onclick=function(e){if(this.value==g.defaultValue){this.value="";this.className=g.className}g.ShowPopup();return BX.PreventDefault(e)};this.pInput.onblur=function(){if(g.bShowed){setTimeout(function(){g.ClosePopup(true)},200)}g.OnChange()}}else{this.pInput.className=this.noMRclassName;this.pInput.onblur=BX.proxy(this.OnChange,this)}};BXInputPopup.prototype={ShowPopup:function(){if(this.bShowed){return}var g=this;if(!this.oPopup){var j,f=BX.create("DIV",{props:{className:"bxecpl-loc-popup "+this.className}});for(var k=0,h=this.values.length;k<h;k++){j=f.appendChild(BX.create("DIV",{props:{id:"bxecmr_"+k},text:this.values[k].NAME,events:{mouseover:function(){BX.addClass(this,"bxecplloc-over")},mouseout:function(){BX.removeClass(this,"bxecplloc-over")},click:function(){var i=this.id.substr("bxecmr_".length);g.pInput.value=g.values[i].NAME;g.curInd=i;g.OnChange();g.ClosePopup(true)}}}));if(this.values[k].DESCRIPTION){j.title=this.values[k].DESCRIPTION}if(this.values[k].CLASS_NAME){BX.addClass(j,this.values[k].CLASS_NAME)}if(this.values[k].URL){j.appendChild(BX.create("A",{props:{href:this.values[k].URL,className:"bxecplloc-view",target:"_blank",title:this.openTitle}}))}}this.oPopup=new BX.PopupWindow(this.id,this.pInput,{autoHide:true,offsetTop:1,offsetLeft:0,lightShadow:true,closeByEsc:true,content:f});BX.addCustomEvent(this.oPopup,"onPopupClose",BX.proxy(this.ClosePopup,this))}this.oPopup.show();this.pInput.select();this.bShowed=true;BX.onCustomEvent(this,"onInputPopupShow",[this])},ClosePopup:function(e){this.bShowed=false;if(this.pInput.value==""){this.OnChange()}BX.onCustomEvent(this,"onInputPopupClose",[this]);if(e===true){this.oPopup.close()}},OnChange:function(){var e=this.pInput.value;if(this.bValues){if(this.pInput.value==""||this.pInput.value==this.defaultValue){this.pInput.value=this.defaultValue;this.pInput.className=this.emptyClassName;e=""}else{this.pInput.className=""}}if(isNaN(parseInt(this.curInd))||this.curInd!==false&&e!=this.values[this.curInd].NAME){this.curInd=false}else{this.curInd=parseInt(this.curInd)}BX.onCustomEvent(this,"onInputPopupChanged",[this,this.curInd,e]);if(this.handler&&typeof this.handler=="function"){this.handler({ind:this.curInd,value:e})}},Set:function(g,h,f){this.curInd=g;if(this.curInd!==false){this.pInput.value=this.values[this.curInd].NAME}else{this.pInput.value=h}if(f!==false){this.OnChange()}},Get:function(f){var g=false;if(typeof f=="undefined"){f=this.curInd}if(f!==false&&this.values[f]){g=this.values[f].ID}return g},GetIndex:function(g){for(var h=0,f=this.values.length;h<f;h++){if(this.values[h].ID==g){return h}}return false},Deactivate:function(e){if(this.pInput.value==""||this.pInput.value==this.defaultValue){if(e){this.pInput.value="";this.pInput.className=this.noMRclassName}else{if(this.oEC.bUseMR){this.pInput.value=this.defaultValue;this.pInput.className=this.emptyClassName}}}this.pInput.disabled=e}};var c=-1,a=null;function d(e,f){if(e===false){if(a&&a.length>0){for(var g=0;g<a.length;g++){a[g]()}a=null;c=-1}}else{if(a===null){a=[];c=-1;BX.defer(d)(false)}if(e>c){c=e;a=[f]}else{if(e==c){a.push(f)}}}}})(window);if(!BXRL){var BXRL={};var BXRLW=null}RatingLike=function(k,g,f,d,c,b,m,j,h){this.enabled=true;this.likeId=k;this.entityTypeId=g;this.entityId=f;this.available=d=="Y"?true:false;this.userId=c;this.localize=b;this.template=m;this.pathToUserProfile=j;this.pathToAjax=typeof h=="string"?h:"/bitrix/components/bitrix/rating.vote/vote.ajax.php";this.box=BX("bx-ilike-button-"+k);if(this.box===null){this.enabled=false;return false}this.button=BX.findChild(this.box,{className:"bx-ilike-left-wrap"},true,false);this.buttonText=BX.findChild(this.button,{className:"bx-ilike-text"},true,false);this.count=BX.findChild(this.box,{tagName:"span",className:"bx-ilike-right-wrap"},true,false);this.countText=BX.findChild(this.count,{tagName:"span",className:"bx-ilike-right"},true,false);this.popup=null;this.popupId=null;this.popupOpenId=null;this.popupTimeoutId=null;this.popupContent=BX.findChild(BX("bx-ilike-popup-cont-"+k),{tagName:"span",className:"bx-ilike-popup"},true,false);this.popupContentPage=1;this.popupListProcess=false;this.popupTimeout=false;this.likeTimeout=false;this.lastVote=BX.hasClass(m=="standart"?this.button:this.count,"bx-you-like")?"plus":"cancel"};RatingLike.LiveUpdate=function(b){if(b.USER_ID==BX.message("USER_ID")){return false}for(var c in BXRL){if(BXRL[c].entityTypeId==b.ENTITY_TYPE_ID&BXRL[c].entityId==b.ENTITY_ID){var a=BXRL[c];a.countText.innerHTML=parseInt(b.TOTAL_POSITIVE_VOTES);a.count.insertBefore(BX.create("span",{props:{className:"bx-ilike-plus-one"},style:{width:a.countText.clientWidth-8+"px",height:a.countText.clientHeight-8+"px"},html:b.TYPE=="ADD"?"+1":"-1"}),a.count.firstChild);if(a.popup){a.popup.close();a.popupContentPage=1}}}};RatingLike.Set=function(m,h,g,d,c,b,q,k,j){if(q===undefined){q="standart"}if(!BXRL[m]||BXRL[m].tryToSet<=5){var f=BXRL[m]&&BXRL[m].tryToSet?BXRL[m].tryToSet:1;BXRL[m]=new RatingLike(m,h,g,d,c,b,q,k,j);if(BXRL[m].enabled){RatingLike.Init(m)}else{setTimeout(function(){BXRL[m].tryToSet=f+1;RatingLike.Set(m,h,g,d,c,b,q,k,j)},500)}}};RatingLike.Init=function(a){if(BXRL[a].available){BX.bind(BXRL[a].template=="standart"?BXRL[a].button:BXRL[a].buttonText,"click",function(b){clearTimeout(BXRL[a].likeTimeout);if(BX.hasClass(BXRL[a].template=="standart"?this:BXRL[a].count,"bx-you-like")){BXRL[a].buttonText.innerHTML=BXRL[a].localize.LIKE_N;BXRL[a].countText.innerHTML=parseInt(BXRL[a].countText.innerHTML)-1;BX.removeClass(BXRL[a].template=="standart"?this:BXRL[a].count,"bx-you-like");BXRL[a].likeTimeout=setTimeout(function(){if(BXRL[a].lastVote!="cancel"){RatingLike.Vote(a,"cancel")}},1000)}else{BXRL[a].buttonText.innerHTML=BXRL[a].localize.LIKE_Y;BXRL[a].countText.innerHTML=parseInt(BXRL[a].countText.innerHTML)+1;BX.addClass(BXRL[a].template=="standart"?this:BXRL[a].count,"bx-you-like");BXRL[a].likeTimeout=setTimeout(function(){if(BXRL[a].lastVote!="plus"){RatingLike.Vote(a,"plus")}},1000)}BX.removeClass(this.box,"bx-ilike-button-hover");BX.PreventDefault(b)});BX.bind(BXRL[a].box,"mouseover",function(){BX.addClass(this,"bx-ilike-button-hover")});BX.bind(BXRL[a].box,"mouseout",function(){BX.removeClass(this,"bx-ilike-button-hover")})}else{if(BXRL[a].buttonText!=undefined){BXRL[a].buttonText.innerHTML=BXRL[a].localize.LIKE_D}}RatingLike.PopupScroll(a);BX.bind(BXRL[a].count,"mouseover",function(){clearTimeout(BXRL[a].popupTimeoutId);BXRL[a].popupTimeoutId=setTimeout(function(){if(BXRLW==a){return false}if(BXRL[a].popupContentPage==1){RatingLike.List(a,1)}BXRL[a].popupTimeoutId=setTimeout(function(){RatingLike.OpenWindow(a)},400)},400)});BX.bind(BXRL[a].count,"mouseout",function(){clearTimeout(BXRL[a].popupTimeoutId)});BX.bind(BXRL[a].count,"click",function(){clearTimeout(BXRL[a].popupTimeoutId);if(BXRL[a].popupContentPage==1){RatingLike.List(a,1)}RatingLike.OpenWindow(a)});BX.bind(BXRL[a].box,"mouseout",function(){clearTimeout(BXRL[a].popupTimeout);BXRL[a].popupTimeout=setTimeout(function(){if(BXRL[a].popup!==null){BXRL[a].popup.close();BXRLW=null}},1000)});BX.bind(BXRL[a].box,"mouseover",function(){clearTimeout(BXRL[a].popupTimeout)})};RatingLike.OpenWindow=function(a){if(parseInt(BXRL[a].countText.innerHTML)==0){return false}if(BXRL[a].popup==null){BXRL[a].popup=new BX.PopupWindow("ilike-popup-"+a,BXRL[a].template=="standart"?BXRL[a].count:BXRL[a].box,{lightShadow:true,offsetLeft:5,autoHide:true,closeByEsc:true,zIndex:2005,bindOptions:{position:"top"},events:{onPopupClose:function(){BXRLW=null},onPopupDestroy:function(){}},content:BX("bx-ilike-popup-cont-"+a)});BXRL[a].popup.setAngle({});BX.bind(BX("ilike-popup-"+a),"mouseout",function(){clearTimeout(BXRL[a].popupTimeout);BXRL[a].popupTimeout=setTimeout(function(){BXRL[a].popup.close()},1000)});BX.bind(BX("ilike-popup-"+a),"mouseover",function(){clearTimeout(BXRL[a].popupTimeout)})}if(BXRLW!=null){BXRL[BXRLW].popup.close()}BXRLW=a;BXRL[a].popup.show();RatingLike.AdjustWindow(a)};RatingLike.Vote=function(a,b){BX.ajax({url:BXRL[a].pathToAjax,method:"POST",dataType:"json",data:{RATING_VOTE:"Y",RATING_VOTE_TYPE_ID:BXRL[a].entityTypeId,RATING_VOTE_ENTITY_ID:BXRL[a].entityId,RATING_VOTE_ACTION:b,sessid:BX.bitrix_sessid()},onsuccess:function(c){BXRL[a].lastVote=c.action;BXRL[a].countText.innerHTML=c.items_all;BXRL[a].popupContentPage=1;BXRL[a].popupContent.innerHTML="";spanTag0=document.createElement("span");spanTag0.className="bx-ilike-wait";BXRL[a].popupContent.appendChild(spanTag0);RatingLike.AdjustWindow(a);if(BX("ilike-popup-"+a)&&BX("ilike-popup-"+a).style.display=="block"){RatingLike.List(a,null)}},onfailure:function(c){}});return false};RatingLike.List=function(a,b){if(parseInt(BXRL[a].countText.innerHTML)==0){return false}if(b==null){b=BXRL[a].popupContentPage}BXRL[a].popupListProcess=true;BX.ajax({url:BXRL[a].pathToAjax,method:"POST",dataType:"json",data:{RATING_VOTE_LIST:"Y",RATING_VOTE_TYPE_ID:BXRL[a].entityTypeId,RATING_VOTE_ENTITY_ID:BXRL[a].entityId,RATING_VOTE_LIST_PAGE:b,PATH_TO_USER_PROFILE:BXRL[a].pathToUserProfile,sessid:BX.bitrix_sessid()},onsuccess:function(c){BXRL[a].countText.innerHTML=c.items_all;if(parseInt(c.items_page)==0){return false}if(b==1){BXRL[a].popupContent.innerHTML="";spanTag0=document.createElement("span");spanTag0.className="bx-ilike-bottom_scroll";BXRL[a].popupContent.appendChild(spanTag0)}BXRL[a].popupContentPage+=1;for(var d=0;d<c.items.length;d++){BXRL[a].popupContent.appendChild(BX.create("a",{attrs:{href:c.items[d]["URL"],target:"_blank"},props:{className:"bx-ilike-popup-img"},children:[BX.create("span",{props:{className:"bx-ilike-popup-avatar"},html:c.items[d]["PHOTO"]}),BX.create("span",{props:{className:"bx-ilike-popup-name"},html:c.items[d]["FULL_NAME"]})]}))}RatingLike.AdjustWindow(a);RatingLike.PopupScroll(a);BXRL[a].popupListProcess=false},onfailure:function(c){}});return false};RatingLike.AdjustWindow=function(a){if(BXRL[a].popup!=null){BXRL[a].popup.bindOptions.forceBindPosition=true;BXRL[a].popup.adjustPosition();BXRL[a].popup.bindOptions.forceBindPosition=false}};RatingLike.PopupScroll=function(a){BX.bind(BXRL[a].popupContent,"scroll",function(){if(this.scrollTop>(this.scrollHeight-this.offsetHeight)/1.5){RatingLike.List(a,null);BX.unbindAll(this)}})};var phpVars;if(!phpVars){phpVars={ADMIN_THEME_ID:".default",LANGUAGE_ID:"en",FORMAT_DATE:"DD.MM.YYYY",FORMAT_DATETIME:"DD.MM.YYYY HH:MI:SS",opt_context_ctrl:false,cookiePrefix:"BITRIX_SM",titlePrefix:"",bitrix_sessid:"",messHideMenu:"",messShowMenu:"",messHideButtons:"",messShowButtons:"",messFilterInactive:"",messFilterActive:"",messFilterLess:"",messLoading:"Loading...",messMenuLoading:"",messMenuLoadingTitle:"",messNoData:"",messExpandTabs:"",messCollapseTabs:"",messPanelFixOn:"",messPanelFixOff:"",messPanelCollapse:"",messPanelExpand:""}}var jsUtils={arEvents:Array(),addEvent:function(c,b,d,a){if(c.attachEvent){c.attachEvent("on"+b,d)}else{if(c.addEventListener){c.addEventListener(b,d,false)}else{c["on"+b]=d}}this.arEvents[this.arEvents.length]={element:c,event:b,fn:d}},removeEvent:function(b,a,c){if(b.detachEvent){b.detachEvent("on"+a,c)}else{if(b.removeEventListener){b.removeEventListener(a,c,false)}else{b["on"+a]=null}}},removeAllEvents:function(b){var a;for(a=0;a<this.arEvents.length;a++){if(this.arEvents[a]&&(b==false||b==this.arEvents[a].element)){jsUtils.removeEvent(this.arEvents[a].element,this.arEvents[a].event,this.arEvents[a].fn);this.arEvents[a]=null}}if(b==false){this.arEvents.length=0}},IsDoctype:function(){if(document.compatMode){return document.compatMode=="CSS1Compat"}if(document.documentElement&&document.documentElement.clientHeight){return true}return false},GetRealPos:function(b){if(window.BX){return BX.pos(b)}if(!b||!b.offsetParent){return false}var a=Array();a.left=b.offsetLeft;a.top=b.offsetTop;var c=b.offsetParent;while(c&&c.tagName!="BODY"){a.left+=c.offsetLeft;a.top+=c.offsetTop;c=c.offsetParent}a.right=a.left+b.offsetWidth;a.bottom=a.top+b.offsetHeight;return a},FindChildObject:function(j,p,f,h){if(!j){return null}var c=p.toUpperCase();var q=f?f.toLowerCase():null;var b=j.childNodes.length;for(var g=0;g<b;g++){var m=j.childNodes[g];if(m.tagName&&m.tagName.toUpperCase()==c){if(!f||m.className.toLowerCase()==q){return m}}if(h==true){var k;if(k=jsUtils.FindChildObject(m,p,f,true)){return k}}}return null},FindParentObject:function(f,b,h){if(!f){return null}var a=f;var g=b.toUpperCase();var c=h?h.toLowerCase():null;while(a.parentNode){var d=a.parentNode;if(d.tagName&&d.tagName.toUpperCase()==g){if(!h||d.className.toLowerCase()==c){return d}}a=d}return null},FindNextSibling:function(c,b){if(!c){return null}var f=c;var a=b.toUpperCase();while(f.nextSibling){var d=f.nextSibling;if(d.tagName&&d.tagName.toUpperCase()==a){return d}f=d}return null},FindPreviousSibling:function(c,b){if(!c){return null}var f=c;var a=b.toUpperCase();while(f.previousSibling){var d=f.previousSibling;if(d.tagName&&d.tagName.toUpperCase()==a){return d}f=d}return null},bOpera:navigator.userAgent.toLowerCase().indexOf("opera")!=-1,bIsIE:document.attachEvent&&navigator.userAgent.toLowerCase().indexOf("opera")==-1,IsIE:function(){return this.bIsIE},IsOpera:function(){return this.bOpera},IsSafari:function(){var a=navigator.userAgent.toLowerCase();return/webkit/.test(a)},IsEditor:function(){var b=navigator.userAgent.toLowerCase();var a=(b.match(/.+(msie)[\/: ]([\d.]+)/)||[])[2];var c=/webkit/.test(b);if(this.IsOpera()||document.all&&!document.compatMode&&a<6||c){return false}return true},ToggleDiv:function(b){var a=document.getElementById(b).style;if(a.display!="none"){a.display="none"}else{a.display="block"}return a.display!="none"},urlencode:function(a){return escape(a).replace(new RegExp("\\+","g"),"%2B")},OpenWindow:function(c,b,f){var a=screen.width,d=screen.height;if(this.IsOpera()){a=document.body.offsetWidth;d=document.body.offsetHeight}window.open(c,"","status=no,scrollbars=yes,resizable=yes,width="+b+",height="+f+",top="+Math.floor((d-f)/2-14)+",left="+Math.floor((a-b)/2-5))},SetPageTitle:function(b){document.title=phpVars.titlePrefix+b;var a=document.getElementsByTagName("H1");if(a){a[0].innerHTML=b}},LoadPageToDiv:function(b,a){var c=document.getElementById(a);if(!c){return}CHttpRequest.Action=function(d){CloseWaitWindow();document.getElementById(a).innerHTML=d};ShowWaitWindow();CHttpRequest.Send(b)},trim:function(b){if(typeof b=="string"||typeof b=="object"&&b.constructor==String){var a,c;c=/^[\s\r\n]+/g;a=b.replace(c,"");c=/[\s\r\n]+$/g;a=a.replace(c,"");return a}else{return b}},Redirect:function(c,b){var d=null,a=false;if(c&&c.length>0){d=c[0]}if(!d){d=window.event}if(d){a=d.shiftKey}if(a){window.open(b)}else{window.location.href=b}},False:function(){return false},AlignToPos:function(f,b,h){var a=f.left,g=f.bottom;var c=jsUtils.GetWindowScrollPos();var d=jsUtils.GetWindowInnerSize();if(d.innerWidth+c.scrollLeft-(f.left+b)<0){if(f.right-b>=0){a=f.right-b}else{a=c.scrollLeft}}if(d.innerHeight+c.scrollTop-(f.bottom+h)<0){if(f.top-h>=0){g=f.top-h}else{g=c.scrollTop}}return{left:a,top:g}},EvalGlobal:function(e){try{if(window.execScript){window.execScript(e,"javascript")}else{if(jsUtils.IsSafari()){window.setTimeout(e,0)}else{window.eval(e)}}}catch(t){}},GetStyleValue:function(b,a){var c;if(b.currentStyle){c=b.currentStyle[a]}else{if(window.getComputedStyle){c=document.defaultView.getComputedStyle(b,null).getPropertyValue(a)}}if(!c){c=""}return c},GetWindowInnerSize:function(b){var a,c;if(!b){b=document}if(self.innerHeight){a=self.innerWidth;c=self.innerHeight}else{if(b.documentElement&&(b.documentElement.clientHeight||b.documentElement.clientWidth)){a=b.documentElement.clientWidth;c=b.documentElement.clientHeight}else{if(b.body){a=b.body.clientWidth;c=b.body.clientHeight}}}return{innerWidth:a,innerHeight:c}},GetWindowScrollPos:function(b){var a,c;if(!b){b=document}if(self.pageYOffset){a=self.pageXOffset;c=self.pageYOffset}else{if(b.documentElement&&(b.documentElement.scrollTop||b.documentElement.scrollLeft)){a=document.documentElement.scrollLeft;c=document.documentElement.scrollTop}else{if(b.body){a=b.body.scrollLeft;c=b.body.scrollTop}}}return{scrollLeft:a,scrollTop:c}},GetWindowScrollSize:function(b){var a,c;if(!b){b=document}if(b.compatMode&&b.compatMode=="CSS1Compat"){a=b.documentElement.scrollWidth;c=b.documentElement.scrollHeight}else{if(b.body.scrollHeight>b.body.offsetHeight){c=b.body.scrollHeight}else{c=b.body.offsetHeight}if(b.body.scrollWidth>b.body.offsetWidth||b.compatMode&&b.compatMode=="BackCompat"||b.documentElement&&!b.documentElement.clientWidth){a=b.body.scrollWidth}else{a=b.body.offsetWidth}}return{scrollWidth:a,scrollHeight:c}},GetWindowSize:function(){var b=jsUtils.GetWindowInnerSize();var a=jsUtils.GetWindowScrollPos();var c=jsUtils.GetWindowScrollSize();return{innerWidth:b.innerWidth,innerHeight:b.innerHeight,scrollLeft:a.scrollLeft,scrollTop:a.scrollTop,scrollWidth:c.scrollWidth,scrollHeight:c.scrollHeight}},arCustomEvents:{},addCustomEvent:function(c,b,d,a){if(!this.arCustomEvents[c]){this.arCustomEvents[c]=[]}if(!d){d=[]}if(!a){a=false}this.arCustomEvents[c].push({handler:b,arParams:d,obj:a})},removeCustomEvent:function(c,b){if(!this.arCustomEvents[c]){return}var d=this.arCustomEvents[c].length;if(d==1){delete this.arCustomEvents[c];return}for(var a=0;a<d;a++){if(!this.arCustomEvents[c][a]){continue}if(this.arCustomEvents[c][a].handler==b){delete this.arCustomEvents[c][a];return}}},onCustomEvent:function(c,b){if(!this.arCustomEvents[c]){return}if(!b){b=[]}var f;for(var a=0,d=this.arCustomEvents[c].length;a<d;a++){f=this.arCustomEvents[c][a];if(!f||!f.handler){continue}if(f.obj){f.handler.call(f.obj,f.arParams,b)}else{f.handler(f.arParams,b)}}},loadJSFile:function(c,b,f){if(!f){f=document}if(typeof c=="string"){c=[c]}var a=function(){if(!b){return}if(typeof b=="function"){return b()}if(typeof b!="object"||!b.func){return}var g=b.params||{};if(b.obj){b.func.apply(b.obj,g)}else{b.func(g)}};var d=function(e){if(e>=c.length){return a()}var g=f.body.appendChild(f.createElement("script"));g.src=c[e];var h=false;g.onload=g.onreadystatechange=function(){if(!h&&(!g.readyState||g.readyState=="loaded"||g.readyState=="complete")){h=true;setTimeout(function(){d(++e)},50)}}};d(0)},loadCSSFile:function(h,k,d){if(typeof h=="string"){var g=true;h=[h]}var c,m=h.length,b=[];if(m==0){return}if(!k){k=document}if(!d){d=window}if(!d.bxhead){var f=k.getElementsByTagName("HEAD");d.bxhead=f[0]}if(!d.bxhead){return}for(c=0;c<m;c++){var j=document.createElement("LINK");j.href=h[c];j.rel="stylesheet";j.type="text/css";d.bxhead.appendChild(j);b.push(j)}if(g){return j}return b},appendBXHint:function(b,a){if(!b||!b.parentNode||!a){return}var c=new BXHint(a);b.parentNode.insertBefore(c.oIcon,b);b.parentNode.removeChild(b);c.oIcon.style.marginLeft="5px"},PreventDefault:function(a){if(!a){a=window.event}if(a.stopPropagation){a.preventDefault();a.stopPropagation()}else{a.cancelBubble=true;a.returnValue=false}return false},CreateElement:function(d,b,g,a){if(!a){a=document}var f=a.createElement(d),c;if(b){for(c in b){if(c=="className"||c=="class"){f.setAttribute("class",b[c]);if(jsUtils.IsIE()){f.setAttribute("className",b[c])}continue}if(b[c]!=undefined&&b[c]!=null){f.setAttribute(c,b[c])}}}if(g){for(c in g){f.style[c]=g[c]}}return f},in_array:function(b,a){for(var c=0;c<a.length;c++){if(a[c]==b){return true}}return false},htmlspecialchars:function(a){if(!a.replace){return a}return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}};function JCFloatDiv(){var a=this;this.floatDiv=null;this.x=this.y=0;this.Create=function(c){var b=document.body.appendChild(document.createElement("DIV"));b.id=c.id;b.style.position="absolute";b.style.left="-10000px";b.style.top="-10000px";if(c.className){b.className=c.className}if(c.zIndex){b.style.zIndex=c.zIndex}if(c.width){b.style.width=c.width+"px"}if(c.height){b.style.height=c.height+"px"}return b};this.Show=function(h,k,d,g,c,m){if(m!==false){m=true}var b=parseInt(h.style.zIndex);if(b<=0||isNaN(b)){b=100}h.style.zIndex=b;if(k<0){k=0}if(d<0){d=0}h.style.left=parseInt(k)+"px";h.style.top=parseInt(d)+"px";if(jsUtils.IsIE()&&m===true){var f=document.getElementById(h.id+"_frame");if(!f){f=document.createElement("IFRAME");f.src="javascript:''";f.id=h.id+"_frame";f.style.position="absolute";f.style.borderWidth="0px";f.style.zIndex=b-1;document.body.appendChild(f)}f.style.width=h.offsetWidth+"px";f.style.height=h.offsetHeight+"px";f.style.left=h.style.left;f.style.top=h.style.top;f.style.visibility="visible"}h.restrictDrag=c||false;if(isNaN(g)){g=5}if(g>0){var j=document.getElementById(h.id+"_shadow");if(!j){if(jsUtils.IsIE()){j=document.createElement("DIV");j.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/images/shadow.png',sizingMethod='scale')"}else{j=document.createElement("IMG");j.src="/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/images/shadow.png"}j.id=h.id+"_shadow";j.style.position="absolute";j.style.zIndex=b-2;j.style.left="-1000px";j.style.top="-1000px";j.style.lineHeight="normal";j.className="bx-js-float-shadow";document.body.appendChild(j)}j.style.width=h.offsetWidth+"px";j.style.height=h.offsetHeight+"px";j.style.left=parseInt(h.style.left)+g+"px";j.style.top=parseInt(h.style.top)+g+"px";j.style.visibility="visible"}h.dxShadow=g};this.Close=function(c){if(!c){return}var b=document.getElementById(c.id+"_shadow");if(b){b.style.visibility="hidden"}var d=document.getElementById(c.id+"_frame");if(d){d.style.visibility="hidden"}};this.Move=function(g,c,j){if(!g){return}var b=g.dxShadow;var h=parseInt(g.style.left)+c;var d=parseInt(g.style.top)+j;if(g.restrictDrag){if(h<0){h=0}if(document.compatMode&&document.compatMode=="CSS1Compat"){windowWidth=document.documentElement.scrollWidth}else{if(document.body.scrollWidth>document.body.offsetWidth||document.compatMode&&document.compatMode=="BackCompat"||document.documentElement&&!document.documentElement.clientWidth){windowWidth=document.body.scrollWidth}else{windowWidth=document.body.offsetWidth}}var f=g.offsetWidth;if(h>windowWidth-f-b){h=windowWidth-f-b}if(d<0){d=0}}g.style.left=h+"px";g.style.top=d+"px";this.AdjustShadow(g)};this.HideShadow=function(c){var b=document.getElementById(c.id+"_shadow");b.style.visibility="hidden"};this.UnhideShadow=function(c){var b=document.getElementById(c.id+"_shadow");b.style.visibility="visible"};this.AdjustShadow=function(d){var c=document.getElementById(d.id+"_shadow");if(c&&c.style.visibility!="hidden"){var f=d.dxShadow;c.style.width=d.offsetWidth+"px";c.style.height=d.offsetHeight+"px";c.style.left=parseInt(d.style.left)+f+"px";c.style.top=parseInt(d.style.top)+f+"px"}var b=document.getElementById(d.id+"_frame");if(b){b.style.width=d.offsetWidth+"px";b.style.height=d.offsetHeight+"px";b.style.left=d.style.left;b.style.top=d.style.top}};this.StartDrag=function(c,d){if(!c){c=window.event}this.x=c.clientX+document.body.scrollLeft;this.y=c.clientY+document.body.scrollTop;this.floatDiv=d;jsUtils.addEvent(document,"mousemove",this.MoveDrag);document.onmouseup=this.StopDrag;if(document.body.setCapture){document.body.setCapture()}document.onmousedown=jsUtils.False;var b=document.body;b.ondrag=jsUtils.False;b.onselectstart=jsUtils.False;b.style.MozUserSelect=a.floatDiv.style.MozUserSelect="none";b.style.cursor="move"};this.StopDrag=function(b){if(document.body.releaseCapture){document.body.releaseCapture()}jsUtils.removeEvent(document,"mousemove",a.MoveDrag);document.onmouseup=null;this.floatDiv=null;document.onmousedown=null;var c=document.body;c.ondrag=null;c.onselectstart=null;c.style.MozUserSelect=a.floatDiv.style.MozUserSelect="";c.style.cursor=""};this.MoveDrag=function(c){var d=c.clientX+document.body.scrollLeft;var b=c.clientY+document.body.scrollTop;if(a.x==d&&a.y==b){return}a.Move(a.floatDiv,d-a.x,b-a.y);a.x=d;a.y=b}}var jsFloatDiv=new JCFloatDiv;var BXHint=function(b,a,c){this.oDivOver=false;this.timeOutID=null;this.oIcon=null;this.freeze=false;this.x=0;this.y=0;this.time=700;if(!b){b=""}this.Create(b,a,c)};BXHint.prototype.Create=function(g,c,j){var b=this,h=0,d=0,f=null,a="icon";this.bWidth=true;if(j){if(j.width===false){this.bWidth=false}else{if(j.width){h=j.width}}if(j.height){d=j.height}if(j.className){f=j.className}if(j.type&&(j.type=="link"||j.type=="icon")){a=j.type}if(j.time>0){this.time=j.time}}if(c){a="element"}if(a=="icon"){var c=document.createElement("IMG");c.src=j&&j.iconSrc?j.iconSrc:"/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/public/popup/hint.gif";c.ondrag=jsUtils.False}else{if(a=="link"){var c=document.createElement("A");c.href="";c.onclick=function(i){return false};c.innerHTML="[?]"}}this.element=c;if(a=="element"){if(j&&j.show_on_click){jsUtils.addEvent(c,"click",function(e){if(!e){e=window.event}b.GetMouseXY(e);b.timeOutID=setTimeout(function(){b.Show(g,h,d,f)},10)})}else{jsUtils.addEvent(c,"mouseover",function(e){if(!e){e=window.event}b.GetMouseXY(e);b.timeOutID=setTimeout(function(){b.Show(g,h,d,f)},750)})}jsUtils.addEvent(c,"mouseout",function(i){if(b.timeOutID){clearTimeout(b.timeOutID)}b.SmartHide(b)})}else{this.oIcon=c;c.onmouseover=function(e){if(!e){e=window.event}b.GetMouseXY(e);b.Show(g,h,d,f)};c.onmouseout=function(){b.SmartHide(b)}}};BXHint.prototype.IsFrozen=function(){return this.freeze};BXHint.prototype.Freeze=function(){this.freeze=true;this.Hide()};BXHint.prototype.UnFreeze=function(){this.freeze=false};BXHint.prototype.GetMouseXY=function(a){if(a.pageX||a.pageY){this.x=a.pageX;this.y=a.pageY}else{if(a.clientX||a.clientY){this.x=a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft;this.y=a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop}}};BXHint.prototype.Show=function(j,p,f,h){var c=document.getElementById("__BXHint_div");if(c){this.Hide()}if(this.freeze){return}var q=this;var b=document.body.appendChild(document.createElement("DIV"));b.onmouseover=function(){q.oDivOver=true};b.onmouseout=function(){q.oDivOver=false;q.SmartHide(q)};b.id="__BXHint_div";b.className=h?h:"bxhint";b.style.position="absolute";if(p&&this.bWidth){b.style.width=p+"px"}if(f){b.style.height=f+"px"}b.innerHTML=j;var g=b.offsetWidth;var m=b.offsetHeight;if(this.bWidth){if(!p&&g>200){g=Math.round(Math.sqrt(1.618*g*m))}b.style.width=g+"px";m=b.offsetHeight}var k={left:this.x+10,right:this.x+g,top:this.y,bottom:this.y+m};k=this.AlignToPos(k,g,m);b.style.zIndex=2100;jsFloatDiv.Show(b,k.left,k.top,3);b=null};BXHint.prototype.AlignToPos=function(c,b,d){var a=document.body;if(a.clientWidth+a.scrollLeft<c.left+b){c.left=c.left-b>=0?c.left-b:a.scrollLeft}if(a.clientHeight+a.scrollTop-c.bottom<0){c.top=c.top-d>=0?c.top-d:a.scrollTop}return c};BXHint.prototype.Hide=function(){var a=document.getElementById("__BXHint_div");if(!a){return}jsFloatDiv.Close(a);a.parentNode.removeChild(a);a=null};BXHint.prototype.SmartHide=function(a){setTimeout(function(){if(!a.oDivOver){a.Hide()}},100)};function WaitOnKeyPress(a){if(!a){a=window.event}if(!a){return}if(a.keyCode==27){CloseWaitWindow()}}function ShowWaitWindow(){CloseWaitWindow();var b=jsUtils.GetWindowSize();var a=document.body.appendChild(document.createElement("DIV"));a.id="wait_window_div";a.innerHTML=phpVars.messLoading;a.className="waitwindow";a.style.right=5-b.scrollLeft+"px";a.style.top=b.scrollTop+5+"px";if(jsUtils.IsIE()){var c=document.createElement("IFRAME");c.src="javascript:''";c.id="wait_window_frame";c.className="waitwindow";c.style.width=a.offsetWidth+"px";c.style.height=a.offsetHeight+"px";c.style.right=a.style.right;c.style.top=a.style.top;document.body.appendChild(c)}jsUtils.addEvent(document,"keypress",WaitOnKeyPress)}function CloseWaitWindow(){jsUtils.removeEvent(document,"keypress",WaitOnKeyPress);var b=document.getElementById("wait_window_frame");if(b){b.parentNode.removeChild(b)}var a=document.getElementById("wait_window_div");if(a){a.parentNode.removeChild(a)}}var jsSelectUtils={addNewOption:function(h,k,d,g,c){var m=typeof h=="string"||h instanceof String?document.getElementById(h):h;if(m){var b=m.length;if(c!==false){for(var f=0;f<b;f++){if(m[f].value==k){return}}}var j=new Option(d,k,false,false);m.options[b]=j}if(g===true){this.sortSelect(h)}},deleteOption:function(c,b){var d=typeof c=="string"||c instanceof String?document.getElementById(c):c;if(d){for(var a=0;a<d.length;a++){if(d[a].value==b){d.remove(a);break}}}},deleteSelectedOptions:function(b){var a=typeof b=="string"||b instanceof String?document.getElementById(b):b;if(a){var c=0;while(c<a.length){if(a[c].selected){a[c].selected=false;a.remove(c)}else{c++}}}},deleteAllOptions:function(b){if(b){for(var a=b.length-1;a>=0;a--){b.remove(a)}}},optionCompare:function(c,b){var d=c.optText.toLowerCase();var a=b.optText.toLowerCase();if(d>a){return 1}if(d<a){return -1}return 0},sortSelect:function(d){var b=typeof d=="string"||d instanceof String?document.getElementById(d):d;if(b){var g=[];var a=b.options.length;for(var f=0;f<a;f++){g[f]={optText:b[f].text,optValue:b[f].value}}g.sort(this.optionCompare);b.length=0;a=g.length;for(var f=0;f<a;f++){var c=new Option(g[f].optText,g[f].optValue,false,false);b[f]=c}}},selectAllOptions:function(c){var b=typeof c=="string"||c instanceof String?document.getElementById(c):c;if(b){var d=b.length;for(var a=0;a<d;a++){b[a].selected=true}}},selectOption:function(c,b){var f=typeof c=="string"||c instanceof String?document.getElementById(c):c;if(f){var a=f.length;for(var d=0;d<a;d++){f[d].selected=f[d].value==b}}},addSelectedOptions:function(d,b,g,a){if(!d){return}var f=d.length;for(var c=0;c<f;c++){if(d[c].selected){this.addNewOption(b,d[c].value,d[c].text,a,g)}}},moveOptionsUp:function(c){if(!c){return}var b=c.length;for(var f=0;f<b;f++){if(c[f].selected&&f>0&&c[f-1].selected==false){var a=new Option(c[f].text,c[f].value);var d=new Option(c[f-1].text,c[f-1].value);c[f]=d;c[f].selected=false;c[f-1]=a;c[f-1].selected=true}}},moveOptionsDown:function(c){if(!c){return}var b=c.length;for(var f=b-1;f>=0;f--){if(c[f].selected&&f<b-1&&c[f+1].selected==false){var a=new Option(c[f].text,c[f].value);var d=new Option(c[f+1].text,c[f+1].value);c[f]=d;c[f].selected=false;c[f+1]=a;c[f+1].selected=true}}}};(function(window){if(BX.tooltip){return}var arTooltipIndex={},bDisable=false;BX.tooltip=function(i,s,t,e,o){if(BX.message("TOOLTIP_ENABLED")!="Y"){return}if(BX.browser.IsAndroid()||BX.browser.IsIOS()){return}BX.ready(function(){var a=BX(s);if(null==a){return}var r=i;if(o&&BX.type.isNotEmptyString(t)){var l=0;for(var n=0,h=t.length;n<h;n++){l=31*l+t.charCodeAt(n)<<0}r=l+i}if(null==arTooltipIndex[r]){arTooltipIndex[r]=new BX.CTooltip(i,a,t,e,o)}else{arTooltipIndex[r].ANCHOR=a;arTooltipIndex[r].rootClassName=e;arTooltipIndex[r].LOADER=o&&BX.type.isNotEmptyString(t)?t:"/bitrix/tools/tooltip.php";arTooltipIndex[r].Create()}})};BX.tooltip.disable=function(){bDisable=true};BX.tooltip.enable=function(){bDisable=false};BX.CTooltip=function(user_id,anchor,loader,rootClassName,bForceUseLoader){this.LOADER=bForceUseLoader&&BX.type.isNotEmptyString(loader)?loader:"/bitrix/tools/tooltip.php";this.USER_ID=user_id;this.ANCHOR=anchor;this.rootClassName="";if(rootClassName!="undefined"&&rootClassName!=null&&rootClassName.length>0){this.rootClassName=rootClassName}var old=document.getElementById("user_info_"+this.USER_ID);if(null!=old){if(null!=old.parentNode){old.parentNode.removeChild(old)}old=null}var _this=this;this.INFO=null;this.width=393;this.height=302;this.CoordsLeft=0;this.CoordsTop=0;this.AnchorRight=0;this.AnchorBottom=0;this.DIV=null;this.ROOT_DIV=null;if(BX.browser.IsIE()){this.IFRAME=null}this.v_delta=0;this.classNameAnim=false;this.classNameFixed=false;this.left=0;this.top=0;this.tracking=false;this.active=false;this.showed=false;this.Create=function(){_this.ANCHOR.onmouseover=function(){if(!bDisable){_this.StartTrackMouse(this)}};_this.ANCHOR.onmouseout=function(){_this.StopTrackMouse(this)}};this.Create();this.TrackMouse=function(i){if(!_this.tracking){return}var s;if(i&&i.pageX){s={x:i.pageX,y:i.pageY}}else{s={x:i.clientX+document.body.scrollLeft,y:i.clientY+document.body.scrollTop}}if(s.x<0){s.x=0}if(s.y<0){s.y=0}s.time=_this.tracking;if(!_this.active){_this.active=s}else{if(_this.active.x>=s.x-1&&_this.active.x<=s.x+1&&_this.active.y>=s.y-1&&_this.active.y<=s.y+1){if(_this.active.time+20<=s.time){_this.ShowTooltip()}}else{_this.active=s}}};this.ShowTooltip=function(){var i=document.getElementById("user_info_"+_this.USER_ID);if(bDisable||i&&i.style.display=="block"){return}var s=BX.browser.IsIE()&&!BX.browser.IsIE10();if(null==_this.DIV&&null==_this.ROOT_DIV){_this.ROOT_DIV=document.body.appendChild(document.createElement("DIV"));_this.ROOT_DIV.style.position="absolute";_this.DIV=_this.ROOT_DIV.appendChild(document.createElement("DIV"));if(s){_this.DIV.className="bx-user-info-shadow-ie"}else{_this.DIV.className="bx-user-info-shadow"}_this.DIV.style.width=_this.width+"px";_this.DIV.style.height=_this.height+"px"}var t=_this.CoordsLeft;var e=_this.CoordsTop+30;var o=jsUtils.GetWindowScrollPos();var a=document.body;var r=false;var l=false;if(a.clientWidth+o.scrollLeft<t+_this.width){t=_this.AnchorRight-_this.width;r=true}if(e-o.scrollTop<0){e=_this.AnchorBottom-5;l=true;_this.v_delta=40}else{_this.v_delta=0}_this.ROOT_DIV.style.left=parseInt(t)+"px";_this.ROOT_DIV.style.top=parseInt(e)+"px";_this.ROOT_DIV.style.zIndex=1200;BX.bind(BX(_this.ROOT_DIV),"click",BX.eventCancelBubble);if(this.rootClassName!="undefined"&&this.rootClassName!=null&&this.rootClassName.length>0){_this.ROOT_DIV.className=this.rootClassName}if(""==_this.DIV.innerHTML){var n;if(_this.LOADER.indexOf("?")>=0){n=_this.LOADER+"&MUL_MODE=INFO&USER_ID="+_this.USER_ID+"&site="+(BX.message("SITE_ID")||"")}else{n=_this.LOADER+"?MUL_MODE=INFO&USER_ID="+_this.USER_ID+"&site="+(BX.message("SITE_ID")||"")}BX.ajax.get(n,_this.InsertData);_this.DIV.id="user_info_"+_this.USER_ID;_this.DIV.innerHTML='<div class="bx-user-info-wrap"><div class="bx-user-info-leftcolumn"><div class="bx-user-photo" id="user-info-photo-'+_this.USER_ID+'"><div class="bx-user-info-data-loading">'+BX.message("JS_CORE_LOADING")+'</div></div><div class="bx-user-tb-control bx-user-tb-control-left" id="user-info-toolbar-'+_this.USER_ID+'"></div></div><div class="bx-user-info-data"><div id="user-info-data-card-'+_this.USER_ID+'"></div><div class="bx-user-info-data-tools"><div class="bx-user-tb-control bx-user-tb-control-right" id="user-info-toolbar2-'+_this.USER_ID+'"></div><div class="bx-user-info-data-clear"></div></div></div></div><div class="bx-user-info-bottomarea"></div>'}if(s){_this.DIV.className="bx-user-info-shadow-ie";_this.classNameAnim="bx-user-info-shadow-anim-ie";_this.classNameFixed="bx-user-info-shadow-ie"}else{_this.DIV.className="bx-user-info-shadow";_this.classNameAnim="bx-user-info-shadow-anim";_this.classNameFixed="bx-user-info-shadow"}_this.filterFixed="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/components/bitrix/main.user.link/templates/.default/images/cloud-left-top.png', sizingMethod = 'crop' );";if(r&&l){if(BX.browser.IsIE6()){_this.DIV.className="bx-user-info-shadow-hv-ie6";_this.classNameAnim="bx-user-info-shadow-hv-anim-ie6";_this.classNameFixed="bx-user-info-shadow-hv-ie6"}else{if(s){_this.DIV.className="bx-user-info-shadow-hv-ie";_this.classNameAnim="bx-user-info-shadow-hv-anim-ie";_this.classNameFixed="bx-user-info-shadow-hv-ie"}else{_this.DIV.className="bx-user-info-shadow-hv";_this.classNameAnim="bx-user-info-shadow-hv-anim";_this.classNameFixed="bx-user-info-shadow-hv"}}_this.filterFixed="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/components/bitrix/main.user.link/templates/.default/images/cloud-right-bottom.png', sizingMethod = 'crop' );"}else{if(r){if(s){_this.DIV.className="bx-user-info-shadow-h-ie";_this.classNameAnim="bx-user-info-shadow-h-anim-ie";_this.classNameFixed="bx-user-info-shadow-h-ie"}else{_this.DIV.className="bx-user-info-shadow-h";_this.classNameAnim="bx-user-info-shadow-h-anim";_this.classNameFixed="bx-user-info-shadow-h"}_this.filterFixed="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/components/bitrix/main.user.link/templates/.default/images/cloud-right-top.png', sizingMethod = 'crop' );"}if(l){if(BX.browser.IsIE6()){_this.DIV.className="bx-user-info-shadow-v-ie6";_this.classNameAnim="bx-user-info-shadow-v-anim-ie6";_this.classNameFixed="bx-user-info-shadow-v-ie6"}else{if(s){_this.DIV.className="bx-user-info-shadow-v-ie";_this.classNameAnim="bx-user-info-shadow-v-anim-ie";_this.classNameFixed="bx-user-info-shadow-v-ie"}else{_this.DIV.className="bx-user-info-shadow-v";_this.classNameAnim="bx-user-info-shadow-v-anim";_this.classNameFixed="bx-user-info-shadow-v"}}_this.filterFixed="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/components/bitrix/main.user.link/templates/.default/images/cloud-left-bottom.png', sizingMethod = 'crop' );"}}if(BX.browser.IsIE()&&null==_this.IFRAME){_this.IFRAME=document.body.appendChild(document.createElement("IFRAME"));_this.IFRAME.id=_this.DIV.id+"_frame";_this.IFRAME.style.position="absolute";_this.IFRAME.style.width=_this.width-60+"px";_this.IFRAME.style.height=_this.height-100+"px";_this.IFRAME.style.borderStyle="solid";_this.IFRAME.style.borderWidth="0px";_this.IFRAME.style.zIndex=550;_this.IFRAME.style.display="none"}if(BX.browser.IsIE()){_this.IFRAME.style.left=parseInt(t)+25+"px";_this.IFRAME.style.top=parseInt(e)+30+_this.v_delta+"px"}_this.DIV.style.display="none";_this.ShowOpacityEffect({func:_this.SetVisible,obj:_this.DIV,arParams:[]},0);document.getElementById("user_info_"+_this.USER_ID).onmouseover=function(){_this.StartTrackMouse(this)};document.getElementById("user_info_"+_this.USER_ID).onmouseout=function(){_this.StopTrackMouse(this)}};this.InsertData=function(data){if(null!=data&&data.length>0){eval("_this.INFO = "+data);var cardEl=document.getElementById("user-info-data-card-"+_this.USER_ID);cardEl.innerHTML=_this.INFO.RESULT.Card;var photoEl=document.getElementById("user-info-photo-"+_this.USER_ID);photoEl.innerHTML=_this.INFO.RESULT.Photo;var toolbarEl=document.getElementById("user-info-toolbar-"+_this.USER_ID);toolbarEl.innerHTML=_this.INFO.RESULT.Toolbar;var toolbar2El=document.getElementById("user-info-toolbar2-"+_this.USER_ID);toolbar2El.innerHTML=_this.INFO.RESULT.Toolbar2}}};BX.CTooltip.prototype.StartTrackMouse=function(i){var s=this;if(!this.tracking){var t=jsUtils.GetRealPos(i);this.CoordsLeft=t.left+0;this.CoordsTop=t.top-325;this.AnchorRight=t.right;this.AnchorBottom=t.bottom;this.tracking=1;jsUtils.addEvent(document,"mousemove",s.TrackMouse);setTimeout(function(){s.tickTimer()},500)}};BX.CTooltip.prototype.StopTrackMouse=function(){var i=this;if(this.tracking){jsUtils.removeEvent(document,"mousemove",i.TrackMouse);this.active=false;setTimeout(function(){i.HideTooltip()},500);this.tracking=false}};BX.CTooltip.prototype.tickTimer=function(){var i=this;if(this.tracking){this.tracking++;if(this.active){if(this.active.time+5<=this.tracking){this.ShowTooltip()}}setTimeout(function(){i.tickTimer()},100)}};BX.CTooltip.prototype.HideTooltip=function(){if(!this.tracking){this.ShowOpacityEffect({func:this.SetInVisible,obj:this.DIV,arParams:[]},1)}};BX.CTooltip.prototype.ShowOpacityEffect=function(i,s){var t=3;var e=1;var o=1/t;var a=0,r,l=this;if(BX.browser.IsIE()&&l.DIV){l.DIV.className=l.classNameAnim}var n=function(){a++;if(a>t){clearInterval(h);if(!i.arParams){i.arParams=[]}if(i.func&&i.obj){i.func.apply(i.obj,i.arParams)}return}r=s?1-a*o:a*o;if(l.DIV!=null){try{l.DIV.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+r*100+")";l.DIV.style.opacity=r;l.DIV.style.MozOpacity=r;l.DIV.style.KhtmlOpacity=r}catch(e){}finally{if(!s&&a==1){l.DIV.style.display="block"}if(s&&a==t&&l.DIV){l.DIV.style.display="none"}if(jsUtils.IsIE()&&a==1&&s&&l.IFRAME){l.IFRAME.style.display="none"}if(jsUtils.IsIE()&&a==t&&l.DIV){if(!s){l.IFRAME.style.display="block"}l.DIV.style.filter=l.filterFixed;l.DIV.className=l.classNameFixed;l.DIV.innerHTML=""+l.DIV.innerHTML}}}};var h=setInterval(n,e)}})(window);(function(a){BX.DD=function(b){return new BX.DD.dragdrop(b)};BX.DD.allowSelection=function(){document.onmousedown=null;var b=document.body;b.ondrag=null;b.onselectstart=null;b.style.MozUserSelect=""};BX.DD.denySelection=function(){document.onmousedown=BX.False;var b=document.body;b.ondrag=BX.False;b.onselectstart=BX.False;b.style.MozUserSelect="none"};BX.DD.dragdrop=function(b){};BX.DD.dropFiles=function(b){if(BX.type.isElementNode(b)&&this.supported()){b.setAttribute("dropzone","copy f:*/*");this.DIV=b;this._timer=null;this._initEvents();this._cancelLeave=function(){if(this._timer!=null){clearTimeout(this._timer);this._timer=null}};this._prepareLeave=function(){this._cancelLeave();this._timer=setTimeout(BX.delegate(function(){BX.onCustomEvent(this,"dragLeave")},this),100)};return this}return false};BX.DD.dropFiles.prototype._initEvents=function(){BX.bind(this.DIV,"dragover",BX.proxy(this._dragOver,this));BX.bind(this.DIV,"dragenter",BX.proxy(this._dragEnter,this));BX.bind(this.DIV,"dragleave",BX.proxy(this._dragLeave,this));BX.bind(this.DIV,"dragexit",BX.proxy(this._dragExit,this));BX.bind(this.DIV,"drop",BX.proxy(this._drop,this))};BX.DD.dropFiles.prototype._dragEnter=function(b){BX.PreventDefault(b);this._cancelLeave();BX.onCustomEvent(this,"dragEnter");return true};BX.DD.dropFiles.prototype._dragExit=function(b){BX.PreventDefault(b);this._prepareLeave();return false};BX.DD.dropFiles.prototype._dragLeave=function(b){BX.PreventDefault(b);this._prepareLeave();return false};BX.DD.dropFiles.prototype._dragOver=function(b){BX.PreventDefault(b);this._cancelLeave();return true};BX.DD.dropFiles.prototype._drop=function(d){BX.PreventDefault(d);var b=d.dataTransfer;var c=b.files;BX.onCustomEvent(this,"dropFiles",[c]);BX.onCustomEvent(this,"dragLeave");return false};BX.DD.dropFiles.prototype.isEventSupported=function(d){var b=BX.create("DIV");var c="on"+d;var f=c in b;if(!f&&b.setAttribute&&b.removeAttribute){b.setAttribute(c,"");f=typeof b[c]==="function"}b=null;return f};BX.DD.dropFiles.prototype.supported=function(){return !!a.FileReader&&this.isEventSupported("dragstart")&&this.isEventSupported("drop")}})(window);(function(d){if(BX.CAutoSave&&top.BX.CAutoSave){return}BX.CAutoSave=function(f){this.FORM_NAME=f.form;this.FORM_MARKER=f.form_marker;this.FORM_ID=f.form_id;this.PERIOD=f.period||[4001,20990];this.RESTORE_DATA=null;this.TIMERS=[null,null];this.bInited=false;this.bRestoreInProgress=false;this.DISABLE_STANDARD_NOTIFY=f.DISABLE_STANDARD_NOTIFY;this.NOTIFY_CONTEXT=null;BX.ready(BX.defer(this.Prepare,this));BX.garbage(BX.delegate(this.Clear,this))};BX.CAutoSave.prototype.Prepare=function(){var f;if(this.FORM_NAME&&BX.type.isString(this.FORM_NAME)){this.FORM=document.forms[this.FORM_NAME]}else{if(this.FORM_MARKER&&BX.type.isString(this.FORM_MARKER)){this.FORM=(BX(this.FORM_MARKER)||{form:null}).form}}if(!BX.type.isDomNode(this.FORM)){return}this.FORM.BXAUTOSAVE=this;BX.bind(this.FORM,"submit",BX.proxy(this.ClearTimers,this));for(f=0;f<this.FORM.elements.length;f++){this.RegisterInput(this.FORM.elements[f])}setTimeout(BX.delegate(this._PrepareAfter,this),10)};BX.CAutoSave.prototype.RegisterInput=function(f){if(BX.type.isString(f)){setTimeout(BX.delegate(function(){this.RegisterInput(this.FORM[f]||BX(f))},this),10)}else{if(BX.type.isDomNode(f)){if(f.type!="button"&&f.type!="submit"&&f.type!="reset"&&f.type!="image"&&f.type!="hidden"){BX.bind(f,"change",BX.proxy(this.Init,this));if(f.type=="text"||f.type=="textarea"){BX.bind(f,"keyup",BX.proxy(this.Init,this))}if(f.type=="checkbox"||f.type=="radio"){BX.bind(f,"click",BX.proxy(this.Init,this))}}}}};BX.CAutoSave.prototype.UnRegisterInput=function(f){if(BX.type.isString(f)){f=this.FORM[f]||BX(f)}if(BX.type.isDomNode(f)){BX.unbind(f,"change",BX.proxy(this.Init,this));BX.unbind(f,"keyup",BX.proxy(this.Init,this));BX.unbind(f,"click",BX.proxy(this.Init,this))}};BX.CAutoSave.prototype._PrepareAfter=function(){BX.onCustomEvent(this.FORM,"onAutoSavePrepare",[this,BX.proxy(this.Init,this)]);if(this.RESTORE_DATA){var g=this.FORM.name||Math.random();BX.addCustomEvent("onExtAutoSaveRestoreClick_"+g,BX.proxy(this.Restore,this));var f=this._NotifyContext();if(f){f.Notify(BX.message("AUTOSAVE")+' <a href="javascript:void(0)" onclick="BX.CAutoSave.Restore(\''+BX.util.urlencode(g)+"', this); return false;\">"+BX.message("AUTOSAVE_R")+"</a>")}BX.onCustomEvent(this.FORM,"onAutoSaveRestoreFound",[this,this.RESTORE_DATA])}};BX.CAutoSave.prototype.Init=function(){if(this.TIMERS[0]){clearTimeout(this.TIMERS[0]);this.TIMERS[0]=null}this.TIMERS[0]=setTimeout(BX.proxy(this.TimerHandler,this),this.PERIOD[0]);if(!this.TIMERS[1]){this.TIMERS[1]=setInterval(BX.proxy(this.Save,this),this.PERIOD[1])}BX.onCustomEvent(this.FORM,"onAutoSaveInit",[this])};BX.CAutoSave.prototype.TimerHandler=function(){if(this.TIMERS[1]){clearInterval(this.TIMERS[1]);this.TIMERS[1]=null}this.Save()};BX.CAutoSave.prototype.Save=function(){if(this.FORM&&BX.isNodeInDom(this.FORM)){var k,g,h,m={autosave_id:this.FORM_ID,form_data:{}};for(k=0;k<this.FORM.elements.length;k++){h=this.FORM.elements[k];if(h.name&&h.name!="sessid"&&h.name!="lang"&&h.name!="autosave_id"){var p=h.name,f="",j=h.type.toLowerCase();switch(j){case"button":case"submit":case"reset":case"image":case"file":case"password":break;case"radio":case"checkbox":if(h.checked){f=h.value||"on"}break;case"select-multiple":p=p.substring(0,p.length-2);f=[];for(g=0;g<h.options.length;g++){if(h.options[g].selected){f.push(h.options[g].value)}}break;default:f=h.value}if(p.indexOf("[]")>0){p=b(p);if(typeof m.form_data[p]=="undefined"){m.form_data[p]=[f]}else{m.form_data[p].push(f)}}else{m.form_data[b(p)]=f}}}BX.onCustomEvent(this.FORM,"onAutoSave",[this,m.form_data]);BX.ajax.post("/bitrix/tools/autosave.php?bxsender=core_autosave&sessid="+BX.bitrix_sessid(),m,BX.proxy(this._Save,this))}else{this.Clear()}};BX.CAutoSave.prototype._Save=function(f){BX.onCustomEvent(this.FORM,"onAutoSaveFinished",[this,f])};BX.CAutoSave.prototype.Restore=function(q,w){if(q){this.RESTORE_DATA=c(q)}else{if(this.FORM&&this.RESTORE_DATA){BX.onCustomEvent(this.FORM,"onAutoSaveRestore",[this,this.RESTORE_DATA]);this.bRestoreInProgress=true;for(var m=0;m<this.FORM.elements.length;m++){var g=this.FORM.elements[m];if(g&&BX.type.isDomNode(g)&&g.name){var j=undefined,s=g.name;if(g.type=="select-multiple"){s=g.name.substring(0,g.name.length-2)}j=this.RESTORE_DATA[s];if(s.indexOf("[]")>0&&BX.type.isArray(j)){j=this.RESTORE_DATA[s].shift()}if(g.type!="checkbox"&&typeof j=="undefined"){continue}var f=false;switch(g.type){case"radio":if(!g.checked&&!!(j==g.value)){f=true;BX.fireEvent(g,"click")}break;case"checkbox":if(g.checked!=!!(j==g.value)){f=true;BX.fireEvent(g,"click")}break;case"select-one":for(var p=0;p<g.options.length;p++){var v=g.options[p].selected;g.options[p].selected=!!(j==g.options[p].value);f|=g.options[p].selected!=v}break;case"select-multiple":j=this.RESTORE_DATA[g.name.substring(0,g.name.length-2)];for(p=0;p<g.options.length;p++){v=g.options[p].selected;g.options[p].selected=!!(BX.type.isArray(j)&&BX.util.in_array(g.options[p].value,j));f|=g.options[p].selected!=v}break;case"file":case"button":case"image":case"submit":case"reset":case"password":break;default:f=j!=g.value;g.value=j}if(f){BX.fireEvent(g,"change")}}}var k=this._NotifyContext();if(k){k.hideNotify(w.parentNode.parentNode)}this.bRestoreInProgress=false;BX.onCustomEvent(this.FORM,"onAutoSaveRestoreFinished",[this,this.RESTORE_DATA])}}};BX.CAutoSave.prototype._NotifyContext=function(){var f=null;if(!this.DISABLE_STANDARD_NOTIFY){if(this.NOTIFY_CONTEXT){f=this.NOTIFY_CONTEXT}else{if(BX.WindowManager&&BX.WindowManager.Get()){f=BX.WindowManager.Get()}else{if(BX.adminPanel){f=BX.adminPanel}else{if(BX.admin&&BX.admin.panel){f=BX.admin.panel}}}}this.NOTIFY_CONTEXT=f}return f};BX.CAutoSave.prototype.ClearTimers=function(){if(this.TIMERS){clearTimeout(this.TIMERS[0]);clearInterval(this.TIMERS[1])}};BX.CAutoSave.prototype.Clear=function(){if(this.FORM){this.FORM.BXAUTOSAVE=null;for(var f=0;f<this.FORM.elements.length;f++){this.UnRegisterInput(this.FORM.elements[f])}}this.ClearTimers();BX.onCustomEvent(this.FORM,"onAutoSaveClear",[this]);this.FORM=null;this.TIMERS=null};BX.CAutoSave.Restore=function(g,f){BX.onCustomEvent("onExtAutoSaveRestoreClick_"+g,[null,f])};function b(g){var f;while(f=/[^a-zA-Z0-9_\-]/.exec(g)){g=g.replace(f[0],"X"+BX.util.str_pad_left(f[0].charCodeAt(0).toString(),6,"0")+"X")}return g}function a(g){var f;while(f=/X[\d]{6}X/.exec(g)){g=g.replace(f[0],String.fromCharCode(parseInt(f[0].replace(/(^X[0]*)|(X$)/g,""))))}return g}function c(h){var f={};for(var g in h){f[a(g)]=h[g]}return f}top.BX.CAutoSave=BX.CAutoSave})(window);(function(){if(BX.date){return}BX.date={};BX.date.format=function(Q,x,U,L){var z=BX.type.isDate(x)?new Date(x.getTime()):BX.type.isNumber(x)?new Date(x*1000):new Date;var E=BX.type.isDate(U)?new Date(U.getTime()):BX.type.isNumber(U)?new Date(U*1000):new Date;var I=!!L;if(BX.type.isArray(Q)){return S(Q,z,E,I)}else{if(!BX.type.isNotEmptyString(Q)){return""}}var H=/\\?(sago|iago|isago|Hago|dago|mago|Yago|sdiff|idiff|Hdiff|ddiff|mdiff|Ydiff|yesterday|today|tommorow|[a-z])/gi;var K={d:function(){return BX.util.str_pad_left(G(z).toString(),2,"0")},D:function(){return BX.message("DOW_"+q(z))},j:function(){return G(z)},l:function(){return BX.message("DAY_OF_WEEK_"+q(z))},N:function(){return q(z)||7},S:function(){if(G(z)%10==1&&G(z)!=11){return"st"}else{if(G(z)%10==2&&G(z)!=12){return"nd"}else{if(G(z)%10==3&&G(z)!=13){return"rd"}else{return"th"}}}},w:function(){return q(z)},z:function(){var d=new Date(R(z),0,1);var c=new Date(R(z),N(z),G(z));return Math.ceil((c-d)/(24*3600*1000))},W:function(){var h=new Date(z.getTime());var f=(q(z)+6)%7;F(h,G(h)-f+3);var c=h.getTime();k(h,0,1);if(q(h)!=4){k(h,0,1+(4-q(h)+7)%7)}var d=1+Math.ceil((c-h)/(7*24*3600*1000));return BX.util.str_pad_left(d.toString(),2,"0")},F:function(){return BX.message("MONTH_"+(N(z)+1)+"_S")},f:function(){return BX.message("MONTH_"+(N(z)+1))},m:function(){return BX.util.str_pad_left((N(z)+1).toString(),2,"0")},M:function(){return BX.message("MON_"+(N(z)+1))},n:function(){return N(z)+1},t:function(){var c=I?new Date(Date.UTC(R(z),N(z)+1,0)):new Date(R(z),N(z)+1,0);return G(c)},L:function(){var c=R(z);return c%4==0&&c%100!=0||c%400==0?1:0},o:function(){var c=new Date(z.getTime());F(c,G(c)-(q(z)+6)%7+3);return R(c)},Y:function(){return R(z)},y:function(){return R(z).toString().slice(2)},a:function(){return P(z)>11?"pm":"am"},A:function(){return P(z)>11?"PM":"AM"},B:function(){var c=(z.getUTCHours()+1)%24+z.getUTCMinutes()/60+z.getUTCSeconds()/3600;return BX.util.str_pad_left(Math.floor(c*1000/24).toString(),3,"0")},g:function(){return P(z)%12||12},G:function(){return P(z)},h:function(){return BX.util.str_pad_left((P(z)%12||12).toString(),2,"0")},H:function(){return BX.util.str_pad_left(P(z).toString(),2,"0")},i:function(){return BX.util.str_pad_left(J(z).toString(),2,"0")},s:function(){return BX.util.str_pad_left(y(z).toString(),2,"0")},u:function(){return BX.util.str_pad_left((g(z)*1000).toString(),6,"0")},e:function(){if(I){return"UTC"}return""},I:function(){if(I){return 0}var h=new Date(R(z),0,1);var f=Date.UTC(R(z),0,1);var c=new Date(R(z),6,0);var d=Date.UTC(R(z),6,0);return 0+(h-f!==c-d)},O:function(){if(I){return"+0000"}var d=z.getTimezoneOffset();var c=Math.abs(d);return(d>0?"-":"+")+BX.util.str_pad_left((Math.floor(c/60)*100+c%60).toString(),4,"0")},P:function(){if(I){return"+00:00"}var c=this.O();return c.substr(0,3)+":"+c.substr(3)},Z:function(){if(I){return 0}return -z.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(H,A)},r:function(){return"D, d M Y H:i:s O".replace(H,A)},U:function(){return Math.floor(z.getTime()/1000)},sago:function(){return b(j((E-z)/1000),{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},sdiff:function(){return b(j((E-z)/1000),{0:"FD_SECOND_DIFF_0",1:"FD_SECOND_DIFF_1","10_20":"FD_SECOND_DIFF_10_20",MOD_1:"FD_SECOND_DIFF_MOD_1",MOD_2_4:"FD_SECOND_DIFF_MOD_2_4",MOD_OTHER:"FD_SECOND_DIFF_MOD_OTHER"})},iago:function(){return b(j((E-z)/60/1000),{0:"FD_MINUTE_AGO_0",1:"FD_MINUTE_AGO_1","10_20":"FD_MINUTE_AGO_10_20",MOD_1:"FD_MINUTE_AGO_MOD_1",MOD_2_4:"FD_MINUTE_AGO_MOD_2_4",MOD_OTHER:"FD_MINUTE_AGO_MOD_OTHER"})},idiff:function(){return b(j((E-z)/60/1000),{0:"FD_MINUTE_DIFF_0",1:"FD_MINUTE_DIFF_1","10_20":"FD_MINUTE_DIFF_10_20",MOD_1:"FD_MINUTE_DIFF_MOD_1",MOD_2_4:"FD_MINUTE_DIFF_MOD_2_4",MOD_OTHER:"FD_MINUTE_DIFF_MOD_OTHER"})},isago:function(){var f=j((E-z)/60/1000);var d=b(f,{0:"FD_MINUTE_0",1:"FD_MINUTE_1","10_20":"FD_MINUTE_10_20",MOD_1:"FD_MINUTE_MOD_1",MOD_2_4:"FD_MINUTE_MOD_2_4",MOD_OTHER:"FD_MINUTE_MOD_OTHER"});d+=" ";var c=j((E-z)/1000)-f*60;d+=b(c,{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"});return d},Hago:function(){return b(j((E-z)/60/60/1000),{0:"FD_HOUR_AGO_0",1:"FD_HOUR_AGO_1","10_20":"FD_HOUR_AGO_10_20",MOD_1:"FD_HOUR_AGO_MOD_1",MOD_2_4:"FD_HOUR_AGO_MOD_2_4",MOD_OTHER:"FD_HOUR_AGO_MOD_OTHER"})},Hdiff:function(){return b(j((E-z)/60/60/1000),{0:"FD_HOUR_DIFF_0",1:"FD_HOUR_DIFF_1","10_20":"FD_HOUR_DIFF_10_20",MOD_1:"FD_HOUR_DIFF_MOD_1",MOD_2_4:"FD_HOUR_DIFF_MOD_2_4",MOD_OTHER:"FD_HOUR_DIFF_MOD_OTHER"})},yesterday:function(){return BX.message("FD_YESTERDAY")},today:function(){return BX.message("FD_TODAY")},tommorow:function(){return BX.message("FD_TOMORROW")},dago:function(){return b(j((E-z)/60/60/24/1000),{0:"FD_DAY_AGO_0",1:"FD_DAY_AGO_1","10_20":"FD_DAY_AGO_10_20",MOD_1:"FD_DAY_AGO_MOD_1",MOD_2_4:"FD_DAY_AGO_MOD_2_4",MOD_OTHER:"FD_DAY_AGO_MOD_OTHER"})},ddiff:function(){return b(j((E-z)/60/60/24/1000),{0:"FD_DAY_DIFF_0",1:"FD_DAY_DIFF_1","10_20":"FD_DAY_DIFF_10_20",MOD_1:"FD_DAY_DIFF_MOD_1",MOD_2_4:"FD_DAY_DIFF_MOD_2_4",MOD_OTHER:"FD_DAY_DIFF_MOD_OTHER"})},mago:function(){return b(j((E-z)/60/60/24/31/1000),{0:"FD_MONTH_AGO_0",1:"FD_MONTH_AGO_1","10_20":"FD_MONTH_AGO_10_20",MOD_1:"FD_MONTH_AGO_MOD_1",MOD_2_4:"FD_MONTH_AGO_MOD_2_4",MOD_OTHER:"FD_MONTH_AGO_MOD_OTHER"})},mdiff:function(){return b(j((E-z)/60/60/24/31/1000),{0:"FD_MONTH_DIFF_0",1:"FD_MONTH_DIFF_1","10_20":"FD_MONTH_DIFF_10_20",MOD_1:"FD_MONTH_DIFF_MOD_1",MOD_2_4:"FD_MONTH_DIFF_MOD_2_4",MOD_OTHER:"FD_MONTH_DIFF_MOD_OTHER"})},Yago:function(){return b(j((E-z)/60/60/24/365/1000),{0:"FD_YEARS_AGO_0",1:"FD_YEARS_AGO_1","10_20":"FD_YEARS_AGO_10_20",MOD_1:"FD_YEARS_AGO_MOD_1",MOD_2_4:"FD_YEARS_AGO_MOD_2_4",MOD_OTHER:"FD_YEARS_AGO_MOD_OTHER"})},Ydiff:function(){return b(j((E-z)/60/60/24/365/1000),{0:"FD_YEARS_DIFF_0",1:"FD_YEARS_DIFF_1","10_20":"FD_YEARS_DIFF_10_20",MOD_1:"FD_YEARS_DIFF_MOD_1",MOD_2_4:"FD_YEARS_DIFF_MOD_2_4",MOD_OTHER:"FD_YEARS_DIFF_MOD_OTHER"})},x:function(){return BX.date.format([["tommorow","tommorow, H:i"],["-",BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:s$/g,"")],["s","sago"],["i","iago"],["today","today, H:i"],["yesterday","yesterday, H:i"],["",BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:s$/g,"")]],z,E,I)},X:function(){var d=BX.date.format([["tommorow","tommorow"],["-",BX.date.convertBitrixFormat(BX.message("FORMAT_DATE"))],["today","today"],["yesterday","yesterday"],["",BX.date.convertBitrixFormat(BX.message("FORMAT_DATE"))]],z,E,I);var c=BX.date.format([["tommorow","H:i"],["today","H:i"],["yesterday","H:i"],["",""]],z,E,I);if(c.length>0){return BX.message("FD_DAY_AT_TIME").replace(/#DAY#/g,d).replace(/#TIME#/g,c)}else{return d}},Q:function(){var c=j((E-z)/60/60/24/1000);if(c==0){return BX.message("FD_DAY_DIFF_1").replace(/#VALUE#/g,1)}else{return BX.date.format([["d","ddiff"],["m","mdiff"],["","Ydiff"]],z,E)}}};var V=false;if(Q[0]&&Q[0]=="^"){V=true;Q=Q.substr(1)}var w=Q.replace(H,A);if(V){w=w.replace(/\s*00:00:00\s*/g,"").replace(/(\d\d:\d\d)(:00)/g,"$1").replace(/(\s*00:00\s*)(?!:)/g,"")}return w;function S(ae,C,ag,ac){var M=j((ag-C)/1000);for(var W=0;W<ae.length;W++){var Z=ae[W][0];var Y=ae[W][1];var ab=null;if(Z=="s"){if(M<60){return BX.date.format(Y,C,ag,ac)}}else{if((ab=/^s(\d+)/.exec(Z))!=null){if(M<ab[1]){return BX.date.format(Y,C,ag,ac)}}else{if(Z=="i"){if(M<60*60){return BX.date.format(Y,C,ag,ac)}}else{if((ab=/^i(\d+)/.exec(Z))!=null){if(M<ab[1]*60){return BX.date.format(Y,C,ag,ac)}}else{if(Z=="H"){if(M<24*60*60){return BX.date.format(Y,C,ag,ac)}}else{if((ab=/^H(\d+)/.exec(Z))!=null){if(M<ab[1]*60*60){return BX.date.format(Y,C,ag,ac)}}else{if(Z=="d"){if(M<31*24*60*60){return BX.date.format(Y,C,ag,ac)}}else{if((ab=/^d(\d+)/.exec(Z))!=null){if(M<ab[1]*60*60){return BX.date.format(Y,C,ag,ac)}}else{if(Z=="m"){if(M<365*24*60*60){return BX.date.format(Y,C,ag,ac)}}else{if((ab=/^m(\d+)/.exec(Z))!=null){if(M<ab[1]*31*24*60*60){return BX.date.format(Y,C,ag,ac)}}else{if(Z=="today"){var ah=R(ag),p=N(ag),af=G(ag);var ad=ac?new Date(Date.UTC(ah,p,af,0,0,0,0)):new Date(ah,p,af,0,0,0,0);var aa=ac?new Date(Date.UTC(ah,p,af+1,0,0,0,0)):new Date(ah,p,af+1,0,0,0,0);if(C>=ad&&C<aa){return BX.date.format(Y,C,ag,ac)}}else{if(Z=="yesterday"){ah=R(ag);p=N(ag);af=G(ag);var O=ac?new Date(Date.UTC(ah,p,af-1,0,0,0,0)):new Date(ah,p,af-1,0,0,0,0);var d=ac?new Date(Date.UTC(ah,p,af,0,0,0,0)):new Date(ah,p,af,0,0,0,0);if(C>=O&&C<d){return BX.date.format(Y,C,ag,ac)}}else{if(Z=="tommorow"){ah=R(ag);p=N(ag);af=G(ag);var h=ac?new Date(Date.UTC(ah,p,af+1,0,0,0,0)):new Date(ah,p,af+1,0,0,0,0);var X=ac?new Date(Date.UTC(ah,p,af+2,0,0,0,0)):new Date(ah,p,af+2,0,0,0,0);if(C>=h&&C<X){return BX.date.format(Y,C,ag,ac)}}else{if(Z=="-"){if(M<0){return BX.date.format(Y,C,ag,ac)}}}}}}}}}}}}}}}}return ae.length>0?BX.date.format(ae.pop()[1],C,ag,ac):""}function R(c){return I?c.getUTCFullYear():c.getFullYear()}function G(c){return I?c.getUTCDate():c.getDate()}function N(c){return I?c.getUTCMonth():c.getMonth()}function P(c){return I?c.getUTCHours():c.getHours()}function J(c){return I?c.getUTCMinutes():c.getMinutes()}function y(c){return I?c.getUTCSeconds():c.getSeconds()}function g(c){return I?c.getUTCMilliseconds():c.getMilliseconds()}function q(c){return I?c.getUTCDay():c.getDay()}function F(d,c){return I?d.setUTCDate(c):d.setDate(c)}function k(f,d,c){return I?f.setUTCMonth(d,c):f.setMonth(d,c)}function b(m,f){var c=m<100?Math.abs(m):Math.abs(m%100);var d=c%10;var h="";if(c==0){h=BX.message(f["0"])}else{if(c==1){h=BX.message(f["1"])}else{if(c>=10&&c<=20){h=BX.message(f["10_20"])}else{if(d==1){h=BX.message(f.MOD_1)}else{if(2<=d&&d<=4){h=BX.message(f.MOD_2_4)}else{h=BX.message(f.MOD_OTHER)}}}}}return h.replace(/#VALUE#/g,m)}function A(d,c){if(K[d]){return K[d]()}else{return c}}function j(c){return c>=0?Math.floor(c):Math.ceil(c)}};BX.date.convertBitrixFormat=function(b){if(!BX.type.isNotEmptyString(b)){return""}return b.replace("YYYY","Y").replace("MMMM","F").replace("MM","m").replace("M","M").replace("DD","d").replace("G","g").replace(/GG/i,"G").replace("H","h").replace(/HH/i,"H").replace("MI","i").replace("SS","s").replace("TT","A").replace("T","a")};BX.date.convertToUTC=function(b){if(!BX.type.isDate(b)){return null}return new Date(Date.UTC(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds()))};BX.date.getNewDate=function(b){return new Date(BX.date.getBrowserTimestamp(b))};BX.date.getBrowserTimestamp=function(c){c=parseInt(c,10);var b=new Date(c*1000).getTimezoneOffset()*60;return(parseInt(c,10)+parseInt(BX.message("SERVER_TZ_OFFSET"))+b)*1000};BX.date.getServerTimestamp=function(c){c=parseInt(c,10);var b=new Date(c).getTimezoneOffset()*60;return Math.round(c/1000-(parseInt(BX.message("SERVER_TZ_OFFSET"),10)+parseInt(b,10)))};var a=null;BX.calendar=function(b){return BX.calendar.get().Show(b)};BX.calendar.get=function(){if(!a){a=new BX.JCCalendar}return a};BX.calendar.InsertDaysBack=function(d,c){if(c!=""){var b=new Date;if(c>0){b.setTime(b.valueOf()-c*86400000)}d.value=BX.date.format(BX.date.convertBitrixFormat(BX.message("FORMAT_DATE")),b,null)}else{d.value=""}};BX.calendar.ValueToString=function(d,c,b){return BX.date.format(BX.date.convertBitrixFormat(BX.message(c?"FORMAT_DATETIME":"FORMAT_DATE")),d,null,!!b)};BX.CalendarPeriod={Init:function(d,c,b){if((d.value!=""||c.value!="")&&b.value==""){b.value="interval"}b.onchange()},ChangeDirectOpts:function(d,c){var b=BX.findChild(c,{className:"adm-select adm-calendar-direction"},true);if(d=="week"){b.options[0].text=BX.message("JSADM_CALEND_PREV_WEEK");b.options[1].text=BX.message("JSADM_CALEND_CURR_WEEK");b.options[2].text=BX.message("JSADM_CALEND_NEXT_WEEK")}else{b.options[0].text=BX.message("JSADM_CALEND_PREV");b.options[1].text=BX.message("JSADM_CALEND_CURR");b.options[2].text=BX.message("JSADM_CALEND_NEXT")}},SaveAndClearInput:function(b){if(!window.SavedPeriodValues){window.SavedPeriodValues={}}window.SavedPeriodValues[b.id]=b.value;b.value=""},RestoreInput:function(b){if(!window.SavedPeriodValues||!window.SavedPeriodValues[b.id]){return}b.value=window.SavedPeriodValues[b.id];delete window.SavedPeriodValues[b.id]},OnChangeP:function(j){var v=j.parentNode.parentNode;var m,h,w,b;m=h=w=b=false;var f=BX.findChild(v,{className:"adm-input-wrap adm-calendar-inp adm-calendar-first"});var d=BX.findChild(v,{className:"adm-input-wrap adm-calendar-second"});var g=BX.findChild(v,{className:"adm-select-wrap adm-calendar-direction"});var p=BX.findChild(v,{className:"adm-calendar-separate"});var q=BX.findChild(v,{className:"adm-input adm-calendar-from"},true);var k=BX.findChild(v,{className:"adm-input adm-calendar-to"},true);switch(j.value){case"day":case"week":case"month":case"quarter":case"year":w=true;BX.CalendarPeriod.OnChangeD(g.children[0]);break;case"before":h=true;break;case"after":m=true;break;case"exact":m=true;break;case"interval":m=h=b=true;BX.CalendarPeriod.RestoreInput(q);BX.CalendarPeriod.RestoreInput(k);break;case"":BX.CalendarPeriod.SaveAndClearInput(q);BX.CalendarPeriod.SaveAndClearInput(k);break;default:break}BX.CalendarPeriod.ChangeDirectOpts(j.value,v);f.style.display=m?"inline-block":"none";d.style.display=h?"inline-block":"none";g.style.display=w?"inline-block":"none";p.style.display=b?"inline-block":"none"},OnChangeD:function(v){var B=v.parentNode.parentNode;var y=BX.findChild(B,{className:"adm-input adm-calendar-from"},true);var m=BX.findChild(B,{className:"adm-input adm-calendar-to"},true);var C=BX.findChild(B,{className:"adm-select adm-calendar-period"},true);var b=0;switch(v.value){case"previous":b=-1;break;case"next":b=1;break;case"current":default:break}var j=false;var g=false;var k=new Date;var z=k.getFullYear();var A=k.getMonth();var x=k.getDate();var w=k.getDay();if(w==0){w=7}switch(C.value){case"day":j=new Date(z,A,x+b,0,0,0);g=new Date(z,A,x+b,23,59,59);break;case"week":j=new Date(z,A,x-w+1+b*7,0,0,0);g=new Date(z,A,x+(7-w)+b*7,23,59,59);break;case"month":j=new Date(z,A+b,1,0,0,0);g=new Date(z,A+1+b,0,23,59,59);break;case"quarter":var f=Math.floor(A/3)+b;j=new Date(z,3*f,1,0,0,0);g=new Date(z,3*(f+1),0,23,59,59);break;case"year":j=new Date(z+b,0,1,0,0,0);g=new Date(z+1+b,0,0,23,59,59);break;default:break}var q=window[y.name+"_bTime"]?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE");if(j){y.value=BX.formatDate(j,q);BX.addClass(y,"adm-calendar-inp-setted")}if(g){m.value=BX.formatDate(g,q);BX.addClass(m,"adm-calendar-inp-setted")}}};BX.JCCalendar=function(){this.params={};this.bAmPm=BX.isAmPmMode();this.popup=null;this.popup_month=null;this.popup_year=null;this.value=null;this.control_id=Math.random();this._layers={};this._current_layer=null;this.DIV=null;this.PARTS={};this.weekStart=0;this.numRows=6;this._create=function(b){this.popup=new BX.PopupWindow("calendar_popup_"+this.control_id,b.node,{closeByEsc:true,autoHide:false,content:this._get_content(),zIndex:3000,bindOptions:{forceBindPosition:true}});BX.bind(this.popup.popupContainer,"click",this.popup.cancelBubble)};this._auto_hide_disable=function(){BX.unbind(document,"click",BX.proxy(this._auto_hide,this))};this._auto_hide_enable=function(){BX.bind(document,"click",BX.proxy(this._auto_hide,this))};this._auto_hide=function(b){this._auto_hide_disable();this.popup.close()};this._get_content=function(){var d=BX.delegate(function(f){f=f||window.event;this.SetDate(new Date(parseInt(BX.proxy_context.getAttribute("data-date"))),f.type=="dblclick")},this);this.DIV=BX.create("DIV",{props:{className:"bx-calendar"},children:[BX.create("DIV",{props:{className:"bx-calendar-header"},children:[BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-left-arrow"},events:{click:BX.proxy(this._prev,this)}}),BX.create("SPAN",{props:{className:"bx-calendar-header-content"},children:[this.PARTS.MONTH=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-month"},events:{click:BX.proxy(this._menu_month,this)}}),this.PARTS.YEAR=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-year"},events:{click:BX.proxy(this._menu_year,this)}})]}),BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-right-arrow"},events:{click:BX.proxy(this._next,this)}})]}),this.PARTS.WEEK=BX.create("DIV",{props:{className:"bx-calendar-name-day-wrap"}}),this.PARTS.LAYERS=BX.create("DIV",{props:{className:"bx-calendar-cell-block"},events:{click:BX.delegateEvent({className:"bx-calendar-cell"},d),dblclick:BX.delegateEvent({className:"bx-calendar-cell"},d)}}),this.PARTS.TIME=BX.create("DIV",{props:{className:"bx-calendar-set-time-wrap"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._time_actions,this))},html:'<a href="javascript:void(0)" data-action="time_show" class="bx-calendar-set-time"><i></i>'+BX.message("CAL_TIME_SET")+'</a><div class="bx-calendar-form-block"><span class="bx-calendar-form-text">'+BX.message("CAL_TIME")+'</span><span class="bx-calendar-form"><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" /><span class="bx-calendar-form-separator"></span><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" />'+(this.bAmPm?'<span class="bx-calendar-AM-PM-block"><span class="bx-calendar-AM-PM-text" data-action="time_ampm"></span><span class="bx-calendar-form-arrow-r"><a href="javascript:void(0)" class="bx-calendar-form-arrow-top" data-action="time_ampm_up"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow-bottom" data-action="time_ampm_down"><i></i></a></span></span>':"")+'</span><a href="javascript:void(0)" data-action="time_hide" class="bx-calendar-form-close"><i></i></a></div>'}),BX.create("DIV",{props:{className:"bx-calendar-button-block"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._button_actions,this))},html:'<a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-select" data-action="submit"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("CAL_BUTTON")+'</span><span class="bx-calendar-button-right"></span></a><a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-cancel" data-action="cancel"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("JS_CORE_WINDOW_CLOSE")+'</span><span class="bx-calendar-button-right"></span></a>'})]});this.PARTS.TIME_INPUT_H=BX.findChild(this.PARTS.TIME,{tag:"INPUT"},true);this.PARTS.TIME_INPUT_M=this.PARTS.TIME_INPUT_H.nextSibling.nextSibling;if(this.bAmPm){this.PARTS.TIME_AMPM=this.PARTS.TIME_INPUT_M.nextSibling.firstChild}var c=new BX.JCSpinner({input:this.PARTS.TIME_INPUT_H,callback_change:BX.proxy(this._check_time,this),bSaveValue:false}).Show();c.className="bx-calendar-form-arrow-l";this.PARTS.TIME_INPUT_H.parentNode.insertBefore(c,this.PARTS.TIME_INPUT_H);c=new BX.JCSpinner({input:this.PARTS.TIME_INPUT_M,callback_change:BX.proxy(this._check_time,this),bSaveValue:true}).Show();c.className="bx-calendar-form-arrow-r";if(!this.PARTS.TIME_INPUT_M.nextSibling){this.PARTS.TIME_INPUT_M.parentNode.appendChild(c)}else{this.PARTS.TIME_INPUT_M.parentNode.insertBefore(c,this.PARTS.TIME_INPUT_M.nextSibling)}for(var b=0;b<7;b++){this.PARTS.WEEK.appendChild(BX.create("SPAN",{props:{className:"bx-calendar-name-day"},text:BX.message("DOW_"+(b+this.weekStart)%7)}))}return this.DIV};this._time_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"time_show":BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened");this.popup.adjustPosition();break;case"time_hide":BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened");this.popup.adjustPosition();break;case"time_ampm":this.PARTS.TIME_AMPM.innerHTML=this.PARTS.TIME_AMPM.innerHTML=="AM"?"PM":"AM";break;case"time_ampm_up":this._check_time({bSaveValue:false},null,12);return;break;case"time_ampm_down":this._check_time({bSaveValue:false},null,-12);return;break}this._check_time()};this._button_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"submit":this.SaveValue();break;case"cancel":this.Close();break}};this._check_time=function(h,d,b){var c=parseInt(this.PARTS.TIME_INPUT_H.value.substring(0,5),10)||0,f=parseInt(this.PARTS.TIME_INPUT_M.value.substring(0,5),10)||0,g=false;if(!!h&&!h.bSaveValue){this.value.setUTCHours(this.value.getUTCHours()+b)}else{if(!isNaN(c)){if(this.bAmPm){if(c!=12&&this.PARTS.TIME_AMPM.innerHTML=="PM"){c+=12}}g=true;this.value.setUTCHours(c%24)}}if(!isNaN(f)){g=true;this.value.setUTCMinutes(f%60)}if(g){this.SetValue(this.value)}};this._set_layer=function(){var f=parseInt(this.value.getUTCFullYear()+""+BX.util.str_pad_left(this.value.getUTCMonth()+"",2,"0"));if(!this._layers[f]){this._layers[f]=this._create_layer();this._layers[f].BXLAYERID=f}if(this._current_layer){var d=new Date(this.value.valueOf());d.setUTCHours(0);d.setUTCMinutes(0);var b=BX.findChild(this._layers[f],{tag:"A",className:"bx-calendar-active"},true),c=BX.findChild(this._layers[f],{tag:"A",attr:{"data-date":d.valueOf()+""}},true);if(b){BX.removeClass(b,"bx-calendar-active")}if(c){BX.addClass(c,"bx-calendar-active")}this._replace_layer(this._current_layer,this._layers[f])}else{this.PARTS.LAYERS.appendChild(this._layers[f])}this._current_layer=this._layers[f]};this._replace_layer=function(h,d){if(h!=d){if(!BX.browser.IsIE()||BX.browser.IsDoctype()){var b=h.BXLAYERID>d.BXLAYERID?1:-1;var c=0;var f=-b*h.offsetHeight;h.style.position="relative";h.style.top="0px";h.style.zIndex=5;d.style.position="absolute";d.style.top=f+"px";d.style.zIndex=6;this.PARTS.LAYERS.appendChild(d);var g=15;var j;(j=function(){f+=b*g;c+=b*g;if(b*f<0){h.style.top=c+"px";d.style.top=f+"px";setTimeout(j,10)}else{h.parentNode.removeChild(h);d.style.top="0px";d.style.position="static";d.style.zIndex=0}})()}else{this.PARTS.LAYERS.replaceChild(d,h)}}};this._create_layer=function(){var h=BX.create("DIV",{props:{className:"bx-calendar-layer"}});var m=new Date(this.value);m.setUTCHours(0);m.setUTCMinutes(0);m.setUTCDate(1);if(m.getUTCDay()!=this.weekStart){var j=m.getUTCDay()-this.weekStart;j+=j<0?7:0;m.setUTCDate(m.getUTCDate()-j)}var g=this.value.getUTCMonth(),p=this.value.getUTCDate(),b="";for(var d=0;d<this.numRows;d++){b+='<div class="bx-calendar-range'+(d==this.numRows-1?" bx-calendar-range-noline":"")+'">';for(var c=0;c<7;c++){j=m.getUTCDate();var f=m.getUTCDay();var k="bx-calendar-cell";if(g!=m.getUTCMonth()){k+=" bx-calendar-date-hidden"}else{if(p==j){k+=" bx-calendar-active"}}if(f==0||f==6){k+=" bx-calendar-weekend"}b+='<a href="javascript:void(0)" class="'+k+'" data-date="'+m.valueOf()+'">'+j+"</a>";m.setUTCDate(m.getUTCDate()+1)}b+="</div>"}h.innerHTML=b;return h};this._prev=function(){this.SetMonth(this.value.getUTCMonth()-1)};this._next=function(){this.SetMonth(this.value.getUTCMonth()+1)};this._menu_month_content=function(){var d="",c=this.value.getMonth(),b;for(b=0;b<12;b++){d+='<a href="javascript:void(0)" class="bx-calendar-month'+(b==c?" bx-calendar-month-active":"")+'" onclick="BX.calendar.get().SetMonth('+b+')">'+BX.message("MONTH_"+(b+1))+"</a>"}return'<div class="bx-calendar-month-popup"><div class="bx-calendar-month-title" onclick="BX.calendar.get().popup_month.close();">'+BX.message("MONTH_"+(this.value.getUTCMonth()+1))+'</div><div class="bx-calendar-month-content">'+d+"</div></div>"};this._menu_month=function(){if(!this.popup_month){this.popup_month=BX.PopupWindowManager.create("calendar_popup_month_"+this.control_id,this.PARTS.MONTH,{content:this._menu_month_content(),zIndex:3001,closeByEsc:true,autoHide:true,offsetTop:-29,offsetLeft:-1});this.popup_month.BXMONTH=this.value.getUTCMonth()}else{if(this.popup_month.BXMONTH!=this.value.getUTCMonth()){this.popup_month.setContent(this._menu_month_content());this.popup_month.BXMONTH=this.value.getUTCMonth()}}this.popup_month.show()};this._menu_year_content=function(){var c='<div class="bx-calendar-year-popup"><div class="bx-calendar-year-title" onclick="BX.calendar.get().popup_year.close();">'+this.value.getUTCFullYear()+'</div><div class="bx-calendar-year-content" id="bx-calendar-year-content">';for(var b=-3;b<=3;b++){c+='<a href="javascript:void(0)" class="bx-calendar-year-number'+(b==0?" bx-calendar-year-active":"")+'" onclick="BX.calendar.get().SetYear('+(this.value.getUTCFullYear()-b)+')">'+(this.value.getUTCFullYear()-b)+"</a>"}c+='</div><input type="text" class="bx-calendar-year-input" onkeyup="if(this.value>=1900&&this.value<=2100)BX.calendar.get().SetYear(this.value);" maxlength="4" /></div>';return c};this._menu_year=function(){if(!this.popup_year){this.popup_year=BX.PopupWindowManager.create("calendar_popup_year_"+this.control_id,this.PARTS.YEAR,{content:this._menu_year_content(),zIndex:3001,closeByEsc:true,autoHide:true,offsetTop:-29,offsetLeft:-1});this.popup_year.BXYEAR=this.value.getUTCFullYear()}else{if(this.popup_year.BXYEAR!=this.value.getUTCFullYear()){this.popup_year.setContent(this._menu_year_content());this.popup_year.BXYEAR=this.value.getUTCFullYear()}}this.popup_year.show()};this._check_date=function(c){var b=c;if(BX.type.isString(c)){b=BX.parseDate(c,true)}if(!BX.type.isDate(b)||isNaN(b.valueOf())){b=BX.date.convertToUTC(new Date);if(this.params.bHideTime){b.setUTCHours(0);b.setUTCMinutes(0)}}b.setUTCMilliseconds(0);b.setUTCSeconds(0);b.BXCHECKED=true;return b}};BX.JCCalendar.prototype.Show=function(f){if(!BX.isReady){BX.ready(BX.delegate(function(){this.Show(f)},this));return}f.node=f.node||document.body;if(BX.type.isNotEmptyString(f.node)){var d=BX(f.node);if(!d){d=document.getElementsByName(f.node);if(d&&d.length>0){d=d[0]}}f.node=d}if(!f.node){return}if(!!f.field){if(BX.type.isString(f.field)){d=BX(f.field);if(!!d){f.field=d}else{if(f.form){if(BX.type.isString(f.form)){f.form=document.forms[f.form]}}if(BX.type.isDomNode(f.form)&&!!f.form[f.field]){f.field=f.form[f.field]}else{d=document.getElementsByName(f.field);if(d&&d.length>0){d=d[0];f.field=d}}}if(BX.type.isString(f.field)){f.field=BX(f.field)}}}var b=!this.popup||!this.popup.isShown()||this.params.node!=f.node;this.params=f;this.params.bTime=typeof this.params.bTime=="undefined"?true:!!this.params.bTime;this.params.bHideTime=typeof this.params.bHideTime=="undefined"?true:!!this.params.bHideTime;this.weekStart=parseInt(this.params.weekStart||this.params.weekStart||BX.message("WEEK_START"));if(isNaN(this.weekStart)){this.weekStart=1}if(!this.popup){this._create(this.params)}else{this.popup.setBindElement(this.params.node)}var c=!!this.params.bHideTime;if(this.params.value){this.SetValue(this.params.value);c=this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0}else{if(this.params.field){this.SetValue(this.params.field.value);c=this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0}else{if(!!this.params.currentTime){this.SetValue(this.params.currentTime)}else{this.SetValue()}}}if(!!this.params.bTime){BX.removeClass(this.DIV,"bx-calendar-time-disabled")}else{BX.addClass(this.DIV,"bx-calendar-time-disabled")}if(!!c){BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}else{BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}if(b){this._auto_hide_disable();this.popup.show();setTimeout(BX.proxy(this._auto_hide_enable,this),0)}this.params.bSetFocus=typeof this.params.bSetFocus=="undefined"?true:!!this.params.bSetFocus;if(this.params.bSetFocus){f.node.blur()}return this};BX.JCCalendar.prototype.SetDay=function(b){this.value.setUTCDate(b);return this.SetValue(this.value)};BX.JCCalendar.prototype.SetMonth=function(b){if(this.popup_month){this.popup_month.close()}this.value.setUTCMonth(b);if(b<0){b+=12}else{if(b>=12){b-=12}}while(this.value.getUTCMonth()>b){this.value.setUTCDate(this.value.getUTCDate()-1)}return this.SetValue(this.value)};BX.JCCalendar.prototype.SetYear=function(b){if(this.popup_year){this.popup_year.close()}this.value.setUTCFullYear(b);return this.SetValue(this.value)};BX.JCCalendar.prototype.SetDate=function(c,b){c=this._check_date(c);c.setUTCHours(this.value.getUTCHours());c.setUTCMinutes(this.value.getUTCMinutes());c.setUTCSeconds(this.value.getUTCSeconds());if(this.params.bTime&&!b){return this.SetValue(c)}else{this.SetValue(c);this.SaveValue()}};BX.JCCalendar.prototype.SetValue=function(c){this.value=c&&c.BXCHECKED?c:this._check_date(c);this.PARTS.MONTH.innerHTML=BX.message("MONTH_"+(this.value.getUTCMonth()+1));this.PARTS.YEAR.innerHTML=this.value.getUTCFullYear();if(!!this.params.bTime){var b=this.value.getUTCHours();if(this.bAmPm){if(b>=12){this.PARTS.TIME_AMPM.innerHTML="PM";if(b!=12){b-=12}}else{this.PARTS.TIME_AMPM.innerHTML="AM";if(b==0){b=12}}}this.PARTS.TIME_INPUT_H.value=BX.util.str_pad_left(b.toString(),2,"0");this.PARTS.TIME_INPUT_M.value=BX.util.str_pad_left(this.value.getUTCMinutes().toString(),2,"0")}this._set_layer();return this};BX.JCCalendar.prototype.SaveValue=function(){if(this.popup_month){this.popup_month.close()}if(this.popup_year){this.popup_year.close()}var d=true;if(!!this.params.callback){var c=this.params.callback.apply(this,[new Date(this.value.valueOf()+this.value.getTimezoneOffset()*60000)]);if(c===false){d=false}}if(d){var b=!!this.params.bTime&&BX.hasClass(this.PARTS.TIME,"bx-calendar-set-time-opened");if(this.params.field){this.params.field.value=BX.calendar.ValueToString(this.value,b,true);BX.fireEvent(this.params.field,"change")}this.popup.close();if(!!this.params.callback_after){this.params.callback_after.apply(this,[new Date(this.value.valueOf()+this.value.getTimezoneOffset()*60000),b])}}return this};BX.JCCalendar.prototype.Close=function(){if(!!this.popup){this.popup.close()}return this};BX.JCSpinner=function(b){b=b||{};this.params={input:b.input||null,delta:b.delta||1,timeout_start:b.timeout_start||1000,timeout_cont:b.timeout_cont||150,callback_start:b.callback_start||null,callback_change:b.callback_change||null,callback_finish:b.callback_finish||null,bSaveValue:typeof b.bSaveValue=="undefined"?!!b.input:!!b.bSaveValue};this.mousedown=false;this.direction=1};BX.JCSpinner.prototype.Show=function(){this.node=BX.create("span",{events:{mousedown:BX.delegateEvent({attr:"data-dir"},BX.delegate(this.Start,this))},html:'<a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-top" data-dir="1"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-bottom" data-dir="-1"><i></i></a>'});return this.node};BX.JCSpinner.prototype.Start=function(){this.mousedown=true;this.direction=BX.proxy_context.getAttribute("data-dir")>0?1:-1;BX.bind(document,"mouseup",BX.proxy(this.MouseUp,this));this.ChangeValue(true)};BX.JCSpinner.prototype.ChangeValue=function(c){if(!this.mousedown){return}if(this.params.input){var b=parseInt(this.params.input.value,10)+this.params.delta*this.direction;if(this.params.bSaveValue){this.params.input.value=b}if(!!c&&this.params.callback_start){this.params.callback_start(this.params,b,this.direction)}if(this.params.callback_change){this.params.callback_change(this.params,b,this.direction)}setTimeout(BX.proxy(this.ChangeValue,this),!!c?this.params.timeout_start:this.params.timeout_cont)}};BX.JCSpinner.prototype.MouseUp=function(){this.mousedown=false;BX.unbind(document,"mouseup",BX.proxy(this.MouseUp,this));if(this.params.callback_finish){this.params.callback_finish(this.params,this.params.input.value)}};window.jsCalendar={Show:function(h,d,b,c,f,g,k,j){return BX.calendar({node:h,field:d,form:k,bTime:!!f,currentTime:g,bHideTimebar:!!j})},ValueToString:BX.calendar.ValueToString};BX.CClockSelector=function(b){this.params=b;this.params.popup_buttons=this.params.popup_buttons||[new BX.PopupWindowButton({text:BX.message("CAL_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(this.setValue,this)}})];this.isReady=false;this.WND=new BX.PopupWindow(this.params.popup_id||"clock_selector_popup",this.params.node,this.params.popup_config||{titleBar:{content:BX.create("SPAN",{text:BX.message("CAL_TIME")})},offsetLeft:-45,offsetTop:-135,autoHide:true,closeIcon:true,closeByEsc:true,zIndex:this.params.zIndex});this.SHOW=false;BX.addCustomEvent(this.WND,"onPopupClose",BX.delegate(this.onPopupClose,this));this.obClocks={};this.CLOCK_ID=this.params.clock_id||"clock_selector"};BX.CClockSelector.prototype.Show=function(){if(!this.isReady){BX.addCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this));return BX.ajax.get("/bitrix/tools/clock_selector.php",{start_time:this.params.start_time,clock_id:this.CLOCK_ID,sessid:BX.bitrix_sessid()},BX.delegate(this.Ready,this))}this.WND.setButtons(this.params.popup_buttons);this.WND.show();this.SHOW=true;if(window["bxClock_"+this.obClocks[this.CLOCK_ID]]){setTimeout("window['bxClock_"+this.obClocks[this.CLOCK_ID]+"'].CalculateCoordinates()",40)}return true};BX.CClockSelector.prototype.onClockRegister=function(b){if(b[this.CLOCK_ID]){this.obClocks[this.CLOCK_ID]=b[this.CLOCK_ID];BX.removeCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this))}};BX.CClockSelector.prototype.Ready=function(b){this.content=this.CreateContent(b);this.WND.setContent(this.content);this.isReady=true;setTimeout(BX.proxy(this.Show,this),30)};BX.CClockSelector.prototype.CreateContent=function(b){return BX.create("DIV",{events:{click:BX.PreventDefault},html:'<div class="bx-tm-popup-clock">'+b+"</div>"})};BX.CClockSelector.prototype.setValue=function(c){if(this.params.callback){var b=BX.findChild(this.content,{tagName:"INPUT"},true);this.params.callback.apply(this.params.node,[b.value])}return BX.PreventDefault(c)};BX.CClockSelector.prototype.closeWnd=function(b){this.WND.close();return b||window.event?BX.PreventDefault(b):true};BX.CClockSelector.prototype.setNode=function(b){this.WND.setBindElement(b)};BX.CClockSelector.prototype.setTime=function(b){this.params.start_time=b;if(window["bxClock_"+this.obClocks[this.CLOCK_ID]]){window["bxClock_"+this.obClocks[this.CLOCK_ID]].SetTime(parseInt(b/3600),parseInt(b%3600/60))}};BX.CClockSelector.prototype.setCallback=function(b){this.params.callback=b};BX.CClockSelector.prototype.onPopupClose=function(){this.SHOW=false}})();