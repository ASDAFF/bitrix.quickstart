!function(d){function c(i,j){this.$element=jQuery(i);this.params=j||{};this.__construct()}c.prototype.__construct=function g(){this.$box=this.$element.find(".js-compare-box");this.$switcher=this.$element.find(".js-compare-switcher");this.$count=this.$element.find(".js-compare-count");this.url=this.$element.find(".js-compare-label").attr("href"),this.id=parseInt(this.$element.data("elementid"));this.name=this.$element.find(".js-compare-name"),this.classActive=this.params.classActive||"active";this.classHidden=this.params.classHidden||"compare_hidden";this._init()};c.prototype._init=function e(){var i=this;this.$switcher.on("click.js-compare",function(j){i.getData.apply(i,[]);return false});this.ready();this.setCompared()};c.prototype.ready=function b(){this.$element.addClass("js-compare-ready").addClass(this.classReady);this.$element.trigger("jscompareready",this)};c.prototype.setCount=function f(i){if(rsFlyaway.count_compare>=0){jQuery(".js-comparelist").removeClass(this.classHidden);$(".js-comparelist-count").html(i)}if(rsFlyaway.count_compare==0){jQuery(".informer").addClass("informer_unactive");jQuery(".js-comparising-list").addClass("hidden")}else{jQuery(".informer").removeClass("informer_unactive");jQuery(".js-comparising-list").removeClass("hidden")}};c.prototype.setCompared=function h(j){var i;jQuery(".js-elementid"+j).find(".js-compare-box").removeClass(this.classActive);for(i in rsFlyaway.compare){if(rsFlyaway.compare[i]=="Y"&&$(".js-elementid"+i).find(".js-compare-box").length>0){jQuery(".js-elementid"+i).find(".js-compare-box").addClass(this.classActive).find(".js-compare-count").html(" ("+rsFlyaway.count_compare+")")}}this.$box.not("."+this.classActive).find(".js-compare-count").html("")};c.prototype.getData=function a(){var j=this,i="";if(this.id>0){if(this.url.indexOf("?")==-1){this.url=this.url+"?"}if(rsFlyaway.compare[this.id]=="Y"||parseInt(rsFlyaway.compare[this.id])>0){i="DELETE_FROM_COMPARE_LIST"}else{i="ADD_TO_COMPARE_LIST"}this.url=this.url+"AJAX_CALL=Y&action="+i+"&id="+this.id;rsFlyaway.darken(this.$box);rsFlyaway.darken(jQuery(".js-informer-status"));jQuery.getJSON(j.url,{},function(k){if(k.TYPE=="OK"){var l=j.name.text();jQuery(".js-compare-product").html(l);jQuery(".js-compare-add").addClass("hidden");jQuery(".js-compare-del").addClass("hidden");if(i=="DELETE_FROM_COMPARE_LIST"){delete rsFlyaway.compare[j.id];jQuery(".js-compare-del").removeClass("hidden")}else{rsFlyaway.compare[j.id]="Y";jQuery(".js-compare-add").removeClass("hidden")}rsFlyaway.count_compare=k.COUNT;j.setCount(k.COUNT_WITH_WORD)}else{console.warn("compare - error responsed")}}).fail(function(k){console.warn("compare - fail request")}).always(function(){rsFlyaway.darken(j.$box);rsFlyaway.darken(jQuery(".js-informer-status"));j.setCompared(j.id);ajaxBasket("fav",$(".js-favorite_in"))})}return false};d.Compare=c}(this);