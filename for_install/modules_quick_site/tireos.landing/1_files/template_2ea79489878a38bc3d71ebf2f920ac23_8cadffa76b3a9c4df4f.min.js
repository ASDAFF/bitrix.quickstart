var authFormWindow={form_window:null,overlay:null,form_window_id:"login-form-window",login_field_id:"auth-user-login",menuFocus:false,UserMenuDisplay:function(){var b=BX("top-menu");if(b){b.style.zIndex=5}var a=BX("top-site-menu");if(a){if(a.className=="top-site-menu"){a.className="top-site-menu-active";a.style.zIndex=100;BX.unbindAll(a);BX.bind(a,"mouseover",function(){a.className="top-site-menu-active";window.clearTimeout(authFormWindow.menuFocus)});BX.bind(a,"mouseout",function(){authFormWindow.menuFocus=window.setTimeout(function(){BX.unbindAll(a);a.className="top-site-menu";a.style.zIndex=0;if(b){b.style.zIndex=15}},200)})}}},UserMenuShow:function(c,d){var a=c.parentNode.parentNode.parentNode;var b="";if(d==1){b="user-auth-block"}else{if(d==2){b="user-auth-block-small"}}if(b!=""){a.className=b;BX.unbindAll(a);BX.bind(a,"mouseover",function(){a.className=b;window.clearTimeout(authFormWindow.menuFocus)});BX.bind(a,"mouseout",function(){authFormWindow.menuFocus=window.setTimeout(function(){BX.unbindAll(a);a.className=""},200)})}},ShowLoginForm:function(){if(!this.form_window){this.form_window=document.getElementById(this.form_window_id);if(!this.form_window){return false}try{document.body.appendChild(this.form_window)}catch(b){}}this.form_window.style.display="block";if(this.GetOpacityProperty()){this.CreateOverlay()}var a=document.getElementById(this.login_field_id);if(a){a.focus();a.select()}return false},CloseLoginForm:function(){if(this.form_window){this.form_window.style.display="none"}if(this.overlay){this.overlay.style.display="none"}return false},CreateOverlay:function(){if(!this.overlay){this.overlay=document.body.appendChild(document.createElement("DIV"));this.overlay.className="login-form-overlay";var b=this;this.overlay.onclick=function(){b.CloseLoginForm()}}var a=this.GetWindowScrollSize();this.overlay.style.width=a.scrollWidth+"px";this.overlay.style.height=a.scrollHeight+"px";this.overlay.style.display="block"},GetOpacityProperty:function(){if(typeof document.body.style.opacity=="string"){return"opacity"}else{if(typeof document.body.style.MozOpacity=="string"){return"MozOpacity"}else{if(typeof document.body.style.KhtmlOpacity=="string"){return"KhtmlOpacity"}else{if(document.body.filters&&navigator.appVersion.match(/MSIE ([\d.]+);/)[1]>=5.5){return"filter"}}}}return false},GetWindowScrollSize:function(c){var b,a;if(!c){c=document}if((c.compatMode&&c.compatMode=="CSS1Compat")){b=c.documentElement.scrollWidth;a=c.documentElement.scrollHeight}else{if(c.body.scrollHeight>c.body.offsetHeight){a=c.body.scrollHeight}else{a=c.body.offsetHeight}if(c.body.scrollWidth>c.body.offsetWidth||(c.compatMode&&c.compatMode=="BackCompat")||(c.documentElement&&!c.documentElement.clientWidth)){b=c.body.scrollWidth}else{b=c.body.offsetWidth}}return{scrollWidth:b,scrollHeight:a}}};function systemAuthFormComponent_logout(){BX("auth-logout-form").submit();return false}function systemAuthFormComponent_openBlock(){var a=BX("hd_loginform_container");if(a.style.display=="block"){BX.hide(a)}else{BX.show(a);BX.focus(BX("USER_LOGIN_INPUT"));BX.bind(document,"keyup",function(b){if(a.style.display=="block"){b=b||window.event;switch(b.keyCode){case 27:systemAuthFormComponent_closeBlock();break}}})}return false}function systemAuthFormComponent_closeBlock(){BX.hide(BX("hd_loginform_container"))}var authPreloadImages=["rt_round_menu.png","rb_round_menu.png","lt_round_menu.png","lb_round_menu.png","l_menu.png","t_menu.png","r_menu.png","b_menu.png","close.gif","auth-form-bg.gif","avatar.png","exit_hover.gif","exit.gif"];for(var imageIndex=0;imageIndex<authPreloadImages.length;imageIndex++){var imageObj=new Image();imageObj.src="/bitrix/templates/.default/components/bitrix/system.auth.form/drop_auth/images/"+authPreloadImages[imageIndex]}authPreloadImages=null;BX.ready(function(){BX.bind(BX("authlogin"),"mouseover",function(){BX.show(BX("authlogin_menu"))});BX.bind(BX("authlogin"),"mouseout",function(){BX.hide(BX("authlogin_menu"))})});function JCTitleSearch(a){var b=this;this.arParams={AJAX_PAGE:a.AJAX_PAGE,CONTAINER_ID:a.CONTAINER_ID,INPUT_ID:a.INPUT_ID,MIN_QUERY_LEN:parseInt(a.MIN_QUERY_LEN)};if(a.WAIT_IMAGE){this.arParams.WAIT_IMAGE=a.WAIT_IMAGE}if(a.MIN_QUERY_LEN<=0){a.MIN_QUERY_LEN=1}this.cache=[];this.cache_key=null;this.startText="";this.currentRow=-1;this.RESULT=null;this.CONTAINER=null;this.INPUT=null;this.WAIT=null;this.ShowResult=function(e){var j=BX.pos(b.CONTAINER);j.width=j.right-j.left;b.RESULT.style.position="absolute";b.RESULT.style.top=(j.bottom+2)+"px";b.RESULT.style.left=j.left+"px";b.RESULT.style.width=j.width+"px";if(e!=null){b.RESULT.innerHTML=e}if(b.RESULT.innerHTML.length>0){b.RESULT.style.display="block"}else{b.RESULT.style.display="none"}var g;var h=BX.findChild(b.RESULT,{tag:"table","class":"title-search-result"},true);if(h){g=BX.findChild(h,{tag:"th"},true)}if(g){var d=BX.pos(h);d.width=d.right-d.left;var f=BX.pos(g);f.width=f.right-f.left;g.style.width=f.width+"px";b.RESULT.style.width=(j.width+f.width)+"px";b.RESULT.style.left=(j.left-f.width-1)+"px";if((d.width-f.width)>j.width){b.RESULT.style.width=(j.width+f.width-1)+"px"}d=BX.pos(h);var c=BX.pos(b.RESULT);if(c.right>d.right){b.RESULT.style.width=(d.right-d.left)+"px"}}var i;if(h){i=BX.findChild(b.RESULT,{"class":"title-search-fader"},true)}if(i&&g){c=BX.pos(b.RESULT);i.style.left=(c.right-c.left-18)+"px";i.style.width=18+"px";i.style.top=0+"px";i.style.height=(c.bottom-c.top)+"px";i.style.display="block"}};this.onKeyPress=function(h){var g=BX.findChild(b.RESULT,{tag:"table","class":"title-search-result"},true);if(!g){return false}var e=g.rows.length;switch(h){case 27:b.RESULT.style.display="none";b.currentRow=-1;b.UnSelectAll();return true;case 40:if(b.RESULT.style.display=="none"){b.RESULT.style.display="block"}var j=-1;for(var d=0;d<e;d++){if(!BX.findChild(g.rows[d],{"class":"title-search-separator"},true)){if(j==-1){j=d}if(b.currentRow<d){b.currentRow=d;break}else{if(g.rows[d].className=="title-search-selected"){g.rows[d].className=""}}}}if(d==e&&b.currentRow!=d){b.currentRow=j}g.rows[b.currentRow].className="title-search-selected";return true;case 38:if(b.RESULT.style.display=="none"){b.RESULT.style.display="block"}var f=-1;for(var d=e-1;d>=0;d--){if(!BX.findChild(g.rows[d],{"class":"title-search-separator"},true)){if(f==-1){f=d}if(b.currentRow>d){b.currentRow=d;break}else{if(g.rows[d].className=="title-search-selected"){g.rows[d].className=""}}}}if(d<0&&b.currentRow!=d){b.currentRow=f}g.rows[b.currentRow].className="title-search-selected";return true;case 13:if(b.RESULT.style.display=="block"){for(var d=0;d<e;d++){if(b.currentRow==d){if(!BX.findChild(g.rows[d],{"class":"title-search-separator"},true)){var c=BX.findChild(g.rows[d],{tag:"a"},true);if(c){window.location=c.href;return true}}}}}return false}return false};this.onTimeout=function(){b.onChange(function(){setTimeout(b.onTimeout,500)})};this.onChange=function(e){if(b.INPUT.value!=b.oldValue&&b.INPUT.value!=b.startText){b.oldValue=b.INPUT.value;if(b.INPUT.value.length>=b.arParams.MIN_QUERY_LEN){b.cache_key=b.arParams.INPUT_ID+"|"+b.INPUT.value;if(b.cache[b.cache_key]==null){if(b.WAIT){var d=BX.pos(b.INPUT);var c=(d.bottom-d.top)-2;b.WAIT.style.top=(d.top+1)+"px";b.WAIT.style.height=c+"px";b.WAIT.style.width=c+"px";b.WAIT.style.left=(d.right-c+2)+"px";b.WAIT.style.display="block"}BX.ajax.post(b.arParams.AJAX_PAGE,{ajax_call:"y",INPUT_ID:b.arParams.INPUT_ID,q:b.INPUT.value,l:b.arParams.MIN_QUERY_LEN},function(f){b.cache[b.cache_key]=f;b.ShowResult(f);b.currentRow=-1;b.EnableMouseEvents();if(b.WAIT){b.WAIT.style.display="none"}if(!!e){e()}});return}else{b.ShowResult(b.cache[b.cache_key]);b.currentRow=-1;b.EnableMouseEvents()}}else{b.RESULT.style.display="none";b.currentRow=-1;b.UnSelectAll()}}if(!!e){e()}};this.UnSelectAll=function(){var e=BX.findChild(b.RESULT,{tag:"table","class":"title-search-result"},true);if(e){var d=e.rows.length;for(var c=0;c<d;c++){e.rows[c].className=""}}};this.EnableMouseEvents=function(){var e=BX.findChild(b.RESULT,{tag:"table","class":"title-search-result"},true);if(e){var d=e.rows.length;for(var c=0;c<d;c++){if(!BX.findChild(e.rows[c],{"class":"title-search-separator"},true)){e.rows[c].id="row_"+c;e.rows[c].onmouseover=function(f){if(b.currentRow!=this.id.substr(4)){b.UnSelectAll();this.className="title-search-selected";b.currentRow=this.id.substr(4)}};e.rows[c].onmouseout=function(f){this.className="";b.currentRow=-1}}}}};this.onFocusLost=function(c){setTimeout(function(){b.RESULT.style.display="none"},250)};this.onFocusGain=function(){if(b.RESULT.innerHTML.length){b.ShowResult()}};this.onKeyDown=function(c){if(!c){c=window.event}if(b.RESULT.style.display=="block"){if(b.onKeyPress(c.keyCode)){return BX.PreventDefault(c)}}};this.Init=function(){this.CONTAINER=document.getElementById(this.arParams.CONTAINER_ID);this.RESULT=document.body.appendChild(document.createElement("DIV"));this.RESULT.className="title-search-result";this.INPUT=document.getElementById(this.arParams.INPUT_ID);this.startText=this.oldValue=this.INPUT.value;BX.bind(this.INPUT,"focus",function(){b.onFocusGain()});BX.bind(this.INPUT,"blur",function(){b.onFocusLost()});if(BX.browser.IsSafari()||BX.browser.IsIE()){this.INPUT.onkeydown=this.onKeyDown}else{this.INPUT.onkeypress=this.onKeyDown}if(this.arParams.WAIT_IMAGE){this.WAIT=document.body.appendChild(document.createElement("DIV"));this.WAIT.style.backgroundImage="url('"+this.arParams.WAIT_IMAGE+"')";if(!BX.browser.IsIE()){this.WAIT.style.backgroundRepeat="none"}this.WAIT.style.display="none";this.WAIT.style.position="absolute";this.WAIT.style.zIndex="1100"}BX.bind(this.INPUT,"bxchange",function(){b.onChange()})};BX.ready(function(){b.Init(a)})};