(function(d){function a(f){if(typeof f=="undefined"){return false}if(f instanceof Array||(!(f instanceof Object)&&(Object.prototype.toString.call((f))=="[object Array]")||typeof f.length=="number"&&typeof f.splice!="undefined"&&typeof f.propertyIsEnumerable!="undefined"&&!f.propertyIsEnumerable("splice"))){return true}return false}d.slider=function(h,g){var f=d(h);if(!f.data("jslider")){f.data("jslider",new c(h,g))}return f.data("jslider")};d.fn.slider=function(j,g){var i,h=arguments;function f(l){return l!==undefined}function k(l){return l!=null}this.each(function(){var m=d.slider(this,j);if(typeof j=="string"){switch(j){case"value":if(f(h[1])&&f(h[2])){var l=m.getPointers();if(k(l[0])&&k(h[1])){l[0].set(h[1]);l[0].setIndexOver()}if(k(l[1])&&k(h[2])){l[1].set(h[2]);l[1].setIndexOver()}}else{if(f(h[1])){var l=m.getPointers();if(k(l[0])&&k(h[1])){l[0].set(h[1]);l[0].setIndexOver()}}else{i=m.getValue()}}break;case"prc":if(f(h[1])&&f(h[2])){var l=m.getPointers();if(k(l[0])&&k(h[1])){l[0]._set(h[1]);l[0].setIndexOver()}if(k(l[1])&&k(h[2])){l[1]._set(h[2]);l[1].setIndexOver()}}else{if(f(h[1])){var l=m.getPointers();if(k(l[0])&&k(h[1])){l[0]._set(h[1]);l[0].setIndexOver()}}else{i=m.getPrcValue()}}break;case"calculatedValue":var o=m.getValue().split(";");i="";for(var n=0;n<o.length;n++){i+=(n>0?";":"")+m.nice(o[n])}break;case"skin":m.setSkin(h[1]);break}}else{if(!j&&!g){if(!a(i)){i=[]}i.push(m)}}});if(a(i)&&i.length==1){i=i[0]}return i||this};var e={settings:{from:1,to:10,step:1,smooth:true,limits:true,round:0,format:{format:"#,##0.##"},value:"5;7",dimension:""},className:"jslider",selector:".jslider-",template:tmpl('<span class="<%=className%>"><table><tr><td><div class="<%=className%>-bg"><i class="l"></i><i class="f"></i><i class="r"></i><i class="v"></i></div><div class="<%=className%>-pointer"></div><div class="<%=className%>-pointer <%=className%>-pointer-to"></div><div class="<%=className%>-label"><span><%=settings.from%></span></div><div class="<%=className%>-label <%=className%>-label-to"><span><%=settings.to%></span><%=settings.dimension%></div><div class="<%=className%>-value"><span></span><%=settings.dimension%></div><div class="<%=className%>-value <%=className%>-value-to"><span></span><%=settings.dimension%></div><div class="<%=className%>-scale"><%=scale%></div></td></tr></table></span>')};function c(){return this.init.apply(this,arguments)}c.prototype.init=function(g,f){this.settings=d.extend(true,{},e.settings,f?f:{});this.inputNode=d(g).hide();this.settings.interval=this.settings.to-this.settings.from;this.settings.value=this.inputNode.attr("value");if(this.settings.calculate&&d.isFunction(this.settings.calculate)){this.nice=this.settings.calculate}if(this.settings.onstatechange&&d.isFunction(this.settings.onstatechange)){this.onstatechange=this.settings.onstatechange}this.is={init:false};this.o={};this.create()};c.prototype.onstatechange=function(){};c.prototype.create=function(){var f=this;this.domNode=d(e.template({className:e.className,settings:{from:this.nice(this.settings.from),to:this.nice(this.settings.to),dimension:this.settings.dimension},scale:this.generateScale()}));this.inputNode.after(this.domNode);this.drawScale();if(this.settings.skin&&this.settings.skin.length>0){this.setSkin(this.settings.skin)}this.sizes={domWidth:this.domNode.width(),domOffset:this.domNode.offset()};d.extend(this.o,{pointers:{},labels:{0:{o:this.domNode.find(e.selector+"value").not(e.selector+"value-to")},1:{o:this.domNode.find(e.selector+"value").filter(e.selector+"value-to")}},limits:{0:this.domNode.find(e.selector+"label").not(e.selector+"label-to"),1:this.domNode.find(e.selector+"label").filter(e.selector+"label-to")}});d.extend(this.o.labels[0],{value:this.o.labels[0].o.find("span")});d.extend(this.o.labels[1],{value:this.o.labels[1].o.find("span")});if(!f.settings.value.split(";")[1]){this.settings.single=true;this.domNode.addDependClass("single")}if(!f.settings.limits){this.domNode.addDependClass("limitless")}this.domNode.find(e.selector+"pointer").each(function(g){var j=f.settings.value.split(";")[g];if(j){f.o.pointers[g]=new b(this,g,f);var h=f.settings.value.split(";")[g-1];if(h&&new Number(j)<new Number(h)){j=h}j=j<f.settings.from?f.settings.from:j;j=j>f.settings.to?f.settings.to:j;f.o.pointers[g].set(j,true)}});this.o.value=this.domNode.find(".v");this.is.init=true;d.each(this.o.pointers,function(g){f.redraw(this)});(function(g){d(window).resize(function(){g.onresize()})})(this)};c.prototype.setSkin=function(f){if(this.skin_){this.domNode.removeDependClass(this.skin_,"_")}this.domNode.addDependClass(this.skin_=f,"_")};c.prototype.setPointersIndex=function(f){d.each(this.getPointers(),function(g){this.index(g)})};c.prototype.getPointers=function(){return this.o.pointers};c.prototype.generateScale=function(){if(this.settings.scale&&this.settings.scale.length>0){var h="";var g=this.settings.scale;var j=Math.round((100/(g.length-1))*10)/10;for(var f=0;f<g.length;f++){h+='<span style="left: '+f*j+'%">'+(g[f]!="|"?"<ins>"+g[f]+"</ins>":"")+"</span>"}return h}else{return""}return""};c.prototype.drawScale=function(){this.domNode.find(e.selector+"scale span ins").each(function(){d(this).css({marginLeft:-d(this).outerWidth()/2})})};c.prototype.onresize=function(){var f=this;this.sizes={domWidth:this.domNode.width(),domOffset:this.domNode.offset()};d.each(this.o.pointers,function(g){f.redraw(this)})};c.prototype.update=function(){this.onresize();this.drawScale()};c.prototype.limits=function(f,i){if(!this.settings.smooth){var h=this.settings.step*100/(this.settings.interval);f=Math.round(f/h)*h}var g=this.o.pointers[1-i.uid];if(g&&i.uid&&f<g.value.prc){f=g.value.prc}if(g&&!i.uid&&f>g.value.prc){f=g.value.prc}if(f<0){f=0}if(f>100){f=100}return Math.round(f*10)/10};c.prototype.redraw=function(f){if(!this.is.init){return false}this.setValue();if(this.o.pointers[0]&&this.o.pointers[1]){this.o.value.css({left:this.o.pointers[0].value.prc+"%",width:(this.o.pointers[1].value.prc-this.o.pointers[0].value.prc)+"%"})}this.o.labels[f.uid].value.html(this.nice(f.value.origin));this.redrawLabels(f)};c.prototype.redrawLabels=function(l){function h(n,o,p){o.margin=-o.label/2;label_left=o.border+o.margin;if(label_left<0){o.margin-=label_left}if(o.border+o.label/2>g.sizes.domWidth){o.margin=0;o.right=true}else{o.right=false}n.o.css({left:p+"%",marginLeft:o.margin,right:"auto"});if(o.right){n.o.css({left:"auto",right:0})}return o}var g=this;var i=this.o.labels[l.uid];var m=l.value.prc;var j={label:i.o.outerWidth(),right:false,border:(m*this.sizes.domWidth)/100};if(!this.settings.single){var f=this.o.pointers[1-l.uid];var k=this.o.labels[f.uid];switch(l.uid){case 0:if(j.border+j.label/2>k.o.offset().left-this.sizes.domOffset.left){k.o.css({visibility:"hidden"});k.value.html(this.nice(f.value.origin));i.o.css({visibility:"visible"});m=(f.value.prc-m)/2+m;if(f.value.prc!=l.value.prc){i.value.html(this.nice(l.value.origin)+"&nbsp;&ndash;&nbsp;"+this.nice(f.value.origin));j.label=i.o.outerWidth();j.border=(m*this.sizes.domWidth)/100}}else{k.o.css({visibility:"visible"})}break;case 1:if(j.border-j.label/2<k.o.offset().left-this.sizes.domOffset.left+k.o.outerWidth()){k.o.css({visibility:"hidden"});k.value.html(this.nice(f.value.origin));i.o.css({visibility:"visible"});m=(m-f.value.prc)/2+f.value.prc;if(f.value.prc!=l.value.prc){i.value.html(this.nice(f.value.origin)+"&nbsp;&ndash;&nbsp;"+this.nice(l.value.origin));j.label=i.o.outerWidth();j.border=(m*this.sizes.domWidth)/100}}else{k.o.css({visibility:"visible"})}break}}j=h(i,j,m);if(k){var j={label:k.o.outerWidth(),right:false,border:(f.value.prc*this.sizes.domWidth)/100};j=h(k,j,f.value.prc)}this.redrawLimits()};c.prototype.redrawLimits=function(){if(this.settings.limits){var h=[true,true];for(key in this.o.pointers){if(!this.settings.single||key==0){var l=this.o.pointers[key];var g=this.o.labels[l.uid];var k=g.o.offset().left-this.sizes.domOffset.left;var f=this.o.limits[0];if(k<f.outerWidth()){h[0]=false}var f=this.o.limits[1];if(k+g.o.outerWidth()>this.sizes.domWidth-f.outerWidth()){h[1]=false}}}for(var j=0;j<h.length;j++){if(h[j]){this.o.limits[j].fadeIn("fast")}else{this.o.limits[j].fadeOut("fast")}}}};c.prototype.setValue=function(){var h=this.getValue();this.inputNode.attr("value",h);this.onstatechange.call(this,h);if(this.settings.first_time=="N"){var g=h.split(";",2);var f=g[0];var i=g[1];d("#"+this.settings.min_control_id).attr("value",f);d("#"+this.settings.max_control_id).attr("value",i)}if(window.smartFilter!=undefined){if(this.settings.first_time=="N"){smartFilter.keyup(BX(this.settings.min_control_id))}else{this.settings.first_time="N"}}if(f==this.settings.from){d("#"+this.settings.min_control_id).attr("value","")}if(i==this.settings.to){d("#"+this.settings.max_control_id).attr("value","")}};c.prototype.getValue=function(){if(!this.is.init){return false}var g=this;var f="";d.each(this.o.pointers,function(h){if(this.value.prc!=undefined&&!isNaN(this.value.prc)){f+=(h>0?";":"")+g.prcToValue(this.value.prc)}});return f};c.prototype.getPrcValue=function(){if(!this.is.init){return false}var g=this;var f="";d.each(this.o.pointers,function(h){if(this.value.prc!=undefined&&!isNaN(this.value.prc)){f+=(h>0?";":"")+this.value.prc}});return f};c.prototype.prcToValue=function(n){if(this.settings.heterogeneity&&this.settings.heterogeneity.length>0){var k=this.settings.heterogeneity;var j=0;var m=this.settings.from;for(var g=0;g<=k.length;g++){if(k[g]){var f=k[g].split("/")}else{var f=[100,this.settings.to]}f[0]=new Number(f[0]);f[1]=new Number(f[1]);if(n>=j&&n<=f[0]){var l=m+((n-j)*(f[1]-m))/(f[0]-j)}j=f[0];m=f[1]}}else{var l=this.settings.from+(n*this.settings.interval)/100}return this.round(l)};c.prototype.valueToPrc=function(l,n){if(this.settings.heterogeneity&&this.settings.heterogeneity.length>0){var k=this.settings.heterogeneity;var j=0;var m=this.settings.from;for(var g=0;g<=k.length;g++){if(k[g]){var f=k[g].split("/")}else{var f=[100,this.settings.to]}f[0]=new Number(f[0]);f[1]=new Number(f[1]);if(l>=m&&l<=f[1]){var o=n.limits(j+(l-m)*(f[0]-j)/(f[1]-m))}j=f[0];m=f[1]}}else{var o=n.limits((l-this.settings.from)*100/this.settings.interval)}return o};c.prototype.round=function(f){f=Math.round(f/this.settings.step)*this.settings.step;if(this.settings.round){f=Math.round(f*Math.pow(10,this.settings.round))/Math.pow(10,this.settings.round)}else{f=Math.round(f)}return f};c.prototype.nice=function(f){f=f.toString().replace(/,/gi,".").replace(/ /gi,"");if(d.formatNumber){return d.formatNumber(new Number(f),this.settings.format||{}).replace(/-/gi,"&minus;")}else{return new Number(f)}};function b(){Draggable.apply(this,arguments)}b.prototype=new Draggable();b.prototype.oninit=function(h,g,f){this.uid=g;this.parent=f;this.value={};this.settings=this.parent.settings};b.prototype.onmousedown=function(f){this._parent={offset:this.parent.domNode.offset(),width:this.parent.domNode.width()};this.ptr.addDependClass("hover");this.setIndexOver()};b.prototype.onmousemove=function(g,f){var h=this._getPageCoords(g);this._set(this.calc(h.x))};b.prototype.onmouseup=function(f){if(this.parent.settings.callback&&d.isFunction(this.parent.settings.callback)){this.parent.settings.callback.call(this.parent,this.parent.getValue())}this.ptr.removeDependClass("hover")};b.prototype.setIndexOver=function(){this.parent.setPointersIndex(1);this.index(2)};b.prototype.index=function(f){this.ptr.css({zIndex:f})};b.prototype.limits=function(f){return this.parent.limits(f,this)};b.prototype.calc=function(g){var f=this.limits(((g-this._parent.offset.left)*100)/this._parent.width);return f};b.prototype.set=function(f,g){this.value.origin=this.parent.round(f);this._set(this.parent.valueToPrc(f,this),g)};b.prototype._set=function(g,f){if(!f){this.value.origin=this.parent.prcToValue(g)}this.value.prc=g;this.ptr.css({left:g+"%"});this.parent.redraw(this)}})(jQuery);