$.fn.trackbar=function(b,a){b=$.extend({onMove:function(){},dual:true,width:100,leftLimit:0,leftValue:0,rightLimit:100,rightValue:100,jq:this},b);$.trackbar.getObject(a).init(b)};$.trackbar={archive:[],getObject:function(a){if(typeof a=="undefined"){a=this.archive.length}if(typeof this.archive[a]=="undefined"){this.archive[a]=new this.hotSearch(a)}return this.archive[a]}};$.trackbar.hotSearch=function(a){this.id=a;this.leftWidth=0;this.rightWidth=0;this.width=0;this.intervalWidth=0;this.leftLimit=0;this.leftValue=0;this.rightLimit=0;this.rightValue=0;this.valueInterval=0;this.widthRem=6;this.valueWidth=0;this.roundUp=0;this.x0=0;this.y0=0;this.blockX0=0;this.rightX0=0;this.leftX0=0;this.dual=true;this.moveState=false;this.moveIntervalState=false;this.debugMode=true;this.clearLimits=false;this.clearValues=false;this.itWasMove=false;this.onMove=null;this.leftBlock=null;this.rightBlock=null;this.leftBegun=null;this.rightBegun=null;this.centerBlock=null;this.tickDiv=null;this.table=null};$.trackbar.hotSearch.prototype={ERRORS:{1:"Object initialization error",2:"Left slider was not found",3:"Right slider was not found",4:"Left resize area was not found",5:"Right resize area was not found",9:"Center click area was not found"},LEFT_BLOCK_PREFIX:"leftBlock",RIGHT_BLOCK_PREFIX:"rightBlock",LEFT_BEGUN_PREFIX:"leftBegun",RIGHT_BEGUN_PREFIX:"rightBegun",CENTER_BLOCK_PREFIX:"centerBlock",TABLE_PREFIX:"fctable_",TICKDIV_PREFIX:"tickdiv_",gebi:function(a){return this.jq.find("#"+a)[0]},addHandler:function(b,d,c,a){if(b.addEventListener){b.addEventListener(d,c,a?a:false)}else{if(b.attachEvent){b.attachEvent("on"+d,c)}else{alert(this.errorArray[9])}}},defPosition:function(b){var a=y=0;if(document.attachEvent!=null){a=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;y=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}if(!document.attachEvent&&document.addEventListener){a=b.clientX+window.scrollX;y=b.clientY+window.scrollY}return{x:a,y:y}},absPosition:function(b){var a=y=0;while(b){a+=b.offsetLeft;y+=b.offsetTop;b=b.offsetParent}return{x:a,y:y}},debug:function(c){if(!this.debugMode){return}var a="";for(var b=0;b<c.length;b++){a+=this.ERRORS[c[b]]+" : "}a=a.substring(0,a.length-3);alert(a)},init:function(c){try{for(var a in c){this[a]=c[a]}if(this.leftValue<this.leftLimit){this.leftValue=this.leftLimit}if(this.rightValue>this.rightLimit){this.rightValue=this.rightLimit}this.jq.html('<div class="tickdiv" id="'+this.TICKDIV_PREFIX+this.id+'"></div><table id="'+this.TABLE_PREFIX+this.id+'" '+(this.width?' style="width:'+this.width+'px;"':"")+'class="trackbar" onSelectStart="return false;">				<tr>					<td class="l"><div id="leftBlock" style="margin-top: -5px;"><span></span><span class="limit"></span><img id="leftBegun" ondragstart="return false;" src="/bitrix/templates/household_first/images/imgtrackbar/b_l.gif" width="12" height="23" alt="" /></div></td>					<td class="c" id="centerBlock"></td>					<td class="r"><div id="rightBlock" style="margin-top: -5px;"><span></span><span class="limit"></span><img id="rightBegun" ondragstart="return false;" src="/bitrix/templates/household_first/images/imgtrackbar/b_r.gif" width="12" height="23" alt="" /></div></td>				</tr>			</table>');if(this.onMove==null){this.debug([1,8]);return}this.leftBegun=this.gebi(this.LEFT_BEGUN_PREFIX);if(this.leftBegun==null){this.debug([1,2]);return}this.rightBegun=this.gebi(this.RIGHT_BEGUN_PREFIX);if(this.rightBegun==null){this.debug([1,3]);return}this.leftBlock=this.gebi(this.LEFT_BLOCK_PREFIX);if(this.leftBlock==null){this.debug([1,4]);return}this.rightBlock=this.gebi(this.RIGHT_BLOCK_PREFIX);if(this.rightBlock==null){this.debug([1,5]);return}this.centerBlock=this.gebi(this.CENTER_BLOCK_PREFIX);if(this.centerBlock==null){this.debug([1,9]);return}this.table=this.gebi(this.TABLE_PREFIX+this.id);this.tickDiv=this.gebi(this.TICKDIV_PREFIX+this.id);this.valueWidth=this.width-2*this.widthRem;this.rightValue=c.rightValue||this.rightLimit;this.leftValue=c.leftValue||this.leftLimit;if(!this.dual){this.rightValue=this.leftValue}this.valueInterval=this.rightLimit-this.leftLimit;this.leftWidth=parseInt((this.leftValue-this.leftLimit)/this.valueInterval*this.valueWidth)+this.widthRem;this.rightWidth=this.valueWidth-parseInt((this.rightValue-this.leftLimit)/this.valueInterval*this.valueWidth)+this.widthRem;if(!this.clearLimits){this.leftBlock.firstChild.nextSibling.innerHTML=this.leftLimit;this.rightBlock.firstChild.nextSibling.innerHTML=this.rightLimit}this.setCurrentState();this.drawTicks();this.onMove();var d=this;this.addHandler(document,"mousemove",function(e){if(d.moveState){d.moveHandler(e)}if(d.moveIntervalState){d.moveIntervalHandler(e)}});this.addHandler(document,"mouseup",function(){d.moveState=false;d.moveIntervalState=false});this.addHandler(this.leftBegun,"mousedown",function(e){e=e||window.event;if(e.preventDefault){e.preventDefault()}e.returnValue=false;d.moveState="left";d.x0=d.defPosition(e).x;d.blockX0=d.leftWidth});this.addHandler(this.rightBegun,"mousedown",function(e){e=e||window.event;if(e.preventDefault){e.preventDefault()}e.returnValue=false;d.moveState="right";d.x0=d.defPosition(e).x;d.blockX0=d.rightWidth});this.addHandler(this.centerBlock,"mousedown",function(e){e=e||window.event;if(e.preventDefault){e.preventDefault()}e.returnValue=false;d.moveIntervalState=true;d.intervalWidth=d.width-d.rightWidth-d.leftWidth;d.x0=d.defPosition(e).x;d.rightX0=d.rightWidth;d.leftX0=d.leftWidth}),this.addHandler(this.centerBlock,"click",function(e){if(!d.itWasMove){d.clickMove(e)}d.itWasMove=false});this.addHandler(this.leftBlock,"click",function(e){if(!d.itWasMove){d.clickMoveLeft(e)}d.itWasMove=false});this.addHandler(this.rightBlock,"click",function(e){if(!d.itWasMove){d.clickMoveRight(e)}d.itWasMove=false})}catch(b){this.debug([1])}},drawTicks:function(){if(this.showBigTicks){for(var a=1;a<=this.bigTicks;a++){this.tickDiv.innerHTML+='<div style="left:'+(this.widthRem+a*this.valueWidth/(this.bigTicks+1))+'px" class="tick"><span>'+parseInt(this.leftLimit+a*this.valueInterval/(this.bigTicks+1))+"</span></div>"}}if(this.showSmallTicks){for(a=1;a<=(this.smallTicks+1)*(this.bigTicks+1)-1;a++){this.tickDiv.innerHTML+='<div style="left:'+(this.widthRem+a*this.valueWidth/((this.smallTicks+1)*(this.bigTicks+1)))+'px" class="stick"></div>'}}},clickMoveRight:function(c){c=c||window.event;if(c.preventDefault){c.preventDefault()}c.returnValue=false;var a=this.defPosition(c).x-this.absPosition(this.rightBlock).x;var b=this.rightBlock.offsetWidth;if(a<=0||b<=0||b<a||(b-a)<this.widthRem){return}this.rightWidth=(b-a);this.rightCounter();this.setCurrentState();this.onMove()},clickMoveLeft:function(c){c=c||window.event;if(c.preventDefault){c.preventDefault()}c.returnValue=false;var a=this.defPosition(c).x-this.absPosition(this.leftBlock).x;var b=this.leftBlock.offsetWidth;if(a<=0||b<=0||b<a||a<this.widthRem){return}this.leftWidth=a;this.leftCounter();this.setCurrentState();this.onMove()},clickMove:function(c){c=c||window.event;if(c.preventDefault){c.preventDefault()}c.returnValue=false;var a=this.defPosition(c).x-this.absPosition(this.centerBlock).x;var b=this.centerBlock.offsetWidth;if(a<=0||b<=0||b<a){return}if(a>=b/2){this.rightWidth+=(b-a);this.rightCounter()}else{this.leftWidth+=a;this.leftCounter()}this.setCurrentState();this.onMove()},setCurrentState:function(){this.leftBlock.style.width=this.leftWidth+"px";if(!this.clearValues){this.leftBlock.firstChild.innerHTML=(!this.dual&&this.leftWidth>this.width/2)?"":this.leftValue}if(!this.dual){var a=this.leftBlock.firstChild.offsetWidth;this.leftBlock.firstChild.style.right=(this.widthRem*(1-2*(this.leftWidth-this.widthRem)/this.width)-((this.leftWidth-this.widthRem)*a/this.width))+"px"}this.rightBlock.style.width=this.rightWidth+"px";if(!this.clearValues){this.rightBlock.firstChild.innerHTML=(!this.dual&&this.rightWidth>=this.width/2)?"":this.rightValue}if(!this.dual){var a=this.rightBlock.firstChild.offsetWidth;this.rightBlock.firstChild.style.left=(this.widthRem*(1-2*(this.rightWidth-this.widthRem)/this.width)-((this.rightWidth-this.widthRem)*a/this.width))+"px"}},moveHandler:function(a){this.itWasMove=true;a=a||window.event;if(a.preventDefault){a.preventDefault()}a.returnValue=false;if(this.moveState=="left"){this.leftWidth=this.blockX0+this.defPosition(a).x-this.x0;this.leftCounter()}if(this.moveState=="right"){this.rightWidth=this.blockX0+this.x0-this.defPosition(a).x;this.rightCounter()}this.setCurrentState();this.onMove()},moveIntervalHandler:function(b){this.itWasMove=true;b=b||window.event;if(b.preventDefault){b.preventDefault()}b.returnValue=false;var a=this.defPosition(b).x-this.x0;if(a>0){this.rightWidth=this.rightX0-a>this.widthRem?this.rightX0-a:this.widthRem;this.leftWidth=this.width-this.rightWidth-this.intervalWidth}else{this.leftWidth=this.leftX0+a>this.widthRem?this.leftX0+a:this.widthRem;this.rightWidth=this.width-this.leftWidth-this.intervalWidth}this.rightCounter();this.leftCounter();this.setCurrentState();this.onMove()},updateRightValue:function(a){try{this.rightValue=parseInt(a);this.rightValue=this.rightValue<this.leftLimit?this.leftLimit:this.rightValue;this.rightValue=this.rightValue>this.rightLimit?this.rightLimit:this.rightValue;if(this.dual){this.rightValue=this.rightValue<this.leftValue?this.leftValue:this.rightValue}else{this.leftValue=this.rightValue}this.rightWidth=this.valueWidth-parseInt((this.rightValue-this.leftLimit)/this.valueInterval*this.valueWidth)+this.widthRem;this.rightWidth=isNaN(this.rightWidth)?this.widthRem:this.rightWidth;if(!this.dual){this.leftWidth=this.width-this.rightWidth}this.setCurrentState()}catch(b){}},rightCounter:function(){if(this.dual){this.rightWidth=this.rightWidth>this.width-this.leftWidth?this.width-this.leftWidth:this.rightWidth;this.rightWidth=this.rightWidth<this.widthRem?this.widthRem:this.rightWidth;this.rightValue=this.leftLimit+this.valueInterval-parseInt((this.rightWidth-this.widthRem)/this.valueWidth*this.valueInterval);if(this.roundUp){this.rightValue=parseInt(this.rightValue/this.roundUp)*this.roundUp}if(this.leftWidth+this.rightWidth>=this.width){this.rightValue=this.leftValue}}else{this.rightWidth=this.rightWidth>(this.width-this.widthRem)?this.width-this.widthRem:this.rightWidth;this.rightWidth=this.rightWidth<this.widthRem?this.widthRem:this.rightWidth;this.leftWidth=this.width-this.rightWidth;this.rightValue=this.leftLimit+this.valueInterval-parseInt((this.rightWidth-this.widthRem)/this.valueWidth*this.valueInterval);if(this.roundUp){this.rightValue=parseInt(this.rightValue/this.roundUp)*this.roundUp}this.leftValue=this.rightValue}},updateLeftValue:function(b){try{this.leftValue=parseInt(b);this.leftValue=this.leftValue<this.leftLimit?this.leftLimit:this.leftValue;this.leftValue=this.leftValue>this.rightLimit?this.rightLimit:this.leftValue;if(this.dual){this.leftValue=this.rightValue<this.leftValue?this.rightValue:this.leftValue}else{this.rightValue=this.leftValue}this.leftWidth=parseInt((this.leftValue-this.leftLimit)/this.valueInterval*this.valueWidth)+this.widthRem;this.leftWidth=isNaN(this.leftWidth)?this.widthRem:this.leftWidth;if(!this.dual){this.rightWidth=this.width-this.leftWidth}this.setCurrentState()}catch(a){}},leftCounter:function(){if(this.dual){this.leftWidth=this.leftWidth>this.width-this.rightWidth?this.width-this.rightWidth:this.leftWidth;this.leftWidth=this.leftWidth<this.widthRem?this.widthRem:this.leftWidth;this.leftValue=this.leftLimit+parseInt((this.leftWidth-this.widthRem)/this.valueWidth*this.valueInterval);if(this.roundUp){this.leftValue=parseInt(this.leftValue/this.roundUp)*this.roundUp}if(this.leftWidth+this.rightWidth>=this.width){this.leftValue=this.rightValue}}else{this.leftWidth=this.leftWidth>(this.width-this.widthRem)?this.width-this.widthRem:this.leftWidth;this.leftWidth=this.leftWidth<this.widthRem?this.widthRem:this.leftWidth;this.rightWidth=this.width-this.leftWidth;this.leftValue=this.leftLimit+parseInt((this.leftWidth-this.widthRem)/this.valueWidth*this.valueInterval);if(this.roundUp){this.leftValue=parseInt(this.leftValue/this.roundUp)*this.roundUp}this.rightValue=this.leftValue}}};