<? $GLOBALS['_589080500_']=Array('i' .'n_array','i' .'n_array','' .'preg_replace','unser' .'ia' .'liz' .'e','intv' .'al','i' .'s_ar' .'ray','ar' .'ray_k' .'eys','int' .'val','' .'is_' .'nume' .'r' .'ic','serial' .'ize','array' .'_' .'key' .'_exi' .'st' .'s','a' .'rray_' .'k' .'ey_' .'exists','intv' .'al','' .'is_array','i' .'n_a' .'rr' .'a' .'y','da' .'te','time','' .'intv' .'al','i' .'s_ar' .'ray','' .'in_a' .'r' .'r' .'ay','dat' .'e','t' .'ime','' .'in' .'t' .'val','in_' .'arra' .'y','ar' .'r' .'ay_' .'key' .'s','in_' .'arr' .'ay','i' .'n_array','pre' .'g_rep' .'lac' .'e','a' .'rray' .'_keys','int' .'va' .'l'); ?><? function _1831155264($i){$a=Array('/^(>=|<=|=|!|>|<)/','','RESULT','PROPERTY','VALUE','VALUE','FORM','PROPERTIES','Y-m-d H:i:s','DATE_CREATE','DATE_MODIFY','PROPERTIES','FORM','FORM','FORM','FORM','DATE_CREATE','DATE_CREATE','DATE_MODIFY','Y-m-d H:i:s','/^(>=|<=|=|!|>|<)/','','PROPERTIES','ID','RESULT','PROPERTIES','PROPERTY','VALUE');return $a[$i];} ?><? class CStartShopFormResult extends CStartShop implements CStartShopInterface{private static $arFieldsEditable=array('FORM');public static function getArFieldsEditable(){return static::$arFieldsEditable;}private static $arFieldsFiltering=array('ID','FORM','DATE_CREATE','DATE_MODIFY');public static function getArFieldsFiltering(){return static::$arFieldsFiltering;}public static function GetProperties($_0=array(),$_1=array()){$_0=CStartShopUtil::ArrayFilter($_0,function($_2){return $GLOBALS['_589080500_'][0]($_2,array('RESULT','PROPERTY'));},STARTSHOP_UTIL_ARRAY_FILTER_USE_KEY);$_1=CStartShopUtil::ArrayFilter($_1,function($_2){return $GLOBALS['_589080500_'][1]($GLOBALS['_589080500_'][2](_1831155264(0),_1831155264(1),$_2),array(_1831155264(2),_1831155264(3)));},STARTSHOP_UTIL_ARRAY_FILTER_USE_KEY);$_3=array();$_4=CStartShopDBQueryBX::Select()->From('startshop_form_results_values')->Where($_1)->OrderBy($_0)->Execute();while($_5=$_4->Fetch()){$_5[_1831155264(4)]=$GLOBALS['_589080500_'][3]($_5[_1831155264(5)]);$_3[]=$_5;}return CStartShopUtil::ArrayToDBResult($_3);}public static function SetProperty($_6,$_7,$_8=l__0){return static::SetProperties($_6,array($_7,$_8));}public static function SetProperties($_6,$_9){$_6=$GLOBALS['_589080500_'][4]($_6);if(!$GLOBALS['_589080500_'][5]($_9))return false;$_10=static::GetByID($_6)->Fetch();if(empty($_10))return false;$_3=CStartShopUtil::DBResultToArray(CStartShopFormProperty::GetList(array(),array('FORM'=> $_10['FORM'])),'ID');CStartShopDBQueryBX::Delete()->From('startshop_form_results_values')->Where(array('RESULT'=> $_10['ID'],'!PROPERTY'=> $GLOBALS['_589080500_'][6]($_3)))->Execute();$_11=CStartShopUtil::DBResultToArray(static::GetProperties(array(),array('RESULT'=> $_10['ID'])),'PROPERTY');foreach($_9 as $_7 => $_12){$_7=$GLOBALS['_589080500_'][7]($_7);$_12=(!empty($_12)|| $GLOBALS['_589080500_'][8]($_12))?$GLOBALS['_589080500_'][9]($_12):l__0;$_13=$GLOBALS['_589080500_'][10]($_7,$_3);$_14=$GLOBALS['_589080500_'][11]($_7,$_11);if(!$_13)continue;if($_14){CStartShopDBQueryBX::Update()->Tables('startshop_form_results_values')->Values(array('VALUE'=> $_12))->Where(array('RESULT'=> $_10['ID'],'PROPERTY'=> $_7))->Execute();}else{CStartShopDBQueryBX::Insert()->Into('startshop_form_results_values')->Values(array('RESULT'=> $_10['ID'],'PROPERTY'=> $_7,'VALUE'=> $_12))->Execute();}}return true;}public static function DeleteProperties($_6){$_6=$GLOBALS['_589080500_'][12]($_6);return static::DeletePropertiesByFilter(array('RESULT'=> $_6));}public static function DeletePropertiesByFilter($_1=array()){CStartShopDBQueryBX::Delete()->From('startshop_form_results_values')->Where($_1)->Execute();return true;}public static function DeletePropertiesAll(){CStartShopDBQueryBX::Delete()->From('startshop_form_results_values')->Execute();return true;}public static function Add($_15){if(empty($_15['FORM']))return false;$_16=(bool)CStartShopForm::GetById($_15[_1831155264(6)])->Fetch();if(!$_16)return false;$_3=$_15[_1831155264(7)];if(!$GLOBALS['_589080500_'][13]($_3))$_3=array();$_15=CStartShopUtil::ArrayFilter($_15,function($_2){return $GLOBALS['_589080500_'][14]($_2,CStartShopFormResult::getArFieldsEditable());},STARTSHOP_UTIL_ARRAY_FILTER_USE_KEY);$_17=$GLOBALS['_589080500_'][15](_1831155264(8),$GLOBALS['_589080500_'][16]());$_15[_1831155264(9)]=$_17;$_15[_1831155264(10)]=$_17;unset($_17);$_18=CStartShopDBQueryBX::Insert()->Into('startshop_form_results')->Values($_15)->Execute();if($_18){static::SetProperties($_18,$_3);return $_18;}return false;}public static function Update($_6,$_15){$_6=$GLOBALS['_589080500_'][17]($_6);$_3=$_15[_1831155264(11)];$_10=static::GetByID($_6)->Fetch();if(empty($_10))return false;if(!$GLOBALS['_589080500_'][18]($_3))$_3=false;if(isset($_15[_1831155264(12)])&& empty($_15[_1831155264(13)]))unset($_15[_1831155264(14)]);if(isset($_15[_1831155264(15)]))if(!(bool)CStartShopForm::GetByID($_15['FORM'])->Fetch())return false;$_15=CStartShopUtil::ArrayFilter($_15,function($_2){return $GLOBALS['_589080500_'][19]($_2,CStartShopFormResult::getArFieldsEditable());},STARTSHOP_UTIL_ARRAY_FILTER_USE_KEY);$_15[_1831155264(16)]=$_10[_1831155264(17)];$_15[_1831155264(18)]=$GLOBALS['_589080500_'][20](_1831155264(19),$GLOBALS['_589080500_'][21]());if(!empty($_15))CStartShopDBQueryBX::Update()->Tables('startshop_form_results')->Values($_15)->Where(array('ID'=> $_6))->Execute();if($_3 !== false){static::DeleteProperties($_6);static::SetProperties($_6,$_3);}return true;}public static function Delete($_6){$_6=$GLOBALS['_589080500_'][22]($_6);CStartShopDBQueryBX::Delete()->From('startshop_form_results')->Where(array('ID'=> $_6))->Execute();static::DeleteProperties($_6);return true;}public static function DeleteByFilter($_1=array()){$_1=CStartShopUtil::ArrayFilter($_1,function($_2){return $GLOBALS['_589080500_'][23]($_2,CStartShopFormResult::getArFieldsFiltering());},STARTSHOP_UTIL_ARRAY_FILTER_USE_KEY);$_19=$GLOBALS['_589080500_'][24](CStartShopUtil::DBResultToArray(static::GetList(array(),$_1),'ID'));CStartShopDBQueryBX::Delete()->From('startshop_form_results')->Where($_1)->Execute();if(!empty($_19)){static::DeletePropertiesByFilter(array('RESULT'=> $_19));return $_19;}return false;}public static function DeleteAll(){CStartShopDBQueryBX::Delete()->From('startshop_form_results')->Execute();static::DeletePropertiesAll();return true;}public static function GetList($_0=array(),$_1=array()){$_20=array();$_0=CStartShopUtil::ArrayFilter($_0,function($_2){return $GLOBALS['_589080500_'][25]($_2,CStartShopFormResult::getArFieldsFiltering());},STARTSHOP_UTIL_ARRAY_FILTER_USE_KEY);$_1=CStartShopUtil::ArrayFilter($_1,function($_2){return $GLOBALS['_589080500_'][26]($GLOBALS['_589080500_'][27](_1831155264(20),_1831155264(21),$_2),CStartShopFormResult::getArFieldsFiltering());},STARTSHOP_UTIL_ARRAY_FILTER_USE_KEY);$_21=CStartShopDBQueryBX::Select()->From('startshop_form_results')->Where($_1)->OrderBy($_0)->Execute();while($_10=$_21->Fetch()){$_10[_1831155264(22)]=array();$_20[$_10[_1831155264(23)]]=$_10;}if(!empty($_20)){$_19=$GLOBALS['_589080500_'][28]($_20);$_4=static::GetProperties(array(),array('RESULT'=> $_19));while($_5=$_4->Fetch())$_20[$_5[_1831155264(24)]][_1831155264(25)][$_5[_1831155264(26)]]=$_5[_1831155264(27)];}return CStartShopUtil::ArrayToDBResult($_20);}public static function GetByID($_6){$_6=$GLOBALS['_589080500_'][29]($_6);return static::GetList(array(),array('ID'=> $_6));}} ?>
