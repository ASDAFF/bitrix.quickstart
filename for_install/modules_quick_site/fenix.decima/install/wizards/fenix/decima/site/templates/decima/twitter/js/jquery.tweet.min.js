(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(a){a.fn.tweet=function(d){var r=a.extend({username:null,list:null,favorites:false,query:null,avatar_size:null,count:3,fetch:null,page:1,retweets:true,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:" I said, ",auto_join_text_ed:" I ",auto_join_text_ing:" I am ",auto_join_text_reply:" I replied to ",auto_join_text_url:" I was looking at ",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",twitter_search_url:"search.twitter.com",template:"{avatar}{time}{join} {text}",li_class:"",comparator:function(s,o){return o.tweet_time-s.tweet_time},filter:function(o){return true}},d);var b=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;function n(t,u){if(typeof t==="string"){var o=t;for(var s in u){var v=u[s];o=o.split("{"+s+"}").join(v===null?"":v)}return o}else{return t(u)}}a.extend({tweet:{t:n}});function g(s,o){return function(){var t=[];this.each(function(){t.push(this.replace(s,o))});return a(t)}}function m(o){return o.replace(/</g,"&lt;").replace(/>/g,"^&gt;")}a.fn.extend({linkUser:g(/(^|[\W])@(\w+)/gi,'$1<span class="at">@</span><a href="http://'+r.twitter_url+'/$2">$2</a>'),linkHash:g(/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi,' <a href="https://twitter.com/search?q=%23$1&lang=all'+((r.username&&r.username.length===1&&!r.list)?"&from="+r.username.join("%2BOR%2B"):"")+'" class="tweet_hashtag">#$1</a>'),makeHeart:g(/(&lt;)+[3]/gi,"<tt class='heart'>&#x2665;</tt>")});function f(s,o){return s.replace(b,function(v){var u=(/^[a-z]+:/i).test(v)?v:"http://"+v;var x=v;for(var w=0;w<o.length;++w){var t=o[w];if(t.url===u&&t.expanded_url){u=t.expanded_url;x=t.display_url;break}}return'<a href="'+m(u)+'">'+m(x)+"</a>"})}function l(o){return Date.parse(o.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"))}function q(o){var t=function(v){return parseInt(v,10)};var s=new Date();var u=t((s.getTime()-o)/1000);if(u<1){u=0}return{days:t(u/86400),hours:t(u/3600),minutes:t(u/60),seconds:t(u)}}function c(o){if(o.days>2){return"about "+o.days+" days ago"}if(o.hours>24){return"about a day ago"}if(o.hours>2){return"about "+o.hours+" hours ago"}if(o.minutes>45){return"about an hour ago"}if(o.minutes>2){return"about "+o.minutes+" minutes ago"}if(o.seconds>1){return"about "+o.seconds+" seconds ago"}return"just now"}function i(o){if(o.match(/^(@([A-Za-z0-9-_]+)) .*/i)){return r.auto_join_text_reply}else{if(o.match(b)){return r.auto_join_text_url}else{if(o.match(/^((\w+ed)|just) .*/im)){return r.auto_join_text_ed}else{if(o.match(/^(\w*ing) .*/i)){return r.auto_join_text_ing}else{return r.auto_join_text_default}}}}}function e(){return r.twitter_api_url}function p(o,s){if(s){return("user" in o)?o.user.profile_image_url_https:p(o,false).replace(/^http:\/\/[a-z0-9]{1,3}\.twimg\.com\//,"https://s3.amazonaws.com/twitter_production/")}else{return o.profile_image_url||o.user.profile_image_url}}function k(s){var t={};t.item=s;t.source=s.source;t.screen_name=s.from_user||s.user.screen_name;t.name=s.from_user_name||s.user.name;t.retweet=typeof(s.retweeted_status)!="undefined";t.tweet_time=l(s.created_at);t.join_text=r.join_text==="auto"?i(s.text):r.join_text;t.tweet_id=s.id_str;t.twitter_base="http://"+r.twitter_url+"/";t.user_url=t.twitter_base+t.screen_name;t.tweet_url=t.user_url+"/status/"+t.tweet_id;t.reply_url=t.twitter_base+"intent/tweet?in_reply_to="+t.tweet_id;t.retweet_url=t.twitter_base+"intent/retweet?tweet_id="+t.tweet_id;t.favorite_url=t.twitter_base+"intent/favorite?tweet_id="+t.tweet_id;t.retweeted_screen_name=t.retweet&&s.retweeted_status.user.screen_name;t.tweet_relative_time=c(q(t.tweet_time));t.entities=s.entities?(s.entities.urls||[]).concat(s.entities.media||[]):[];t.tweet_raw_text=t.retweet?("RT @"+t.retweeted_screen_name+" "+s.retweeted_status.text):s.text;t.tweet_text=a([f(t.tweet_raw_text,t.entities)]).linkUser().linkHash()[0];t.retweeted_tweet_text=a([f(s.text,t.entities)]).linkUser().linkHash()[0];t.tweet_text_fancy=a([t.tweet_text]).makeHeart()[0];t.avatar_size=r.avatar_size;t.avatar_url=p(t.retweet?s.retweeted_status:s,(document.location.protocol==="https:"));t.avatar_screen_name=t.retweet?t.retweeted_screen_name:t.screen_name;t.avatar_profile_url=t.twitter_base+t.avatar_screen_name;t.user=n('<a class="tweet_user" href="{user_url}">@{screen_name}</a>',t);t.join=r.join_text?n('<span class="tweet_join">{join_text}</span>',t):"";t.avatar=t.avatar_size?n('<a class="tweet_avatar" href="{avatar_profile_url}"><img src="{avatar_url}" height="{avatar_size}" width="{avatar_size}" alt="{avatar_screen_name}\'s avatar" title="{avatar_screen_name}\'s avatar" border="0"/></a>',t):"";t.time=n('<span class="tweet_time"><a href="{tweet_url}" title="view tweet on twitter">{tweet_relative_time}</a></span>',t);t.text=n('<span class="tweet_text">{tweet_text_fancy}</span>',t);t.retweeted_text=n('<span class="tweet_text">{retweeted_tweet_text}</span>',t);t.reply_action=n('<a class="tweet_action tweet_reply" href="{reply_url}">reply</a>',t);t.retweet_action=n('<a class="tweet_action tweet_retweet" href="{retweet_url}">retweet</a>',t);t.favorite_action=n('<a class="tweet_action tweet_favorite" href="{favorite_url}">favorite</a>',t);return t}function h(s,t){var o=a('<ul class="tweet_list slides">');o.append(a.map(t,function(u){return"<li"+(r.li_class?' class="'+r.li_class+'"':"")+">"+n(r.template,u)+"</li>"}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:even").addClass("tweet_odd");a(s).append(o);if(r.intro_text){o.before('<p class="tweet_intro">'+r.intro_text+"</p>")}if(r.outro_text){o.after('<p class="tweet_outro">'+r.outro_text+"</p>")}a(s).trigger("loaded").trigger((t.length===0?"empty":"full"));if(r.refresh_interval){window.setTimeout(function(){a(s).trigger("tweet:load")},1000*r.refresh_interval)}}function j(o){var s=a('<p class="loading">'+r.loading_text+"</p>");if(r.loading_text){a(o).not(":has(.tweet_list)").empty().append(s)}a.getJSON(e(),function(t){var u=a.map(t.results||t,k);u=a.grep(u,r.filter).sort(r.comparator).slice(0,r.count);a(o).trigger("tweet:retrieved",[u])})}return this.each(function(o,s){if(r.username&&typeof(r.username)==="string"){r.username=[r.username]}a(s).unbind("tweet:render").unbind("tweet:retrieved").unbind("tweet:load").bind({"tweet:load":function(){j(s)},"tweet:retrieved":function(t,u){a(s).trigger("tweet:render",[u])},"tweet:render":function(t,u){h(a(s),u)}}).trigger("tweet:load")})}}));jQuery(document).ready(function(){if(jQuery().tweet){jQuery(".tweets_display").each(function(){var b=jQuery(this);var a=b.attr("data-limit");jQuery(b).tweet({template:"{user} {text} {time}",twitter_api_url:"twitter/proxy/twitter_proxy.php?limit="+a}).bind("loaded",function(){var c=jQuery(this);if(c.is(".flexslider")){jQuery(c).flexslider({controlNav:false,smoothHeight:false,slideshow:false,animationSpeed:1000})}})})}});