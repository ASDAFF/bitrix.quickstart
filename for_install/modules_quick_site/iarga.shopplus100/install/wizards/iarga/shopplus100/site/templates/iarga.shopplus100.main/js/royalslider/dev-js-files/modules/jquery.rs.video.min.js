(function(a){a.extend(a.rsProto,{_initVideo:function(){var b=this;b._videoDefaults={autoHideArrows:true,autoHideControlNav:false,autoHideBlocks:false,youTubeCode:'<iframe src="http://www.youtube.com/embed/%id%?rel=1&autoplay=1&showinfo=0&autoplay=1" frameborder="no"></iframe>',vimeoCode:'<iframe src="http://player.vimeo.com/video/%id%?byline=0&amp;portrait=0&amp;autoplay=1" frameborder="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'};b.st.video=a.extend({},b._videoDefaults,b.st.video);b.ev.on("rsBeforeSizeSet",function(){if(b._isVideoPlaying){setTimeout(function(){var d=b._currHolder;d=d.hasClass("rsVideoContainer")?d:d.find(".rsVideoContainer");b._videoFrameHolder.css({width:d.width(),height:d.height()})},32)}});var c=a.browser.mozilla;b.ev.on("rsAfterParseNode",function(k,i,j){var f=a(i),l,g;if(j.videoURL){if(!g&&c){g=true;b._useCSS3Transitions=b._use3dTransform=false}var h=a('<div class="rsVideoContainer"></div>'),d=a('<div class="rsBtnCenterer"><div class="rsPlayBtn"><div class="rsPlayBtnIcon"></div></div></div>');if(f.hasClass("rsImg")){j.content=h.append(f).append(d)}else{j.content.find(".rsImg").wrap(h).after(d)}}})},toggleVideo:function(){var b=this;if(!b._isVideoPlaying){return b.playVideo()}else{return b.stopVideo()}},playVideo:function(){var b=this;if(!b._isVideoPlaying){var g=b.currSlide;if(!g.videoURL){return false}var f=b._currVideoContent=g.content;var e=g.videoURL,h,d,c;if(e.match(/youtu\.be/i)||e.match(/youtube\.com\/watch/i)){d=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/;c=e.match(d);if(c&&c[7].length==11){h=c[7]}if(h!==undefined){b._videoFrameHolder=b.st.video.youTubeCode.replace("%id%",h)}}else{if(e.match(/vimeo\.com/i)){d=/\/\/(www\.)?vimeo.com\/(\d+)($|\/)/;c=e.match(d);if(c){h=c[2]}if(h!==undefined){b._videoFrameHolder=b.st.video.vimeoCode.replace("%id%",h)}}}b.videoObj=a(b._videoFrameHolder);b.ev.trigger("rsOnCreateVideoElement",[e]);if(b.videoObj.length){b._videoFrameHolder=a('<div class="rsVideoFrameHolder"><div class="rsPreloader"></div><div class="rsCloseVideoBtn"><div class="rsCloseVideoIcn"></div></div></div>');b._videoFrameHolder.find(".rsPreloader").after(b.videoObj);var f=f.hasClass("rsVideoContainer")?f:f.find(".rsVideoContainer");b._videoFrameHolder.css({width:f.width(),height:f.height()}).find(".rsCloseVideoBtn").off("click.rsv").on("click.rsv",function(i){b.stopVideo();i.preventDefault();i.stopPropagation();return false});f.append(b._videoFrameHolder);if(b.isIPAD){f.addClass("rsIOSVideo")}if(b._arrowLeft&&b.st.video.autoHideArrows){b._arrowLeft.addClass("rsHidden");b._arrowRight.addClass("rsHidden");b._arrowsAutoHideLocked=true}if(b._controlNav&&b.st.video.autoHideControlNav){b._controlNav.addClass("rsHidden")}if(b.st.video.autoHideBlocks&&b.currSlide.animBlocks){b.currSlide.animBlocks.addClass("rsHidden")}setTimeout(function(){b._videoFrameHolder.addClass("rsVideoActive")},10);b.ev.trigger("rsVideoPlay");b._isVideoPlaying=true}return true}return false},stopVideo:function(){var b=this;if(b._isVideoPlaying){if(b.isIPAD){b.slider.find(".rsCloseVideoBtn").remove()}if(b._arrowLeft&&b.st.video.autoHideArrows){b._arrowLeft.removeClass("rsHidden");b._arrowRight.removeClass("rsHidden");b._arrowsAutoHideLocked=false}if(b._controlNav&&b.st.video.autoHideControlNav){b._controlNav.removeClass("rsHidden")}if(b.st.video.autoHideBlocks&&b.currSlide.animBlocks){b.currSlide.animBlocks.removeClass("rsHidden")}setTimeout(function(){b.ev.trigger("rsOnDestroyVideoElement",[b.videoObj]);b._videoFrameHolder.remove()},16);b.ev.trigger("rsVideoStop");b._isVideoPlaying=false;return true}return false}});a.rsModules.video=a.rsProto._initVideo})(jQuery);