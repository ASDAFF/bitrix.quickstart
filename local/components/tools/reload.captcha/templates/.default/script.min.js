function getXmlHttp(){var a;try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){a=false}}if(!a&&typeof XMLHttpRequest!="undefined"){a=new XMLHttpRequest()}return a}function findParent(b,a){if(b.parentNode.tagName!="HTML"){if(b.parentNode.name==a&&b.parentNode.tagName=="FORM"){return true}if(findParent(b.parentNode,a)){return true}}else{return false}}function Bind(f){f=f||window.event;var c=f.target||f.srcElement;var b="";var e="";if(!prev(prev(c))){var a=getMyElementsByClassName("forum-reply-field forum-reply-field-captcha")[0];e=first(a)}else{e=prev(prev(c))}cap_name=prev(c);var d=getXmlHttp();d.onreadystatechange=function(){if(d.readyState==4){if(d.status==200){cap_name.src="/bitrix/tools/captcha.php?"+e.name+"="+d.responseText;e.value=d.responseText}}};d.open("GET",pathExec+"?mode="+e.name,true);d.send(null)}function prev(a){do{a=a.previousSibling}while(a&&a.nodeType!=1);return a}function first(a){a=a.firstChild;return a&&a.nodeType!=1?a.nextSibling:a}function addImageObj(b){var c=b.getElementsByTagName("IMG")[0];if(c){var a=document.createElement("img");a.src=imgPath;a.onmouseup=Bind;insertAfter(a,c)}}function getMyElementsByClassName(b){var a=[];var f=new RegExp("\\b"+b+"\\b");var e=document.getElementsByTagName("*");for(var d=0;d<e.length;d++){var c=e[d].className;if(f.test(c)){a.push(e[d])}}return a}function insertAfter(c,a){var b=a.parentNode;if(b.lastchild==a){b.appendChild(c)}else{b.insertBefore(c,a.nextSibling)}};