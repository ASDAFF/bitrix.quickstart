<?php/** * Bitrix Framework * @package    Bitrix * @subpackage mlife.asz * @copyright  2014 Zahalski Andrew */namespace Mlife\Asz;use Bitrix\Main\Entity;use Bitrix\Main\Localization\Loc;Loc::loadMessages(__FILE__);class PropertyValuesTable extends Entity\DataManager {		public static $iblockNameIb = false;	public static $iblockTyperIb = false;		public static function getFilePath()	{		return __FILE__;	}		public static function getTableName()	{		if(!self::$iblockTyperIb || !self::$iblockNameIb)			return 'b_iblock_element_property';					return 'b_iblock_element_prop_s'.self::$iblockNameIb;	}		public static function getMap()	{		$tableField = array();		if(!self::$iblockTyperIb) {			$tableField['ID'] = array(				'data_type' => 'integer',				'primary' => true,				'autocomplete' => true,			);			$tableField['IBLOCK_PROPERTY_ID'] = array(				'data_type' => 'integer',			);			$tableField['IBLOCK_ELEMENT_ID'] = array(				'data_type' => 'integer',			);			$tableField['VALUE'] = array(				'data_type' => 'string',			);			$tableField['VALUE_TYPE'] = array(				'data_type' => 'string',			);			$tableField['VALUE_ENUM'] = array(				'data_type' => 'integer',			);			$tableField['VALUE_NUM'] = array(				'data_type' => 'string',			);			$tableField['DESCRIPTION'] = array(				'data_type' => 'string',			);					}else{						\CModule::IncludeModule("iblock");						$IBLOCK_ID = self::$iblockNameIb;			$properties = \CIBlockProperty::GetList(Array("sort"=>"asc", "name"=>"asc"), Array("IBLOCK_ID"=>$IBLOCK_ID));			$arProp = array();			while ($prop_fields = $properties->GetNext())			{				$arProp[] = $prop_fields;			}						$tableField["IBLOCK_ELEMENT_ID"] = array(				'data_type' => 'integer',				'primary' => true,			);			foreach($arProp as $prop){				if($prop["MULTIPLE"]=="N"){					$tableField["PROPERTY_".$prop["ID"]] = array(						'data_type' => ($prop["TYPE"]=="N" || $prop["TYPE"]=="L" || $prop["TYPE"]=="F" || $prop["TYPE"]=="G" || $prop["TYPE"]=="E") ? 'integer' : 'string',						'primary' => false,					);				}else{					\Mlife\Asz\PropmultipleTable::$iblockNameIb = self::$iblockNameIb;					$tableField["PROPERTY_".$prop["ID"]] = array(						'data_type' => '\Mlife\Asz\PropmultipleTable',						'reference' => array(							'=this.IBLOCK_ELEMENT_ID' => 'ref.IBLOCK_ELEMENT_ID',						),						'join_type' => 'left',					);				}			}		}				return $tableField;	}	}?>